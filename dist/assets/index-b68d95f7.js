(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var $a=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Py={},_H={get exports(){return Py},set exports(n){Py=n}},Kw={},Vt={},vH={get exports(){return Vt},set exports(n){Vt=n}},Ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G0=Symbol.for("react.element"),xH=Symbol.for("react.portal"),wH=Symbol.for("react.fragment"),EH=Symbol.for("react.strict_mode"),TH=Symbol.for("react.profiler"),SH=Symbol.for("react.provider"),CH=Symbol.for("react.context"),IH=Symbol.for("react.forward_ref"),RH=Symbol.for("react.suspense"),bH=Symbol.for("react.memo"),AH=Symbol.for("react.lazy"),v2=Symbol.iterator;function kH(n){return n===null||typeof n!="object"?null:(n=v2&&n[v2]||n["@@iterator"],typeof n=="function"?n:null)}var tN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nN=Object.assign,iN={};function lp(n,e,t){this.props=n,this.context=e,this.refs=iN,this.updater=t||tN}lp.prototype.isReactComponent={};lp.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};lp.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function rN(){}rN.prototype=lp.prototype;function Eb(n,e,t){this.props=n,this.context=e,this.refs=iN,this.updater=t||tN}var Tb=Eb.prototype=new rN;Tb.constructor=Eb;nN(Tb,lp.prototype);Tb.isPureReactComponent=!0;var x2=Array.isArray,sN=Object.prototype.hasOwnProperty,Sb={current:null},oN={key:!0,ref:!0,__self:!0,__source:!0};function aN(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sN.call(e,i)&&!oN.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:G0,type:n,key:s,ref:o,props:r,_owner:Sb.current}}function PH(n,e){return{$$typeof:G0,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Cb(n){return typeof n=="object"&&n!==null&&n.$$typeof===G0}function LH(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var w2=/\/+/g;function hS(n,e){return typeof n=="object"&&n!==null&&n.key!=null?LH(""+n.key):e.toString(36)}function $1(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case G0:case xH:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+hS(o,0):i,x2(r)?(t="",n!=null&&(t=n.replace(w2,"$&/")+"/"),$1(r,e,t,"",function(u){return u})):r!=null&&(Cb(r)&&(r=PH(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(w2,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",x2(n))for(var a=0;a<n.length;a++){s=n[a];var l=i+hS(s,a);o+=$1(s,e,t,l,r)}else if(l=kH(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=i+hS(s,a++),o+=$1(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function $v(n,e,t){if(n==null)return n;var i=[],r=0;return $1(n,i,"","",function(s){return e.call(t,s,r++)}),i}function MH(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var as={current:null},W1={transition:null},DH={ReactCurrentDispatcher:as,ReactCurrentBatchConfig:W1,ReactCurrentOwner:Sb};Ut.Children={map:$v,forEach:function(n,e,t){$v(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return $v(n,function(){e++}),e},toArray:function(n){return $v(n,function(e){return e})||[]},only:function(n){if(!Cb(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ut.Component=lp;Ut.Fragment=wH;Ut.Profiler=TH;Ut.PureComponent=Eb;Ut.StrictMode=EH;Ut.Suspense=RH;Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DH;Ut.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=nN({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Sb.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)sN.call(e,l)&&!oN.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:G0,type:n.type,key:r,ref:s,props:i,_owner:o}};Ut.createContext=function(n){return n={$$typeof:CH,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:SH,_context:n},n.Consumer=n};Ut.createElement=aN;Ut.createFactory=function(n){var e=aN.bind(null,n);return e.type=n,e};Ut.createRef=function(){return{current:null}};Ut.forwardRef=function(n){return{$$typeof:IH,render:n}};Ut.isValidElement=Cb;Ut.lazy=function(n){return{$$typeof:AH,_payload:{_status:-1,_result:n},_init:MH}};Ut.memo=function(n,e){return{$$typeof:bH,type:n,compare:e===void 0?null:e}};Ut.startTransition=function(n){var e=W1.transition;W1.transition={};try{n()}finally{W1.transition=e}};Ut.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ut.useCallback=function(n,e){return as.current.useCallback(n,e)};Ut.useContext=function(n){return as.current.useContext(n)};Ut.useDebugValue=function(){};Ut.useDeferredValue=function(n){return as.current.useDeferredValue(n)};Ut.useEffect=function(n,e){return as.current.useEffect(n,e)};Ut.useId=function(){return as.current.useId()};Ut.useImperativeHandle=function(n,e,t){return as.current.useImperativeHandle(n,e,t)};Ut.useInsertionEffect=function(n,e){return as.current.useInsertionEffect(n,e)};Ut.useLayoutEffect=function(n,e){return as.current.useLayoutEffect(n,e)};Ut.useMemo=function(n,e){return as.current.useMemo(n,e)};Ut.useReducer=function(n,e,t){return as.current.useReducer(n,e,t)};Ut.useRef=function(n){return as.current.useRef(n)};Ut.useState=function(n){return as.current.useState(n)};Ut.useSyncExternalStore=function(n,e,t){return as.current.useSyncExternalStore(n,e,t)};Ut.useTransition=function(){return as.current.useTransition()};Ut.version="18.2.0";(function(n){n.exports=Ut})(vH);const H1=eN(Vt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FH=Vt,OH=Symbol.for("react.element"),NH=Symbol.for("react.fragment"),zH=Object.prototype.hasOwnProperty,UH=FH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GH={key:!0,ref:!0,__self:!0,__source:!0};function lN(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)zH.call(e,i)&&!GH.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:OH,type:n,key:s,ref:o,props:r,_owner:UH.current}}Kw.Fragment=NH;Kw.jsx=lN;Kw.jsxs=lN;(function(n){n.exports=Kw})(_H);const jH=Py.Fragment,Ke=Py.jsx,Ni=Py.jsxs;var iI={},rI={},BH={get exports(){return rI},set exports(n){rI=n}},Js={},sI={},VH={get exports(){return sI},set exports(n){sI=n}},uN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(Z,pe){var ne=Z.length;Z.push(pe);e:for(;0<ne;){var ee=ne-1>>>1,j=Z[ee];if(0<r(j,pe))Z[ee]=pe,Z[ne]=j,ne=ee;else break e}}function t(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var pe=Z[0],ne=Z.pop();if(ne!==pe){Z[0]=ne;e:for(var ee=0,j=Z.length,ie=j>>>1;ee<ie;){var q=2*(ee+1)-1,H=Z[q],te=q+1,ue=Z[te];if(0>r(H,ne))te<j&&0>r(ue,H)?(Z[ee]=ue,Z[te]=ne,ee=te):(Z[ee]=H,Z[q]=ne,ee=q);else if(te<j&&0>r(ue,ne))Z[ee]=ue,Z[te]=ne,ee=te;else break e}}return pe}function r(Z,pe){var ne=Z.sortIndex-pe.sortIndex;return ne!==0?ne:Z.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,p=null,m=3,y=!1,x=!1,w=!1,R=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(Z){for(var pe=t(u);pe!==null;){if(pe.callback===null)i(u);else if(pe.startTime<=Z)i(u),pe.sortIndex=pe.expirationTime,e(l,pe);else break;pe=t(u)}}function A(Z){if(w=!1,I(Z),!x)if(t(l)!==null)x=!0,_e(L);else{var pe=t(u);pe!==null&&se(A,pe.startTime-Z)}}function L(Z,pe){x=!1,w&&(w=!1,E(N),N=-1),y=!0;var ne=m;try{for(I(pe),p=t(l);p!==null&&(!(p.expirationTime>pe)||Z&&!J());){var ee=p.callback;if(typeof ee=="function"){p.callback=null,m=p.priorityLevel;var j=ee(p.expirationTime<=pe);pe=n.unstable_now(),typeof j=="function"?p.callback=j:p===t(l)&&i(l),I(pe)}else i(l);p=t(l)}if(p!==null)var ie=!0;else{var q=t(u);q!==null&&se(A,q.startTime-pe),ie=!1}return ie}finally{p=null,m=ne,y=!1}}var F=!1,O=null,N=-1,B=5,V=-1;function J(){return!(n.unstable_now()-V<B)}function ge(){if(O!==null){var Z=n.unstable_now();V=Z;var pe=!0;try{pe=O(!0,Z)}finally{pe?he():(F=!1,O=null)}}else F=!1}var he;if(typeof T=="function")he=function(){T(ge)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,oe=de.port2;de.port1.onmessage=ge,he=function(){oe.postMessage(null)}}else he=function(){R(ge,0)};function _e(Z){O=Z,F||(F=!0,he())}function se(Z,pe){N=R(function(){Z(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Z){Z.callback=null},n.unstable_continueExecution=function(){x||y||(x=!0,_e(L))},n.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<Z?Math.floor(1e3/Z):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var pe=3;break;default:pe=m}var ne=m;m=pe;try{return Z()}finally{m=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Z,pe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ne=m;m=Z;try{return pe()}finally{m=ne}},n.unstable_scheduleCallback=function(Z,pe,ne){var ee=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ee+ne:ee):ne=ee,Z){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ne+j,Z={id:h++,callback:pe,priorityLevel:Z,startTime:ne,expirationTime:j,sortIndex:-1},ne>ee?(Z.sortIndex=ne,e(u,Z),t(l)===null&&Z===t(u)&&(w?(E(N),N=-1):w=!0,se(A,ne-ee))):(Z.sortIndex=j,e(l,Z),x||y||(x=!0,_e(L))),Z},n.unstable_shouldYield=J,n.unstable_wrapCallback=function(Z){var pe=m;return function(){var ne=m;m=pe;try{return Z.apply(this,arguments)}finally{m=ne}}}})(uN);(function(n){n.exports=uN})(VH);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cN=Vt,Ys=sI;function xe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hN=new Set,Ly={};function Tf(n,e){Dg(n,e),Dg(n+"Capture",e)}function Dg(n,e){for(Ly[n]=e,n=0;n<e.length;n++)hN.add(e[n])}var Yl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oI=Object.prototype.hasOwnProperty,$H=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,E2={},T2={};function WH(n){return oI.call(T2,n)?!0:oI.call(E2,n)?!1:$H.test(n)?T2[n]=!0:(E2[n]=!0,!1)}function HH(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function XH(n,e,t,i){if(e===null||typeof e>"u"||HH(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ls(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){vr[n]=new ls(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];vr[e]=new ls(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){vr[n]=new ls(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){vr[n]=new ls(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){vr[n]=new ls(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){vr[n]=new ls(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){vr[n]=new ls(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){vr[n]=new ls(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){vr[n]=new ls(n,5,!1,n.toLowerCase(),null,!1,!1)});var Ib=/[\-:]([a-z])/g;function Rb(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Ib,Rb);vr[e]=new ls(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Ib,Rb);vr[e]=new ls(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Ib,Rb);vr[e]=new ls(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){vr[n]=new ls(n,1,!1,n.toLowerCase(),null,!1,!1)});vr.xlinkHref=new ls("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){vr[n]=new ls(n,1,!1,n.toLowerCase(),null,!0,!0)});function bb(n,e,t,i){var r=vr.hasOwnProperty(e)?vr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(XH(e,t,r,i)&&(t=null),i||r===null?WH(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var lu=cN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wv=Symbol.for("react.element"),Vd=Symbol.for("react.portal"),$d=Symbol.for("react.fragment"),Ab=Symbol.for("react.strict_mode"),aI=Symbol.for("react.profiler"),fN=Symbol.for("react.provider"),dN=Symbol.for("react.context"),kb=Symbol.for("react.forward_ref"),lI=Symbol.for("react.suspense"),uI=Symbol.for("react.suspense_list"),Pb=Symbol.for("react.memo"),qu=Symbol.for("react.lazy"),gN=Symbol.for("react.offscreen"),S2=Symbol.iterator;function km(n){return n===null||typeof n!="object"?null:(n=S2&&n[S2]||n["@@iterator"],typeof n=="function"?n:null)}var qn=Object.assign,fS;function qm(n){if(fS===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);fS=e&&e[1]||""}return`
`+fS+n}var dS=!1;function gS(n,e){if(!n||dS)return"";dS=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{dS=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?qm(n):""}function qH(n){switch(n.tag){case 5:return qm(n.type);case 16:return qm("Lazy");case 13:return qm("Suspense");case 19:return qm("SuspenseList");case 0:case 2:case 15:return n=gS(n.type,!1),n;case 11:return n=gS(n.type.render,!1),n;case 1:return n=gS(n.type,!0),n;default:return""}}function cI(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $d:return"Fragment";case Vd:return"Portal";case aI:return"Profiler";case Ab:return"StrictMode";case lI:return"Suspense";case uI:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case dN:return(n.displayName||"Context")+".Consumer";case fN:return(n._context.displayName||"Context")+".Provider";case kb:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Pb:return e=n.displayName||null,e!==null?e:cI(n.type)||"Memo";case qu:e=n._payload,n=n._init;try{return cI(n(e))}catch{}}return null}function KH(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cI(e);case 8:return e===Ab?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rc(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function pN(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function YH(n){var e=pN(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Hv(n){n._valueTracker||(n._valueTracker=YH(n))}function mN(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=pN(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function mx(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function hI(n,e){var t=e.checked;return qn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function C2(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Rc(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yN(n,e){e=e.checked,e!=null&&bb(n,"checked",e,!1)}function fI(n,e){yN(n,e);var t=Rc(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?dI(n,e.type,t):e.hasOwnProperty("defaultValue")&&dI(n,e.type,Rc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function I2(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function dI(n,e,t){(e!=="number"||mx(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Km=Array.isArray;function ug(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Rc(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function gI(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xe(91));return qn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function R2(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(xe(92));if(Km(t)){if(1<t.length)throw Error(xe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Rc(t)}}function _N(n,e){var t=Rc(e.value),i=Rc(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function b2(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function vN(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pI(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?vN(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Xv,xN=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Xv=Xv||document.createElement("div"),Xv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xv.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function My(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var oy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ZH=["Webkit","ms","Moz","O"];Object.keys(oy).forEach(function(n){ZH.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),oy[e]=oy[n]})});function wN(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||oy.hasOwnProperty(n)&&oy[n]?(""+e).trim():e+"px"}function EN(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=wN(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var QH=qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mI(n,e){if(e){if(QH[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xe(62))}}function yI(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _I=null;function Lb(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var vI=null,cg=null,hg=null;function A2(n){if(n=V0(n)){if(typeof vI!="function")throw Error(xe(280));var e=n.stateNode;e&&(e=eE(e),vI(n.stateNode,n.type,e))}}function TN(n){cg?hg?hg.push(n):hg=[n]:cg=n}function SN(){if(cg){var n=cg,e=hg;if(hg=cg=null,A2(n),e)for(n=0;n<e.length;n++)A2(e[n])}}function CN(n,e){return n(e)}function IN(){}var pS=!1;function RN(n,e,t){if(pS)return n(e,t);pS=!0;try{return CN(n,e,t)}finally{pS=!1,(cg!==null||hg!==null)&&(IN(),SN())}}function Dy(n,e){var t=n.stateNode;if(t===null)return null;var i=eE(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(xe(231,e,typeof t));return t}var xI=!1;if(Yl)try{var Pm={};Object.defineProperty(Pm,"passive",{get:function(){xI=!0}}),window.addEventListener("test",Pm,Pm),window.removeEventListener("test",Pm,Pm)}catch{xI=!1}function JH(n,e,t,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var ay=!1,yx=null,_x=!1,wI=null,eX={onError:function(n){ay=!0,yx=n}};function tX(n,e,t,i,r,s,o,a,l){ay=!1,yx=null,JH.apply(eX,arguments)}function nX(n,e,t,i,r,s,o,a,l){if(tX.apply(this,arguments),ay){if(ay){var u=yx;ay=!1,yx=null}else throw Error(xe(198));_x||(_x=!0,wI=u)}}function Sf(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function bN(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function k2(n){if(Sf(n)!==n)throw Error(xe(188))}function iX(n){var e=n.alternate;if(!e){if(e=Sf(n),e===null)throw Error(xe(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return k2(r),n;if(s===i)return k2(r),e;s=s.sibling}throw Error(xe(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(xe(189))}}if(t.alternate!==i)throw Error(xe(190))}if(t.tag!==3)throw Error(xe(188));return t.stateNode.current===t?n:e}function AN(n){return n=iX(n),n!==null?kN(n):null}function kN(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=kN(n);if(e!==null)return e;n=n.sibling}return null}var PN=Ys.unstable_scheduleCallback,P2=Ys.unstable_cancelCallback,rX=Ys.unstable_shouldYield,sX=Ys.unstable_requestPaint,fi=Ys.unstable_now,oX=Ys.unstable_getCurrentPriorityLevel,Mb=Ys.unstable_ImmediatePriority,LN=Ys.unstable_UserBlockingPriority,vx=Ys.unstable_NormalPriority,aX=Ys.unstable_LowPriority,MN=Ys.unstable_IdlePriority,Yw=null,Ya=null;function lX(n){if(Ya&&typeof Ya.onCommitFiberRoot=="function")try{Ya.onCommitFiberRoot(Yw,n,void 0,(n.current.flags&128)===128)}catch{}}var ca=Math.clz32?Math.clz32:hX,uX=Math.log,cX=Math.LN2;function hX(n){return n>>>=0,n===0?32:31-(uX(n)/cX|0)|0}var qv=64,Kv=4194304;function Ym(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function xx(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=Ym(a):(s&=o,s!==0&&(i=Ym(s)))}else o=t&~r,o!==0?i=Ym(o):s!==0&&(i=Ym(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-ca(e),r=1<<t,i|=n[t],e&=~r;return i}function fX(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dX(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-ca(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&i)&&(r[o]=fX(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function EI(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function DN(){var n=qv;return qv<<=1,!(qv&4194240)&&(qv=64),n}function mS(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function j0(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ca(e),n[e]=t}function gX(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-ca(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function Db(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-ca(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var nn=0;function FN(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var ON,Fb,NN,zN,UN,TI=!1,Yv=[],cc=null,hc=null,fc=null,Fy=new Map,Oy=new Map,Zu=[],pX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function L2(n,e){switch(n){case"focusin":case"focusout":cc=null;break;case"dragenter":case"dragleave":hc=null;break;case"mouseover":case"mouseout":fc=null;break;case"pointerover":case"pointerout":Fy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oy.delete(e.pointerId)}}function Lm(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=V0(e),e!==null&&Fb(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function mX(n,e,t,i,r){switch(e){case"focusin":return cc=Lm(cc,n,e,t,i,r),!0;case"dragenter":return hc=Lm(hc,n,e,t,i,r),!0;case"mouseover":return fc=Lm(fc,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return Fy.set(s,Lm(Fy.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Oy.set(s,Lm(Oy.get(s)||null,n,e,t,i,r)),!0}return!1}function GN(n){var e=Eh(n.target);if(e!==null){var t=Sf(e);if(t!==null){if(e=t.tag,e===13){if(e=bN(t),e!==null){n.blockedOn=e,UN(n.priority,function(){NN(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function X1(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=SI(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);_I=i,t.target.dispatchEvent(i),_I=null}else return e=V0(t),e!==null&&Fb(e),n.blockedOn=t,!1;e.shift()}return!0}function M2(n,e,t){X1(n)&&t.delete(e)}function yX(){TI=!1,cc!==null&&X1(cc)&&(cc=null),hc!==null&&X1(hc)&&(hc=null),fc!==null&&X1(fc)&&(fc=null),Fy.forEach(M2),Oy.forEach(M2)}function Mm(n,e){n.blockedOn===e&&(n.blockedOn=null,TI||(TI=!0,Ys.unstable_scheduleCallback(Ys.unstable_NormalPriority,yX)))}function Ny(n){function e(r){return Mm(r,n)}if(0<Yv.length){Mm(Yv[0],n);for(var t=1;t<Yv.length;t++){var i=Yv[t];i.blockedOn===n&&(i.blockedOn=null)}}for(cc!==null&&Mm(cc,n),hc!==null&&Mm(hc,n),fc!==null&&Mm(fc,n),Fy.forEach(e),Oy.forEach(e),t=0;t<Zu.length;t++)i=Zu[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Zu.length&&(t=Zu[0],t.blockedOn===null);)GN(t),t.blockedOn===null&&Zu.shift()}var fg=lu.ReactCurrentBatchConfig,wx=!0;function _X(n,e,t,i){var r=nn,s=fg.transition;fg.transition=null;try{nn=1,Ob(n,e,t,i)}finally{nn=r,fg.transition=s}}function vX(n,e,t,i){var r=nn,s=fg.transition;fg.transition=null;try{nn=4,Ob(n,e,t,i)}finally{nn=r,fg.transition=s}}function Ob(n,e,t,i){if(wx){var r=SI(n,e,t,i);if(r===null)IS(n,e,i,Ex,t),L2(n,i);else if(mX(r,n,e,t,i))i.stopPropagation();else if(L2(n,i),e&4&&-1<pX.indexOf(n)){for(;r!==null;){var s=V0(r);if(s!==null&&ON(s),s=SI(n,e,t,i),s===null&&IS(n,e,i,Ex,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else IS(n,e,i,null,t)}}var Ex=null;function SI(n,e,t,i){if(Ex=null,n=Lb(i),n=Eh(n),n!==null)if(e=Sf(n),e===null)n=null;else if(t=e.tag,t===13){if(n=bN(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Ex=n,null}function jN(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oX()){case Mb:return 1;case LN:return 4;case vx:case aX:return 16;case MN:return 536870912;default:return 16}default:return 16}}var nc=null,Nb=null,q1=null;function BN(){if(q1)return q1;var n,e=Nb,t=e.length,i,r="value"in nc?nc.value:nc.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return q1=r.slice(n,1<i?1-i:void 0)}function K1(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Zv(){return!0}function D2(){return!1}function eo(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Zv:D2,this.isPropagationStopped=D2,this}return qn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Zv)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Zv)},persist:function(){},isPersistent:Zv}),e}var up={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zb=eo(up),B0=qn({},up,{view:0,detail:0}),xX=eo(B0),yS,_S,Dm,Zw=qn({},B0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ub,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Dm&&(Dm&&n.type==="mousemove"?(yS=n.screenX-Dm.screenX,_S=n.screenY-Dm.screenY):_S=yS=0,Dm=n),yS)},movementY:function(n){return"movementY"in n?n.movementY:_S}}),F2=eo(Zw),wX=qn({},Zw,{dataTransfer:0}),EX=eo(wX),TX=qn({},B0,{relatedTarget:0}),vS=eo(TX),SX=qn({},up,{animationName:0,elapsedTime:0,pseudoElement:0}),CX=eo(SX),IX=qn({},up,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),RX=eo(IX),bX=qn({},up,{data:0}),O2=eo(bX),AX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LX(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=PX[n])?!!e[n]:!1}function Ub(){return LX}var MX=qn({},B0,{key:function(n){if(n.key){var e=AX[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=K1(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?kX[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ub,charCode:function(n){return n.type==="keypress"?K1(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?K1(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),DX=eo(MX),FX=qn({},Zw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N2=eo(FX),OX=qn({},B0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ub}),NX=eo(OX),zX=qn({},up,{propertyName:0,elapsedTime:0,pseudoElement:0}),UX=eo(zX),GX=qn({},Zw,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),jX=eo(GX),BX=[9,13,27,32],Gb=Yl&&"CompositionEvent"in window,ly=null;Yl&&"documentMode"in document&&(ly=document.documentMode);var VX=Yl&&"TextEvent"in window&&!ly,VN=Yl&&(!Gb||ly&&8<ly&&11>=ly),z2=String.fromCharCode(32),U2=!1;function $N(n,e){switch(n){case"keyup":return BX.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WN(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Wd=!1;function $X(n,e){switch(n){case"compositionend":return WN(e);case"keypress":return e.which!==32?null:(U2=!0,z2);case"textInput":return n=e.data,n===z2&&U2?null:n;default:return null}}function WX(n,e){if(Wd)return n==="compositionend"||!Gb&&$N(n,e)?(n=BN(),q1=Nb=nc=null,Wd=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VN&&e.locale!=="ko"?null:e.data;default:return null}}var HX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function G2(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!HX[n.type]:e==="textarea"}function HN(n,e,t,i){TN(i),e=Tx(e,"onChange"),0<e.length&&(t=new zb("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var uy=null,zy=null;function XX(n){iz(n,0)}function Qw(n){var e=qd(n);if(mN(e))return n}function qX(n,e){if(n==="change")return e}var XN=!1;if(Yl){var xS;if(Yl){var wS="oninput"in document;if(!wS){var j2=document.createElement("div");j2.setAttribute("oninput","return;"),wS=typeof j2.oninput=="function"}xS=wS}else xS=!1;XN=xS&&(!document.documentMode||9<document.documentMode)}function B2(){uy&&(uy.detachEvent("onpropertychange",qN),zy=uy=null)}function qN(n){if(n.propertyName==="value"&&Qw(zy)){var e=[];HN(e,zy,n,Lb(n)),RN(XX,e)}}function KX(n,e,t){n==="focusin"?(B2(),uy=e,zy=t,uy.attachEvent("onpropertychange",qN)):n==="focusout"&&B2()}function YX(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Qw(zy)}function ZX(n,e){if(n==="click")return Qw(e)}function QX(n,e){if(n==="input"||n==="change")return Qw(e)}function JX(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var pa=typeof Object.is=="function"?Object.is:JX;function Uy(n,e){if(pa(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!oI.call(e,r)||!pa(n[r],e[r]))return!1}return!0}function V2(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function $2(n,e){var t=V2(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=V2(t)}}function KN(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?KN(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function YN(){for(var n=window,e=mx();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=mx(n.document)}return e}function jb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function eq(n){var e=YN(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&KN(t.ownerDocument.documentElement,t)){if(i!==null&&jb(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=$2(t,s);var o=$2(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var tq=Yl&&"documentMode"in document&&11>=document.documentMode,Hd=null,CI=null,cy=null,II=!1;function W2(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;II||Hd==null||Hd!==mx(i)||(i=Hd,"selectionStart"in i&&jb(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),cy&&Uy(cy,i)||(cy=i,i=Tx(CI,"onSelect"),0<i.length&&(e=new zb("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Hd)))}function Qv(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Xd={animationend:Qv("Animation","AnimationEnd"),animationiteration:Qv("Animation","AnimationIteration"),animationstart:Qv("Animation","AnimationStart"),transitionend:Qv("Transition","TransitionEnd")},ES={},ZN={};Yl&&(ZN=document.createElement("div").style,"AnimationEvent"in window||(delete Xd.animationend.animation,delete Xd.animationiteration.animation,delete Xd.animationstart.animation),"TransitionEvent"in window||delete Xd.transitionend.transition);function Jw(n){if(ES[n])return ES[n];if(!Xd[n])return n;var e=Xd[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in ZN)return ES[n]=e[t];return n}var QN=Jw("animationend"),JN=Jw("animationiteration"),ez=Jw("animationstart"),tz=Jw("transitionend"),nz=new Map,H2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oc(n,e){nz.set(n,e),Tf(e,[n])}for(var TS=0;TS<H2.length;TS++){var SS=H2[TS],nq=SS.toLowerCase(),iq=SS[0].toUpperCase()+SS.slice(1);Oc(nq,"on"+iq)}Oc(QN,"onAnimationEnd");Oc(JN,"onAnimationIteration");Oc(ez,"onAnimationStart");Oc("dblclick","onDoubleClick");Oc("focusin","onFocus");Oc("focusout","onBlur");Oc(tz,"onTransitionEnd");Dg("onMouseEnter",["mouseout","mouseover"]);Dg("onMouseLeave",["mouseout","mouseover"]);Dg("onPointerEnter",["pointerout","pointerover"]);Dg("onPointerLeave",["pointerout","pointerover"]);Tf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rq=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zm));function X2(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,nX(i,e,void 0,n),n.currentTarget=null}function iz(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;X2(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;X2(r,a,u),s=l}}}if(_x)throw n=wI,_x=!1,wI=null,n}function En(n,e){var t=e[PI];t===void 0&&(t=e[PI]=new Set);var i=n+"__bubble";t.has(i)||(rz(e,n,2,!1),t.add(i))}function CS(n,e,t){var i=0;e&&(i|=4),rz(t,n,i,e)}var Jv="_reactListening"+Math.random().toString(36).slice(2);function Gy(n){if(!n[Jv]){n[Jv]=!0,hN.forEach(function(t){t!=="selectionchange"&&(rq.has(t)||CS(t,!1,n),CS(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Jv]||(e[Jv]=!0,CS("selectionchange",!1,e))}}function rz(n,e,t,i){switch(jN(e)){case 1:var r=_X;break;case 4:r=vX;break;default:r=Ob}t=r.bind(null,e,t,n),r=void 0,!xI||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function IS(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Eh(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}RN(function(){var u=s,h=Lb(t),p=[];e:{var m=nz.get(n);if(m!==void 0){var y=zb,x=n;switch(n){case"keypress":if(K1(t)===0)break e;case"keydown":case"keyup":y=DX;break;case"focusin":x="focus",y=vS;break;case"focusout":x="blur",y=vS;break;case"beforeblur":case"afterblur":y=vS;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=F2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=EX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=NX;break;case QN:case JN:case ez:y=CX;break;case tz:y=UX;break;case"scroll":y=xX;break;case"wheel":y=jX;break;case"copy":case"cut":case"paste":y=RX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=N2}var w=(e&4)!==0,R=!w&&n==="scroll",E=w?m!==null?m+"Capture":null:m;w=[];for(var T=u,I;T!==null;){I=T;var A=I.stateNode;if(I.tag===5&&A!==null&&(I=A,E!==null&&(A=Dy(T,E),A!=null&&w.push(jy(T,A,I)))),R)break;T=T.return}0<w.length&&(m=new y(m,x,null,t,h),p.push({event:m,listeners:w}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",y=n==="mouseout"||n==="pointerout",m&&t!==_I&&(x=t.relatedTarget||t.fromElement)&&(Eh(x)||x[Zl]))break e;if((y||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,y?(x=t.relatedTarget||t.toElement,y=u,x=x?Eh(x):null,x!==null&&(R=Sf(x),x!==R||x.tag!==5&&x.tag!==6)&&(x=null)):(y=null,x=u),y!==x)){if(w=F2,A="onMouseLeave",E="onMouseEnter",T="mouse",(n==="pointerout"||n==="pointerover")&&(w=N2,A="onPointerLeave",E="onPointerEnter",T="pointer"),R=y==null?m:qd(y),I=x==null?m:qd(x),m=new w(A,T+"leave",y,t,h),m.target=R,m.relatedTarget=I,A=null,Eh(h)===u&&(w=new w(E,T+"enter",x,t,h),w.target=I,w.relatedTarget=R,A=w),R=A,y&&x)t:{for(w=y,E=x,T=0,I=w;I;I=Id(I))T++;for(I=0,A=E;A;A=Id(A))I++;for(;0<T-I;)w=Id(w),T--;for(;0<I-T;)E=Id(E),I--;for(;T--;){if(w===E||E!==null&&w===E.alternate)break t;w=Id(w),E=Id(E)}w=null}else w=null;y!==null&&q2(p,m,y,w,!1),x!==null&&R!==null&&q2(p,R,x,w,!0)}}e:{if(m=u?qd(u):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var L=qX;else if(G2(m))if(XN)L=QX;else{L=YX;var F=KX}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(L=ZX);if(L&&(L=L(n,u))){HN(p,L,t,h);break e}F&&F(n,m,u),n==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&dI(m,"number",m.value)}switch(F=u?qd(u):window,n){case"focusin":(G2(F)||F.contentEditable==="true")&&(Hd=F,CI=u,cy=null);break;case"focusout":cy=CI=Hd=null;break;case"mousedown":II=!0;break;case"contextmenu":case"mouseup":case"dragend":II=!1,W2(p,t,h);break;case"selectionchange":if(tq)break;case"keydown":case"keyup":W2(p,t,h)}var O;if(Gb)e:{switch(n){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Wd?$N(n,t)&&(N="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(N="onCompositionStart");N&&(VN&&t.locale!=="ko"&&(Wd||N!=="onCompositionStart"?N==="onCompositionEnd"&&Wd&&(O=BN()):(nc=h,Nb="value"in nc?nc.value:nc.textContent,Wd=!0)),F=Tx(u,N),0<F.length&&(N=new O2(N,n,null,t,h),p.push({event:N,listeners:F}),O?N.data=O:(O=WN(t),O!==null&&(N.data=O)))),(O=VX?$X(n,t):WX(n,t))&&(u=Tx(u,"onBeforeInput"),0<u.length&&(h=new O2("onBeforeInput","beforeinput",null,t,h),p.push({event:h,listeners:u}),h.data=O))}iz(p,e)})}function jy(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Tx(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Dy(n,t),s!=null&&i.unshift(jy(n,s,r)),s=Dy(n,e),s!=null&&i.push(jy(n,s,r))),n=n.return}return i}function Id(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function q2(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Dy(t,s),l!=null&&o.unshift(jy(t,l,a))):r||(l=Dy(t,s),l!=null&&o.push(jy(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var sq=/\r\n?/g,oq=/\u0000|\uFFFD/g;function K2(n){return(typeof n=="string"?n:""+n).replace(sq,`
`).replace(oq,"")}function e1(n,e,t){if(e=K2(e),K2(n)!==e&&t)throw Error(xe(425))}function Sx(){}var RI=null,bI=null;function AI(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var kI=typeof setTimeout=="function"?setTimeout:void 0,aq=typeof clearTimeout=="function"?clearTimeout:void 0,Y2=typeof Promise=="function"?Promise:void 0,lq=typeof queueMicrotask=="function"?queueMicrotask:typeof Y2<"u"?function(n){return Y2.resolve(null).then(n).catch(uq)}:kI;function uq(n){setTimeout(function(){throw n})}function RS(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),Ny(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);Ny(e)}function dc(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Z2(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var cp=Math.random().toString(36).slice(2),Wa="__reactFiber$"+cp,By="__reactProps$"+cp,Zl="__reactContainer$"+cp,PI="__reactEvents$"+cp,cq="__reactListeners$"+cp,hq="__reactHandles$"+cp;function Eh(n){var e=n[Wa];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Zl]||t[Wa]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Z2(n);n!==null;){if(t=n[Wa])return t;n=Z2(n)}return e}n=t,t=n.parentNode}return null}function V0(n){return n=n[Wa]||n[Zl],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function qd(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(xe(33))}function eE(n){return n[By]||null}var LI=[],Kd=-1;function Nc(n){return{current:n}}function In(n){0>Kd||(n.current=LI[Kd],LI[Kd]=null,Kd--)}function gn(n,e){Kd++,LI[Kd]=n.current,n.current=e}var bc={},jr=Nc(bc),Ss=Nc(!1),Gh=bc;function Fg(n,e){var t=n.type.contextTypes;if(!t)return bc;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Cs(n){return n=n.childContextTypes,n!=null}function Cx(){In(Ss),In(jr)}function Q2(n,e,t){if(jr.current!==bc)throw Error(xe(168));gn(jr,e),gn(Ss,t)}function sz(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(xe(108,KH(n)||"Unknown",r));return qn({},t,i)}function Ix(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||bc,Gh=jr.current,gn(jr,n),gn(Ss,Ss.current),!0}function J2(n,e,t){var i=n.stateNode;if(!i)throw Error(xe(169));t?(n=sz(n,e,Gh),i.__reactInternalMemoizedMergedChildContext=n,In(Ss),In(jr),gn(jr,n)):In(Ss),gn(Ss,t)}var Ml=null,tE=!1,bS=!1;function oz(n){Ml===null?Ml=[n]:Ml.push(n)}function fq(n){tE=!0,oz(n)}function zc(){if(!bS&&Ml!==null){bS=!0;var n=0,e=nn;try{var t=Ml;for(nn=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Ml=null,tE=!1}catch(r){throw Ml!==null&&(Ml=Ml.slice(n+1)),PN(Mb,zc),r}finally{nn=e,bS=!1}}return null}var Yd=[],Zd=0,Rx=null,bx=0,To=[],So=0,jh=null,zl=1,Ul="";function yh(n,e){Yd[Zd++]=bx,Yd[Zd++]=Rx,Rx=n,bx=e}function az(n,e,t){To[So++]=zl,To[So++]=Ul,To[So++]=jh,jh=n;var i=zl;n=Ul;var r=32-ca(i)-1;i&=~(1<<r),t+=1;var s=32-ca(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,zl=1<<32-ca(e)+r|t<<r|i,Ul=s+n}else zl=1<<s|t<<r|i,Ul=n}function Bb(n){n.return!==null&&(yh(n,1),az(n,1,0))}function Vb(n){for(;n===Rx;)Rx=Yd[--Zd],Yd[Zd]=null,bx=Yd[--Zd],Yd[Zd]=null;for(;n===jh;)jh=To[--So],To[So]=null,Ul=To[--So],To[So]=null,zl=To[--So],To[So]=null}var Xs=null,$s=null,An=!1,aa=null;function lz(n,e){var t=Ro(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function eM(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Xs=n,$s=dc(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Xs=n,$s=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=jh!==null?{id:zl,overflow:Ul}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ro(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Xs=n,$s=null,!0):!1;default:return!1}}function MI(n){return(n.mode&1)!==0&&(n.flags&128)===0}function DI(n){if(An){var e=$s;if(e){var t=e;if(!eM(n,e)){if(MI(n))throw Error(xe(418));e=dc(t.nextSibling);var i=Xs;e&&eM(n,e)?lz(i,t):(n.flags=n.flags&-4097|2,An=!1,Xs=n)}}else{if(MI(n))throw Error(xe(418));n.flags=n.flags&-4097|2,An=!1,Xs=n}}}function tM(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Xs=n}function t1(n){if(n!==Xs)return!1;if(!An)return tM(n),An=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!AI(n.type,n.memoizedProps)),e&&(e=$s)){if(MI(n))throw uz(),Error(xe(418));for(;e;)lz(n,e),e=dc(e.nextSibling)}if(tM(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(xe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){$s=dc(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}$s=null}}else $s=Xs?dc(n.stateNode.nextSibling):null;return!0}function uz(){for(var n=$s;n;)n=dc(n.nextSibling)}function Og(){$s=Xs=null,An=!1}function $b(n){aa===null?aa=[n]:aa.push(n)}var dq=lu.ReactCurrentBatchConfig;function ia(n,e){if(n&&n.defaultProps){e=qn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var Ax=Nc(null),kx=null,Qd=null,Wb=null;function Hb(){Wb=Qd=kx=null}function Xb(n){var e=Ax.current;In(Ax),n._currentValue=e}function FI(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function dg(n,e){kx=n,Wb=Qd=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Es=!0),n.firstContext=null)}function Mo(n){var e=n._currentValue;if(Wb!==n)if(n={context:n,memoizedValue:e,next:null},Qd===null){if(kx===null)throw Error(xe(308));Qd=n,kx.dependencies={lanes:0,firstContext:n}}else Qd=Qd.next=n;return e}var Th=null;function qb(n){Th===null?Th=[n]:Th.push(n)}function cz(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,qb(e)):(t.next=r.next,r.next=t),e.interleaved=t,Ql(n,i)}function Ql(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ku=!1;function Kb(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hz(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function $l(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function gc(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,$t&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Ql(n,t)}return r=i.interleaved,r===null?(e.next=e,qb(i)):(e.next=r.next,r.next=e),i.interleaved=e,Ql(n,t)}function Y1(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Db(n,t)}}function nM(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Px(n,e,t,i){var r=n.updateQueue;Ku=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(s!==null){var p=r.baseState;o=0,h=u=l=null,a=s;do{var m=a.lane,y=a.eventTime;if((i&m)===m){h!==null&&(h=h.next={eventTime:y,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=n,w=a;switch(m=e,y=t,w.tag){case 1:if(x=w.payload,typeof x=="function"){p=x.call(y,p,m);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,m=typeof x=="function"?x.call(y,p,m):x,m==null)break e;p=qn({},p,m);break e;case 2:Ku=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=r.effects,m===null?r.effects=[a]:m.push(a))}else y={eventTime:y,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=y,l=p):h=h.next=y,o|=m;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;m=a,a=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(1);if(h===null&&(l=p),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Vh|=o,n.lanes=o,n.memoizedState=p}}function iM(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(xe(191,r));r.call(i)}}}var fz=new cN.Component().refs;function OI(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:qn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var nE={isMounted:function(n){return(n=n._reactInternals)?Sf(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=os(),r=mc(n),s=$l(i,r);s.payload=e,t!=null&&(s.callback=t),e=gc(n,s,r),e!==null&&(ha(e,n,r,i),Y1(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=os(),r=mc(n),s=$l(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=gc(n,s,r),e!==null&&(ha(e,n,r,i),Y1(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=os(),i=mc(n),r=$l(t,i);r.tag=2,e!=null&&(r.callback=e),e=gc(n,r,i),e!==null&&(ha(e,n,i,t),Y1(e,n,i))}};function rM(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Uy(t,i)||!Uy(r,s):!0}function dz(n,e,t){var i=!1,r=bc,s=e.contextType;return typeof s=="object"&&s!==null?s=Mo(s):(r=Cs(e)?Gh:jr.current,i=e.contextTypes,s=(i=i!=null)?Fg(n,r):bc),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nE,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function sM(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&nE.enqueueReplaceState(e,e.state,null)}function NI(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs=fz,Kb(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Mo(s):(s=Cs(e)?Gh:jr.current,r.context=Fg(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(OI(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&nE.enqueueReplaceState(r,r.state,null),Px(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Fm(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(xe(309));var i=t.stateNode}if(!i)throw Error(xe(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===fz&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(xe(284));if(!t._owner)throw Error(xe(290,n))}return n}function n1(n,e){throw n=Object.prototype.toString.call(e),Error(xe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function oM(n){var e=n._init;return e(n._payload)}function gz(n){function e(E,T){if(n){var I=E.deletions;I===null?(E.deletions=[T],E.flags|=16):I.push(T)}}function t(E,T){if(!n)return null;for(;T!==null;)e(E,T),T=T.sibling;return null}function i(E,T){for(E=new Map;T!==null;)T.key!==null?E.set(T.key,T):E.set(T.index,T),T=T.sibling;return E}function r(E,T){return E=yc(E,T),E.index=0,E.sibling=null,E}function s(E,T,I){return E.index=I,n?(I=E.alternate,I!==null?(I=I.index,I<T?(E.flags|=2,T):I):(E.flags|=2,T)):(E.flags|=1048576,T)}function o(E){return n&&E.alternate===null&&(E.flags|=2),E}function a(E,T,I,A){return T===null||T.tag!==6?(T=FS(I,E.mode,A),T.return=E,T):(T=r(T,I),T.return=E,T)}function l(E,T,I,A){var L=I.type;return L===$d?h(E,T,I.props.children,A,I.key):T!==null&&(T.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===qu&&oM(L)===T.type)?(A=r(T,I.props),A.ref=Fm(E,T,I),A.return=E,A):(A=nx(I.type,I.key,I.props,null,E.mode,A),A.ref=Fm(E,T,I),A.return=E,A)}function u(E,T,I,A){return T===null||T.tag!==4||T.stateNode.containerInfo!==I.containerInfo||T.stateNode.implementation!==I.implementation?(T=OS(I,E.mode,A),T.return=E,T):(T=r(T,I.children||[]),T.return=E,T)}function h(E,T,I,A,L){return T===null||T.tag!==7?(T=Dh(I,E.mode,A,L),T.return=E,T):(T=r(T,I),T.return=E,T)}function p(E,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return T=FS(""+T,E.mode,I),T.return=E,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Wv:return I=nx(T.type,T.key,T.props,null,E.mode,I),I.ref=Fm(E,null,T),I.return=E,I;case Vd:return T=OS(T,E.mode,I),T.return=E,T;case qu:var A=T._init;return p(E,A(T._payload),I)}if(Km(T)||km(T))return T=Dh(T,E.mode,I,null),T.return=E,T;n1(E,T)}return null}function m(E,T,I,A){var L=T!==null?T.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return L!==null?null:a(E,T,""+I,A);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Wv:return I.key===L?l(E,T,I,A):null;case Vd:return I.key===L?u(E,T,I,A):null;case qu:return L=I._init,m(E,T,L(I._payload),A)}if(Km(I)||km(I))return L!==null?null:h(E,T,I,A,null);n1(E,I)}return null}function y(E,T,I,A,L){if(typeof A=="string"&&A!==""||typeof A=="number")return E=E.get(I)||null,a(T,E,""+A,L);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Wv:return E=E.get(A.key===null?I:A.key)||null,l(T,E,A,L);case Vd:return E=E.get(A.key===null?I:A.key)||null,u(T,E,A,L);case qu:var F=A._init;return y(E,T,I,F(A._payload),L)}if(Km(A)||km(A))return E=E.get(I)||null,h(T,E,A,L,null);n1(T,A)}return null}function x(E,T,I,A){for(var L=null,F=null,O=T,N=T=0,B=null;O!==null&&N<I.length;N++){O.index>N?(B=O,O=null):B=O.sibling;var V=m(E,O,I[N],A);if(V===null){O===null&&(O=B);break}n&&O&&V.alternate===null&&e(E,O),T=s(V,T,N),F===null?L=V:F.sibling=V,F=V,O=B}if(N===I.length)return t(E,O),An&&yh(E,N),L;if(O===null){for(;N<I.length;N++)O=p(E,I[N],A),O!==null&&(T=s(O,T,N),F===null?L=O:F.sibling=O,F=O);return An&&yh(E,N),L}for(O=i(E,O);N<I.length;N++)B=y(O,E,N,I[N],A),B!==null&&(n&&B.alternate!==null&&O.delete(B.key===null?N:B.key),T=s(B,T,N),F===null?L=B:F.sibling=B,F=B);return n&&O.forEach(function(J){return e(E,J)}),An&&yh(E,N),L}function w(E,T,I,A){var L=km(I);if(typeof L!="function")throw Error(xe(150));if(I=L.call(I),I==null)throw Error(xe(151));for(var F=L=null,O=T,N=T=0,B=null,V=I.next();O!==null&&!V.done;N++,V=I.next()){O.index>N?(B=O,O=null):B=O.sibling;var J=m(E,O,V.value,A);if(J===null){O===null&&(O=B);break}n&&O&&J.alternate===null&&e(E,O),T=s(J,T,N),F===null?L=J:F.sibling=J,F=J,O=B}if(V.done)return t(E,O),An&&yh(E,N),L;if(O===null){for(;!V.done;N++,V=I.next())V=p(E,V.value,A),V!==null&&(T=s(V,T,N),F===null?L=V:F.sibling=V,F=V);return An&&yh(E,N),L}for(O=i(E,O);!V.done;N++,V=I.next())V=y(O,E,N,V.value,A),V!==null&&(n&&V.alternate!==null&&O.delete(V.key===null?N:V.key),T=s(V,T,N),F===null?L=V:F.sibling=V,F=V);return n&&O.forEach(function(ge){return e(E,ge)}),An&&yh(E,N),L}function R(E,T,I,A){if(typeof I=="object"&&I!==null&&I.type===$d&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Wv:e:{for(var L=I.key,F=T;F!==null;){if(F.key===L){if(L=I.type,L===$d){if(F.tag===7){t(E,F.sibling),T=r(F,I.props.children),T.return=E,E=T;break e}}else if(F.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===qu&&oM(L)===F.type){t(E,F.sibling),T=r(F,I.props),T.ref=Fm(E,F,I),T.return=E,E=T;break e}t(E,F);break}else e(E,F);F=F.sibling}I.type===$d?(T=Dh(I.props.children,E.mode,A,I.key),T.return=E,E=T):(A=nx(I.type,I.key,I.props,null,E.mode,A),A.ref=Fm(E,T,I),A.return=E,E=A)}return o(E);case Vd:e:{for(F=I.key;T!==null;){if(T.key===F)if(T.tag===4&&T.stateNode.containerInfo===I.containerInfo&&T.stateNode.implementation===I.implementation){t(E,T.sibling),T=r(T,I.children||[]),T.return=E,E=T;break e}else{t(E,T);break}else e(E,T);T=T.sibling}T=OS(I,E.mode,A),T.return=E,E=T}return o(E);case qu:return F=I._init,R(E,T,F(I._payload),A)}if(Km(I))return x(E,T,I,A);if(km(I))return w(E,T,I,A);n1(E,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,T!==null&&T.tag===6?(t(E,T.sibling),T=r(T,I),T.return=E,E=T):(t(E,T),T=FS(I,E.mode,A),T.return=E,E=T),o(E)):t(E,T)}return R}var Ng=gz(!0),pz=gz(!1),$0={},Za=Nc($0),Vy=Nc($0),$y=Nc($0);function Sh(n){if(n===$0)throw Error(xe(174));return n}function Yb(n,e){switch(gn($y,e),gn(Vy,n),gn(Za,$0),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pI(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=pI(e,n)}In(Za),gn(Za,e)}function zg(){In(Za),In(Vy),In($y)}function mz(n){Sh($y.current);var e=Sh(Za.current),t=pI(e,n.type);e!==t&&(gn(Vy,n),gn(Za,t))}function Zb(n){Vy.current===n&&(In(Za),In(Vy))}var $n=Nc(0);function Lx(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var AS=[];function Qb(){for(var n=0;n<AS.length;n++)AS[n]._workInProgressVersionPrimary=null;AS.length=0}var Z1=lu.ReactCurrentDispatcher,kS=lu.ReactCurrentBatchConfig,Bh=0,Xn=null,Oi=null,Qi=null,Mx=!1,hy=!1,Wy=0,gq=0;function Pr(){throw Error(xe(321))}function Jb(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!pa(n[t],e[t]))return!1;return!0}function eA(n,e,t,i,r,s){if(Bh=s,Xn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Z1.current=n===null||n.memoizedState===null?_q:vq,n=t(i,r),hy){s=0;do{if(hy=!1,Wy=0,25<=s)throw Error(xe(301));s+=1,Qi=Oi=null,e.updateQueue=null,Z1.current=xq,n=t(i,r)}while(hy)}if(Z1.current=Dx,e=Oi!==null&&Oi.next!==null,Bh=0,Qi=Oi=Xn=null,Mx=!1,e)throw Error(xe(300));return n}function tA(){var n=Wy!==0;return Wy=0,n}function ja(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qi===null?Xn.memoizedState=Qi=n:Qi=Qi.next=n,Qi}function Do(){if(Oi===null){var n=Xn.alternate;n=n!==null?n.memoizedState:null}else n=Oi.next;var e=Qi===null?Xn.memoizedState:Qi.next;if(e!==null)Qi=e,Oi=n;else{if(n===null)throw Error(xe(310));Oi=n,n={memoizedState:Oi.memoizedState,baseState:Oi.baseState,baseQueue:Oi.baseQueue,queue:Oi.queue,next:null},Qi===null?Xn.memoizedState=Qi=n:Qi=Qi.next=n}return Qi}function Hy(n,e){return typeof e=="function"?e(n):e}function PS(n){var e=Do(),t=e.queue;if(t===null)throw Error(xe(311));t.lastRenderedReducer=n;var i=Oi,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var h=u.lane;if((Bh&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=i):l=l.next=p,Xn.lanes|=h,Vh|=h}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,pa(i,e.memoizedState)||(Es=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,Xn.lanes|=s,Vh|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function LS(n){var e=Do(),t=e.queue;if(t===null)throw Error(xe(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);pa(s,e.memoizedState)||(Es=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function yz(){}function _z(n,e){var t=Xn,i=Do(),r=e(),s=!pa(i.memoizedState,r);if(s&&(i.memoizedState=r,Es=!0),i=i.queue,nA(wz.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Qi!==null&&Qi.memoizedState.tag&1){if(t.flags|=2048,Xy(9,xz.bind(null,t,i,r,e),void 0,null),Ji===null)throw Error(xe(349));Bh&30||vz(t,e,r)}return r}function vz(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Xn.updateQueue,e===null?(e={lastEffect:null,stores:null},Xn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function xz(n,e,t,i){e.value=t,e.getSnapshot=i,Ez(e)&&Tz(n)}function wz(n,e,t){return t(function(){Ez(e)&&Tz(n)})}function Ez(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!pa(n,t)}catch{return!0}}function Tz(n){var e=Ql(n,1);e!==null&&ha(e,n,1,-1)}function aM(n){var e=ja();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hy,lastRenderedState:n},e.queue=n,n=n.dispatch=yq.bind(null,Xn,n),[e.memoizedState,n]}function Xy(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=Xn.updateQueue,e===null?(e={lastEffect:null,stores:null},Xn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function Sz(){return Do().memoizedState}function Q1(n,e,t,i){var r=ja();Xn.flags|=n,r.memoizedState=Xy(1|e,t,void 0,i===void 0?null:i)}function iE(n,e,t,i){var r=Do();i=i===void 0?null:i;var s=void 0;if(Oi!==null){var o=Oi.memoizedState;if(s=o.destroy,i!==null&&Jb(i,o.deps)){r.memoizedState=Xy(e,t,s,i);return}}Xn.flags|=n,r.memoizedState=Xy(1|e,t,s,i)}function lM(n,e){return Q1(8390656,8,n,e)}function nA(n,e){return iE(2048,8,n,e)}function Cz(n,e){return iE(4,2,n,e)}function Iz(n,e){return iE(4,4,n,e)}function Rz(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function bz(n,e,t){return t=t!=null?t.concat([n]):null,iE(4,4,Rz.bind(null,e,n),t)}function iA(){}function Az(n,e){var t=Do();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Jb(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function kz(n,e){var t=Do();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Jb(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function Pz(n,e,t){return Bh&21?(pa(t,e)||(t=DN(),Xn.lanes|=t,Vh|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Es=!0),n.memoizedState=t)}function pq(n,e){var t=nn;nn=t!==0&&4>t?t:4,n(!0);var i=kS.transition;kS.transition={};try{n(!1),e()}finally{nn=t,kS.transition=i}}function Lz(){return Do().memoizedState}function mq(n,e,t){var i=mc(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},Mz(n))Dz(e,t);else if(t=cz(n,e,t,i),t!==null){var r=os();ha(t,n,i,r),Fz(t,e,i)}}function yq(n,e,t){var i=mc(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(Mz(n))Dz(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,pa(a,o)){var l=e.interleaved;l===null?(r.next=r,qb(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=cz(n,e,r,i),t!==null&&(r=os(),ha(t,n,i,r),Fz(t,e,i))}}function Mz(n){var e=n.alternate;return n===Xn||e!==null&&e===Xn}function Dz(n,e){hy=Mx=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Fz(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Db(n,t)}}var Dx={readContext:Mo,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},_q={readContext:Mo,useCallback:function(n,e){return ja().memoizedState=[n,e===void 0?null:e],n},useContext:Mo,useEffect:lM,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Q1(4194308,4,Rz.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Q1(4194308,4,n,e)},useInsertionEffect:function(n,e){return Q1(4,2,n,e)},useMemo:function(n,e){var t=ja();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=ja();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=mq.bind(null,Xn,n),[i.memoizedState,n]},useRef:function(n){var e=ja();return n={current:n},e.memoizedState=n},useState:aM,useDebugValue:iA,useDeferredValue:function(n){return ja().memoizedState=n},useTransition:function(){var n=aM(!1),e=n[0];return n=pq.bind(null,n[1]),ja().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=Xn,r=ja();if(An){if(t===void 0)throw Error(xe(407));t=t()}else{if(t=e(),Ji===null)throw Error(xe(349));Bh&30||vz(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,lM(wz.bind(null,i,s,n),[n]),i.flags|=2048,Xy(9,xz.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=ja(),e=Ji.identifierPrefix;if(An){var t=Ul,i=zl;t=(i&~(1<<32-ca(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Wy++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=gq++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},vq={readContext:Mo,useCallback:Az,useContext:Mo,useEffect:nA,useImperativeHandle:bz,useInsertionEffect:Cz,useLayoutEffect:Iz,useMemo:kz,useReducer:PS,useRef:Sz,useState:function(){return PS(Hy)},useDebugValue:iA,useDeferredValue:function(n){var e=Do();return Pz(e,Oi.memoizedState,n)},useTransition:function(){var n=PS(Hy)[0],e=Do().memoizedState;return[n,e]},useMutableSource:yz,useSyncExternalStore:_z,useId:Lz,unstable_isNewReconciler:!1},xq={readContext:Mo,useCallback:Az,useContext:Mo,useEffect:nA,useImperativeHandle:bz,useInsertionEffect:Cz,useLayoutEffect:Iz,useMemo:kz,useReducer:LS,useRef:Sz,useState:function(){return LS(Hy)},useDebugValue:iA,useDeferredValue:function(n){var e=Do();return Oi===null?e.memoizedState=n:Pz(e,Oi.memoizedState,n)},useTransition:function(){var n=LS(Hy)[0],e=Do().memoizedState;return[n,e]},useMutableSource:yz,useSyncExternalStore:_z,useId:Lz,unstable_isNewReconciler:!1};function Ug(n,e){try{var t="",i=e;do t+=qH(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function MS(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function zI(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var wq=typeof WeakMap=="function"?WeakMap:Map;function Oz(n,e,t){t=$l(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Ox||(Ox=!0,qI=i),zI(n,e)},t}function Nz(n,e,t){t=$l(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){zI(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){zI(n,e),typeof i!="function"&&(pc===null?pc=new Set([this]):pc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function uM(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new wq;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=Fq.bind(null,n,e,t),e.then(n,n))}function cM(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function hM(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=$l(-1,1),e.tag=2,gc(t,e,1))),t.lanes|=1),n)}var Eq=lu.ReactCurrentOwner,Es=!1;function ts(n,e,t,i){e.child=n===null?pz(e,null,t,i):Ng(e,n.child,t,i)}function fM(n,e,t,i,r){t=t.render;var s=e.ref;return dg(e,r),i=eA(n,e,t,i,s,r),t=tA(),n!==null&&!Es?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Jl(n,e,r)):(An&&t&&Bb(e),e.flags|=1,ts(n,e,i,r),e.child)}function dM(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!hA(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,zz(n,e,s,i,r)):(n=nx(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Uy,t(o,i)&&n.ref===e.ref)return Jl(n,e,r)}return e.flags|=1,n=yc(s,i),n.ref=e.ref,n.return=e,e.child=n}function zz(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(Uy(s,i)&&n.ref===e.ref)if(Es=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(Es=!0);else return e.lanes=n.lanes,Jl(n,e,r)}return UI(n,e,t,i,r)}function Uz(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(eg,Bs),Bs|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,gn(eg,Bs),Bs|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,gn(eg,Bs),Bs|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,gn(eg,Bs),Bs|=i;return ts(n,e,r,t),e.child}function Gz(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function UI(n,e,t,i,r){var s=Cs(t)?Gh:jr.current;return s=Fg(e,s),dg(e,r),t=eA(n,e,t,i,s,r),i=tA(),n!==null&&!Es?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Jl(n,e,r)):(An&&i&&Bb(e),e.flags|=1,ts(n,e,t,r),e.child)}function gM(n,e,t,i,r){if(Cs(t)){var s=!0;Ix(e)}else s=!1;if(dg(e,r),e.stateNode===null)J1(n,e),dz(e,t,i),NI(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Mo(u):(u=Cs(t)?Gh:jr.current,u=Fg(e,u));var h=t.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&sM(e,o,i,u),Ku=!1;var m=e.memoizedState;o.state=m,Px(e,i,o,r),l=e.memoizedState,a!==i||m!==l||Ss.current||Ku?(typeof h=="function"&&(OI(e,t,h,i),l=e.memoizedState),(a=Ku||rM(e,t,a,i,m,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,hz(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:ia(e.type,a),o.props=u,p=e.pendingProps,m=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Mo(l):(l=Cs(t)?Gh:jr.current,l=Fg(e,l));var y=t.getDerivedStateFromProps;(h=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&sM(e,o,i,l),Ku=!1,m=e.memoizedState,o.state=m,Px(e,i,o,r);var x=e.memoizedState;a!==p||m!==x||Ss.current||Ku?(typeof y=="function"&&(OI(e,t,y,i),x=e.memoizedState),(u=Ku||rM(e,t,u,i,m,x,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,x,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,x,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=x),o.props=i,o.state=x,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),i=!1)}return GI(n,e,t,i,s,r)}function GI(n,e,t,i,r,s){Gz(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&J2(e,t,!1),Jl(n,e,s);i=e.stateNode,Eq.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Ng(e,n.child,null,s),e.child=Ng(e,null,a,s)):ts(n,e,a,s),e.memoizedState=i.state,r&&J2(e,t,!0),e.child}function jz(n){var e=n.stateNode;e.pendingContext?Q2(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Q2(n,e.context,!1),Yb(n,e.containerInfo)}function pM(n,e,t,i,r){return Og(),$b(r),e.flags|=256,ts(n,e,t,i),e.child}var jI={dehydrated:null,treeContext:null,retryLane:0};function BI(n){return{baseLanes:n,cachePool:null,transitions:null}}function Bz(n,e,t){var i=e.pendingProps,r=$n.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),gn($n,r&1),n===null)return DI(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=oE(o,i,0,null),n=Dh(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=BI(t),e.memoizedState=jI,n):rA(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Tq(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=yc(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=yc(a,s):(s=Dh(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?BI(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=jI,i}return s=n.child,n=s.sibling,i=yc(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function rA(n,e){return e=oE({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function i1(n,e,t,i){return i!==null&&$b(i),Ng(e,n.child,null,t),n=rA(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Tq(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=MS(Error(xe(422))),i1(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=oE({mode:"visible",children:i.children},r,0,null),s=Dh(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Ng(e,n.child,null,o),e.child.memoizedState=BI(o),e.memoizedState=jI,s);if(!(e.mode&1))return i1(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(xe(419)),i=MS(s,i,void 0),i1(n,e,o,i)}if(a=(o&n.childLanes)!==0,Es||a){if(i=Ji,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Ql(n,r),ha(i,n,r,-1))}return cA(),i=MS(Error(xe(421))),i1(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=Oq.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,$s=dc(r.nextSibling),Xs=e,An=!0,aa=null,n!==null&&(To[So++]=zl,To[So++]=Ul,To[So++]=jh,zl=n.id,Ul=n.overflow,jh=e),e=rA(e,i.children),e.flags|=4096,e)}function mM(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),FI(n.return,e,t)}function DS(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function Vz(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ts(n,e,i.children,t),i=$n.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&mM(n,t,e);else if(n.tag===19)mM(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(gn($n,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&Lx(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),DS(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&Lx(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}DS(e,!0,t,null,s);break;case"together":DS(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function J1(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Jl(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Vh|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(xe(153));if(e.child!==null){for(n=e.child,t=yc(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=yc(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Sq(n,e,t){switch(e.tag){case 3:jz(e),Og();break;case 5:mz(e);break;case 1:Cs(e.type)&&Ix(e);break;case 4:Yb(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;gn(Ax,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(gn($n,$n.current&1),e.flags|=128,null):t&e.child.childLanes?Bz(n,e,t):(gn($n,$n.current&1),n=Jl(n,e,t),n!==null?n.sibling:null);gn($n,$n.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return Vz(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),gn($n,$n.current),i)break;return null;case 22:case 23:return e.lanes=0,Uz(n,e,t)}return Jl(n,e,t)}var $z,VI,Wz,Hz;$z=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};VI=function(){};Wz=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,Sh(Za.current);var s=null;switch(t){case"input":r=hI(n,r),i=hI(n,i),s=[];break;case"select":r=qn({},r,{value:void 0}),i=qn({},i,{value:void 0}),s=[];break;case"textarea":r=gI(n,r),i=gI(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Sx)}mI(t,i);var o;t=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ly.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ly.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&En("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Hz=function(n,e,t,i){t!==i&&(e.flags|=4)};function Om(n,e){if(!An)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Lr(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function Cq(n,e,t){var i=e.pendingProps;switch(Vb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lr(e),null;case 1:return Cs(e.type)&&Cx(),Lr(e),null;case 3:return i=e.stateNode,zg(),In(Ss),In(jr),Qb(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(t1(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,aa!==null&&(ZI(aa),aa=null))),VI(n,e),Lr(e),null;case 5:Zb(e);var r=Sh($y.current);if(t=e.type,n!==null&&e.stateNode!=null)Wz(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(xe(166));return Lr(e),null}if(n=Sh(Za.current),t1(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[Wa]=e,i[By]=s,n=(e.mode&1)!==0,t){case"dialog":En("cancel",i),En("close",i);break;case"iframe":case"object":case"embed":En("load",i);break;case"video":case"audio":for(r=0;r<Zm.length;r++)En(Zm[r],i);break;case"source":En("error",i);break;case"img":case"image":case"link":En("error",i),En("load",i);break;case"details":En("toggle",i);break;case"input":C2(i,s),En("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},En("invalid",i);break;case"textarea":R2(i,s),En("invalid",i)}mI(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&e1(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&e1(i.textContent,a,n),r=["children",""+a]):Ly.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&En("scroll",i)}switch(t){case"input":Hv(i),I2(i,s,!0);break;case"textarea":Hv(i),b2(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Sx)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=vN(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[Wa]=e,n[By]=i,$z(n,e,!1,!1),e.stateNode=n;e:{switch(o=yI(t,i),t){case"dialog":En("cancel",n),En("close",n),r=i;break;case"iframe":case"object":case"embed":En("load",n),r=i;break;case"video":case"audio":for(r=0;r<Zm.length;r++)En(Zm[r],n);r=i;break;case"source":En("error",n),r=i;break;case"img":case"image":case"link":En("error",n),En("load",n),r=i;break;case"details":En("toggle",n),r=i;break;case"input":C2(n,i),r=hI(n,i),En("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=qn({},i,{value:void 0}),En("invalid",n);break;case"textarea":R2(n,i),r=gI(n,i),En("invalid",n);break;default:r=i}mI(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?EN(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&xN(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&My(n,l):typeof l=="number"&&My(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ly.hasOwnProperty(s)?l!=null&&s==="onScroll"&&En("scroll",n):l!=null&&bb(n,s,l,o))}switch(t){case"input":Hv(n),I2(n,i,!1);break;case"textarea":Hv(n),b2(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Rc(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?ug(n,!!i.multiple,s,!1):i.defaultValue!=null&&ug(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=Sx)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Lr(e),null;case 6:if(n&&e.stateNode!=null)Hz(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(xe(166));if(t=Sh($y.current),Sh(Za.current),t1(e)){if(i=e.stateNode,t=e.memoizedProps,i[Wa]=e,(s=i.nodeValue!==t)&&(n=Xs,n!==null))switch(n.tag){case 3:e1(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&e1(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Wa]=e,e.stateNode=i}return Lr(e),null;case 13:if(In($n),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(An&&$s!==null&&e.mode&1&&!(e.flags&128))uz(),Og(),e.flags|=98560,s=!1;else if(s=t1(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(xe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(xe(317));s[Wa]=e}else Og(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Lr(e),s=!1}else aa!==null&&(ZI(aa),aa=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||$n.current&1?zi===0&&(zi=3):cA())),e.updateQueue!==null&&(e.flags|=4),Lr(e),null);case 4:return zg(),VI(n,e),n===null&&Gy(e.stateNode.containerInfo),Lr(e),null;case 10:return Xb(e.type._context),Lr(e),null;case 17:return Cs(e.type)&&Cx(),Lr(e),null;case 19:if(In($n),s=e.memoizedState,s===null)return Lr(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Om(s,!1);else{if(zi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Lx(n),o!==null){for(e.flags|=128,Om(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return gn($n,$n.current&1|2),e.child}n=n.sibling}s.tail!==null&&fi()>Gg&&(e.flags|=128,i=!0,Om(s,!1),e.lanes=4194304)}else{if(!i)if(n=Lx(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Om(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!An)return Lr(e),null}else 2*fi()-s.renderingStartTime>Gg&&t!==1073741824&&(e.flags|=128,i=!0,Om(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=fi(),e.sibling=null,t=$n.current,gn($n,i?t&1|2:t&1),e):(Lr(e),null);case 22:case 23:return uA(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Bs&1073741824&&(Lr(e),e.subtreeFlags&6&&(e.flags|=8192)):Lr(e),null;case 24:return null;case 25:return null}throw Error(xe(156,e.tag))}function Iq(n,e){switch(Vb(e),e.tag){case 1:return Cs(e.type)&&Cx(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return zg(),In(Ss),In(jr),Qb(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Zb(e),null;case 13:if(In($n),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(xe(340));Og()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return In($n),null;case 4:return zg(),null;case 10:return Xb(e.type._context),null;case 22:case 23:return uA(),null;case 24:return null;default:return null}}var r1=!1,Fr=!1,Rq=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Jd(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Zn(n,e,i)}else t.current=null}function $I(n,e,t){try{t()}catch(i){Zn(n,e,i)}}var yM=!1;function bq(n,e){if(RI=wx,n=YN(),jb(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,h=0,p=n,m=null;t:for(;;){for(var y;p!==t||r!==0&&p.nodeType!==3||(a=o+r),p!==s||i!==0&&p.nodeType!==3||(l=o+i),p.nodeType===3&&(o+=p.nodeValue.length),(y=p.firstChild)!==null;)m=p,p=y;for(;;){if(p===n)break t;if(m===t&&++u===r&&(a=o),m===s&&++h===i&&(l=o),(y=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=y}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(bI={focusedElem:n,selectionRange:t},wx=!1,Ne=e;Ne!==null;)if(e=Ne,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Ne=n;else for(;Ne!==null;){e=Ne;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,R=x.memoizedState,E=e.stateNode,T=E.getSnapshotBeforeUpdate(e.elementType===e.type?w:ia(e.type,w),R);E.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(A){Zn(e,e.return,A)}if(n=e.sibling,n!==null){n.return=e.return,Ne=n;break}Ne=e.return}return x=yM,yM=!1,x}function fy(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&$I(e,t,s)}r=r.next}while(r!==i)}}function rE(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function WI(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Xz(n){var e=n.alternate;e!==null&&(n.alternate=null,Xz(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Wa],delete e[By],delete e[PI],delete e[cq],delete e[hq])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function qz(n){return n.tag===5||n.tag===3||n.tag===4}function _M(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||qz(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function HI(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Sx));else if(i!==4&&(n=n.child,n!==null))for(HI(n,e,t),n=n.sibling;n!==null;)HI(n,e,t),n=n.sibling}function XI(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(XI(n,e,t),n=n.sibling;n!==null;)XI(n,e,t),n=n.sibling}var dr=null,ra=!1;function Uu(n,e,t){for(t=t.child;t!==null;)Kz(n,e,t),t=t.sibling}function Kz(n,e,t){if(Ya&&typeof Ya.onCommitFiberUnmount=="function")try{Ya.onCommitFiberUnmount(Yw,t)}catch{}switch(t.tag){case 5:Fr||Jd(t,e);case 6:var i=dr,r=ra;dr=null,Uu(n,e,t),dr=i,ra=r,dr!==null&&(ra?(n=dr,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):dr.removeChild(t.stateNode));break;case 18:dr!==null&&(ra?(n=dr,t=t.stateNode,n.nodeType===8?RS(n.parentNode,t):n.nodeType===1&&RS(n,t),Ny(n)):RS(dr,t.stateNode));break;case 4:i=dr,r=ra,dr=t.stateNode.containerInfo,ra=!0,Uu(n,e,t),dr=i,ra=r;break;case 0:case 11:case 14:case 15:if(!Fr&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&$I(t,e,o),r=r.next}while(r!==i)}Uu(n,e,t);break;case 1:if(!Fr&&(Jd(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){Zn(t,e,a)}Uu(n,e,t);break;case 21:Uu(n,e,t);break;case 22:t.mode&1?(Fr=(i=Fr)||t.memoizedState!==null,Uu(n,e,t),Fr=i):Uu(n,e,t);break;default:Uu(n,e,t)}}function vM(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Rq),e.forEach(function(i){var r=Nq.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function ta(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:dr=a.stateNode,ra=!1;break e;case 3:dr=a.stateNode.containerInfo,ra=!0;break e;case 4:dr=a.stateNode.containerInfo,ra=!0;break e}a=a.return}if(dr===null)throw Error(xe(160));Kz(s,o,r),dr=null,ra=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Zn(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Yz(e,n),e=e.sibling}function Yz(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(ta(e,n),Oa(n),i&4){try{fy(3,n,n.return),rE(3,n)}catch(w){Zn(n,n.return,w)}try{fy(5,n,n.return)}catch(w){Zn(n,n.return,w)}}break;case 1:ta(e,n),Oa(n),i&512&&t!==null&&Jd(t,t.return);break;case 5:if(ta(e,n),Oa(n),i&512&&t!==null&&Jd(t,t.return),n.flags&32){var r=n.stateNode;try{My(r,"")}catch(w){Zn(n,n.return,w)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&yN(r,s),yI(a,o);var u=yI(a,s);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?EN(r,p):h==="dangerouslySetInnerHTML"?xN(r,p):h==="children"?My(r,p):bb(r,h,p,u)}switch(a){case"input":fI(r,s);break;case"textarea":_N(r,s);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?ug(r,!!s.multiple,y,!1):m!==!!s.multiple&&(s.defaultValue!=null?ug(r,!!s.multiple,s.defaultValue,!0):ug(r,!!s.multiple,s.multiple?[]:"",!1))}r[By]=s}catch(w){Zn(n,n.return,w)}}break;case 6:if(ta(e,n),Oa(n),i&4){if(n.stateNode===null)throw Error(xe(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(w){Zn(n,n.return,w)}}break;case 3:if(ta(e,n),Oa(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Ny(e.containerInfo)}catch(w){Zn(n,n.return,w)}break;case 4:ta(e,n),Oa(n);break;case 13:ta(e,n),Oa(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(aA=fi())),i&4&&vM(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Fr=(u=Fr)||h,ta(e,n),Fr=u):ta(e,n),Oa(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(Ne=n,h=n.child;h!==null;){for(p=Ne=h;Ne!==null;){switch(m=Ne,y=m.child,m.tag){case 0:case 11:case 14:case 15:fy(4,m,m.return);break;case 1:Jd(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){i=m,t=m.return;try{e=i,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){Zn(i,t,w)}}break;case 5:Jd(m,m.return);break;case 22:if(m.memoizedState!==null){wM(p);continue}}y!==null?(y.return=m,Ne=y):wM(p)}h=h.sibling}e:for(h=null,p=n;;){if(p.tag===5){if(h===null){h=p;try{r=p.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=wN("display",o))}catch(w){Zn(n,n.return,w)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(w){Zn(n,n.return,w)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===n)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===n)break e;for(;p.sibling===null;){if(p.return===null||p.return===n)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ta(e,n),Oa(n),i&4&&vM(n);break;case 21:break;default:ta(e,n),Oa(n)}}function Oa(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(qz(t)){var i=t;break e}t=t.return}throw Error(xe(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(My(r,""),i.flags&=-33);var s=_M(n);XI(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=_M(n);HI(n,a,o);break;default:throw Error(xe(161))}}catch(l){Zn(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Aq(n,e,t){Ne=n,Zz(n)}function Zz(n,e,t){for(var i=(n.mode&1)!==0;Ne!==null;){var r=Ne,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||r1;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Fr;a=r1;var u=Fr;if(r1=o,(Fr=l)&&!u)for(Ne=r;Ne!==null;)o=Ne,l=o.child,o.tag===22&&o.memoizedState!==null?EM(r):l!==null?(l.return=o,Ne=l):EM(r);for(;s!==null;)Ne=s,Zz(s),s=s.sibling;Ne=r,r1=a,Fr=u}xM(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Ne=s):xM(n)}}function xM(n){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fr||rE(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Fr)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:ia(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&iM(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}iM(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Ny(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}Fr||e.flags&512&&WI(e)}catch(m){Zn(e,e.return,m)}}if(e===n){Ne=null;break}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}}function wM(n){for(;Ne!==null;){var e=Ne;if(e===n){Ne=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Ne=t;break}Ne=e.return}}function EM(n){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{rE(4,e)}catch(l){Zn(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Zn(e,r,l)}}var s=e.return;try{WI(e)}catch(l){Zn(e,s,l)}break;case 5:var o=e.return;try{WI(e)}catch(l){Zn(e,o,l)}}}catch(l){Zn(e,e.return,l)}if(e===n){Ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ne=a;break}Ne=e.return}}var kq=Math.ceil,Fx=lu.ReactCurrentDispatcher,sA=lu.ReactCurrentOwner,Ao=lu.ReactCurrentBatchConfig,$t=0,Ji=null,xi=null,mr=0,Bs=0,eg=Nc(0),zi=0,qy=null,Vh=0,sE=0,oA=0,dy=null,xs=null,aA=0,Gg=1/0,Ll=null,Ox=!1,qI=null,pc=null,s1=!1,ic=null,Nx=0,gy=0,KI=null,ex=-1,tx=0;function os(){return $t&6?fi():ex!==-1?ex:ex=fi()}function mc(n){return n.mode&1?$t&2&&mr!==0?mr&-mr:dq.transition!==null?(tx===0&&(tx=DN()),tx):(n=nn,n!==0||(n=window.event,n=n===void 0?16:jN(n.type)),n):1}function ha(n,e,t,i){if(50<gy)throw gy=0,KI=null,Error(xe(185));j0(n,t,i),(!($t&2)||n!==Ji)&&(n===Ji&&(!($t&2)&&(sE|=t),zi===4&&Qu(n,mr)),Is(n,i),t===1&&$t===0&&!(e.mode&1)&&(Gg=fi()+500,tE&&zc()))}function Is(n,e){var t=n.callbackNode;dX(n,e);var i=xx(n,n===Ji?mr:0);if(i===0)t!==null&&P2(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&P2(t),e===1)n.tag===0?fq(TM.bind(null,n)):oz(TM.bind(null,n)),lq(function(){!($t&6)&&zc()}),t=null;else{switch(FN(i)){case 1:t=Mb;break;case 4:t=LN;break;case 16:t=vx;break;case 536870912:t=MN;break;default:t=vx}t=s3(t,Qz.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Qz(n,e){if(ex=-1,tx=0,$t&6)throw Error(xe(327));var t=n.callbackNode;if(gg()&&n.callbackNode!==t)return null;var i=xx(n,n===Ji?mr:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=zx(n,i);else{e=i;var r=$t;$t|=2;var s=e3();(Ji!==n||mr!==e)&&(Ll=null,Gg=fi()+500,Mh(n,e));do try{Mq();break}catch(a){Jz(n,a)}while(1);Hb(),Fx.current=s,$t=r,xi!==null?e=0:(Ji=null,mr=0,e=zi)}if(e!==0){if(e===2&&(r=EI(n),r!==0&&(i=r,e=YI(n,r))),e===1)throw t=qy,Mh(n,0),Qu(n,i),Is(n,fi()),t;if(e===6)Qu(n,i);else{if(r=n.current.alternate,!(i&30)&&!Pq(r)&&(e=zx(n,i),e===2&&(s=EI(n),s!==0&&(i=s,e=YI(n,s))),e===1))throw t=qy,Mh(n,0),Qu(n,i),Is(n,fi()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(xe(345));case 2:_h(n,xs,Ll);break;case 3:if(Qu(n,i),(i&130023424)===i&&(e=aA+500-fi(),10<e)){if(xx(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){os(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=kI(_h.bind(null,n,xs,Ll),e);break}_h(n,xs,Ll);break;case 4:if(Qu(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-ca(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=fi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*kq(i/1960))-i,10<i){n.timeoutHandle=kI(_h.bind(null,n,xs,Ll),i);break}_h(n,xs,Ll);break;case 5:_h(n,xs,Ll);break;default:throw Error(xe(329))}}}return Is(n,fi()),n.callbackNode===t?Qz.bind(null,n):null}function YI(n,e){var t=dy;return n.current.memoizedState.isDehydrated&&(Mh(n,e).flags|=256),n=zx(n,e),n!==2&&(e=xs,xs=t,e!==null&&ZI(e)),n}function ZI(n){xs===null?xs=n:xs.push.apply(xs,n)}function Pq(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!pa(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qu(n,e){for(e&=~oA,e&=~sE,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ca(e),i=1<<t;n[t]=-1,e&=~i}}function TM(n){if($t&6)throw Error(xe(327));gg();var e=xx(n,0);if(!(e&1))return Is(n,fi()),null;var t=zx(n,e);if(n.tag!==0&&t===2){var i=EI(n);i!==0&&(e=i,t=YI(n,i))}if(t===1)throw t=qy,Mh(n,0),Qu(n,e),Is(n,fi()),t;if(t===6)throw Error(xe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,_h(n,xs,Ll),Is(n,fi()),null}function lA(n,e){var t=$t;$t|=1;try{return n(e)}finally{$t=t,$t===0&&(Gg=fi()+500,tE&&zc())}}function $h(n){ic!==null&&ic.tag===0&&!($t&6)&&gg();var e=$t;$t|=1;var t=Ao.transition,i=nn;try{if(Ao.transition=null,nn=1,n)return n()}finally{nn=i,Ao.transition=t,$t=e,!($t&6)&&zc()}}function uA(){Bs=eg.current,In(eg)}function Mh(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,aq(t)),xi!==null)for(t=xi.return;t!==null;){var i=t;switch(Vb(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Cx();break;case 3:zg(),In(Ss),In(jr),Qb();break;case 5:Zb(i);break;case 4:zg();break;case 13:In($n);break;case 19:In($n);break;case 10:Xb(i.type._context);break;case 22:case 23:uA()}t=t.return}if(Ji=n,xi=n=yc(n.current,null),mr=Bs=e,zi=0,qy=null,oA=sE=Vh=0,xs=dy=null,Th!==null){for(e=0;e<Th.length;e++)if(t=Th[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}Th=null}return n}function Jz(n,e){do{var t=xi;try{if(Hb(),Z1.current=Dx,Mx){for(var i=Xn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Mx=!1}if(Bh=0,Qi=Oi=Xn=null,hy=!1,Wy=0,sA.current=null,t===null||t.return===null){zi=1,qy=e,xi=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=mr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=cM(o);if(y!==null){y.flags&=-257,hM(y,o,a,s,e),y.mode&1&&uM(s,u,e),e=y,l=u;var x=e.updateQueue;if(x===null){var w=new Set;w.add(l),e.updateQueue=w}else x.add(l);break e}else{if(!(e&1)){uM(s,u,e),cA();break e}l=Error(xe(426))}}else if(An&&a.mode&1){var R=cM(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),hM(R,o,a,s,e),$b(Ug(l,a));break e}}s=l=Ug(l,a),zi!==4&&(zi=2),dy===null?dy=[s]:dy.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var E=Oz(s,l,e);nM(s,E);break e;case 1:a=l;var T=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(pc===null||!pc.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var A=Nz(s,a,e);nM(s,A);break e}}s=s.return}while(s!==null)}n3(t)}catch(L){e=L,xi===t&&t!==null&&(xi=t=t.return);continue}break}while(1)}function e3(){var n=Fx.current;return Fx.current=Dx,n===null?Dx:n}function cA(){(zi===0||zi===3||zi===2)&&(zi=4),Ji===null||!(Vh&268435455)&&!(sE&268435455)||Qu(Ji,mr)}function zx(n,e){var t=$t;$t|=2;var i=e3();(Ji!==n||mr!==e)&&(Ll=null,Mh(n,e));do try{Lq();break}catch(r){Jz(n,r)}while(1);if(Hb(),$t=t,Fx.current=i,xi!==null)throw Error(xe(261));return Ji=null,mr=0,zi}function Lq(){for(;xi!==null;)t3(xi)}function Mq(){for(;xi!==null&&!rX();)t3(xi)}function t3(n){var e=r3(n.alternate,n,Bs);n.memoizedProps=n.pendingProps,e===null?n3(n):xi=e,sA.current=null}function n3(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Iq(t,e),t!==null){t.flags&=32767,xi=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{zi=6,xi=null;return}}else if(t=Cq(t,e,Bs),t!==null){xi=t;return}if(e=e.sibling,e!==null){xi=e;return}xi=e=n}while(e!==null);zi===0&&(zi=5)}function _h(n,e,t){var i=nn,r=Ao.transition;try{Ao.transition=null,nn=1,Dq(n,e,t,i)}finally{Ao.transition=r,nn=i}return null}function Dq(n,e,t,i){do gg();while(ic!==null);if($t&6)throw Error(xe(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(xe(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(gX(n,s),n===Ji&&(xi=Ji=null,mr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||s1||(s1=!0,s3(vx,function(){return gg(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Ao.transition,Ao.transition=null;var o=nn;nn=1;var a=$t;$t|=4,sA.current=null,bq(n,t),Yz(t,n),eq(bI),wx=!!RI,bI=RI=null,n.current=t,Aq(t),sX(),$t=a,nn=o,Ao.transition=s}else n.current=t;if(s1&&(s1=!1,ic=n,Nx=r),s=n.pendingLanes,s===0&&(pc=null),lX(t.stateNode),Is(n,fi()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Ox)throw Ox=!1,n=qI,qI=null,n;return Nx&1&&n.tag!==0&&gg(),s=n.pendingLanes,s&1?n===KI?gy++:(gy=0,KI=n):gy=0,zc(),null}function gg(){if(ic!==null){var n=FN(Nx),e=Ao.transition,t=nn;try{if(Ao.transition=null,nn=16>n?16:n,ic===null)var i=!1;else{if(n=ic,ic=null,Nx=0,$t&6)throw Error(xe(331));var r=$t;for($t|=4,Ne=n.current;Ne!==null;){var s=Ne,o=s.child;if(Ne.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ne=u;Ne!==null;){var h=Ne;switch(h.tag){case 0:case 11:case 15:fy(8,h,s)}var p=h.child;if(p!==null)p.return=h,Ne=p;else for(;Ne!==null;){h=Ne;var m=h.sibling,y=h.return;if(Xz(h),h===u){Ne=null;break}if(m!==null){m.return=y,Ne=m;break}Ne=y}}}var x=s.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var R=w.sibling;w.sibling=null,w=R}while(w!==null)}}Ne=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ne=o;else e:for(;Ne!==null;){if(s=Ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:fy(9,s,s.return)}var E=s.sibling;if(E!==null){E.return=s.return,Ne=E;break e}Ne=s.return}}var T=n.current;for(Ne=T;Ne!==null;){o=Ne;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,Ne=I;else e:for(o=T;Ne!==null;){if(a=Ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:rE(9,a)}}catch(L){Zn(a,a.return,L)}if(a===o){Ne=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,Ne=A;break e}Ne=a.return}}if($t=r,zc(),Ya&&typeof Ya.onPostCommitFiberRoot=="function")try{Ya.onPostCommitFiberRoot(Yw,n)}catch{}i=!0}return i}finally{nn=t,Ao.transition=e}}return!1}function SM(n,e,t){e=Ug(t,e),e=Oz(n,e,1),n=gc(n,e,1),e=os(),n!==null&&(j0(n,1,e),Is(n,e))}function Zn(n,e,t){if(n.tag===3)SM(n,n,t);else for(;e!==null;){if(e.tag===3){SM(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(pc===null||!pc.has(i))){n=Ug(t,n),n=Nz(e,n,1),e=gc(e,n,1),n=os(),e!==null&&(j0(e,1,n),Is(e,n));break}}e=e.return}}function Fq(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=os(),n.pingedLanes|=n.suspendedLanes&t,Ji===n&&(mr&t)===t&&(zi===4||zi===3&&(mr&130023424)===mr&&500>fi()-aA?Mh(n,0):oA|=t),Is(n,e)}function i3(n,e){e===0&&(n.mode&1?(e=Kv,Kv<<=1,!(Kv&130023424)&&(Kv=4194304)):e=1);var t=os();n=Ql(n,e),n!==null&&(j0(n,e,t),Is(n,t))}function Oq(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),i3(n,t)}function Nq(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(xe(314))}i!==null&&i.delete(e),i3(n,t)}var r3;r3=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ss.current)Es=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Es=!1,Sq(n,e,t);Es=!!(n.flags&131072)}else Es=!1,An&&e.flags&1048576&&az(e,bx,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;J1(n,e),n=e.pendingProps;var r=Fg(e,jr.current);dg(e,t),r=eA(null,e,i,n,r,t);var s=tA();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Cs(i)?(s=!0,Ix(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Kb(e),r.updater=nE,e.stateNode=r,r._reactInternals=e,NI(e,i,n,t),e=GI(null,e,i,!0,s,t)):(e.tag=0,An&&s&&Bb(e),ts(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(J1(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=Uq(i),n=ia(i,n),r){case 0:e=UI(null,e,i,n,t);break e;case 1:e=gM(null,e,i,n,t);break e;case 11:e=fM(null,e,i,n,t);break e;case 14:e=dM(null,e,i,ia(i.type,n),t);break e}throw Error(xe(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:ia(i,r),UI(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:ia(i,r),gM(n,e,i,r,t);case 3:e:{if(jz(e),n===null)throw Error(xe(387));i=e.pendingProps,s=e.memoizedState,r=s.element,hz(n,e),Px(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Ug(Error(xe(423)),e),e=pM(n,e,i,t,r);break e}else if(i!==r){r=Ug(Error(xe(424)),e),e=pM(n,e,i,t,r);break e}else for($s=dc(e.stateNode.containerInfo.firstChild),Xs=e,An=!0,aa=null,t=pz(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Og(),i===r){e=Jl(n,e,t);break e}ts(n,e,i,t)}e=e.child}return e;case 5:return mz(e),n===null&&DI(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,AI(i,r)?o=null:s!==null&&AI(i,s)&&(e.flags|=32),Gz(n,e),ts(n,e,o,t),e.child;case 6:return n===null&&DI(e),null;case 13:return Bz(n,e,t);case 4:return Yb(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Ng(e,null,i,t):ts(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:ia(i,r),fM(n,e,i,r,t);case 7:return ts(n,e,e.pendingProps,t),e.child;case 8:return ts(n,e,e.pendingProps.children,t),e.child;case 12:return ts(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,gn(Ax,i._currentValue),i._currentValue=o,s!==null)if(pa(s.value,o)){if(s.children===r.children&&!Ss.current){e=Jl(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=$l(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),FI(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(xe(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),FI(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ts(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,dg(e,t),r=Mo(r),i=i(r),e.flags|=1,ts(n,e,i,t),e.child;case 14:return i=e.type,r=ia(i,e.pendingProps),r=ia(i.type,r),dM(n,e,i,r,t);case 15:return zz(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:ia(i,r),J1(n,e),e.tag=1,Cs(i)?(n=!0,Ix(e)):n=!1,dg(e,t),dz(e,i,r),NI(e,i,r,t),GI(null,e,i,!0,n,t);case 19:return Vz(n,e,t);case 22:return Uz(n,e,t)}throw Error(xe(156,e.tag))};function s3(n,e){return PN(n,e)}function zq(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ro(n,e,t,i){return new zq(n,e,t,i)}function hA(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Uq(n){if(typeof n=="function")return hA(n)?1:0;if(n!=null){if(n=n.$$typeof,n===kb)return 11;if(n===Pb)return 14}return 2}function yc(n,e){var t=n.alternate;return t===null?(t=Ro(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function nx(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")hA(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case $d:return Dh(t.children,r,s,e);case Ab:o=8,r|=8;break;case aI:return n=Ro(12,t,e,r|2),n.elementType=aI,n.lanes=s,n;case lI:return n=Ro(13,t,e,r),n.elementType=lI,n.lanes=s,n;case uI:return n=Ro(19,t,e,r),n.elementType=uI,n.lanes=s,n;case gN:return oE(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case fN:o=10;break e;case dN:o=9;break e;case kb:o=11;break e;case Pb:o=14;break e;case qu:o=16,i=null;break e}throw Error(xe(130,n==null?n:typeof n,""))}return e=Ro(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function Dh(n,e,t,i){return n=Ro(7,n,i,e),n.lanes=t,n}function oE(n,e,t,i){return n=Ro(22,n,i,e),n.elementType=gN,n.lanes=t,n.stateNode={isHidden:!1},n}function FS(n,e,t){return n=Ro(6,n,null,e),n.lanes=t,n}function OS(n,e,t){return e=Ro(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Gq(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mS(0),this.expirationTimes=mS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mS(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function fA(n,e,t,i,r,s,o,a,l){return n=new Gq(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ro(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kb(s),n}function jq(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vd,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function o3(n){if(!n)return bc;n=n._reactInternals;e:{if(Sf(n)!==n||n.tag!==1)throw Error(xe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Cs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xe(171))}if(n.tag===1){var t=n.type;if(Cs(t))return sz(n,t,e)}return e}function a3(n,e,t,i,r,s,o,a,l){return n=fA(t,i,!0,n,r,s,o,a,l),n.context=o3(null),t=n.current,i=os(),r=mc(t),s=$l(i,r),s.callback=e??null,gc(t,s,r),n.current.lanes=r,j0(n,r,i),Is(n,i),n}function aE(n,e,t,i){var r=e.current,s=os(),o=mc(r);return t=o3(t),e.context===null?e.context=t:e.pendingContext=t,e=$l(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=gc(r,e,o),n!==null&&(ha(n,r,o,s),Y1(n,r,o)),o}function Ux(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function CM(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function dA(n,e){CM(n,e),(n=n.alternate)&&CM(n,e)}function Bq(){return null}var l3=typeof reportError=="function"?reportError:function(n){console.error(n)};function gA(n){this._internalRoot=n}lE.prototype.render=gA.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(xe(409));aE(n,e,null,null)};lE.prototype.unmount=gA.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;$h(function(){aE(null,n,null,null)}),e[Zl]=null}};function lE(n){this._internalRoot=n}lE.prototype.unstable_scheduleHydration=function(n){if(n){var e=zN();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Zu.length&&e!==0&&e<Zu[t].priority;t++);Zu.splice(t,0,n),t===0&&GN(n)}};function pA(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function uE(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function IM(){}function Vq(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Ux(o);s.call(u)}}var o=a3(e,i,n,0,null,!1,!1,"",IM);return n._reactRootContainer=o,n[Zl]=o.current,Gy(n.nodeType===8?n.parentNode:n),$h(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=Ux(l);a.call(u)}}var l=fA(n,0,!1,null,null,!1,!1,"",IM);return n._reactRootContainer=l,n[Zl]=l.current,Gy(n.nodeType===8?n.parentNode:n),$h(function(){aE(e,l,t,i)}),l}function cE(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Ux(o);a.call(l)}}aE(e,o,n,r)}else o=Vq(t,e,n,r,i);return Ux(o)}ON=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ym(e.pendingLanes);t!==0&&(Db(e,t|1),Is(e,fi()),!($t&6)&&(Gg=fi()+500,zc()))}break;case 13:$h(function(){var i=Ql(n,1);if(i!==null){var r=os();ha(i,n,1,r)}}),dA(n,1)}};Fb=function(n){if(n.tag===13){var e=Ql(n,134217728);if(e!==null){var t=os();ha(e,n,134217728,t)}dA(n,134217728)}};NN=function(n){if(n.tag===13){var e=mc(n),t=Ql(n,e);if(t!==null){var i=os();ha(t,n,e,i)}dA(n,e)}};zN=function(){return nn};UN=function(n,e){var t=nn;try{return nn=n,e()}finally{nn=t}};vI=function(n,e,t){switch(e){case"input":if(fI(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=eE(i);if(!r)throw Error(xe(90));mN(i),fI(i,r)}}}break;case"textarea":_N(n,t);break;case"select":e=t.value,e!=null&&ug(n,!!t.multiple,e,!1)}};CN=lA;IN=$h;var $q={usingClientEntryPoint:!1,Events:[V0,qd,eE,TN,SN,lA]},Nm={findFiberByHostInstance:Eh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Wq={bundleType:Nm.bundleType,version:Nm.version,rendererPackageName:Nm.rendererPackageName,rendererConfig:Nm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lu.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=AN(n),n===null?null:n.stateNode},findFiberByHostInstance:Nm.findFiberByHostInstance||Bq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var o1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!o1.isDisabled&&o1.supportsFiber)try{Yw=o1.inject(Wq),Ya=o1}catch{}}Js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$q;Js.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pA(e))throw Error(xe(200));return jq(n,e,null,t)};Js.createRoot=function(n,e){if(!pA(n))throw Error(xe(299));var t=!1,i="",r=l3;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=fA(n,1,!1,null,null,t,!1,i,r),n[Zl]=e.current,Gy(n.nodeType===8?n.parentNode:n),new gA(e)};Js.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(xe(188)):(n=Object.keys(n).join(","),Error(xe(268,n)));return n=AN(e),n=n===null?null:n.stateNode,n};Js.flushSync=function(n){return $h(n)};Js.hydrate=function(n,e,t){if(!uE(e))throw Error(xe(200));return cE(null,n,e,!0,t)};Js.hydrateRoot=function(n,e,t){if(!pA(n))throw Error(xe(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=l3;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=a3(e,null,n,1,t??null,r,!1,s,o),n[Zl]=e.current,Gy(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new lE(e)};Js.render=function(n,e,t){if(!uE(e))throw Error(xe(200));return cE(null,n,e,!1,t)};Js.unmountComponentAtNode=function(n){if(!uE(n))throw Error(xe(40));return n._reactRootContainer?($h(function(){cE(null,null,n,!1,function(){n._reactRootContainer=null,n[Zl]=null})}),!0):!1};Js.unstable_batchedUpdates=lA;Js.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!uE(t))throw Error(xe(200));if(n==null||n._reactInternals===void 0)throw Error(xe(38));return cE(n,e,t,!1,i)};Js.version="18.2.0-next-9e3b772b8-20220608";(function(n){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),n.exports=Js})(BH);var RM=rI;iI.createRoot=RM.createRoot,iI.hydrateRoot=RM.hydrateRoot;var Gx={},Hq={get exports(){return Gx},set exports(n){Gx=n}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){function t(W,ae,k){switch(k.length){case 0:return W.call(ae);case 1:return W.call(ae,k[0]);case 2:return W.call(ae,k[0],k[1]);case 3:return W.call(ae,k[0],k[1],k[2])}return W.apply(ae,k)}function i(W,ae,k,ke){for(var Be=-1,Fe=W==null?0:W.length;++Be<Fe;){var Pi=W[Be];ae(ke,Pi,k(Pi),W)}return ke}function r(W,ae){for(var k=-1,ke=W==null?0:W.length;++k<ke&&ae(W[k],k,W)!==!1;);return W}function s(W,ae){for(var k=W==null?0:W.length;k--&&ae(W[k],k,W)!==!1;);return W}function o(W,ae){for(var k=-1,ke=W==null?0:W.length;++k<ke;)if(!ae(W[k],k,W))return!1;return!0}function a(W,ae){for(var k=-1,ke=W==null?0:W.length,Be=0,Fe=[];++k<ke;){var Pi=W[k];ae(Pi,k,W)&&(Fe[Be++]=Pi)}return Fe}function l(W,ae){return!!(W!=null&&W.length)&&I(W,ae,0)>-1}function u(W,ae,k){for(var ke=-1,Be=W==null?0:W.length;++ke<Be;)if(k(ae,W[ke]))return!0;return!1}function h(W,ae){for(var k=-1,ke=W==null?0:W.length,Be=Array(ke);++k<ke;)Be[k]=ae(W[k],k,W);return Be}function p(W,ae){for(var k=-1,ke=ae.length,Be=W.length;++k<ke;)W[Be+k]=ae[k];return W}function m(W,ae,k,ke){var Be=-1,Fe=W==null?0:W.length;for(ke&&Fe&&(k=W[++Be]);++Be<Fe;)k=ae(k,W[Be],Be,W);return k}function y(W,ae,k,ke){var Be=W==null?0:W.length;for(ke&&Be&&(k=W[--Be]);Be--;)k=ae(k,W[Be],Be,W);return k}function x(W,ae){for(var k=-1,ke=W==null?0:W.length;++k<ke;)if(ae(W[k],k,W))return!0;return!1}function w(W){return W.split("")}function R(W){return W.match(M_)||[]}function E(W,ae,k){var ke;return k(W,function(Be,Fe,Pi){if(ae(Be,Fe,Pi))return ke=Fe,!1}),ke}function T(W,ae,k,ke){for(var Be=W.length,Fe=k+(ke?1:-1);ke?Fe--:++Fe<Be;)if(ae(W[Fe],Fe,W))return Fe;return-1}function I(W,ae,k){return ae===ae?It(W,ae,k):T(W,L,k)}function A(W,ae,k,ke){for(var Be=k-1,Fe=W.length;++Be<Fe;)if(ke(W[Be],ae))return Be;return-1}function L(W){return W!==W}function F(W,ae){var k=W==null?0:W.length;return k?J(W,ae)/k:sn}function O(W){return function(ae){return ae==null?U:ae[W]}}function N(W){return function(ae){return W==null?U:W[ae]}}function B(W,ae,k,ke,Be){return Be(W,function(Fe,Pi,em){k=ke?(ke=!1,Fe):ae(k,Fe,Pi,em)}),k}function V(W,ae){var k=W.length;for(W.sort(ae);k--;)W[k]=W[k].value;return W}function J(W,ae){for(var k,ke=-1,Be=W.length;++ke<Be;){var Fe=ae(W[ke]);Fe!==U&&(k=k===U?Fe:k+Fe)}return k}function ge(W,ae){for(var k=-1,ke=Array(W);++k<W;)ke[k]=ae(k);return ke}function he(W,ae){return h(ae,function(k){return[k,W[k]]})}function de(W){return W&&W.slice(0,rr(W)+1).replace(ho,"")}function oe(W){return function(ae){return W(ae)}}function _e(W,ae){return h(ae,function(k){return W[k]})}function se(W,ae){return W.has(ae)}function Z(W,ae){for(var k=-1,ke=W.length;++k<ke&&I(ae,W[k],0)>-1;);return k}function pe(W,ae){for(var k=W.length;k--&&I(ae,W[k],0)>-1;);return k}function ne(W,ae){for(var k=W.length,ke=0;k--;)W[k]===ae&&++ke;return ke}function ee(W){return"\\"+W_[W]}function j(W,ae){return W==null?U:W[ae]}function ie(W){return $p.test(W)}function q(W){return $_.test(W)}function H(W){for(var ae,k=[];!(ae=W.next()).done;)k.push(ae.value);return k}function te(W){var ae=-1,k=Array(W.size);return W.forEach(function(ke,Be){k[++ae]=[Be,ke]}),k}function ue(W,ae){return function(k){return W(ae(k))}}function K(W,ae){for(var k=-1,ke=W.length,Be=0,Fe=[];++k<ke;){var Pi=W[k];Pi!==ae&&Pi!==Hi||(W[k]=Hi,Fe[Be++]=k)}return Fe}function Te(W){var ae=-1,k=Array(W.size);return W.forEach(function(ke){k[++ae]=ke}),k}function lt(W){var ae=-1,k=Array(W.size);return W.forEach(function(ke){k[++ae]=[ke,ke]}),k}function It(W,ae,k){for(var ke=k-1,Be=W.length;++ke<Be;)if(W[ke]===ae)return ke;return-1}function rt(W,ae,k){for(var ke=k+1;ke--;)if(W[ke]===ae)return ke;return ke}function ut(W){return ie(W)?Mn(W):Qp(W)}function ct(W){return ie(W)?$i(W):w(W)}function rr(W){for(var ae=W.length;ae--&&Lp.test(W.charAt(ae)););return ae}function Mn(W){for(var ae=Au.lastIndex=0;Au.test(W);)++ae;return ae}function $i(W){return W.match(Au)||[]}function Ie(W){return W.match(V_)||[]}var U,Wr="4.17.21",ks=200,ei="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",Wt="Expected a function",yn="Invalid `variable` option passed into `_.template`",Wi="__lodash_hash_undefined__",cs=500,Hi="__lodash_placeholder__",Rn=1,Ft=2,sr=4,Xt=1,cn=2,ti=1,or=2,no=4,Dn=8,ar=16,bn=32,lr=64,ni=128,ii=256,Ps=512,zo=30,io="...",_n=800,ro=16,ri=1,Ti=2,Fn=3,On=1/0,Rt=9007199254740991,bt=17976931348623157e292,sn=NaN,Pt=4294967295,si=Pt-1,Si=Pt>>>1,so=[["ary",ni],["bind",ti],["bindKey",or],["curry",Dn],["curryRight",ar],["flip",Ps],["partial",bn],["partialRight",lr],["rearg",ii]],vn="[object Arguments]",Hr="[object Array]",gu="[object AsyncFunction]",hs="[object Boolean]",Ls="[object Date]",pu="[object DOMException]",wa="[object Error]",oo="[object Function]",mu="[object GeneratorFunction]",Ht="[object Map]",Xr="[object Number]",dl="[object Null]",Nn="[object Object]",Uo="[object Promise]",yu="[object Proxy]",ao="[object RegExp]",oi="[object Set]",Go="[object String]",gl="[object Symbol]",_u="[object Undefined]",Ci="[object WeakMap]",vu="[object WeakSet]",ur="[object ArrayBuffer]",lo="[object DataView]",Ii="[object Float32Array]",uo="[object Float64Array]",Ea="[object Int8Array]",Ri="[object Int16Array]",xu="[object Int32Array]",Ta="[object Uint8Array]",bi="[object Uint8ClampedArray]",pl="[object Uint16Array]",co="[object Uint32Array]",ml=/\b__p \+= '';/g,qr=/\b(__p \+=) '' \+/g,Xi=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Tr=/&(?:amp|lt|gt|quot|#39);/g,Kr=/[&<>"']/g,yl=RegExp(Tr.source),Sa=RegExp(Kr.source),Yr=/<%-([\s\S]+?)%>/g,jo=/<%([\s\S]+?)%>/g,wu=/<%=([\s\S]+?)%>/g,P_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pp=/^\w*$/,L_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ca=/[\\^$.*+?()[\]{}|]/g,fs=RegExp(Ca.source),ho=/^\s+/,Lp=/\s/,Mp=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ia=/\{\n\/\* \[wrapped with (.+)\] \*/,Ra=/,? & /,M_=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Xc=/[()=,{}\[\]\/\s]/,D_=/\\(\\)?/g,qc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Dp=/\w*$/,Gf=/^[-+]0x[0-9a-f]+$/i,jf=/^0b[01]+$/i,F_=/^\[object .+?Constructor\]$/,O_=/^0o[0-7]+$/i,N_=/^(?:0|[1-9]\d*)$/,Fp=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_l=/($^)/,Kc=/['\n\r\u2028\u2029\\]/g,vl="\\ud800-\\udfff",z_="\\u0300-\\u036f",Eu="\\ufe20-\\ufe2f",Op="\\u20d0-\\u20ff",Tu=z_+Eu+Op,Zr="\\u2700-\\u27bf",Su="a-z\\xdf-\\xf6\\xf8-\\xff",Cu="\\xac\\xb1\\xd7\\xf7",fo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Np="\\u2000-\\u206f",Iu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",zp="A-Z\\xc0-\\xd6\\xd8-\\xde",Bf="\\ufe0e\\ufe0f",xn=Cu+fo+Np+Iu,Ru="[']",Up="["+vl+"]",Yc="["+xn+"]",cr="["+Tu+"]",Bo="\\d+",ai="["+Zr+"]",Ai="["+Su+"]",ki="[^"+vl+xn+Bo+Zr+Su+zp+"]",bu="\\ud83c[\\udffb-\\udfff]",Qr="(?:"+cr+"|"+bu+")",Vf="[^"+vl+"]",Zc="(?:\\ud83c[\\udde6-\\uddff]){2}",ba="[\\ud800-\\udbff][\\udc00-\\udfff]",Ms="["+zp+"]",Aa="\\u200d",Qc="(?:"+Ai+"|"+ki+")",$f="(?:"+Ms+"|"+ki+")",Wf="(?:"+Ru+"(?:d|ll|m|re|s|t|ve))?",Hf="(?:"+Ru+"(?:D|LL|M|RE|S|T|VE))?",Gp=Qr+"?",Xf="["+Bf+"]?",jp="(?:"+Aa+"(?:"+[Vf,Zc,ba].join("|")+")"+Xf+Gp+")*",U_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qf="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Bp=Xf+Gp+jp,G_="(?:"+[ai,Zc,ba].join("|")+")"+Bp,j_="(?:"+[Vf+cr+"?",cr,Zc,ba,Up].join("|")+")",Vp=RegExp(Ru,"g"),B_=RegExp(cr,"g"),Au=RegExp(bu+"(?="+bu+")|"+j_+Bp,"g"),V_=RegExp([Ms+"?"+Ai+"+"+Wf+"(?="+[Yc,Ms,"$"].join("|")+")",$f+"+"+Hf+"(?="+[Yc,Ms+Qc,"$"].join("|")+")",Ms+"?"+Qc+"+"+Wf,Ms+"+"+Hf,qf,U_,Bo,G_].join("|"),"g"),$p=RegExp("["+Aa+vl+Tu+Bf+"]"),$_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Kf=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ST=-1,hn={};hn[Ii]=hn[uo]=hn[Ea]=hn[Ri]=hn[xu]=hn[Ta]=hn[bi]=hn[pl]=hn[co]=!0,hn[vn]=hn[Hr]=hn[ur]=hn[hs]=hn[lo]=hn[Ls]=hn[wa]=hn[oo]=hn[Ht]=hn[Xr]=hn[Nn]=hn[ao]=hn[oi]=hn[Go]=hn[Ci]=!1;var on={};on[vn]=on[Hr]=on[ur]=on[lo]=on[hs]=on[Ls]=on[Ii]=on[uo]=on[Ea]=on[Ri]=on[xu]=on[Ht]=on[Xr]=on[Nn]=on[ao]=on[oi]=on[Go]=on[gl]=on[Ta]=on[bi]=on[pl]=on[co]=!0,on[wa]=on[oo]=on[Ci]=!1;var Vo={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},xl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wl={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},W_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},H_=parseFloat,Wp=parseInt,Hp=typeof $a=="object"&&$a&&$a.Object===Object&&$a,Yf=typeof self=="object"&&self&&self.Object===Object&&self,li=Hp||Yf||Function("return this")(),Xp=e&&!e.nodeType&&e,qi=Xp&&!0&&n&&!n.nodeType&&n,Sr=qi&&qi.exports===Xp,Zf=Sr&&Hp.process,Jr=function(){try{var W=qi&&qi.require&&qi.require("util").types;return W||Zf&&Zf.binding&&Zf.binding("util")}catch{}}(),qp=Jr&&Jr.isArrayBuffer,Kp=Jr&&Jr.isDate,Qf=Jr&&Jr.isMap,Yp=Jr&&Jr.isRegExp,Jf=Jr&&Jr.isSet,Zp=Jr&&Jr.isTypedArray,Qp=O("length"),X_=N(Vo),q_=N(xl),Jp=N(wl),K_=function W(ae){function k(c){if(Kn(c)&&!pt(c)&&!(c instanceof Fe)){if(c instanceof Be)return c;if(tn.call(c,"__wrapped__"))return EL(c)}return new Be(c)}function ke(){}function Be(c,f){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=U}function Fe(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Pt,this.__views__=[]}function Pi(){var c=new Fe(this.__wrapped__);return c.__actions__=g(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=g(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=g(this.__views__),c}function em(){if(this.__filtered__){var c=new Fe(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function CT(){var c=this.__wrapped__.value(),f=this.__dir__,_=pt(c),C=f<0,P=_?c.length:0,M=E5(0,P,this.__views__),G=M.start,$=M.end,Y=$-G,me=C?$:G-1,fe=this.__iteratees__,ve=fe.length,Le=0,ze=br(Y,this.__takeCount__);if(!_||!C&&P==Y&&ze==Y)return ym(c,this.__actions__);var He=[];e:for(;Y--&&Le<ze;){me+=f;for(var vt=-1,Xe=c[me];++vt<ve;){var Lt=fe[vt],Mt=Lt.iteratee,kr=Lt.type,ys=Mt(Xe);if(kr==Ti)Xe=ys;else if(!ys){if(kr==ri)continue e;break e}}He[Le++]=Xe}return He}function $o(c){var f=-1,_=c==null?0:c.length;for(this.clear();++f<_;){var C=c[f];this.set(C[0],C[1])}}function IT(){this.__data__=Im?Im(null):{},this.size=0}function tm(c){var f=this.has(c)&&delete this.__data__[c];return this.size-=f?1:0,f}function RT(c){var f=this.__data__;if(Im){var _=f[c];return _===Wi?U:_}return tn.call(f,c)?f[c]:U}function Y_(c){var f=this.__data__;return Im?f[c]!==U:tn.call(f,c)}function bT(c,f){var _=this.__data__;return this.size+=this.has(c)?0:1,_[c]=Im&&f===U?Wi:f,this}function Ds(c){var f=-1,_=c==null?0:c.length;for(this.clear();++f<_;){var C=c[f];this.set(C[0],C[1])}}function Z_(){this.__data__=[],this.size=0}function AT(c){var f=this.__data__,_=Jc(f,c);return!(_<0)&&(_==f.length-1?f.pop():Ov.call(f,_,1),--this.size,!0)}function Q_(c){var f=this.__data__,_=Jc(f,c);return _<0?U:f[_][1]}function J_(c){return Jc(this.__data__,c)>-1}function ev(c,f){var _=this.__data__,C=Jc(_,c);return C<0?(++this.size,_.push([c,f])):_[C][1]=f,this}function Wo(c){var f=-1,_=c==null?0:c.length;for(this.clear();++f<_;){var C=c[f];this.set(C[0],C[1])}}function tv(){this.size=0,this.__data__={hash:new $o,map:new(Sm||Ds),string:new $o}}function nv(c){var f=xv(this,c).delete(c);return this.size-=f?1:0,f}function nm(c){return xv(this,c).get(c)}function im(c){return xv(this,c).has(c)}function iv(c,f){var _=xv(this,c),C=_.size;return _.set(c,f),this.size+=_.size==C?0:1,this}function Ho(c){var f=-1,_=c==null?0:c.length;for(this.__data__=new Wo;++f<_;)this.add(c[f])}function rv(c){return this.__data__.set(c,Wi),this}function ed(c){return this.__data__.has(c)}function Fs(c){this.size=(this.__data__=new Ds(c)).size}function sv(){this.__data__=new Ds,this.size=0}function ov(c){var f=this.__data__,_=f.delete(c);return this.size=f.size,_}function kT(c){return this.__data__.get(c)}function td(c){return this.__data__.has(c)}function av(c,f){var _=this.__data__;if(_ instanceof Ds){var C=_.__data__;if(!Sm||C.length<ks-1)return C.push([c,f]),this.size=++_.size,this;_=this.__data__=new Wo(C)}return _.set(c,f),this.size=_.size,this}function zn(c,f){var _=pt(c),C=!_&&hh(c),P=!_&&!C&&Nu(c),M=!_&&!C&&!P&&Cd(c),G=_||C||P||M,$=G?ge(c.length,P6):[],Y=$.length;for(var me in c)!f&&!tn.call(c,me)||G&&(me=="length"||P&&(me=="offset"||me=="parent")||M&&(me=="buffer"||me=="byteLength"||me=="byteOffset")||Il(me,Y))||$.push(me);return $}function nd(c){var f=c.length;return f?c[hm(0,f-1)]:U}function ds(c,f){return wv(g(c),tt(f,0,c.length))}function Os(c){return wv(g(c))}function Xo(c,f,_){(_===U||ea(c[f],_))&&(_!==U||f in c)||Ge(c,f,_)}function ka(c,f,_){var C=c[f];tn.call(c,f)&&ea(C,_)&&(_!==U||f in c)||Ge(c,f,_)}function Jc(c,f){for(var _=c.length;_--;)if(ea(c[_][0],f))return _;return-1}function id(c,f,_,C){return Ou(c,function(P,M,G){f(C,P,_(P),G)}),C}function eh(c,f){return c&&v(f,Ki(f),c)}function rm(c,f){return c&&v(f,ps(f),c)}function Ge(c,f,_){f=="__proto__"&&Nv?Nv(c,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):c[f]=_}function hr(c,f){for(var _=-1,C=f.length,P=Li(C),M=c==null;++_<C;)P[_]=M?U:$T(c,f[_]);return P}function tt(c,f,_){return c===c&&(_!==U&&(c=c<=_?c:_),f!==U&&(c=c>=f?c:f)),c}function fn(c,f,_,C,P,M){var G,$=f&Rn,Y=f&Ft,me=f&sr;if(_&&(G=P?_(c,C,P,M):_(c)),G!==U)return G;if(!Bn(c))return c;var fe=pt(c);if(fe){if(G=S5(c),!$)return g(c,G)}else{var ve=Ar(c),Le=ve==oo||ve==mu;if(Nu(c))return gd(c,$);if(ve==Nn||ve==vn||Le&&!P){if(G=Y||Le?{}:pL(c),!$)return Y?b(c,rm(G,c)):S(c,eh(G,c))}else{if(!on[ve])return P?c:{};G=C5(c,ve,$)}}M||(M=new Fs);var ze=M.get(c);if(ze)return ze;M.set(c,G),f2(c)?c.forEach(function(Xe){G.add(fn(Xe,f,_,Xe,c,M))}):h2(c)&&c.forEach(function(Xe,Lt){G.set(Lt,fn(Xe,f,_,Lt,c,M))});var He=me?Y?OT:FT:Y?ps:Ki,vt=fe?U:He(c);return r(vt||c,function(Xe,Lt){vt&&(Lt=Xe,Xe=c[Lt]),ka(G,Lt,fn(Xe,f,_,Lt,c,M))}),G}function gi(c){var f=Ki(c);return function(_){return th(_,c,f)}}function th(c,f,_){var C=_.length;if(c==null)return!C;for(c=wn(c);C--;){var P=_[C],M=f[P],G=c[P];if(G===U&&!(P in c)||!M(G))return!1}return!0}function go(c,f,_){if(typeof c!="function")throw new xo(Wt);return bm(function(){c.apply(U,_)},f)}function qo(c,f,_,C){var P=-1,M=l,G=!0,$=c.length,Y=[],me=f.length;if(!$)return Y;_&&(f=h(f,oe(_))),C?(M=u,G=!1):f.length>=ks&&(M=se,G=!1,f=new Ho(f));e:for(;++P<$;){var fe=c[P],ve=_==null?fe:_(fe);if(fe=C||fe!==0?fe:0,G&&ve===ve){for(var Le=me;Le--;)if(f[Le]===ve)continue e;Y.push(fe)}else M(f,ve,C)||Y.push(fe)}return Y}function rd(c,f){var _=!0;return Ou(c,function(C,P,M){return _=!!f(C,P,M)}),_}function Pa(c,f,_){for(var C=-1,P=c.length;++C<P;){var M=c[C],G=f(M);if(G!=null&&($===U?G===G&&!Gs(G):_(G,$)))var $=G,Y=M}return Y}function sd(c,f,_,C){var P=c.length;for(_=Tt(_),_<0&&(_=-_>P?0:P+_),C=C===U||C>P?P:Tt(C),C<0&&(C+=P),C=_>C?0:GL(C);_<C;)c[_++]=f;return c}function od(c,f){var _=[];return Ou(c,function(C,P,M){f(C,P,M)&&_.push(C)}),_}function pi(c,f,_,C,P){var M=-1,G=c.length;for(_||(_=R5),P||(P=[]);++M<G;){var $=c[M];f>0&&_($)?f>1?pi($,f-1,_,C,P):p(P,$):C||(P[P.length]=$)}return P}function Me(c,f){return c&&iS(c,f,Ki)}function ku(c,f){return c&&i2(c,f,Ki)}function Pu(c,f){return a(f,function(_){return Rl(c[_])})}function Ir(c,f){f=Zo(f,c);for(var _=0,C=f.length;c!=null&&_<C;)c=c[Fa(f[_++])];return _&&_==C?c:U}function nh(c,f,_){var C=f(c);return pt(c)?C:p(C,_(c))}function ui(c){return c==null?c===U?_u:dl:ch&&ch in wn(c)?w5(c):M5(c)}function El(c,f){return c>f}function Tl(c,f){return c!=null&&tn.call(c,f)}function ih(c,f){return c!=null&&f in wn(c)}function sm(c,f,_){return c>=br(f,_)&&c<Mi(f,_)}function Lu(c,f,_){for(var C=_?u:l,P=c[0].length,M=c.length,G=M,$=Li(M),Y=1/0,me=[];G--;){var fe=c[G];G&&f&&(fe=h(fe,oe(f))),Y=br(fe.length,Y),$[G]=!_&&(f||P>=120&&fe.length>=120)?new Ho(G&&fe):U}fe=c[0];var ve=-1,Le=$[0];e:for(;++ve<P&&me.length<Y;){var ze=fe[ve],He=f?f(ze):ze;if(ze=_||ze!==0?ze:0,!(Le?se(Le,He):C(me,He,_))){for(G=M;--G;){var vt=$[G];if(!(vt?se(vt,He):C(c[G],He,_)))continue e}Le&&Le.push(He),me.push(ze)}}return me}function Ns(c,f,_,C){return Me(c,function(P,M,G){f(C,_(P),M,G)}),C}function zs(c,f,_){f=Zo(f,c),c=vL(c,f);var C=c==null?c:c[Fa(_o(f))];return C==null?U:t(C,c,_)}function po(c){return Kn(c)&&ui(c)==vn}function ad(c){return Kn(c)&&ui(c)==ur}function ld(c){return Kn(c)&&ui(c)==Ls}function mi(c,f,_,C,P){return c===f||(c==null||f==null||!Kn(c)&&!Kn(f)?c!==c&&f!==f:lv(c,f,_,C,mi,P))}function lv(c,f,_,C,P,M){var G=pt(c),$=pt(f),Y=G?Hr:Ar(c),me=$?Hr:Ar(f);Y=Y==vn?Nn:Y,me=me==vn?Nn:me;var fe=Y==Nn,ve=me==Nn,Le=Y==me;if(Le&&Nu(c)){if(!Nu(f))return!1;G=!0,fe=!1}if(Le&&!fe)return M||(M=new Fs),G||Cd(c)?dL(c,f,_,C,P,M):v5(c,f,Y,_,C,P,M);if(!(_&Xt)){var ze=fe&&tn.call(c,"__wrapped__"),He=ve&&tn.call(f,"__wrapped__");if(ze||He){var vt=ze?c.value():c,Xe=He?f.value():f;return M||(M=new Fs),P(vt,Xe,_,C,M)}}return!!Le&&(M||(M=new Fs),x5(c,f,_,C,P,M))}function om(c){return Kn(c)&&Ar(c)==Ht}function am(c,f,_,C){var P=_.length,M=P,G=!C;if(c==null)return!M;for(c=wn(c);P--;){var $=_[P];if(G&&$[2]?$[1]!==c[$[0]]:!($[0]in c))return!1}for(;++P<M;){$=_[P];var Y=$[0],me=c[Y],fe=$[1];if(G&&$[2]){if(me===U&&!(Y in c))return!1}else{var ve=new Fs;if(C)var Le=C(me,fe,Y,c,f,ve);if(!(Le===U?mi(fe,me,Xt|cn,C,ve):Le))return!1}}return!0}function uv(c){return!(!Bn(c)||A5(c))&&(Rl(c)?O6:F_).test(uh(c))}function cv(c){return Kn(c)&&ui(c)==ao}function hv(c){return Kn(c)&&Ar(c)==oi}function Sl(c){return Kn(c)&&Iv(c.length)&&!!hn[ui(c)]}function lm(c){return typeof c=="function"?c:c==null?ms:typeof c=="object"?pt(c)?um(c[0],c[1]):gv(c):HL(c)}function ud(c){if(!wm(c))return B6(c);var f=[];for(var _ in wn(c))tn.call(c,_)&&_!="constructor"&&f.push(_);return f}function fv(c){if(!Bn(c))return L5(c);var f=wm(c),_=[];for(var C in c)(C!="constructor"||!f&&tn.call(c,C))&&_.push(C);return _}function Mu(c,f){return c<f}function dv(c,f){var _=-1,C=gs(c)?Li(c.length):[];return Ou(c,function(P,M,G){C[++_]=f(P,M,G)}),C}function gv(c){var f=NT(c);return f.length==1&&f[0][2]?yL(f[0][0],f[0][1]):function(_){return _===c||am(_,c,f)}}function um(c,f){return zT(c)&&mL(f)?yL(Fa(c),f):function(_){var C=$T(_,c);return C===U&&C===f?WT(_,c):mi(f,C,Xt|cn)}}function rh(c,f,_,C,P){c!==f&&iS(f,function(M,G){if(P||(P=new Fs),Bn(M))cm(c,f,G,_,rh,C,P);else{var $=C?C(GT(c,G),M,G+"",c,f,P):U;$===U&&($=M),Xo(c,G,$)}},ps)}function cm(c,f,_,C,P,M,G){var $=GT(c,_),Y=GT(f,_),me=G.get(Y);if(me)return Xo(c,_,me),U;var fe=M?M($,Y,_+"",c,f,G):U,ve=fe===U;if(ve){var Le=pt(Y),ze=!Le&&Nu(Y),He=!Le&&!ze&&Cd(Y);fe=Y,Le||ze||He?pt($)?fe=$:ci($)?fe=g($):ze?(ve=!1,fe=gd(Y,!0)):He?(ve=!1,fe=xm(Y,!0)):fe=[]:Em(Y)||hh(Y)?(fe=$,hh($)?fe=jL($):Bn($)&&!Rl($)||(fe=pL(Y))):ve=!1}ve&&(G.set(Y,fe),P(fe,Y,C,M,G),G.delete(Y)),Xo(c,_,fe)}function La(c,f){var _=c.length;if(_)return f+=f<0?_:0,Il(f,_)?c[f]:U}function pv(c,f,_){f=f.length?h(f,function(P){return pt(P)?function(M){return Ir(M,P.length===1?P[0]:P)}:P}):[ms];var C=-1;return f=h(f,oe(Ze())),V(dv(c,function(P,M,G){return{criteria:h(f,function($){return $(P)}),index:++C,value:P}}),function(P,M){return yv(P,M,_)})}function PT(c,f){return Ma(c,f,function(_,C){return WT(c,C)})}function Ma(c,f,_){for(var C=-1,P=f.length,M={};++C<P;){var G=f[C],$=Ir(c,G);_($,G)&&sh(M,Zo(G,c),$)}return M}function LT(c){return function(f){return Ir(f,c)}}function cd(c,f,_,C){var P=C?A:I,M=-1,G=f.length,$=c;for(c===f&&(f=g(f)),_&&($=h(c,oe(_)));++M<G;)for(var Y=0,me=f[M],fe=_?_(me):me;(Y=P($,fe,Y,C))>-1;)$!==c&&Ov.call($,Y,1),Ov.call(c,Y,1);return c}function Da(c,f){for(var _=c?f.length:0,C=_-1;_--;){var P=f[_];if(_==C||P!==M){var M=P;Il(P)?Ov.call(c,P,1):pm(c,P)}}return c}function hm(c,f){return c+Uv(e2()*(f-c+1))}function MT(c,f,_,C){for(var P=-1,M=Mi(zv((f-c)/(_||1)),0),G=Li(M);M--;)G[C?M:++P]=c,c+=_;return G}function hd(c,f){var _="";if(!c||f<1||f>Rt)return _;do f%2&&(_+=c),f=Uv(f/2),f&&(c+=c);while(f);return _}function dt(c,f){return oS(_L(c,f,ms),c+"")}function fm(c){return nd(vd(c))}function dm(c,f){var _=vd(c);return wv(_,tt(f,0,_.length))}function sh(c,f,_,C){if(!Bn(c))return c;f=Zo(f,c);for(var P=-1,M=f.length,G=M-1,$=c;$!=null&&++P<M;){var Y=Fa(f[P]),me=_;if(Y==="__proto__"||Y==="constructor"||Y==="prototype")return c;if(P!=G){var fe=$[Y];me=C?C(fe,Y,$):U,me===U&&(me=Bn(fe)?fe:Il(f[P+1])?[]:{})}ka($,Y,me),$=$[Y]}return c}function DT(c){return wv(vd(c))}function Un(c,f,_){var C=-1,P=c.length;f<0&&(f=-f>P?0:P+f),_=_>P?P:_,_<0&&(_+=P),P=f>_?0:_-f>>>0,f>>>=0;for(var M=Li(P);++C<P;)M[C]=c[C+f];return M}function gm(c,f){var _;return Ou(c,function(C,P,M){return _=f(C,P,M),!_}),!!_}function fd(c,f,_){var C=0,P=c==null?C:c.length;if(typeof f=="number"&&f===f&&P<=Si){for(;C<P;){var M=C+P>>>1,G=c[M];G!==null&&!Gs(G)&&(_?G<=f:G<f)?C=M+1:P=M}return P}return Ko(c,f,ms,_)}function Ko(c,f,_,C){var P=0,M=c==null?0:c.length;if(M===0)return 0;f=_(f);for(var G=f!==f,$=f===null,Y=Gs(f),me=f===U;P<M;){var fe=Uv((P+M)/2),ve=_(c[fe]),Le=ve!==U,ze=ve===null,He=ve===ve,vt=Gs(ve);if(G)var Xe=C||He;else Xe=me?He&&(C||Le):$?He&&Le&&(C||!ze):Y?He&&Le&&!ze&&(C||!vt):!ze&&!vt&&(C?ve<=f:ve<f);Xe?P=fe+1:M=fe}return br(M,si)}function oh(c,f){for(var _=-1,C=c.length,P=0,M=[];++_<C;){var G=c[_],$=f?f(G):G;if(!_||!ea($,Y)){var Y=$;M[P++]=G===0?0:G}}return M}function Yo(c){return typeof c=="number"?c:Gs(c)?sn:+c}function fr(c){if(typeof c=="string")return c;if(pt(c))return h(c,fr)+"";if(Gs(c))return t2?t2.call(c):"";var f=c+"";return f=="0"&&1/c==-On?"-0":f}function mo(c,f,_){var C=-1,P=l,M=c.length,G=!0,$=[],Y=$;if(_)G=!1,P=u;else if(M>=ks){var me=f?null:J6(c);if(me)return Te(me);G=!1,P=se,Y=new Ho}else Y=f?[]:$;e:for(;++C<M;){var fe=c[C],ve=f?f(fe):fe;if(fe=_||fe!==0?fe:0,G&&ve===ve){for(var Le=Y.length;Le--;)if(Y[Le]===ve)continue e;f&&Y.push(ve),$.push(fe)}else P(Y,ve,_)||(Y!==$&&Y.push(ve),$.push(fe))}return $}function pm(c,f){return f=Zo(f,c),c=vL(c,f),c==null||delete c[Fa(_o(f))]}function mm(c,f,_,C){return sh(c,f,_(Ir(c,f)),C)}function yo(c,f,_,C){for(var P=c.length,M=C?P:-1;(C?M--:++M<P)&&f(c[M],M,c););return _?Un(c,C?0:M,C?M+1:P):Un(c,C?M+1:0,C?P:M)}function ym(c,f){var _=c;return _ instanceof Fe&&(_=_.value()),m(f,function(C,P){return P.func.apply(P.thisArg,p([C],P.args))},_)}function Du(c,f,_){var C=c.length;if(C<2)return C?mo(c[0]):[];for(var P=-1,M=Li(C);++P<C;)for(var G=c[P],$=-1;++$<C;)$!=P&&(M[P]=qo(M[P]||G,c[$],f,_));return mo(pi(M,1),f,_)}function ah(c,f,_){for(var C=-1,P=c.length,M=f.length,G={};++C<P;)_(G,c[C],C<M?f[C]:U);return G}function _m(c){return ci(c)?c:[]}function dd(c){return typeof c=="function"?c:ms}function Zo(c,f){return pt(c)?c:zT(c,f)?[c]:l2(Jt(c))}function Us(c,f,_){var C=c.length;return _=_===U?C:_,!f&&_>=C?c:Un(c,f,_)}function gd(c,f){if(f)return c.slice();var _=c.length,C=KL?KL(_):new c.constructor(_);return c.copy(C),C}function pd(c){var f=new c.constructor(c.byteLength);return new Dv(f).set(new Dv(c)),f}function vm(c,f){return new c.constructor(f?pd(c.buffer):c.buffer,c.byteOffset,c.byteLength)}function mv(c){var f=new c.constructor(c.source,Dp.exec(c));return f.lastIndex=c.lastIndex,f}function md(c){return Rm?wn(Rm.call(c)):{}}function xm(c,f){return new c.constructor(f?pd(c.buffer):c.buffer,c.byteOffset,c.length)}function yd(c,f){if(c!==f){var _=c!==U,C=c===null,P=c===c,M=Gs(c),G=f!==U,$=f===null,Y=f===f,me=Gs(f);if(!$&&!me&&!M&&c>f||M&&G&&Y&&!$&&!me||C&&G&&Y||!_&&Y||!P)return 1;if(!C&&!M&&!me&&c<f||me&&_&&P&&!C&&!M||$&&_&&P||!G&&P||!Y)return-1}return 0}function yv(c,f,_){for(var C=-1,P=c.criteria,M=f.criteria,G=P.length,$=_.length;++C<G;){var Y=yd(P[C],M[C]);if(Y)return C>=$?Y:Y*(_[C]=="desc"?-1:1)}return c.index-f.index}function _v(c,f,_,C){for(var P=-1,M=c.length,G=_.length,$=-1,Y=f.length,me=Mi(M-G,0),fe=Li(Y+me),ve=!C;++$<Y;)fe[$]=f[$];for(;++P<G;)(ve||P<M)&&(fe[_[P]]=c[P]);for(;me--;)fe[$++]=c[P++];return fe}function d(c,f,_,C){for(var P=-1,M=c.length,G=-1,$=_.length,Y=-1,me=f.length,fe=Mi(M-$,0),ve=Li(fe+me),Le=!C;++P<fe;)ve[P]=c[P];for(var ze=P;++Y<me;)ve[ze+Y]=f[Y];for(;++G<$;)(Le||P<M)&&(ve[ze+_[G]]=c[P++]);return ve}function g(c,f){var _=-1,C=c.length;for(f||(f=Li(C));++_<C;)f[_]=c[_];return f}function v(c,f,_,C){var P=!_;_||(_={});for(var M=-1,G=f.length;++M<G;){var $=f[M],Y=C?C(_[$],c[$],$,_,c):U;Y===U&&(Y=c[$]),P?Ge(_,$,Y):ka(_,$,Y)}return _}function S(c,f){return v(c,sS(c),f)}function b(c,f){return v(c,o2(c),f)}function D(c,f){return function(_,C){var P=pt(_)?i:id,M=f?f():{};return P(_,c,Ze(C,2),M)}}function z(c){return dt(function(f,_){var C=-1,P=_.length,M=P>1?_[P-1]:U,G=P>2?_[2]:U;for(M=c.length>3&&typeof M=="function"?(P--,M):U,G&&es(_[0],_[1],G)&&(M=P<3?U:M,P=1),f=wn(f);++C<P;){var $=_[C];$&&c(f,$,C,M)}return f})}function re(c,f){return function(_,C){if(_==null)return _;if(!gs(_))return c(_,C);for(var P=_.length,M=f?P:-1,G=wn(_);(f?M--:++M<P)&&C(G[M],M,G)!==!1;);return _}}function Se(c){return function(f,_,C){for(var P=-1,M=wn(f),G=C(f),$=G.length;$--;){var Y=G[c?$:++P];if(_(M[Y],Y,M)===!1)break}return f}}function Pe(c,f,_){function C(){return(this&&this!==li&&this instanceof C?M:c).apply(P?_:this,arguments)}var P=f&ti,M=At(c);return C}function qt(c){return function(f){f=Jt(f);var _=ie(f)?ct(f):U,C=_?_[0]:f.charAt(0),P=_?Us(_,1).join(""):f.slice(1);return C[c]()+P}}function nt(c){return function(f){return m(WL($L(f).replace(Vp,"")),c,"")}}function At(c){return function(){var f=arguments;switch(f.length){case 0:return new c;case 1:return new c(f[0]);case 2:return new c(f[0],f[1]);case 3:return new c(f[0],f[1],f[2]);case 4:return new c(f[0],f[1],f[2],f[3]);case 5:return new c(f[0],f[1],f[2],f[3],f[4]);case 6:return new c(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new c(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=Sd(c.prototype),C=c.apply(_,f);return Bn(C)?C:_}}function Kt(c,f,_){function C(){for(var M=arguments.length,G=Li(M),$=M,Y=_d(C);$--;)G[$]=arguments[$];var me=M<3&&G[0]!==Y&&G[M-1]!==Y?[]:K(G,Y);return M-=me.length,M<_?jn(c,f,Q,C.placeholder,U,G,me,U,U,_-M):t(this&&this!==li&&this instanceof C?P:c,this,G)}var P=At(c);return C}function Rr(c){return function(f,_,C){var P=wn(f);if(!gs(f)){var M=Ze(_,3);f=Ki(f),_=function($){return M(P[$],$,P)}}var G=c(f,_,C);return G>-1?P[M?f[G]:G]:U}}function Gn(c){return Cl(function(f){var _=f.length,C=_,P=Be.prototype.thru;for(c&&f.reverse();C--;){var M=f[C];if(typeof M!="function")throw new xo(Wt);if(P&&!G&&vv(M)=="wrapper")var G=new Be([],!0)}for(C=G?C:_;++C<_;){M=f[C];var $=vv(M),Y=$=="wrapper"?rS(M):U;G=Y&&UT(Y[0])&&Y[1]==(ni|Dn|bn|ii)&&!Y[4].length&&Y[9]==1?G[vv(Y[0])].apply(G,Y[3]):M.length==1&&UT(M)?G[$]():G.thru(M)}return function(){var me=arguments,fe=me[0];if(G&&me.length==1&&pt(fe))return G.plant(fe).value();for(var ve=0,Le=_?f[ve].apply(this,me):fe;++ve<_;)Le=f[ve].call(this,Le);return Le}})}function Q(c,f,_,C,P,M,G,$,Y,me){function fe(){for(var Lt=arguments.length,Mt=Li(Lt),kr=Lt;kr--;)Mt[kr]=arguments[kr];if(He)var ys=_d(fe),zu=ne(Mt,ys);if(C&&(Mt=_v(Mt,C,P,He)),M&&(Mt=d(Mt,M,G,He)),Lt-=zu,He&&Lt<me)return jn(c,f,Q,fe.placeholder,_,Mt,K(Mt,ys),$,Y,me-Lt);var Yn=Le?_:this,wo=ze?Yn[c]:c;return Lt=Mt.length,$?Mt=D5(Mt,$):vt&&Lt>1&&Mt.reverse(),ve&&Y<Lt&&(Mt.length=Y),this&&this!==li&&this instanceof fe&&(wo=Xe||At(wo)),wo.apply(Yn,Mt)}var ve=f&ni,Le=f&ti,ze=f&or,He=f&(Dn|ar),vt=f&Ps,Xe=ze?U:At(c);return fe}function X(c,f){return function(_,C){return Ns(_,c,f(C),{})}}function le(c,f){return function(_,C){var P;if(_===U&&C===U)return f;if(_!==U&&(P=_),C!==U){if(P===U)return C;typeof _=="string"||typeof C=="string"?(_=fr(_),C=fr(C)):(_=Yo(_),C=Yo(C)),P=c(_,C)}return P}}function Oe(c){return Cl(function(f){return f=h(f,oe(Ze())),dt(function(_){var C=this;return c(f,function(P){return t(P,C,_)})})})}function $e(c,f){f=f===U?" ":fr(f);var _=f.length;if(_<2)return _?hd(f,c):f;var C=hd(f,zv(c/ut(f)));return ie(f)?Us(ct(C),0,c).join(""):C.slice(0,c)}function an(c,f,_,C){function P(){for(var $=-1,Y=arguments.length,me=-1,fe=C.length,ve=Li(fe+Y),Le=this&&this!==li&&this instanceof P?G:c;++me<fe;)ve[me]=C[me];for(;Y--;)ve[me++]=arguments[++$];return t(Le,M?_:this,ve)}var M=f&ti,G=At(c);return P}function Qe(c){return function(f,_,C){return C&&typeof C!="number"&&es(f,_,C)&&(_=C=U),f=bl(f),_===U?(_=f,f=0):_=bl(_),C=C===U?f<_?1:-1:bl(C),MT(f,_,C,c)}}function Bt(c){return function(f,_){return typeof f=="string"&&typeof _=="string"||(f=vo(f),_=vo(_)),c(f,_)}}function jn(c,f,_,C,P,M,G,$,Y,me){var fe=f&Dn,ve=fe?G:U,Le=fe?U:G,ze=fe?M:U,He=fe?U:M;f|=fe?bn:lr,f&=~(fe?lr:bn),f&no||(f&=~(ti|or));var vt=[c,f,P,ze,ve,He,Le,$,Y,me],Xe=_.apply(U,vt);return UT(c)&&a2(Xe,vt),Xe.placeholder=C,xL(Xe,c,f)}function Ot(c){var f=xd[c];return function(_,C){if(_=vo(_),C=C==null?0:br(Tt(C),292),C&&JL(_)){var P=(Jt(_)+"e").split("e");return P=(Jt(f(P[0]+"e"+(+P[1]+C)))+"e").split("e"),+(P[0]+"e"+(+P[1]-C))}return f(_)}}function Qo(c){return function(f){var _=Ar(f);return _==Ht?te(f):_==oi?lt(f):he(f,c(f))}}function Jo(c,f,_,C,P,M,G,$){var Y=f&or;if(!Y&&typeof c!="function")throw new xo(Wt);var me=C?C.length:0;if(me||(f&=~(bn|lr),C=P=U),G=G===U?G:Mi(Tt(G),0),$=$===U?$:Tt($),me-=P?P.length:0,f&lr){var fe=C,ve=P;C=P=U}var Le=Y?U:rS(c),ze=[c,f,_,C,P,fe,ve,M,G,$];if(Le&&P5(ze,Le),c=ze[0],f=ze[1],_=ze[2],C=ze[3],P=ze[4],$=ze[9]=ze[9]===U?Y?0:c.length:Mi(ze[9]-me,0),!$&&f&(Dn|ar)&&(f&=~(Dn|ar)),f&&f!=ti)He=f==Dn||f==ar?Kt(c,f,$):f!=bn&&f!=(ti|bn)||P.length?Q.apply(U,ze):an(c,f,_,C);else var He=Pe(c,f,_);return xL((Le?r2:a2)(He,ze),c,f)}function hL(c,f,_,C){return c===U||ea(c,wd[_])&&!tn.call(C,_)?f:c}function fL(c,f,_,C,P,M){return Bn(c)&&Bn(f)&&(M.set(f,c),rh(c,f,U,fL,M),M.delete(f)),c}function _5(c){return Em(c)?U:c}function dL(c,f,_,C,P,M){var G=_&Xt,$=c.length,Y=f.length;if($!=Y&&!(G&&Y>$))return!1;var me=M.get(c),fe=M.get(f);if(me&&fe)return me==f&&fe==c;var ve=-1,Le=!0,ze=_&cn?new Ho:U;for(M.set(c,f),M.set(f,c);++ve<$;){var He=c[ve],vt=f[ve];if(C)var Xe=G?C(vt,He,ve,f,c,M):C(He,vt,ve,c,f,M);if(Xe!==U){if(Xe)continue;Le=!1;break}if(ze){if(!x(f,function(Lt,Mt){if(!se(ze,Mt)&&(He===Lt||P(He,Lt,_,C,M)))return ze.push(Mt)})){Le=!1;break}}else if(He!==vt&&!P(He,vt,_,C,M)){Le=!1;break}}return M.delete(c),M.delete(f),Le}function v5(c,f,_,C,P,M,G){switch(_){case lo:if(c.byteLength!=f.byteLength||c.byteOffset!=f.byteOffset)return!1;c=c.buffer,f=f.buffer;case ur:return!(c.byteLength!=f.byteLength||!M(new Dv(c),new Dv(f)));case hs:case Ls:case Xr:return ea(+c,+f);case wa:return c.name==f.name&&c.message==f.message;case ao:case Go:return c==f+"";case Ht:var $=te;case oi:var Y=C&Xt;if($||($=Te),c.size!=f.size&&!Y)return!1;var me=G.get(c);if(me)return me==f;C|=cn,G.set(c,f);var fe=dL($(c),$(f),C,P,M,G);return G.delete(c),fe;case gl:if(Rm)return Rm.call(c)==Rm.call(f)}return!1}function x5(c,f,_,C,P,M){var G=_&Xt,$=FT(c),Y=$.length;if(Y!=FT(f).length&&!G)return!1;for(var me=Y;me--;){var fe=$[me];if(!(G?fe in f:tn.call(f,fe)))return!1}var ve=M.get(c),Le=M.get(f);if(ve&&Le)return ve==f&&Le==c;var ze=!0;M.set(c,f),M.set(f,c);for(var He=G;++me<Y;){fe=$[me];var vt=c[fe],Xe=f[fe];if(C)var Lt=G?C(Xe,vt,fe,f,c,M):C(vt,Xe,fe,c,f,M);if(!(Lt===U?vt===Xe||P(vt,Xe,_,C,M):Lt)){ze=!1;break}He||(He=fe=="constructor")}if(ze&&!He){var Mt=c.constructor,kr=f.constructor;Mt!=kr&&"constructor"in c&&"constructor"in f&&!(typeof Mt=="function"&&Mt instanceof Mt&&typeof kr=="function"&&kr instanceof kr)&&(ze=!1)}return M.delete(c),M.delete(f),ze}function Cl(c){return oS(_L(c,U,CL),c+"")}function FT(c){return nh(c,Ki,sS)}function OT(c){return nh(c,ps,o2)}function vv(c){for(var f=c.name+"",_=Td[f],C=tn.call(Td,f)?_.length:0;C--;){var P=_[C],M=P.func;if(M==null||M==c)return P.name}return f}function _d(c){return(tn.call(k,"placeholder")?k:c).placeholder}function Ze(){var c=k.iteratee||XT;return c=c===XT?lm:c,arguments.length?c(arguments[0],arguments[1]):c}function xv(c,f){var _=c.__data__;return b5(f)?_[typeof f=="string"?"string":"hash"]:_.map}function NT(c){for(var f=Ki(c),_=f.length;_--;){var C=f[_],P=c[C];f[_]=[C,P,mL(P)]}return f}function lh(c,f){var _=j(c,f);return uv(_)?_:U}function w5(c){var f=tn.call(c,ch),_=c[ch];try{c[ch]=U;var C=!0}catch{}var P=Lv.call(c);return C&&(f?c[ch]=_:delete c[ch]),P}function E5(c,f,_){for(var C=-1,P=_.length;++C<P;){var M=_[C],G=M.size;switch(M.type){case"drop":c+=G;break;case"dropRight":f-=G;break;case"take":f=br(f,c+G);break;case"takeRight":c=Mi(c,f-G)}}return{start:c,end:f}}function T5(c){var f=c.match(Ia);return f?f[1].split(Ra):[]}function gL(c,f,_){f=Zo(f,c);for(var C=-1,P=f.length,M=!1;++C<P;){var G=Fa(f[C]);if(!(M=c!=null&&_(c,G)))break;c=c[G]}return M||++C!=P?M:(P=c==null?0:c.length,!!P&&Iv(P)&&Il(G,P)&&(pt(c)||hh(c)))}function S5(c){var f=c.length,_=new c.constructor(f);return f&&typeof c[0]=="string"&&tn.call(c,"index")&&(_.index=c.index,_.input=c.input),_}function pL(c){return typeof c.constructor!="function"||wm(c)?{}:Sd(Fv(c))}function C5(c,f,_){var C=c.constructor;switch(f){case ur:return pd(c);case hs:case Ls:return new C(+c);case lo:return vm(c,_);case Ii:case uo:case Ea:case Ri:case xu:case Ta:case bi:case pl:case co:return xm(c,_);case Ht:return new C;case Xr:case Go:return new C(c);case ao:return mv(c);case oi:return new C;case gl:return md(c)}}function I5(c,f){var _=f.length;if(!_)return c;var C=_-1;return f[C]=(_>1?"& ":"")+f[C],f=f.join(_>2?", ":" "),c.replace(Mp,`{
/* [wrapped with `+f+`] */
`)}function R5(c){return pt(c)||hh(c)||!!(QL&&c&&c[QL])}function Il(c,f){var _=typeof c;return f=f??Rt,!!f&&(_=="number"||_!="symbol"&&N_.test(c))&&c>-1&&c%1==0&&c<f}function es(c,f,_){if(!Bn(_))return!1;var C=typeof f;return!!(C=="number"?gs(_)&&Il(f,_.length):C=="string"&&f in _)&&ea(_[f],c)}function zT(c,f){if(pt(c))return!1;var _=typeof c;return!(_!="number"&&_!="symbol"&&_!="boolean"&&c!=null&&!Gs(c))||Pp.test(c)||!P_.test(c)||f!=null&&c in wn(f)}function b5(c){var f=typeof c;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?c!=="__proto__":c===null}function UT(c){var f=vv(c),_=k[f];if(typeof _!="function"||!(f in Fe.prototype))return!1;if(c===_)return!0;var C=rS(_);return!!C&&c===C[0]}function A5(c){return!!qL&&qL in c}function wm(c){var f=c&&c.constructor;return c===(typeof f=="function"&&f.prototype||wd)}function mL(c){return c===c&&!Bn(c)}function yL(c,f){return function(_){return _!=null&&_[c]===f&&(f!==U||c in wn(_))}}function k5(c){var f=Sv(c,function(C){return _.size===cs&&_.clear(),C}),_=f.cache;return f}function P5(c,f){var _=c[1],C=f[1],P=_|C,M=P<(ti|or|ni),G=C==ni&&_==Dn||C==ni&&_==ii&&c[7].length<=f[8]||C==(ni|ii)&&f[7].length<=f[8]&&_==Dn;if(!M&&!G)return c;C&ti&&(c[2]=f[2],P|=_&ti?0:no);var $=f[3];if($){var Y=c[3];c[3]=Y?_v(Y,$,f[4]):$,c[4]=Y?K(c[3],Hi):f[4]}return $=f[5],$&&(Y=c[5],c[5]=Y?d(Y,$,f[6]):$,c[6]=Y?K(c[5],Hi):f[6]),$=f[7],$&&(c[7]=$),C&ni&&(c[8]=c[8]==null?f[8]:br(c[8],f[8])),c[9]==null&&(c[9]=f[9]),c[0]=f[0],c[1]=P,c}function L5(c){var f=[];if(c!=null)for(var _ in wn(c))f.push(_);return f}function M5(c){return Lv.call(c)}function _L(c,f,_){return f=Mi(f===U?c.length-1:f,0),function(){for(var C=arguments,P=-1,M=Mi(C.length-f,0),G=Li(M);++P<M;)G[P]=C[f+P];P=-1;for(var $=Li(f+1);++P<f;)$[P]=C[P];return $[f]=_(G),t(c,this,$)}}function vL(c,f){return f.length<2?c:Ir(c,Un(f,0,-1))}function D5(c,f){for(var _=c.length,C=br(f.length,_),P=g(c);C--;){var M=f[C];c[C]=Il(M,_)?P[M]:U}return c}function GT(c,f){if((f!=="constructor"||typeof c[f]!="function")&&f!="__proto__")return c[f]}function xL(c,f,_){var C=f+"";return oS(c,I5(C,F5(T5(C),_)))}function wL(c){var f=0,_=0;return function(){var C=V6(),P=ro-(C-_);if(_=C,P>0){if(++f>=_n)return arguments[0]}else f=0;return c.apply(U,arguments)}}function wv(c,f){var _=-1,C=c.length,P=C-1;for(f=f===U?C:f;++_<f;){var M=hm(_,P),G=c[M];c[M]=c[_],c[_]=G}return c.length=f,c}function Fa(c){if(typeof c=="string"||Gs(c))return c;var f=c+"";return f=="0"&&1/c==-On?"-0":f}function uh(c){if(c!=null){try{return Pv.call(c)}catch{}try{return c+""}catch{}}return""}function F5(c,f){return r(so,function(_){var C="_."+_[0];f&_[1]&&!l(c,C)&&c.push(C)}),c.sort()}function EL(c){if(c instanceof Fe)return c.clone();var f=new Be(c.__wrapped__,c.__chain__);return f.__actions__=g(c.__actions__),f.__index__=c.__index__,f.__values__=c.__values__,f}function O5(c,f,_){f=(_?es(c,f,_):f===U)?1:Mi(Tt(f),0);var C=c==null?0:c.length;if(!C||f<1)return[];for(var P=0,M=0,G=Li(zv(C/f));P<C;)G[M++]=Un(c,P,P+=f);return G}function N5(c){for(var f=-1,_=c==null?0:c.length,C=0,P=[];++f<_;){var M=c[f];M&&(P[C++]=M)}return P}function z5(){var c=arguments.length;if(!c)return[];for(var f=Li(c-1),_=arguments[0],C=c;C--;)f[C-1]=arguments[C];return p(pt(_)?g(_):[_],pi(f,1))}function U5(c,f,_){var C=c==null?0:c.length;return C?(f=_||f===U?1:Tt(f),Un(c,f<0?0:f,C)):[]}function G5(c,f,_){var C=c==null?0:c.length;return C?(f=_||f===U?1:Tt(f),f=C-f,Un(c,0,f<0?0:f)):[]}function j5(c,f){return c&&c.length?yo(c,Ze(f,3),!0,!0):[]}function B5(c,f){return c&&c.length?yo(c,Ze(f,3),!0):[]}function V5(c,f,_,C){var P=c==null?0:c.length;return P?(_&&typeof _!="number"&&es(c,f,_)&&(_=0,C=P),sd(c,f,_,C)):[]}function TL(c,f,_){var C=c==null?0:c.length;if(!C)return-1;var P=_==null?0:Tt(_);return P<0&&(P=Mi(C+P,0)),T(c,Ze(f,3),P)}function SL(c,f,_){var C=c==null?0:c.length;if(!C)return-1;var P=C-1;return _!==U&&(P=Tt(_),P=_<0?Mi(C+P,0):br(P,C-1)),T(c,Ze(f,3),P,!0)}function CL(c){return c!=null&&c.length?pi(c,1):[]}function $5(c){return c!=null&&c.length?pi(c,On):[]}function W5(c,f){return c!=null&&c.length?(f=f===U?1:Tt(f),pi(c,f)):[]}function H5(c){for(var f=-1,_=c==null?0:c.length,C={};++f<_;){var P=c[f];C[P[0]]=P[1]}return C}function IL(c){return c&&c.length?c[0]:U}function X5(c,f,_){var C=c==null?0:c.length;if(!C)return-1;var P=_==null?0:Tt(_);return P<0&&(P=Mi(C+P,0)),I(c,f,P)}function q5(c){return c!=null&&c.length?Un(c,0,-1):[]}function K5(c,f){return c==null?"":j6.call(c,f)}function _o(c){var f=c==null?0:c.length;return f?c[f-1]:U}function Y5(c,f,_){var C=c==null?0:c.length;if(!C)return-1;var P=C;return _!==U&&(P=Tt(_),P=P<0?Mi(C+P,0):br(P,C-1)),f===f?rt(c,f,P):T(c,L,P,!0)}function Z5(c,f){return c&&c.length?La(c,Tt(f)):U}function RL(c,f){return c&&c.length&&f&&f.length?cd(c,f):c}function Q5(c,f,_){return c&&c.length&&f&&f.length?cd(c,f,Ze(_,2)):c}function J5(c,f,_){return c&&c.length&&f&&f.length?cd(c,f,U,_):c}function e$(c,f){var _=[];if(!c||!c.length)return _;var C=-1,P=[],M=c.length;for(f=Ze(f,3);++C<M;){var G=c[C];f(G,C,c)&&(_.push(G),P.push(C))}return Da(c,P),_}function jT(c){return c==null?c:W6.call(c)}function t$(c,f,_){var C=c==null?0:c.length;return C?(_&&typeof _!="number"&&es(c,f,_)?(f=0,_=C):(f=f==null?0:Tt(f),_=_===U?C:Tt(_)),Un(c,f,_)):[]}function n$(c,f){return fd(c,f)}function i$(c,f,_){return Ko(c,f,Ze(_,2))}function r$(c,f){var _=c==null?0:c.length;if(_){var C=fd(c,f);if(C<_&&ea(c[C],f))return C}return-1}function s$(c,f){return fd(c,f,!0)}function o$(c,f,_){return Ko(c,f,Ze(_,2),!0)}function a$(c,f){if(c!=null&&c.length){var _=fd(c,f,!0)-1;if(ea(c[_],f))return _}return-1}function l$(c){return c&&c.length?oh(c):[]}function u$(c,f){return c&&c.length?oh(c,Ze(f,2)):[]}function c$(c){var f=c==null?0:c.length;return f?Un(c,1,f):[]}function h$(c,f,_){return c&&c.length?(f=_||f===U?1:Tt(f),Un(c,0,f<0?0:f)):[]}function f$(c,f,_){var C=c==null?0:c.length;return C?(f=_||f===U?1:Tt(f),f=C-f,Un(c,f<0?0:f,C)):[]}function d$(c,f){return c&&c.length?yo(c,Ze(f,3),!1,!0):[]}function g$(c,f){return c&&c.length?yo(c,Ze(f,3)):[]}function p$(c){return c&&c.length?mo(c):[]}function m$(c,f){return c&&c.length?mo(c,Ze(f,2)):[]}function y$(c,f){return f=typeof f=="function"?f:U,c&&c.length?mo(c,U,f):[]}function BT(c){if(!c||!c.length)return[];var f=0;return c=a(c,function(_){if(ci(_))return f=Mi(_.length,f),!0}),ge(f,function(_){return h(c,O(_))})}function bL(c,f){if(!c||!c.length)return[];var _=BT(c);return f==null?_:h(_,function(C){return t(f,U,C)})}function _$(c,f){return ah(c||[],f||[],ka)}function v$(c,f){return ah(c||[],f||[],sh)}function AL(c){var f=k(c);return f.__chain__=!0,f}function x$(c,f){return f(c),c}function Ev(c,f){return f(c)}function w$(){return AL(this)}function E$(){return new Be(this.value(),this.__chain__)}function T$(){this.__values__===U&&(this.__values__=UL(this.value()));var c=this.__index__>=this.__values__.length;return{done:c,value:c?U:this.__values__[this.__index__++]}}function S$(){return this}function C$(c){for(var f,_=this;_ instanceof ke;){var C=EL(_);C.__index__=0,C.__values__=U,f?P.__wrapped__=C:f=C;var P=C;_=_.__wrapped__}return P.__wrapped__=c,f}function I$(){var c=this.__wrapped__;if(c instanceof Fe){var f=c;return this.__actions__.length&&(f=new Fe(this)),f=f.reverse(),f.__actions__.push({func:Ev,args:[jT],thisArg:U}),new Be(f,this.__chain__)}return this.thru(jT)}function R$(){return ym(this.__wrapped__,this.__actions__)}function b$(c,f,_){var C=pt(c)?o:rd;return _&&es(c,f,_)&&(f=U),C(c,Ze(f,3))}function A$(c,f){return(pt(c)?a:od)(c,Ze(f,3))}function k$(c,f){return pi(Tv(c,f),1)}function P$(c,f){return pi(Tv(c,f),On)}function L$(c,f,_){return _=_===U?1:Tt(_),pi(Tv(c,f),_)}function kL(c,f){return(pt(c)?r:Ou)(c,Ze(f,3))}function PL(c,f){return(pt(c)?s:n2)(c,Ze(f,3))}function M$(c,f,_,C){c=gs(c)?c:vd(c),_=_&&!C?Tt(_):0;var P=c.length;return _<0&&(_=Mi(P+_,0)),Rv(c)?_<=P&&c.indexOf(f,_)>-1:!!P&&I(c,f,_)>-1}function Tv(c,f){return(pt(c)?h:dv)(c,Ze(f,3))}function D$(c,f,_,C){return c==null?[]:(pt(f)||(f=f==null?[]:[f]),_=C?U:_,pt(_)||(_=_==null?[]:[_]),pv(c,f,_))}function F$(c,f,_){var C=pt(c)?m:B,P=arguments.length<3;return C(c,Ze(f,4),_,P,Ou)}function O$(c,f,_){var C=pt(c)?y:B,P=arguments.length<3;return C(c,Ze(f,4),_,P,n2)}function N$(c,f){return(pt(c)?a:od)(c,Cv(Ze(f,3)))}function z$(c){return(pt(c)?nd:fm)(c)}function U$(c,f,_){return f=(_?es(c,f,_):f===U)?1:Tt(f),(pt(c)?ds:dm)(c,f)}function G$(c){return(pt(c)?Os:DT)(c)}function j$(c){if(c==null)return 0;if(gs(c))return Rv(c)?ut(c):c.length;var f=Ar(c);return f==Ht||f==oi?c.size:ud(c).length}function B$(c,f,_){var C=pt(c)?x:gm;return _&&es(c,f,_)&&(f=U),C(c,Ze(f,3))}function V$(c,f){if(typeof f!="function")throw new xo(Wt);return c=Tt(c),function(){if(--c<1)return f.apply(this,arguments)}}function LL(c,f,_){return f=_?U:f,f=c&&f==null?c.length:f,Jo(c,ni,U,U,U,U,f)}function ML(c,f){var _;if(typeof f!="function")throw new xo(Wt);return c=Tt(c),function(){return--c>0&&(_=f.apply(this,arguments)),c<=1&&(f=U),_}}function DL(c,f,_){f=_?U:f;var C=Jo(c,Dn,U,U,U,U,U,f);return C.placeholder=DL.placeholder,C}function FL(c,f,_){f=_?U:f;var C=Jo(c,ar,U,U,U,U,U,f);return C.placeholder=FL.placeholder,C}function OL(c,f,_){function C(Yn){var wo=Le,Am=ze;return Le=ze=U,Mt=Yn,vt=c.apply(Am,wo)}function P(Yn){return Mt=Yn,Xe=bm($,f),kr?C(Yn):vt}function M(Yn){var wo=Yn-Lt,Am=Yn-Mt,_2=f-wo;return ys?br(_2,He-Am):_2}function G(Yn){var wo=Yn-Lt,Am=Yn-Mt;return Lt===U||wo>=f||wo<0||ys&&Am>=He}function $(){var Yn=Bv();return G(Yn)?Y(Yn):(Xe=bm($,M(Yn)),U)}function Y(Yn){return Xe=U,zu&&Le?C(Yn):(Le=ze=U,vt)}function me(){Xe!==U&&s2(Xe),Mt=0,Le=Lt=ze=Xe=U}function fe(){return Xe===U?vt:Y(Bv())}function ve(){var Yn=Bv(),wo=G(Yn);if(Le=arguments,ze=this,Lt=Yn,wo){if(Xe===U)return P(Lt);if(ys)return s2(Xe),Xe=bm($,f),C(Lt)}return Xe===U&&(Xe=bm($,f)),vt}var Le,ze,He,vt,Xe,Lt,Mt=0,kr=!1,ys=!1,zu=!0;if(typeof c!="function")throw new xo(Wt);return f=vo(f)||0,Bn(_)&&(kr=!!_.leading,ys="maxWait"in _,He=ys?Mi(vo(_.maxWait)||0,f):He,zu="trailing"in _?!!_.trailing:zu),ve.cancel=me,ve.flush=fe,ve}function $$(c){return Jo(c,Ps)}function Sv(c,f){if(typeof c!="function"||f!=null&&typeof f!="function")throw new xo(Wt);var _=function(){var C=arguments,P=f?f.apply(this,C):C[0],M=_.cache;if(M.has(P))return M.get(P);var G=c.apply(this,C);return _.cache=M.set(P,G)||M,G};return _.cache=new(Sv.Cache||Wo),_}function Cv(c){if(typeof c!="function")throw new xo(Wt);return function(){var f=arguments;switch(f.length){case 0:return!c.call(this);case 1:return!c.call(this,f[0]);case 2:return!c.call(this,f[0],f[1]);case 3:return!c.call(this,f[0],f[1],f[2])}return!c.apply(this,f)}}function W$(c){return ML(2,c)}function H$(c,f){if(typeof c!="function")throw new xo(Wt);return f=f===U?f:Tt(f),dt(c,f)}function X$(c,f){if(typeof c!="function")throw new xo(Wt);return f=f==null?0:Mi(Tt(f),0),dt(function(_){var C=_[f],P=Us(_,0,f);return C&&p(P,C),t(c,this,P)})}function q$(c,f,_){var C=!0,P=!0;if(typeof c!="function")throw new xo(Wt);return Bn(_)&&(C="leading"in _?!!_.leading:C,P="trailing"in _?!!_.trailing:P),OL(c,f,{leading:C,maxWait:f,trailing:P})}function K$(c){return LL(c,1)}function Y$(c,f){return lS(dd(f),c)}function Z$(){if(!arguments.length)return[];var c=arguments[0];return pt(c)?c:[c]}function Q$(c){return fn(c,sr)}function J$(c,f){return f=typeof f=="function"?f:U,fn(c,sr,f)}function eW(c){return fn(c,Rn|sr)}function tW(c,f){return f=typeof f=="function"?f:U,fn(c,Rn|sr,f)}function nW(c,f){return f==null||th(c,f,Ki(f))}function ea(c,f){return c===f||c!==c&&f!==f}function gs(c){return c!=null&&Iv(c.length)&&!Rl(c)}function ci(c){return Kn(c)&&gs(c)}function iW(c){return c===!0||c===!1||Kn(c)&&ui(c)==hs}function rW(c){return Kn(c)&&c.nodeType===1&&!Em(c)}function sW(c){if(c==null)return!0;if(gs(c)&&(pt(c)||typeof c=="string"||typeof c.splice=="function"||Nu(c)||Cd(c)||hh(c)))return!c.length;var f=Ar(c);if(f==Ht||f==oi)return!c.size;if(wm(c))return!ud(c).length;for(var _ in c)if(tn.call(c,_))return!1;return!0}function oW(c,f){return mi(c,f)}function aW(c,f,_){_=typeof _=="function"?_:U;var C=_?_(c,f):U;return C===U?mi(c,f,U,_):!!C}function VT(c){if(!Kn(c))return!1;var f=ui(c);return f==wa||f==pu||typeof c.message=="string"&&typeof c.name=="string"&&!Em(c)}function lW(c){return typeof c=="number"&&JL(c)}function Rl(c){if(!Bn(c))return!1;var f=ui(c);return f==oo||f==mu||f==gu||f==yu}function NL(c){return typeof c=="number"&&c==Tt(c)}function Iv(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=Rt}function Bn(c){var f=typeof c;return c!=null&&(f=="object"||f=="function")}function Kn(c){return c!=null&&typeof c=="object"}function uW(c,f){return c===f||am(c,f,NT(f))}function cW(c,f,_){return _=typeof _=="function"?_:U,am(c,f,NT(f),_)}function hW(c){return zL(c)&&c!=+c}function fW(c){if(e8(c))throw new QT(ei);return uv(c)}function dW(c){return c===null}function gW(c){return c==null}function zL(c){return typeof c=="number"||Kn(c)&&ui(c)==Xr}function Em(c){if(!Kn(c)||ui(c)!=Nn)return!1;var f=Fv(c);if(f===null)return!0;var _=tn.call(f,"constructor")&&f.constructor;return typeof _=="function"&&_ instanceof _&&Pv.call(_)==D6}function pW(c){return NL(c)&&c>=-Rt&&c<=Rt}function Rv(c){return typeof c=="string"||!pt(c)&&Kn(c)&&ui(c)==Go}function Gs(c){return typeof c=="symbol"||Kn(c)&&ui(c)==gl}function mW(c){return c===U}function yW(c){return Kn(c)&&Ar(c)==Ci}function _W(c){return Kn(c)&&ui(c)==vu}function UL(c){if(!c)return[];if(gs(c))return Rv(c)?ct(c):g(c);if(Tm&&c[Tm])return H(c[Tm]());var f=Ar(c);return(f==Ht?te:f==oi?Te:vd)(c)}function bl(c){return c?(c=vo(c),c===On||c===-On?(c<0?-1:1)*bt:c===c?c:0):c===0?c:0}function Tt(c){var f=bl(c),_=f%1;return f===f?_?f-_:f:0}function GL(c){return c?tt(Tt(c),0,Pt):0}function vo(c){if(typeof c=="number")return c;if(Gs(c))return sn;if(Bn(c)){var f=typeof c.valueOf=="function"?c.valueOf():c;c=Bn(f)?f+"":f}if(typeof c!="string")return c===0?c:+c;c=de(c);var _=jf.test(c);return _||O_.test(c)?Wp(c.slice(2),_?2:8):Gf.test(c)?sn:+c}function jL(c){return v(c,ps(c))}function vW(c){return c?tt(Tt(c),-Rt,Rt):c===0?c:0}function Jt(c){return c==null?"":fr(c)}function xW(c,f){var _=Sd(c);return f==null?_:eh(_,f)}function wW(c,f){return E(c,Ze(f,3),Me)}function EW(c,f){return E(c,Ze(f,3),ku)}function TW(c,f){return c==null?c:iS(c,Ze(f,3),ps)}function SW(c,f){return c==null?c:i2(c,Ze(f,3),ps)}function CW(c,f){return c&&Me(c,Ze(f,3))}function IW(c,f){return c&&ku(c,Ze(f,3))}function RW(c){return c==null?[]:Pu(c,Ki(c))}function bW(c){return c==null?[]:Pu(c,ps(c))}function $T(c,f,_){var C=c==null?U:Ir(c,f);return C===U?_:C}function AW(c,f){return c!=null&&gL(c,f,Tl)}function WT(c,f){return c!=null&&gL(c,f,ih)}function Ki(c){return gs(c)?zn(c):ud(c)}function ps(c){return gs(c)?zn(c,!0):fv(c)}function kW(c,f){var _={};return f=Ze(f,3),Me(c,function(C,P,M){Ge(_,f(C,P,M),C)}),_}function PW(c,f){var _={};return f=Ze(f,3),Me(c,function(C,P,M){Ge(_,P,f(C,P,M))}),_}function LW(c,f){return BL(c,Cv(Ze(f)))}function BL(c,f){if(c==null)return{};var _=h(OT(c),function(C){return[C]});return f=Ze(f),Ma(c,_,function(C,P){return f(C,P[0])})}function MW(c,f,_){f=Zo(f,c);var C=-1,P=f.length;for(P||(P=1,c=U);++C<P;){var M=c==null?U:c[Fa(f[C])];M===U&&(C=P,M=_),c=Rl(M)?M.call(c):M}return c}function DW(c,f,_){return c==null?c:sh(c,f,_)}function FW(c,f,_,C){return C=typeof C=="function"?C:U,c==null?c:sh(c,f,_,C)}function OW(c,f,_){var C=pt(c),P=C||Nu(c)||Cd(c);if(f=Ze(f,4),_==null){var M=c&&c.constructor;_=P?C?new M:[]:Bn(c)&&Rl(M)?Sd(Fv(c)):{}}return(P?r:Me)(c,function(G,$,Y){return f(_,G,$,Y)}),_}function NW(c,f){return c==null||pm(c,f)}function zW(c,f,_){return c==null?c:mm(c,f,dd(_))}function UW(c,f,_,C){return C=typeof C=="function"?C:U,c==null?c:mm(c,f,dd(_),C)}function vd(c){return c==null?[]:_e(c,Ki(c))}function GW(c){return c==null?[]:_e(c,ps(c))}function jW(c,f,_){return _===U&&(_=f,f=U),_!==U&&(_=vo(_),_=_===_?_:0),f!==U&&(f=vo(f),f=f===f?f:0),tt(vo(c),f,_)}function BW(c,f,_){return f=bl(f),_===U?(_=f,f=0):_=bl(_),c=vo(c),sm(c,f,_)}function VW(c,f,_){if(_&&typeof _!="boolean"&&es(c,f,_)&&(f=_=U),_===U&&(typeof f=="boolean"?(_=f,f=U):typeof c=="boolean"&&(_=c,c=U)),c===U&&f===U?(c=0,f=1):(c=bl(c),f===U?(f=c,c=0):f=bl(f)),c>f){var C=c;c=f,f=C}if(_||c%1||f%1){var P=e2();return br(c+P*(f-c+H_("1e-"+((P+"").length-1))),f)}return hm(c,f)}function VL(c){return cS(Jt(c).toLowerCase())}function $L(c){return c=Jt(c),c&&c.replace(Fp,X_).replace(B_,"")}function $W(c,f,_){c=Jt(c),f=fr(f);var C=c.length;_=_===U?C:tt(Tt(_),0,C);var P=_;return _-=f.length,_>=0&&c.slice(_,P)==f}function WW(c){return c=Jt(c),c&&Sa.test(c)?c.replace(Kr,q_):c}function HW(c){return c=Jt(c),c&&fs.test(c)?c.replace(Ca,"\\$&"):c}function XW(c,f,_){c=Jt(c),f=Tt(f);var C=f?ut(c):0;if(!f||C>=f)return c;var P=(f-C)/2;return $e(Uv(P),_)+c+$e(zv(P),_)}function qW(c,f,_){c=Jt(c),f=Tt(f);var C=f?ut(c):0;return f&&C<f?c+$e(f-C,_):c}function KW(c,f,_){c=Jt(c),f=Tt(f);var C=f?ut(c):0;return f&&C<f?$e(f-C,_)+c:c}function YW(c,f,_){return _||f==null?f=0:f&&(f=+f),$6(Jt(c).replace(ho,""),f||0)}function ZW(c,f,_){return f=(_?es(c,f,_):f===U)?1:Tt(f),hd(Jt(c),f)}function QW(){var c=arguments,f=Jt(c[0]);return c.length<3?f:f.replace(c[1],c[2])}function JW(c,f,_){return _&&typeof _!="number"&&es(c,f,_)&&(f=_=U),(_=_===U?Pt:_>>>0)?(c=Jt(c),c&&(typeof f=="string"||f!=null&&!uS(f))&&(f=fr(f),!f&&ie(c))?Us(ct(c),0,_):c.split(f,_)):[]}function e6(c,f,_){return c=Jt(c),_=_==null?0:tt(Tt(_),0,c.length),f=fr(f),c.slice(_,_+f.length)==f}function t6(c,f,_){var C=k.templateSettings;_&&es(c,f,_)&&(f=U),c=Jt(c),f=Vv({},f,C,hL);var P,M,G=Vv({},f.imports,C.imports,hL),$=Ki(G),Y=_e(G,$),me=0,fe=f.interpolate||_l,ve="__p += '",Le=JT((f.escape||_l).source+"|"+fe.source+"|"+(fe===wu?qc:_l).source+"|"+(f.evaluate||_l).source+"|$","g"),ze="//# sourceURL="+(tn.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ST+"]")+`
`;c.replace(Le,function(Xe,Lt,Mt,kr,ys,zu){return Mt||(Mt=kr),ve+=c.slice(me,zu).replace(Kc,ee),Lt&&(P=!0,ve+=`' +
__e(`+Lt+`) +
'`),ys&&(M=!0,ve+=`';
`+ys+`;
__p += '`),Mt&&(ve+=`' +
((__t = (`+Mt+`)) == null ? '' : __t) +
'`),me=zu+Xe.length,Xe}),ve+=`';
`;var He=tn.call(f,"variable")&&f.variable;if(He){if(Xc.test(He))throw new QT(yn)}else ve=`with (obj) {
`+ve+`
}
`;ve=(M?ve.replace(ml,""):ve).replace(qr,"$1").replace(Xi,"$1;"),ve="function("+(He||"obj")+`) {
`+(He?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(P?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ve+`return __p
}`;var vt=y2(function(){return XL($,ze+"return "+ve).apply(U,Y)});if(vt.source=ve,VT(vt))throw vt;return vt}function n6(c){return Jt(c).toLowerCase()}function i6(c){return Jt(c).toUpperCase()}function r6(c,f,_){if(c=Jt(c),c&&(_||f===U))return de(c);if(!c||!(f=fr(f)))return c;var C=ct(c),P=ct(f);return Us(C,Z(C,P),pe(C,P)+1).join("")}function s6(c,f,_){if(c=Jt(c),c&&(_||f===U))return c.slice(0,rr(c)+1);if(!c||!(f=fr(f)))return c;var C=ct(c);return Us(C,0,pe(C,ct(f))+1).join("")}function o6(c,f,_){if(c=Jt(c),c&&(_||f===U))return c.replace(ho,"");if(!c||!(f=fr(f)))return c;var C=ct(c);return Us(C,Z(C,ct(f))).join("")}function a6(c,f){var _=zo,C=io;if(Bn(f)){var P="separator"in f?f.separator:P;_="length"in f?Tt(f.length):_,C="omission"in f?fr(f.omission):C}c=Jt(c);var M=c.length;if(ie(c)){var G=ct(c);M=G.length}if(_>=M)return c;var $=_-ut(C);if($<1)return C;var Y=G?Us(G,0,$).join(""):c.slice(0,$);if(P===U)return Y+C;if(G&&($+=Y.length-$),uS(P)){if(c.slice($).search(P)){var me,fe=Y;for(P.global||(P=JT(P.source,Jt(Dp.exec(P))+"g")),P.lastIndex=0;me=P.exec(fe);)var ve=me.index;Y=Y.slice(0,ve===U?$:ve)}}else if(c.indexOf(fr(P),$)!=$){var Le=Y.lastIndexOf(P);Le>-1&&(Y=Y.slice(0,Le))}return Y+C}function l6(c){return c=Jt(c),c&&yl.test(c)?c.replace(Tr,Jp):c}function WL(c,f,_){return c=Jt(c),f=_?U:f,f===U?q(c)?Ie(c):R(c):c.match(f)||[]}function u6(c){var f=c==null?0:c.length,_=Ze();return c=f?h(c,function(C){if(typeof C[1]!="function")throw new xo(Wt);return[_(C[0]),C[1]]}):[],dt(function(C){for(var P=-1;++P<f;){var M=c[P];if(t(M[0],this,C))return t(M[1],this,C)}})}function c6(c){return gi(fn(c,Rn))}function HT(c){return function(){return c}}function h6(c,f){return c==null||c!==c?f:c}function ms(c){return c}function XT(c){return lm(typeof c=="function"?c:fn(c,Rn))}function f6(c){return gv(fn(c,Rn))}function d6(c,f){return um(c,fn(f,Rn))}function qT(c,f,_){var C=Ki(f),P=Pu(f,C);_!=null||Bn(f)&&(P.length||!C.length)||(_=f,f=c,c=this,P=Pu(f,Ki(f)));var M=!(Bn(_)&&"chain"in _&&!_.chain),G=Rl(c);return r(P,function($){var Y=f[$];c[$]=Y,G&&(c.prototype[$]=function(){var me=this.__chain__;if(M||me){var fe=c(this.__wrapped__);return(fe.__actions__=g(this.__actions__)).push({func:Y,args:arguments,thisArg:c}),fe.__chain__=me,fe}return Y.apply(c,p([this.value()],arguments))})}),c}function g6(){return li._===this&&(li._=F6),this}function KT(){}function p6(c){return c=Tt(c),dt(function(f){return La(f,c)})}function HL(c){return zT(c)?O(Fa(c)):LT(c)}function m6(c){return function(f){return c==null?U:Ir(c,f)}}function YT(){return[]}function ZT(){return!1}function y6(){return{}}function _6(){return""}function v6(){return!0}function x6(c,f){if(c=Tt(c),c<1||c>Rt)return[];var _=Pt,C=br(c,Pt);f=Ze(f),c-=Pt;for(var P=ge(C,f);++_<c;)f(_);return P}function w6(c){return pt(c)?h(c,Fa):Gs(c)?[c]:g(l2(Jt(c)))}function E6(c){var f=++M6;return Jt(c)+f}function T6(c){return c&&c.length?Pa(c,ms,El):U}function S6(c,f){return c&&c.length?Pa(c,Ze(f,2),El):U}function C6(c){return F(c,ms)}function I6(c,f){return F(c,Ze(f,2))}function R6(c){return c&&c.length?Pa(c,ms,Mu):U}function b6(c,f){return c&&c.length?Pa(c,Ze(f,2),Mu):U}function A6(c){return c&&c.length?J(c,ms):0}function k6(c,f){return c&&c.length?J(c,Ze(f,2)):0}ae=ae==null?li:Cr.defaults(li.Object(),ae,Cr.pick(li,Kf));var Li=ae.Array,bv=ae.Date,QT=ae.Error,XL=ae.Function,xd=ae.Math,wn=ae.Object,JT=ae.RegExp,P6=ae.String,xo=ae.TypeError,Av=Li.prototype,L6=XL.prototype,wd=wn.prototype,kv=ae["__core-js_shared__"],Pv=L6.toString,tn=wd.hasOwnProperty,M6=0,qL=function(){var c=/[^.]+$/.exec(kv&&kv.keys&&kv.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Lv=wd.toString,D6=Pv.call(wn),F6=li._,O6=JT("^"+Pv.call(tn).replace(Ca,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Mv=Sr?ae.Buffer:U,Fu=ae.Symbol,Dv=ae.Uint8Array,KL=Mv?Mv.allocUnsafe:U,Fv=ue(wn.getPrototypeOf,wn),YL=wn.create,ZL=wd.propertyIsEnumerable,Ov=Av.splice,QL=Fu?Fu.isConcatSpreadable:U,Tm=Fu?Fu.iterator:U,ch=Fu?Fu.toStringTag:U,Nv=function(){try{var c=lh(wn,"defineProperty");return c({},"",{}),c}catch{}}(),N6=ae.clearTimeout!==li.clearTimeout&&ae.clearTimeout,z6=bv&&bv.now!==li.Date.now&&bv.now,U6=ae.setTimeout!==li.setTimeout&&ae.setTimeout,zv=xd.ceil,Uv=xd.floor,eS=wn.getOwnPropertySymbols,G6=Mv?Mv.isBuffer:U,JL=ae.isFinite,j6=Av.join,B6=ue(wn.keys,wn),Mi=xd.max,br=xd.min,V6=bv.now,$6=ae.parseInt,e2=xd.random,W6=Av.reverse,tS=lh(ae,"DataView"),Sm=lh(ae,"Map"),nS=lh(ae,"Promise"),Ed=lh(ae,"Set"),Cm=lh(ae,"WeakMap"),Im=lh(wn,"create"),Gv=Cm&&new Cm,Td={},H6=uh(tS),X6=uh(Sm),q6=uh(nS),K6=uh(Ed),Y6=uh(Cm),jv=Fu?Fu.prototype:U,Rm=jv?jv.valueOf:U,t2=jv?jv.toString:U,Sd=function(){function c(){}return function(f){if(!Bn(f))return{};if(YL)return YL(f);c.prototype=f;var _=new c;return c.prototype=U,_}}();k.templateSettings={escape:Yr,evaluate:jo,interpolate:wu,variable:"",imports:{_:k}},k.prototype=ke.prototype,k.prototype.constructor=k,Be.prototype=Sd(ke.prototype),Be.prototype.constructor=Be,Fe.prototype=Sd(ke.prototype),Fe.prototype.constructor=Fe,$o.prototype.clear=IT,$o.prototype.delete=tm,$o.prototype.get=RT,$o.prototype.has=Y_,$o.prototype.set=bT,Ds.prototype.clear=Z_,Ds.prototype.delete=AT,Ds.prototype.get=Q_,Ds.prototype.has=J_,Ds.prototype.set=ev,Wo.prototype.clear=tv,Wo.prototype.delete=nv,Wo.prototype.get=nm,Wo.prototype.has=im,Wo.prototype.set=iv,Ho.prototype.add=Ho.prototype.push=rv,Ho.prototype.has=ed,Fs.prototype.clear=sv,Fs.prototype.delete=ov,Fs.prototype.get=kT,Fs.prototype.has=td,Fs.prototype.set=av;var Ou=re(Me),n2=re(ku,!0),iS=Se(),i2=Se(!0),r2=Gv?function(c,f){return Gv.set(c,f),c}:ms,Z6=Nv?function(c,f){return Nv(c,"toString",{configurable:!0,enumerable:!1,value:HT(f),writable:!0})}:ms,Q6=dt,s2=N6||function(c){return li.clearTimeout(c)},J6=Ed&&1/Te(new Ed([,-0]))[1]==On?function(c){return new Ed(c)}:KT,rS=Gv?function(c){return Gv.get(c)}:KT,sS=eS?function(c){return c==null?[]:(c=wn(c),a(eS(c),function(f){return ZL.call(c,f)}))}:YT,o2=eS?function(c){for(var f=[];c;)p(f,sS(c)),c=Fv(c);return f}:YT,Ar=ui;(tS&&Ar(new tS(new ArrayBuffer(1)))!=lo||Sm&&Ar(new Sm)!=Ht||nS&&Ar(nS.resolve())!=Uo||Ed&&Ar(new Ed)!=oi||Cm&&Ar(new Cm)!=Ci)&&(Ar=function(c){var f=ui(c),_=f==Nn?c.constructor:U,C=_?uh(_):"";if(C)switch(C){case H6:return lo;case X6:return Ht;case q6:return Uo;case K6:return oi;case Y6:return Ci}return f});var e8=kv?Rl:ZT,a2=wL(r2),bm=U6||function(c,f){return li.setTimeout(c,f)},oS=wL(Z6),l2=k5(function(c){var f=[];return c.charCodeAt(0)===46&&f.push(""),c.replace(L_,function(_,C,P,M){f.push(P?M.replace(D_,"$1"):C||_)}),f}),t8=dt(function(c,f){return ci(c)?qo(c,pi(f,1,ci,!0)):[]}),n8=dt(function(c,f){var _=_o(f);return ci(_)&&(_=U),ci(c)?qo(c,pi(f,1,ci,!0),Ze(_,2)):[]}),i8=dt(function(c,f){var _=_o(f);return ci(_)&&(_=U),ci(c)?qo(c,pi(f,1,ci,!0),U,_):[]}),r8=dt(function(c){var f=h(c,_m);return f.length&&f[0]===c[0]?Lu(f):[]}),s8=dt(function(c){var f=_o(c),_=h(c,_m);return f===_o(_)?f=U:_.pop(),_.length&&_[0]===c[0]?Lu(_,Ze(f,2)):[]}),o8=dt(function(c){var f=_o(c),_=h(c,_m);return f=typeof f=="function"?f:U,f&&_.pop(),_.length&&_[0]===c[0]?Lu(_,U,f):[]}),a8=dt(RL),l8=Cl(function(c,f){var _=c==null?0:c.length,C=hr(c,f);return Da(c,h(f,function(P){return Il(P,_)?+P:P}).sort(yd)),C}),u8=dt(function(c){return mo(pi(c,1,ci,!0))}),c8=dt(function(c){var f=_o(c);return ci(f)&&(f=U),mo(pi(c,1,ci,!0),Ze(f,2))}),h8=dt(function(c){var f=_o(c);return f=typeof f=="function"?f:U,mo(pi(c,1,ci,!0),U,f)}),f8=dt(function(c,f){return ci(c)?qo(c,f):[]}),d8=dt(function(c){return Du(a(c,ci))}),g8=dt(function(c){var f=_o(c);return ci(f)&&(f=U),Du(a(c,ci),Ze(f,2))}),p8=dt(function(c){var f=_o(c);return f=typeof f=="function"?f:U,Du(a(c,ci),U,f)}),m8=dt(BT),y8=dt(function(c){var f=c.length,_=f>1?c[f-1]:U;return _=typeof _=="function"?(c.pop(),_):U,bL(c,_)}),_8=Cl(function(c){var f=c.length,_=f?c[0]:0,C=this.__wrapped__,P=function(M){return hr(M,c)};return!(f>1||this.__actions__.length)&&C instanceof Fe&&Il(_)?(C=C.slice(_,+_+(f?1:0)),C.__actions__.push({func:Ev,args:[P],thisArg:U}),new Be(C,this.__chain__).thru(function(M){return f&&!M.length&&M.push(U),M})):this.thru(P)}),v8=D(function(c,f,_){tn.call(c,_)?++c[_]:Ge(c,_,1)}),x8=Rr(TL),w8=Rr(SL),E8=D(function(c,f,_){tn.call(c,_)?c[_].push(f):Ge(c,_,[f])}),T8=dt(function(c,f,_){var C=-1,P=typeof f=="function",M=gs(c)?Li(c.length):[];return Ou(c,function(G){M[++C]=P?t(f,G,_):zs(G,f,_)}),M}),S8=D(function(c,f,_){Ge(c,_,f)}),C8=D(function(c,f,_){c[_?0:1].push(f)},function(){return[[],[]]}),I8=dt(function(c,f){if(c==null)return[];var _=f.length;return _>1&&es(c,f[0],f[1])?f=[]:_>2&&es(f[0],f[1],f[2])&&(f=[f[0]]),pv(c,pi(f,1),[])}),Bv=z6||function(){return li.Date.now()},aS=dt(function(c,f,_){var C=ti;if(_.length){var P=K(_,_d(aS));C|=bn}return Jo(c,C,f,_,P)}),u2=dt(function(c,f,_){var C=ti|or;if(_.length){var P=K(_,_d(u2));C|=bn}return Jo(f,C,c,_,P)}),R8=dt(function(c,f){return go(c,1,f)}),b8=dt(function(c,f,_){return go(c,vo(f)||0,_)});Sv.Cache=Wo;var A8=Q6(function(c,f){f=f.length==1&&pt(f[0])?h(f[0],oe(Ze())):h(pi(f,1),oe(Ze()));var _=f.length;return dt(function(C){for(var P=-1,M=br(C.length,_);++P<M;)C[P]=f[P].call(this,C[P]);return t(c,this,C)})}),lS=dt(function(c,f){return Jo(c,bn,U,f,K(f,_d(lS)))}),c2=dt(function(c,f){return Jo(c,lr,U,f,K(f,_d(c2)))}),k8=Cl(function(c,f){return Jo(c,ii,U,U,U,f)}),P8=Bt(El),L8=Bt(function(c,f){return c>=f}),hh=po(function(){return arguments}())?po:function(c){return Kn(c)&&tn.call(c,"callee")&&!ZL.call(c,"callee")},pt=Li.isArray,M8=qp?oe(qp):ad,Nu=G6||ZT,D8=Kp?oe(Kp):ld,h2=Qf?oe(Qf):om,uS=Yp?oe(Yp):cv,f2=Jf?oe(Jf):hv,Cd=Zp?oe(Zp):Sl,F8=Bt(Mu),O8=Bt(function(c,f){return c<=f}),N8=z(function(c,f){if(wm(f)||gs(f))return v(f,Ki(f),c),U;for(var _ in f)tn.call(f,_)&&ka(c,_,f[_])}),d2=z(function(c,f){v(f,ps(f),c)}),Vv=z(function(c,f,_,C){v(f,ps(f),c,C)}),z8=z(function(c,f,_,C){v(f,Ki(f),c,C)}),U8=Cl(hr),G8=dt(function(c,f){c=wn(c);var _=-1,C=f.length,P=C>2?f[2]:U;for(P&&es(f[0],f[1],P)&&(C=1);++_<C;)for(var M=f[_],G=ps(M),$=-1,Y=G.length;++$<Y;){var me=G[$],fe=c[me];(fe===U||ea(fe,wd[me])&&!tn.call(c,me))&&(c[me]=M[me])}return c}),j8=dt(function(c){return c.push(U,fL),t(g2,U,c)}),B8=X(function(c,f,_){f!=null&&typeof f.toString!="function"&&(f=Lv.call(f)),c[f]=_},HT(ms)),V8=X(function(c,f,_){f!=null&&typeof f.toString!="function"&&(f=Lv.call(f)),tn.call(c,f)?c[f].push(_):c[f]=[_]},Ze),$8=dt(zs),W8=z(function(c,f,_){rh(c,f,_)}),g2=z(function(c,f,_,C){rh(c,f,_,C)}),H8=Cl(function(c,f){var _={};if(c==null)return _;var C=!1;f=h(f,function(M){return M=Zo(M,c),C||(C=M.length>1),M}),v(c,OT(c),_),C&&(_=fn(_,Rn|Ft|sr,_5));for(var P=f.length;P--;)pm(_,f[P]);return _}),X8=Cl(function(c,f){return c==null?{}:PT(c,f)}),p2=Qo(Ki),m2=Qo(ps),q8=nt(function(c,f,_){return f=f.toLowerCase(),c+(_?VL(f):f)}),K8=nt(function(c,f,_){return c+(_?"-":"")+f.toLowerCase()}),Y8=nt(function(c,f,_){return c+(_?" ":"")+f.toLowerCase()}),Z8=qt("toLowerCase"),Q8=nt(function(c,f,_){return c+(_?"_":"")+f.toLowerCase()}),J8=nt(function(c,f,_){return c+(_?" ":"")+cS(f)}),eH=nt(function(c,f,_){return c+(_?" ":"")+f.toUpperCase()}),cS=qt("toUpperCase"),y2=dt(function(c,f){try{return t(c,U,f)}catch(_){return VT(_)?_:new QT(_)}}),tH=Cl(function(c,f){return r(f,function(_){_=Fa(_),Ge(c,_,aS(c[_],c))}),c}),nH=Gn(),iH=Gn(!0),rH=dt(function(c,f){return function(_){return zs(_,c,f)}}),sH=dt(function(c,f){return function(_){return zs(c,_,f)}}),oH=Oe(h),aH=Oe(o),lH=Oe(x),uH=Qe(),cH=Qe(!0),hH=le(function(c,f){return c+f},0),fH=Ot("ceil"),dH=le(function(c,f){return c/f},1),gH=Ot("floor"),pH=le(function(c,f){return c*f},1),mH=Ot("round"),yH=le(function(c,f){return c-f},0);return k.after=V$,k.ary=LL,k.assign=N8,k.assignIn=d2,k.assignInWith=Vv,k.assignWith=z8,k.at=U8,k.before=ML,k.bind=aS,k.bindAll=tH,k.bindKey=u2,k.castArray=Z$,k.chain=AL,k.chunk=O5,k.compact=N5,k.concat=z5,k.cond=u6,k.conforms=c6,k.constant=HT,k.countBy=v8,k.create=xW,k.curry=DL,k.curryRight=FL,k.debounce=OL,k.defaults=G8,k.defaultsDeep=j8,k.defer=R8,k.delay=b8,k.difference=t8,k.differenceBy=n8,k.differenceWith=i8,k.drop=U5,k.dropRight=G5,k.dropRightWhile=j5,k.dropWhile=B5,k.fill=V5,k.filter=A$,k.flatMap=k$,k.flatMapDeep=P$,k.flatMapDepth=L$,k.flatten=CL,k.flattenDeep=$5,k.flattenDepth=W5,k.flip=$$,k.flow=nH,k.flowRight=iH,k.fromPairs=H5,k.functions=RW,k.functionsIn=bW,k.groupBy=E8,k.initial=q5,k.intersection=r8,k.intersectionBy=s8,k.intersectionWith=o8,k.invert=B8,k.invertBy=V8,k.invokeMap=T8,k.iteratee=XT,k.keyBy=S8,k.keys=Ki,k.keysIn=ps,k.map=Tv,k.mapKeys=kW,k.mapValues=PW,k.matches=f6,k.matchesProperty=d6,k.memoize=Sv,k.merge=W8,k.mergeWith=g2,k.method=rH,k.methodOf=sH,k.mixin=qT,k.negate=Cv,k.nthArg=p6,k.omit=H8,k.omitBy=LW,k.once=W$,k.orderBy=D$,k.over=oH,k.overArgs=A8,k.overEvery=aH,k.overSome=lH,k.partial=lS,k.partialRight=c2,k.partition=C8,k.pick=X8,k.pickBy=BL,k.property=HL,k.propertyOf=m6,k.pull=a8,k.pullAll=RL,k.pullAllBy=Q5,k.pullAllWith=J5,k.pullAt=l8,k.range=uH,k.rangeRight=cH,k.rearg=k8,k.reject=N$,k.remove=e$,k.rest=H$,k.reverse=jT,k.sampleSize=U$,k.set=DW,k.setWith=FW,k.shuffle=G$,k.slice=t$,k.sortBy=I8,k.sortedUniq=l$,k.sortedUniqBy=u$,k.split=JW,k.spread=X$,k.tail=c$,k.take=h$,k.takeRight=f$,k.takeRightWhile=d$,k.takeWhile=g$,k.tap=x$,k.throttle=q$,k.thru=Ev,k.toArray=UL,k.toPairs=p2,k.toPairsIn=m2,k.toPath=w6,k.toPlainObject=jL,k.transform=OW,k.unary=K$,k.union=u8,k.unionBy=c8,k.unionWith=h8,k.uniq=p$,k.uniqBy=m$,k.uniqWith=y$,k.unset=NW,k.unzip=BT,k.unzipWith=bL,k.update=zW,k.updateWith=UW,k.values=vd,k.valuesIn=GW,k.without=f8,k.words=WL,k.wrap=Y$,k.xor=d8,k.xorBy=g8,k.xorWith=p8,k.zip=m8,k.zipObject=_$,k.zipObjectDeep=v$,k.zipWith=y8,k.entries=p2,k.entriesIn=m2,k.extend=d2,k.extendWith=Vv,qT(k,k),k.add=hH,k.attempt=y2,k.camelCase=q8,k.capitalize=VL,k.ceil=fH,k.clamp=jW,k.clone=Q$,k.cloneDeep=eW,k.cloneDeepWith=tW,k.cloneWith=J$,k.conformsTo=nW,k.deburr=$L,k.defaultTo=h6,k.divide=dH,k.endsWith=$W,k.eq=ea,k.escape=WW,k.escapeRegExp=HW,k.every=b$,k.find=x8,k.findIndex=TL,k.findKey=wW,k.findLast=w8,k.findLastIndex=SL,k.findLastKey=EW,k.floor=gH,k.forEach=kL,k.forEachRight=PL,k.forIn=TW,k.forInRight=SW,k.forOwn=CW,k.forOwnRight=IW,k.get=$T,k.gt=P8,k.gte=L8,k.has=AW,k.hasIn=WT,k.head=IL,k.identity=ms,k.includes=M$,k.indexOf=X5,k.inRange=BW,k.invoke=$8,k.isArguments=hh,k.isArray=pt,k.isArrayBuffer=M8,k.isArrayLike=gs,k.isArrayLikeObject=ci,k.isBoolean=iW,k.isBuffer=Nu,k.isDate=D8,k.isElement=rW,k.isEmpty=sW,k.isEqual=oW,k.isEqualWith=aW,k.isError=VT,k.isFinite=lW,k.isFunction=Rl,k.isInteger=NL,k.isLength=Iv,k.isMap=h2,k.isMatch=uW,k.isMatchWith=cW,k.isNaN=hW,k.isNative=fW,k.isNil=gW,k.isNull=dW,k.isNumber=zL,k.isObject=Bn,k.isObjectLike=Kn,k.isPlainObject=Em,k.isRegExp=uS,k.isSafeInteger=pW,k.isSet=f2,k.isString=Rv,k.isSymbol=Gs,k.isTypedArray=Cd,k.isUndefined=mW,k.isWeakMap=yW,k.isWeakSet=_W,k.join=K5,k.kebabCase=K8,k.last=_o,k.lastIndexOf=Y5,k.lowerCase=Y8,k.lowerFirst=Z8,k.lt=F8,k.lte=O8,k.max=T6,k.maxBy=S6,k.mean=C6,k.meanBy=I6,k.min=R6,k.minBy=b6,k.stubArray=YT,k.stubFalse=ZT,k.stubObject=y6,k.stubString=_6,k.stubTrue=v6,k.multiply=pH,k.nth=Z5,k.noConflict=g6,k.noop=KT,k.now=Bv,k.pad=XW,k.padEnd=qW,k.padStart=KW,k.parseInt=YW,k.random=VW,k.reduce=F$,k.reduceRight=O$,k.repeat=ZW,k.replace=QW,k.result=MW,k.round=mH,k.runInContext=W,k.sample=z$,k.size=j$,k.snakeCase=Q8,k.some=B$,k.sortedIndex=n$,k.sortedIndexBy=i$,k.sortedIndexOf=r$,k.sortedLastIndex=s$,k.sortedLastIndexBy=o$,k.sortedLastIndexOf=a$,k.startCase=J8,k.startsWith=e6,k.subtract=yH,k.sum=A6,k.sumBy=k6,k.template=t6,k.times=x6,k.toFinite=bl,k.toInteger=Tt,k.toLength=GL,k.toLower=n6,k.toNumber=vo,k.toSafeInteger=vW,k.toString=Jt,k.toUpper=i6,k.trim=r6,k.trimEnd=s6,k.trimStart=o6,k.truncate=a6,k.unescape=l6,k.uniqueId=E6,k.upperCase=eH,k.upperFirst=cS,k.each=kL,k.eachRight=PL,k.first=IL,qT(k,function(){var c={};return Me(k,function(f,_){tn.call(k.prototype,_)||(c[_]=f)}),c}(),{chain:!1}),k.VERSION=Wr,r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){k[c].placeholder=k}),r(["drop","take"],function(c,f){Fe.prototype[c]=function(_){_=_===U?1:Mi(Tt(_),0);var C=this.__filtered__&&!f?new Fe(this):this.clone();return C.__filtered__?C.__takeCount__=br(_,C.__takeCount__):C.__views__.push({size:br(_,Pt),type:c+(C.__dir__<0?"Right":"")}),C},Fe.prototype[c+"Right"]=function(_){return this.reverse()[c](_).reverse()}}),r(["filter","map","takeWhile"],function(c,f){var _=f+1,C=_==ri||_==Fn;Fe.prototype[c]=function(P){var M=this.clone();return M.__iteratees__.push({iteratee:Ze(P,3),type:_}),M.__filtered__=M.__filtered__||C,M}}),r(["head","last"],function(c,f){var _="take"+(f?"Right":"");Fe.prototype[c]=function(){return this[_](1).value()[0]}}),r(["initial","tail"],function(c,f){var _="drop"+(f?"":"Right");Fe.prototype[c]=function(){return this.__filtered__?new Fe(this):this[_](1)}}),Fe.prototype.compact=function(){return this.filter(ms)},Fe.prototype.find=function(c){return this.filter(c).head()},Fe.prototype.findLast=function(c){return this.reverse().find(c)},Fe.prototype.invokeMap=dt(function(c,f){return typeof c=="function"?new Fe(this):this.map(function(_){return zs(_,c,f)})}),Fe.prototype.reject=function(c){return this.filter(Cv(Ze(c)))},Fe.prototype.slice=function(c,f){c=Tt(c);var _=this;return _.__filtered__&&(c>0||f<0)?new Fe(_):(c<0?_=_.takeRight(-c):c&&(_=_.drop(c)),f!==U&&(f=Tt(f),_=f<0?_.dropRight(-f):_.take(f-c)),_)},Fe.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},Fe.prototype.toArray=function(){return this.take(Pt)},Me(Fe.prototype,function(c,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),C=/^(?:head|last)$/.test(f),P=k[C?"take"+(f=="last"?"Right":""):f],M=C||/^find/.test(f);P&&(k.prototype[f]=function(){var G=this.__wrapped__,$=C?[1]:arguments,Y=G instanceof Fe,me=$[0],fe=Y||pt(G),ve=function(Lt){var Mt=P.apply(k,p([Lt],$));return C&&Le?Mt[0]:Mt};fe&&_&&typeof me=="function"&&me.length!=1&&(Y=fe=!1);var Le=this.__chain__,ze=!!this.__actions__.length,He=M&&!Le,vt=Y&&!ze;if(!M&&fe){G=vt?G:new Fe(this);var Xe=c.apply(G,$);return Xe.__actions__.push({func:Ev,args:[ve],thisArg:U}),new Be(Xe,Le)}return He&&vt?c.apply(this,$):(Xe=this.thru(ve),He?C?Xe.value()[0]:Xe.value():Xe)})}),r(["pop","push","shift","sort","splice","unshift"],function(c){var f=Av[c],_=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",C=/^(?:pop|shift)$/.test(c);k.prototype[c]=function(){var P=arguments;if(C&&!this.__chain__){var M=this.value();return f.apply(pt(M)?M:[],P)}return this[_](function(G){return f.apply(pt(G)?G:[],P)})}}),Me(Fe.prototype,function(c,f){var _=k[f];if(_){var C=_.name+"";tn.call(Td,C)||(Td[C]=[]),Td[C].push({name:f,func:_})}}),Td[Q(U,or).name]=[{name:"wrapper",func:U}],Fe.prototype.clone=Pi,Fe.prototype.reverse=em,Fe.prototype.value=CT,k.prototype.at=_8,k.prototype.chain=w$,k.prototype.commit=E$,k.prototype.next=T$,k.prototype.plant=C$,k.prototype.reverse=I$,k.prototype.toJSON=k.prototype.valueOf=k.prototype.value=R$,k.prototype.first=k.prototype.head,Tm&&(k.prototype[Tm]=S$),k},Cr=K_();qi?((qi.exports=Cr)._=Cr,Xp._=Cr):li._=Cr}).call($a)})(Hq,Gx);var u3={};(function(n){n.aliasToReal={each:"forEach",eachRight:"forEachRight",entries:"toPairs",entriesIn:"toPairsIn",extend:"assignIn",extendAll:"assignInAll",extendAllWith:"assignInAllWith",extendWith:"assignInWith",first:"head",conforms:"conformsTo",matches:"isMatch",property:"get",__:"placeholder",F:"stubFalse",T:"stubTrue",all:"every",allPass:"overEvery",always:"constant",any:"some",anyPass:"overSome",apply:"spread",assoc:"set",assocPath:"set",complement:"negate",compose:"flowRight",contains:"includes",dissoc:"unset",dissocPath:"unset",dropLast:"dropRight",dropLastWhile:"dropRightWhile",equals:"isEqual",identical:"eq",indexBy:"keyBy",init:"initial",invertObj:"invert",juxt:"over",omitAll:"omit",nAry:"ary",path:"get",pathEq:"matchesProperty",pathOr:"getOr",paths:"at",pickAll:"pick",pipe:"flow",pluck:"map",prop:"get",propEq:"matchesProperty",propOr:"getOr",props:"at",symmetricDifference:"xor",symmetricDifferenceBy:"xorBy",symmetricDifferenceWith:"xorWith",takeLast:"takeRight",takeLastWhile:"takeRightWhile",unapply:"rest",unnest:"flatten",useWith:"overArgs",where:"conformsTo",whereEq:"isMatch",zipObj:"zipObject"},n.aryMethod={1:["assignAll","assignInAll","attempt","castArray","ceil","create","curry","curryRight","defaultsAll","defaultsDeepAll","floor","flow","flowRight","fromPairs","invert","iteratee","memoize","method","mergeAll","methodOf","mixin","nthArg","over","overEvery","overSome","rest","reverse","round","runInContext","spread","template","trim","trimEnd","trimStart","uniqueId","words","zipAll"],2:["add","after","ary","assign","assignAllWith","assignIn","assignInAllWith","at","before","bind","bindAll","bindKey","chunk","cloneDeepWith","cloneWith","concat","conformsTo","countBy","curryN","curryRightN","debounce","defaults","defaultsDeep","defaultTo","delay","difference","divide","drop","dropRight","dropRightWhile","dropWhile","endsWith","eq","every","filter","find","findIndex","findKey","findLast","findLastIndex","findLastKey","flatMap","flatMapDeep","flattenDepth","forEach","forEachRight","forIn","forInRight","forOwn","forOwnRight","get","groupBy","gt","gte","has","hasIn","includes","indexOf","intersection","invertBy","invoke","invokeMap","isEqual","isMatch","join","keyBy","lastIndexOf","lt","lte","map","mapKeys","mapValues","matchesProperty","maxBy","meanBy","merge","mergeAllWith","minBy","multiply","nth","omit","omitBy","overArgs","pad","padEnd","padStart","parseInt","partial","partialRight","partition","pick","pickBy","propertyOf","pull","pullAll","pullAt","random","range","rangeRight","rearg","reject","remove","repeat","restFrom","result","sampleSize","some","sortBy","sortedIndex","sortedIndexOf","sortedLastIndex","sortedLastIndexOf","sortedUniqBy","split","spreadFrom","startsWith","subtract","sumBy","take","takeRight","takeRightWhile","takeWhile","tap","throttle","thru","times","trimChars","trimCharsEnd","trimCharsStart","truncate","union","uniqBy","uniqWith","unset","unzipWith","without","wrap","xor","zip","zipObject","zipObjectDeep"],3:["assignInWith","assignWith","clamp","differenceBy","differenceWith","findFrom","findIndexFrom","findLastFrom","findLastIndexFrom","getOr","includesFrom","indexOfFrom","inRange","intersectionBy","intersectionWith","invokeArgs","invokeArgsMap","isEqualWith","isMatchWith","flatMapDepth","lastIndexOfFrom","mergeWith","orderBy","padChars","padCharsEnd","padCharsStart","pullAllBy","pullAllWith","rangeStep","rangeStepRight","reduce","reduceRight","replace","set","slice","sortedIndexBy","sortedLastIndexBy","transform","unionBy","unionWith","update","xorBy","xorWith","zipWith"],4:["fill","setWith","updateWith"]},n.aryRearg={2:[1,0],3:[2,0,1],4:[3,2,0,1]},n.iterateeAry={dropRightWhile:1,dropWhile:1,every:1,filter:1,find:1,findFrom:1,findIndex:1,findIndexFrom:1,findKey:1,findLast:1,findLastFrom:1,findLastIndex:1,findLastIndexFrom:1,findLastKey:1,flatMap:1,flatMapDeep:1,flatMapDepth:1,forEach:1,forEachRight:1,forIn:1,forInRight:1,forOwn:1,forOwnRight:1,map:1,mapKeys:1,mapValues:1,partition:1,reduce:2,reduceRight:2,reject:1,remove:1,some:1,takeRightWhile:1,takeWhile:1,times:1,transform:2},n.iterateeRearg={mapKeys:[1],reduceRight:[1,0]},n.methodRearg={assignInAllWith:[1,0],assignInWith:[1,2,0],assignAllWith:[1,0],assignWith:[1,2,0],differenceBy:[1,2,0],differenceWith:[1,2,0],getOr:[2,1,0],intersectionBy:[1,2,0],intersectionWith:[1,2,0],isEqualWith:[1,2,0],isMatchWith:[2,1,0],mergeAllWith:[1,0],mergeWith:[1,2,0],padChars:[2,1,0],padCharsEnd:[2,1,0],padCharsStart:[2,1,0],pullAllBy:[2,1,0],pullAllWith:[2,1,0],rangeStep:[1,2,0],rangeStepRight:[1,2,0],setWith:[3,1,2,0],sortedIndexBy:[2,1,0],sortedLastIndexBy:[2,1,0],unionBy:[1,2,0],unionWith:[1,2,0],updateWith:[3,1,2,0],xorBy:[1,2,0],xorWith:[1,2,0],zipWith:[1,2,0]},n.methodSpread={assignAll:{start:0},assignAllWith:{start:0},assignInAll:{start:0},assignInAllWith:{start:0},defaultsAll:{start:0},defaultsDeepAll:{start:0},invokeArgs:{start:2},invokeArgsMap:{start:2},mergeAll:{start:0},mergeAllWith:{start:0},partial:{start:1},partialRight:{start:1},without:{start:1},zipAll:{start:0}},n.mutate={array:{fill:!0,pull:!0,pullAll:!0,pullAllBy:!0,pullAllWith:!0,pullAt:!0,remove:!0,reverse:!0},object:{assign:!0,assignAll:!0,assignAllWith:!0,assignIn:!0,assignInAll:!0,assignInAllWith:!0,assignInWith:!0,assignWith:!0,defaults:!0,defaultsAll:!0,defaultsDeep:!0,defaultsDeepAll:!0,merge:!0,mergeAll:!0,mergeAllWith:!0,mergeWith:!0},set:{set:!0,setWith:!0,unset:!0,update:!0,updateWith:!0}},n.realToAlias=function(){var e=Object.prototype.hasOwnProperty,t=n.aliasToReal,i={};for(var r in t){var s=t[r];e.call(i,s)?i[s].push(r):i[s]=[r]}return i}(),n.remap={assignAll:"assign",assignAllWith:"assignWith",assignInAll:"assignIn",assignInAllWith:"assignInWith",curryN:"curry",curryRightN:"curryRight",defaultsAll:"defaults",defaultsDeepAll:"defaultsDeep",findFrom:"find",findIndexFrom:"findIndex",findLastFrom:"findLast",findLastIndexFrom:"findLastIndex",getOr:"get",includesFrom:"includes",indexOfFrom:"indexOf",invokeArgs:"invoke",invokeArgsMap:"invokeMap",lastIndexOfFrom:"lastIndexOf",mergeAll:"merge",mergeAllWith:"mergeWith",padChars:"pad",padCharsEnd:"padEnd",padCharsStart:"padStart",propertyOf:"get",rangeStep:"range",rangeStepRight:"rangeRight",restFrom:"rest",spreadFrom:"spread",trimChars:"trim",trimCharsEnd:"trimEnd",trimCharsStart:"trimStart",zipAll:"zip"},n.skipFixed={castArray:!0,flow:!0,flowRight:!0,iteratee:!0,mixin:!0,rearg:!0,runInContext:!0},n.skipRearg={add:!0,assign:!0,assignIn:!0,bind:!0,bindKey:!0,concat:!0,difference:!0,divide:!0,eq:!0,gt:!0,gte:!0,isEqual:!0,lt:!0,lte:!0,matchesProperty:!0,merge:!0,multiply:!0,overArgs:!0,partial:!0,partialRight:!0,propertyOf:!0,random:!0,range:!0,rangeRight:!0,subtract:!0,zip:!0,zipObject:!0,zipObjectDeep:!0}})(u3);var Xq={},Di=u3,qq=Xq,bM=Array.prototype.push;function Kq(n,e){return e==2?function(t,i){return n.apply(void 0,arguments)}:function(t){return n.apply(void 0,arguments)}}function NS(n,e){return e==2?function(t,i){return n(t,i)}:function(t){return n(t)}}function AM(n){for(var e=n?n.length:0,t=Array(e);e--;)t[e]=n[e];return t}function Yq(n){return function(e){return n({},e)}}function Zq(n,e){return function(){for(var t=arguments.length,i=t-1,r=Array(t);t--;)r[t]=arguments[t];var s=r[e],o=r.slice(0,e);return s&&bM.apply(o,s),e!=i&&bM.apply(o,r.slice(e+1)),n.apply(this,o)}}function zS(n,e){return function(){var t=arguments.length;if(t){for(var i=Array(t);t--;)i[t]=arguments[t];var r=i[0]=e.apply(void 0,i);return n.apply(void 0,i),r}}}function QI(n,e,t,i){var r=typeof e=="function",s=e===Object(e);if(s&&(i=t,t=e,e=void 0),t==null)throw new TypeError;i||(i={});var o={cap:"cap"in i?i.cap:!0,curry:"curry"in i?i.curry:!0,fixed:"fixed"in i?i.fixed:!0,immutable:"immutable"in i?i.immutable:!0,rearg:"rearg"in i?i.rearg:!0},a=r?t:qq,l="curry"in i&&i.curry,u="fixed"in i&&i.fixed,h="rearg"in i&&i.rearg,p=r?t.runInContext():void 0,m=r?t:{ary:n.ary,assign:n.assign,clone:n.clone,curry:n.curry,forEach:n.forEach,isArray:n.isArray,isError:n.isError,isFunction:n.isFunction,isWeakMap:n.isWeakMap,iteratee:n.iteratee,keys:n.keys,rearg:n.rearg,toInteger:n.toInteger,toPath:n.toPath},y=m.ary,x=m.assign,w=m.clone,R=m.curry,E=m.forEach,T=m.isArray,I=m.isError,A=m.isFunction,L=m.isWeakMap,F=m.keys,O=m.rearg,N=m.toInteger,B=m.toPath,V=F(Di.aryMethod),J={castArray:function(H){return function(){var te=arguments[0];return T(te)?H(AM(te)):H.apply(void 0,arguments)}},iteratee:function(H){return function(){var te=arguments[0],ue=arguments[1],K=H(te,ue),Te=K.length;return o.cap&&typeof ue=="number"?(ue=ue>2?ue-2:1,Te&&Te<=ue?K:NS(K,ue)):K}},mixin:function(H){return function(te){var ue=this;if(!A(ue))return H(ue,Object(te));var K=[];return E(F(te),function(Te){A(te[Te])&&K.push([Te,ue.prototype[Te]])}),H(ue,Object(te)),E(K,function(Te){var lt=Te[1];A(lt)?ue.prototype[Te[0]]=lt:delete ue.prototype[Te[0]]}),ue}},nthArg:function(H){return function(te){var ue=te<0?1:N(te)+1;return R(H(te),ue)}},rearg:function(H){return function(te,ue){var K=ue?ue.length:0;return R(H(te,ue),K)}},runInContext:function(H){return function(te){return QI(n,H(te),i)}}};function ge(H,te){if(o.cap){var ue=Di.iterateeRearg[H];if(ue)return ne(te,ue);var K=!r&&Di.iterateeAry[H];if(K)return pe(te,K)}return te}function he(H,te,ue){return l||o.curry&&ue>1?R(te,ue):te}function de(H,te,ue){if(o.fixed&&(u||!Di.skipFixed[H])){var K=Di.methodSpread[H],Te=K&&K.start;return Te===void 0?y(te,ue):Zq(te,Te)}return te}function oe(H,te,ue){return o.rearg&&ue>1&&(h||!Di.skipRearg[H])?O(te,Di.methodRearg[H]||Di.aryRearg[ue]):te}function _e(H,te){te=B(te);for(var ue=-1,K=te.length,Te=K-1,lt=w(Object(H)),It=lt;It!=null&&++ue<K;){var rt=te[ue],ut=It[rt];ut!=null&&!(A(ut)||I(ut)||L(ut))&&(It[rt]=w(ue==Te?ut:Object(ut))),It=It[rt]}return lt}function se(H){return ie.runInContext.convert(H)(void 0)}function Z(H,te){var ue=Di.aliasToReal[H]||H,K=Di.remap[ue]||ue,Te=i;return function(lt){var It=r?p:m,rt=r?p[K]:te,ut=x(x({},Te),lt);return QI(It,ue,rt,ut)}}function pe(H,te){return ee(H,function(ue){return typeof ue=="function"?NS(ue,te):ue})}function ne(H,te){return ee(H,function(ue){var K=te.length;return Kq(O(NS(ue,K),te),K)})}function ee(H,te){return function(){var ue=arguments.length;if(!ue)return H();for(var K=Array(ue);ue--;)K[ue]=arguments[ue];var Te=o.rearg?0:ue-1;return K[Te]=te(K[Te]),H.apply(void 0,K)}}function j(H,te,ue){var K,Te=Di.aliasToReal[H]||H,lt=te,It=J[Te];return It?lt=It(te):o.immutable&&(Di.mutate.array[Te]?lt=zS(te,AM):Di.mutate.object[Te]?lt=zS(te,Yq(te)):Di.mutate.set[Te]&&(lt=zS(te,_e))),E(V,function(rt){return E(Di.aryMethod[rt],function(ut){if(Te==ut){var ct=Di.methodSpread[Te],rr=ct&&ct.afterRearg;return K=rr?de(Te,oe(Te,lt,rt),rt):oe(Te,de(Te,lt,rt),rt),K=ge(Te,K),K=he(Te,K,rt),!1}}),!K}),K||(K=lt),K==te&&(K=l?R(K,1):function(){return te.apply(this,arguments)}),K.convert=Z(Te,te),K.placeholder=te.placeholder=ue,K}if(!s)return j(e,t,a);var ie=t,q=[];return E(V,function(H){E(Di.aryMethod[H],function(te){var ue=ie[Di.remap[te]||te];ue&&q.push([te,j(te,ue,ie)])})}),E(F(ie),function(H){var te=ie[H];if(typeof te=="function"){for(var ue=q.length;ue--;)if(q[ue][0]==H)return;te.convert=Z(H,te),q.push([H,te])}}),E(q,function(H){ie[H[0]]=H[1]}),ie.convert=se,ie.placeholder=ie,E(F(ie),function(H){E(Di.realToAlias[H]||[],function(te){ie[te]=ie[H]})}),ie}var Qq=QI,kM=Gx.runInContext(),Ae=Qq(kM,kM);const Jq={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class eK extends Error{constructor(e){const t=Jq[e];super(t),this.code=e,this.name="AssertionError",this.message=t}}const mA=eK;class tK{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}function nK(n){n.stopPropagation()}const Vi=tK,Wh={PROPERTYCHANGE:"propertychange"};class iK{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}const hp=iK;function rK(n,e,t){let i,r;t=t||Ac;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function Ac(n,e){return n>e?1:n<e?-1:0}function hE(n,e,t){const i=n.length;if(n[0]<=e)return 0;if(e<=n[i-1])return i-1;let r;if(t>0){for(r=1;r<i;++r)if(n[r]<e)return r-1}else if(t<0){for(r=1;r<i;++r)if(n[r]<=e)return r}else for(r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return typeof t=="function"?t(e,n[r-1],n[r])>0?r-1:r:n[r-1]-e<e-n[r]?r-1:r}return i-1}function sK(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function qs(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function cl(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function oK(n,e,t){const i=e||Ac;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||t&&o===0)})}function Fo(){return!0}function Cf(){return!1}function Hh(){}function aK(n){let e=!1,t,i,r;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==r||!cl(s,i))&&(e=!0,r=this,i=s,t=n.apply(this,arguments)),t}}function lK(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function If(n){for(const e in n)delete n[e]}function Xh(n){let e;for(e in n)return!1;return!e}class uK extends hp{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Vi(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let u=0,h=r.length;u<h;++u)if("handleEvent"in r[u]?l=r[u].handleEvent(s):l=r[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let u=a[i];for(delete a[i];u--;)this.removeEventListener(i,Hh);delete o[i]}return l}disposeInternal(){this.listeners_&&If(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){const i=this.listeners_&&this.listeners_[e];if(i){const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Hh,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}}const fp=uK,Re={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Ve(n,e,t,i,r){if(i&&i!==n&&(t=t.bind(i)),r){const o=t;t=function(){n.removeEventListener(e,t),o.apply(this,arguments)}}const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function jg(n,e,t,i){return Ve(n,e,t,i,!0)}function zt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),If(n))}class fE extends fp{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Re.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ve(this,e[s],t);return r}return Ve(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=jg(this,e[s],t)}else i=jg(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)cK(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}fE.prototype.on;fE.prototype.once;fE.prototype.un;function cK(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)zt(n[e]);else zt(n)}const yA=fE;function et(){throw new Error("Unimplemented abstract method.")}let hK=0;function be(n){return n.ol_uid||(n.ol_uid=String(++hK))}const fK="7.2.2";class PM extends Vi{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class dK extends yA{constructor(e){super(),this.on,this.once,this.un,be(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new PM(i,e,t)),i=Wh.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new PM(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],Xh(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const to=dK,Qn={ADD:"add",REMOVE:"remove"},LM={LENGTH:"length"};class a1 extends Vi{constructor(e,t,i){super(e),this.element=t,this.index=i}}class gK extends to{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(LM.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new a1(Qn.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new a1(Qn.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new a1(Qn.REMOVE,r,e)),this.dispatchEvent(new a1(Qn.ADD,t,e))}updateLength_(){this.set(LM.LENGTH,this.array_.length)}assertUnique_(e,t){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===e&&i!==t)throw new mA(58)}}const Ei=gK;function Ye(n,e){if(!n)throw new mA(e)}class _A extends to{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new _A(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(zt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Ve(e,Re.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?pK(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function pK(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Ye(typeof n.getZIndex=="function",41),e=[n]),function(){return e}}const pr=_A,kc=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",mK=kc.includes("firefox"),yK=kc.includes("safari")&&!kc.includes("chrom"),_K=yK&&(kc.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(kc)),vK=kc.includes("webkit")&&!kc.includes("edge"),xK=kc.includes("macintosh"),c3=typeof devicePixelRatio<"u"?devicePixelRatio:1,vA=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,wK=typeof Image<"u"&&Image.prototype.decode,h3=function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n}(),xA=new Array(6);function Hn(){return[1,0,0,1,0,0]}function pg(n){return W0(n,1,0,0,1,0,0)}function qh(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=n[4],a=n[5],l=e[0],u=e[1],h=e[2],p=e[3],m=e[4],y=e[5];return n[0]=t*l+r*u,n[1]=i*l+s*u,n[2]=t*h+r*p,n[3]=i*h+s*p,n[4]=t*m+r*y+o,n[5]=i*m+s*y+a,n}function W0(n,e,t,i,r,s,o){return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n[4]=s,n[5]=o,n}function EK(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Tn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function f3(n,e){const t=Math.cos(e),i=Math.sin(e);return qh(n,W0(xA,t,i,-i,t,0,0))}function mg(n,e,t){return qh(n,W0(xA,e,0,0,t,0,0))}function TK(n,e,t){return W0(n,e,0,0,t,0,0)}function jx(n,e,t){return qh(n,W0(xA,1,0,0,1,e,t))}function As(n,e,t,i,r,s,o,a){const l=Math.sin(s),u=Math.cos(s);return n[0]=i*u,n[1]=r*l,n[2]=-i*l,n[3]=r*u,n[4]=o*i*u-a*i*l+e,n[5]=o*r*l+a*r*u+t,n}function H0(n,e){const t=SK(e);Ye(t!==0,32);const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*l-o*a)/t,n[5]=-(i*l-r*a)/t,n}function SK(n){return n[0]*n[3]-n[1]*n[2]}let MM;function wA(n){const e="matrix("+n.join(", ")+")";if(vA)return e;const t=MM||(MM=document.createElement("div"));return t.style.transform=e,t.style.transform}const Yi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function _i(n){const e=xr();for(let t=0,i=n.length;t<i;++t)py(e,n[t]);return e}function CK(n,e,t){const i=Math.min.apply(null,n),r=Math.min.apply(null,e),s=Math.max.apply(null,n),o=Math.max.apply(null,e);return ma(i,r,s,o,t)}function Rs(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function d3(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Rf(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function la(n,e){return EA(n,e[0],e[1])}function zr(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function EA(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function JI(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let l=Yi.UNKNOWN;return o<t?l=l|Yi.LEFT:o>r&&(l=l|Yi.RIGHT),a<i?l=l|Yi.BELOW:a>s&&(l=l|Yi.ABOVE),l===Yi.UNKNOWN&&(l=Yi.INTERSECTING),l}function xr(){return[1/0,1/0,-1/0,-1/0]}function ma(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function X0(n){return ma(1/0,1/0,-1/0,-1/0,n)}function yg(n,e){const t=n[0],i=n[1];return ma(t,i,t,i,e)}function TA(n,e,t,i,r){const s=X0(r);return p3(s,n,e,t,i)}function Oo(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function IK(n,e,t){return Math.abs(n[0]-e[0])<t&&Math.abs(n[2]-e[2])<t&&Math.abs(n[1]-e[1])<t&&Math.abs(n[3]-e[3])<t}function g3(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function py(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function p3(n,e,t,i,r){for(;t<i;t+=r)RK(n,e[t],e[t+1]);return n}function RK(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function SA(n,e){let t;return t=e(dE(n)),t||(t=e(q0(n)),t)||(t=e(gE(n)),t)||(t=e(va(n)),t)?t:!1}function Bg(n){let e=0;return bf(n)||(e=gt(n)*rn(n)),e}function dE(n){return[n[0],n[1]]}function q0(n){return[n[2],n[1]]}function er(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function bK(n,e){let t;return e==="bottom-left"?t=dE(n):e==="bottom-right"?t=q0(n):e==="top-left"?t=va(n):e==="top-right"?t=gE(n):Ye(!1,13),t}function _g(n,e,t,i,r){const[s,o,a,l,u,h,p,m]=eR(n,e,t,i);return ma(Math.min(s,a,u,p),Math.min(o,l,h,m),Math.max(s,a,u,p),Math.max(o,l,h,m),r)}function eR(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),l=r*o,u=r*a,h=s*o,p=s*a,m=n[0],y=n[1];return[m-l+p,y-u-h,m-l-p,y-u+h,m+l-p,y+u+h,m+l+p,y+u-h,m-l+p,y-u-h]}function rn(n){return n[3]-n[1]}function tr(n,e,t){const i=t||xr();return un(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):X0(i),i}function va(n){return[n[0],n[3]]}function gE(n){return[n[2],n[3]]}function gt(n){return n[2]-n[0]}function un(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function bf(n){return n[2]<n[0]||n[3]<n[1]}function AK(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function pE(n,e){const t=(n[2]-n[0])/2*(e-1),i=(n[3]-n[1])/2*(e-1);n[0]-=t,n[2]+=t,n[1]-=i,n[3]+=i}function kK(n,e,t){let i=!1;const r=JI(n,e),s=JI(n,t);if(r===Yi.INTERSECTING||s===Yi.INTERSECTING)i=!0;else{const o=n[0],a=n[1],l=n[2],u=n[3],h=e[0],p=e[1],m=t[0],y=t[1],x=(y-p)/(m-h);let w,R;s&Yi.ABOVE&&!(r&Yi.ABOVE)&&(w=m-(y-u)/x,i=w>=o&&w<=l),!i&&s&Yi.RIGHT&&!(r&Yi.RIGHT)&&(R=y-(m-l)*x,i=R>=a&&R<=u),!i&&s&Yi.BELOW&&!(r&Yi.BELOW)&&(w=m-(y-a)/x,i=w>=o&&w<=l),!i&&s&Yi.LEFT&&!(r&Yi.LEFT)&&(R=y-(m-o)*x,i=R>=a&&R<=u)}return i}function Vg(n,e,t,i){let r=[];if(i>1){const a=n[2]-n[0],l=n[3]-n[1];for(let u=0;u<i;++u)r.push(n[0]+a*u/i,n[1],n[2],n[1]+l*u/i,n[2]-a*u/i,n[3],n[0],n[3]-l*u/i)}else r=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]];e(r,r,2);const s=[],o=[];for(let a=0,l=r.length;a<l;a+=2)s.push(r[a]),o.push(r[a+1]);return CK(s,o,t)}function CA(n,e){const t=e.getExtent(),i=er(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=gt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function PK(n,e){if(e.canWrapX()){const t=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[t[0],n[1],t[2],n[3]]];CA(n,e);const i=gt(t);if(gt(n)>i)return[[t[0],n[1],t[2],n[3]]];if(n[0]<t[0])return[[n[0]+i,n[1],t[2],n[3]],[t[0],n[1],n[2],n[3]]];if(n[2]>t[2])return[[n[0],n[1],t[2],n[3]],[t[0],n[1],n[2]-i,n[3]]]}return[n]}const LK={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function DM(n){return LK[n]}const Kh={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class MK{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Kh[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Ky=MK,K0=6378137,tg=Math.PI*K0,DK=[-tg,-tg,tg,tg],FK=[-180,-85,180,85],l1=K0*Math.log(Math.tan(Math.PI/2));class Rd extends Ky{constructor(e){super({code:e,units:"m",extent:DK,global:!0,worldExtent:FK,getPointResolution:function(t,i){return t/Math.cosh(i[1]/K0)}})}}const FM=[new Rd("EPSG:3857"),new Rd("EPSG:102100"),new Rd("EPSG:102113"),new Rd("EPSG:900913"),new Rd("http://www.opengis.net/def/crs/EPSG/0/3857"),new Rd("http://www.opengis.net/gml/srs/epsg.xml#3857")];function OK(n,e,t){const i=n.length;t=t>1?t:2,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let r=0;r<i;r+=t){e[r]=tg*n[r]/180;let s=K0*Math.log(Math.tan(Math.PI*(+n[r+1]+90)/360));s>l1?s=l1:s<-l1&&(s=-l1),e[r+1]=s}return e}function NK(n,e,t){const i=n.length;t=t>1?t:2,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let r=0;r<i;r+=t)e[r]=180*n[r]/tg,e[r+1]=360*Math.atan(Math.exp(n[r+1]/K0))/Math.PI-90;return e}const zK=6378137,OM=[-180,-90,180,90],UK=Math.PI*zK/180;class fh extends Ky{constructor(e,t){super({code:e,units:"degrees",extent:OM,axisOrientation:t,global:!0,metersPerUnit:UK,worldExtent:OM})}}const NM=[new fh("CRS:84"),new fh("EPSG:4326","neu"),new fh("urn:ogc:def:crs:OGC:1.3:CRS84"),new fh("urn:ogc:def:crs:OGC:2:84"),new fh("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new fh("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new fh("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let tR={};function GK(n){return tR[n]||tR[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function jK(n,e){tR[n]=e}let vg={};function Bx(n,e,t){const i=n.getCode(),r=e.getCode();i in vg||(vg[i]={}),vg[i][r]=t}function BK(n,e){let t;return n in vg&&e in vg[n]&&(t=vg[n][e]),t}function ot(n,e,t){return Math.min(Math.max(n,e),t)}function m3(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const l=((n-t)*o+(e-i)*a)/(o*o+a*a);l>1?(t=r,i=s):l>0&&(t+=o*l,i+=a*l)}return Wl(n,e,t,i)}function Wl(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function VK(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const l=Math.abs(n[a][i]);l>s&&(s=l,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const l=-n[a][i]/n[i][i];for(let u=i;u<e+1;u++)i==u?n[a][u]=0:n[a][u]+=l*n[i][u]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function zM(n){return n*180/Math.PI}function Fh(n){return n*Math.PI/180}function Qa(n,e){const t=n%e;return t*e<0?t+e:t}function Dl(n,e,t){return n+t*(e-n)}function Af(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function UM(n,e){return Math.round(Af(n,e))}function ng(n,e){return Math.floor(Af(n,e))}function rc(n,e){return Math.ceil(Af(n,e))}function GM(n,e,t){const i=t!==void 0?n.toFixed(t):""+n;let r=i.indexOf(".");return r=r===-1?i.length:r,r>e?i:new Array(1+e-r).join("0")+i}function y3(n,e){const t=(""+n).split("."),i=(""+e).split(".");for(let r=0;r<Math.max(t.length,i.length);r++){const s=parseInt(t[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function _3(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function $K(n,e){const t=e.getRadius(),i=e.getCenter(),r=i[0],s=i[1],o=n[0],a=n[1];let l=o-r;const u=a-s;l===0&&u===0&&(l=1);const h=Math.sqrt(l*l+u*u),p=r+t*l/h,m=s+t*u/h;return[p,m]}function mE(n,e){const t=n[0],i=n[1],r=e[0],s=e[1],o=r[0],a=r[1],l=s[0],u=s[1],h=l-o,p=u-a,m=h===0&&p===0?0:(h*(t-o)+p*(i-a))/(h*h+p*p||0);let y,x;return m<=0?(y=o,x=a):m>=1?(y=l,x=u):(y=o+m*h,x=a+m*p),[y,x]}function jM(n,e,t){const i=Qa(e+180,360)-180,r=Math.abs(3600*i),s=t||0;let o=Math.floor(r/3600),a=Math.floor((r-o*3600)/60),l=Af(r-o*3600-a*60,s);l>=60&&(l=0,a+=1),a>=60&&(a=0,o+=1);let u=o+"";return(a!==0||l!==0)&&(u+=" "+GM(a,2)+""),l!==0&&(u+=" "+GM(l,2,s)+""),i!==0&&(u+=" "+n.charAt(i<0?1:0)),u}function sa(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function IA(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function v3(n,e){return n[0]*=e,n[1]*=e,n}function fa(n,e){const t=n[0]-e[0],i=n[1]-e[1];return t*t+i*i}function Yy(n,e){return Math.sqrt(fa(n,e))}function nR(n,e){return fa(n,mE(n,e))}function yE(n,e){if(e.canWrapX()){const t=gt(e.getExtent()),i=WK(n,e,t);i&&(n[0]-=i*t)}return n}function WK(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||gt(i),r=Math.floor((n[0]-i[0])/t)),r}const x3=63710088e-1;function BM(n,e,t){t=t||x3;const i=Fh(n[1]),r=Fh(e[1]),s=(r-i)/2,o=Fh(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function HK(n,e,t,i){i=i||x3;const r=Fh(n[1]),s=Fh(n[0]),o=e/i,a=Math.asin(Math.sin(r)*Math.cos(o)+Math.cos(r)*Math.sin(o)*Math.cos(t)),l=s+Math.atan2(Math.sin(t)*Math.sin(o)*Math.cos(r),Math.cos(o)-Math.sin(r)*Math.sin(a));return[zM(l),zM(a)]}const RA={info:1,warn:2,error:3,none:4};let w3=RA.info;function E3(...n){w3>RA.warn||console.warn(...n)}function VM(...n){w3>RA.error||console.error(...n)}let iR=!0;function T3(n){iR=!(n===void 0?!0:n)}function bA(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function _E(n,e){if(e!==void 0&&n!==e){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];n=e}return n}function XK(n){jK(n.getCode(),n),Bx(n,n,bA)}function qK(n){n.forEach(XK)}function _t(n){return typeof n=="string"?GK(n):n||null}function Vx(n,e,t,i){n=_t(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/Kh[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=Uc(n,_t("EPSG:4326"));if(a===_E&&o!=="degrees")r=e*n.getMetersPerUnit();else{let u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=a(u,u,2);const h=BM(u.slice(0,2),u.slice(2,4)),p=BM(u.slice(4,6),u.slice(6,8));r=(h+p)/2}const l=i?Kh[i]:n.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function $M(n){qK(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Bx(e,t,bA)})})}function KK(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Bx(r,s,t),Bx(s,r,i)})})}function AA(n,e){if(n){if(typeof n=="string")return _t(n)}else return _t(e);return n}function WM(n,e){return T3(),vE(n,"EPSG:4326",e!==void 0?e:"EPSG:3857")}function rs(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||Uc(n,e)===bA)&&t}function Uc(n,e){const t=n.getCode(),i=e.getCode();let r=BK(t,i);return r||(r=_E),r}function eu(n,e){const t=_t(n),i=_t(e);return Uc(t,i)}function vE(n,e,t){return eu(e,t)(n,void 0,n.length)}function YK(n,e,t,i){const r=eu(e,t);return Vg(n,r,void 0,i)}let ZK=null;function QK(){return ZK}function Yh(n,e){return n}function Sn(n,e){return iR&&!sa(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(iR=!1,E3("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function dp(n,e){return n}function bo(n,e){return n}function JK(){$M(FM),$M(NM),KK(NM,FM,OK,NK)}JK();function _c(n,e,t,i,r,s){s=s||[];let o=0;for(let a=e;a<t;a+=i){const l=n[a],u=n[a+1];s[o++]=r[0]*l+r[2]*u+r[4],s[o++]=r[1]*l+r[3]*u+r[5]}return s&&s.length!=o&&(s.length=o),s}function kA(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),u=s[0],h=s[1];let p=0;for(let m=e;m<t;m+=i){const y=n[m]-u,x=n[m+1]-h;o[p++]=u+y*a-x*l,o[p++]=h+y*l+x*a;for(let w=m+2;w<m+i;++w)o[p++]=n[w]}return o&&o.length!=p&&(o.length=p),o}function eY(n,e,t,i,r,s,o,a){a=a||[];const l=o[0],u=o[1];let h=0;for(let p=e;p<t;p+=i){const m=n[p]-l,y=n[p+1]-u;a[h++]=l+r*m,a[h++]=u+s*y;for(let x=p+2;x<p+i;++x)a[h++]=n[x]}return a&&a.length!=h&&(a.length=h),a}function S3(n,e,t,i,r,s,o){o=o||[];let a=0;for(let l=e;l<t;l+=i){o[a++]=n[l]+r,o[a++]=n[l+1]+s;for(let u=l+2;u<l+i;++u)o[a++]=n[u]}return o&&o.length!=a&&(o.length=a),o}const HM=Hn();class tY extends to{constructor(){super(),this.extent_=xr(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=aK(function(e,t,i){if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return et()}closestPointXY(e,t,i,r){return et()}containsXY(e,t){const i=this.getClosestPoint([e,t]);return i[0]===e&&i[1]===t}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return et()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&X0(t),this.extentRevision_=this.getRevision()}return AK(this.extent_,e)}rotate(e,t){et()}scale(e,t,i){et()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return et()}getType(){return et()}applyTransform(e){et()}intersectsExtent(e){return et()}translate(e,t){et()}transform(e,t){const i=_t(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),u=i.getWorldExtent(),h=rn(u)/rn(l);return As(HM,u[0],u[3],h,-h,0,0,0),_c(s,0,s.length,a,HM,o),eu(i,t)(s,o,a)}:eu(i,t);return this.applyTransform(r),this}}const PA=tY;class nY extends PA{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(e){return TA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return et()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=$x(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){et()}setLayout(e,t,i){let r;if(e)r=$x(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=iY(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();kA(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=er(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();eY(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();S3(i,0,i.length,r,e,t,i),this.changed()}}}function iY(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function $x(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function rY(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return _c(i,0,i.length,r,e,t)}const uu=nY;function XM(n,e,t,i,r,s,o){const a=n[e],l=n[e+1],u=n[t]-a,h=n[t+1]-l;let p;if(u===0&&h===0)p=e;else{const m=((r-a)*u+(s-l)*h)/(u*u+h*h);if(m>1)p=t;else if(m>0){for(let y=0;y<i;++y)o[y]=Dl(n[e+y],n[t+y],m);o.length=i;return}else p=e}for(let m=0;m<i;++m)o[m]=n[p+m];o.length=i}function LA(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],l=n[e+1],u=Wl(s,o,a,l);u>r&&(r=u),s=a,o=l}return r}function MA(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=LA(n,e,a,i,r),e=a}return r}function sY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=MA(n,e,a,i,r),e=a[a.length-1]}return r}function DA(n,e,t,i,r,s,o,a,l,u,h){if(e==t)return u;let p,m;if(r===0){if(m=Wl(o,a,n[e],n[e+1]),m<u){for(p=0;p<i;++p)l[p]=n[e+p];return l.length=i,m}return u}h=h||[NaN,NaN];let y=e+i;for(;y<t;)if(XM(n,y-i,y,i,o,a,h),m=Wl(o,a,h[0],h[1]),m<u){for(u=m,p=0;p<i;++p)l[p]=h[p];l.length=i,y+=i}else y+=i*Math.max((Math.sqrt(m)-Math.sqrt(u))/r|0,1);if(s&&(XM(n,t-i,e,i,o,a,h),m=Wl(o,a,h[0],h[1]),m<u)){for(u=m,p=0;p<i;++p)l[p]=h[p];l.length=i}return u}function FA(n,e,t,i,r,s,o,a,l,u,h){h=h||[NaN,NaN];for(let p=0,m=t.length;p<m;++p){const y=t[p];u=DA(n,e,y,i,r,s,o,a,l,u,h),e=y}return u}function oY(n,e,t,i,r,s,o,a,l,u,h){h=h||[NaN,NaN];for(let p=0,m=t.length;p<m;++p){const y=t[p];u=FA(n,e,y,i,r,s,o,a,l,u,h),e=y[y.length-1]}return u}function C3(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function xE(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function OA(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=xE(n,e,t[o],i);r[s++]=l,e=l}return r.length=s,r}function aY(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=OA(n,e,t[o],i,r[s]);l.length===0&&(l[0]=e),r[s++]=l,e=l[l.length-1]}return r.length=s,r}function NA(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const u=[e,t-i];let h=0;for(;u.length>0;){const p=u.pop(),m=u.pop();let y=0;const x=n[m],w=n[m+1],R=n[p],E=n[p+1];for(let T=m+i;T<p;T+=i){const I=n[T],A=n[T+1],L=m3(I,A,x,w,R,E);L>y&&(h=T,y=L)}y>r&&(l[(h-e)/i]=1,m+i<h&&u.push(m,h),h+i<p&&u.push(h,p))}for(let p=0;p<a;++p)l[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function lY(n,e,t,i,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const h=t[l];o=NA(n,e,h,i,r,s,o),a.push(o),e=h}return o}function vh(n,e){return e*Math.round(n/e)}function uY(n,e,t,i,r,s,o){if(e==t)return o;let a=vh(n[e],r),l=vh(n[e+1],r);e+=i,s[o++]=a,s[o++]=l;let u,h;do if(u=vh(n[e],r),h=vh(n[e+1],r),e+=i,e==t)return s[o++]=u,s[o++]=h,o;while(u==a&&h==l);for(;e<t;){const p=vh(n[e],r),m=vh(n[e+1],r);if(e+=i,p==u&&m==h)continue;const y=u-a,x=h-l,w=p-a,R=m-l;if(y*R==x*w&&(y<0&&w<y||y==w||y>0&&w>y)&&(x<0&&R<x||x==R||x>0&&R>x)){u=p,h=m;continue}s[o++]=u,s[o++]=h,a=u,l=h,u=p,h=m}return s[o++]=u,s[o++]=h,o}function I3(n,e,t,i,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const h=t[l];o=uY(n,e,h,i,r,s,o),a.push(o),e=h}return o}function cY(n,e,t,i,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const h=t[l],p=[];o=I3(n,e,h,i,r,s,o,p),a.push(p),e=h[h.length-1]}return o}function sc(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Zy(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=sc(n,e,l,i,r[s]),e=l}return r.length=s,r}function rR(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=l.length===1&&l[0]===e?[]:Zy(n,e,l,i,r[s]),e=l[l.length-1]}return r.length=s,r}function R3(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],l=n[e+1];r+=o*a-s*l,s=a,o=l}return r/2}function b3(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=R3(n,e,a,i),e=a}return r}function hY(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=b3(n,e,a,i),e=a[a.length-1]}return r}class Wx extends uu{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Wx(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Rf(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(LA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),DA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return R3(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=NA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Wx(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xE(this.flatCoordinates,0,e,this.stride),this.changed()}}const sR=Wx;class zA extends uu{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new zA(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Wl(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(e){return yg(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return EA(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=C3(this.flatCoordinates,0,e,this.stride),this.changed()}}const bs=zA;function fY(n,e,t,i,r){return!SA(r,function(o){return!Ch(n,e,t,i,o[0],o[1])})}function Ch(n,e,t,i,r,s){let o=0,a=n[t-i],l=n[t-i+1];for(;e<t;e+=i){const u=n[e],h=n[e+1];l<=s?h>s&&(u-a)*(s-l)-(r-a)*(h-l)>0&&o++:h<=s&&(u-a)*(s-l)-(r-a)*(h-l)<0&&o--,a=u,l=h}return o!==0}function UA(n,e,t,i,r,s){if(t.length===0||!Ch(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(Ch(n,t[o-1],t[o],i,r,s))return!1;return!0}function dY(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const l=t[o];if(UA(n,e,l,i,r,s))return!0;e=l[l.length-1]}return!1}function GA(n,e,t,i,r,s,o){let a,l,u,h,p,m,y;const x=r[s+1],w=[];for(let T=0,I=t.length;T<I;++T){const A=t[T];for(h=n[A-i],m=n[A-i+1],a=e;a<A;a+=i)p=n[a],y=n[a+1],(x<=m&&y<=x||m<=x&&x<=y)&&(u=(x-m)/(y-m)*(p-h)+h,w.push(u)),h=p,m=y}let R=NaN,E=-1/0;for(w.sort(Ac),h=w[0],a=1,l=w.length;a<l;++a){p=w[a];const T=Math.abs(p-h);T>E&&(u=(h+p)/2,UA(n,e,t,i,u,x)&&(R=u,E=T)),h=p}return isNaN(R)&&(R=r[s]),o?(o.push(R,x,E),o):[R,x,E]}function A3(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const l=t[o];s=GA(n,e,l,i,r,2*o,s),e=l[l.length-1]}return s}function k3(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function wE(n,e,t,i,r){const s=p3(xr(),n,e,t,i);return un(r,s)?zr(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:k3(n,e,t,i,function(o,a){return kK(r,o,a)}):!1}function gY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(wE(n,e,t[s],i,r))return!0;e=t[s]}return!1}function P3(n,e,t,i,r){return!!(wE(n,e,t,i,r)||Ch(n,e,t,i,r[0],r[1])||Ch(n,e,t,i,r[0],r[3])||Ch(n,e,t,i,r[2],r[1])||Ch(n,e,t,i,r[2],r[3]))}function L3(n,e,t,i,r){if(!P3(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(fY(n,t[s-1],t[s],i,r)&&!wE(n,t[s-1],t[s],i,r))return!1;return!0}function pY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(L3(n,e,a,i,r))return!0;e=a[a.length-1]}return!1}function mY(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function jA(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],l=n[e+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function M3(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=jA(n,e,a,i);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=a}return!0}function yY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!M3(n,e,a,i,r))return!1;a.length&&(e=a[a.length-1])}return!0}function oR(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=jA(n,e,a,i);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&mY(n,e,a,i),e=a}return e}function qM(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=oR(n,e,t[s],i,r);return e}function _Y(n,e){const t=[];let i=0,r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!jA(n,i,a,2))t.push(e.slice(r,s+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=s+1,i=a}return t}class Zh extends uu{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?qs(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Zh(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Rf(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(MA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),FA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return UA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return b3(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),oR(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Zy(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=er(this.getExtent());this.flatInteriorPoint_=GA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new bs(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new sR(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],u=new sR(t.slice(s,l),e);r.push(u),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;M3(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=oR(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=I3(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Zh(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return L3(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=OA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}const Pc=Zh;function vY(n,e,t,i){t=t||32;const r=[];for(let s=0;s<t;++s)qs(r,HK(n,e,2*Math.PI*s/t,i));return r.push(r[0],r[1]),new Zh(r,"XY",[r.length])}function $g(n){const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Zh(s,"XY",[s.length])}function xY(n,e,t){e=e||32;const i=n.getStride(),r=n.getLayout(),s=n.getCenter(),o=i*(e+1),a=new Array(o);for(let h=0;h<o;h+=i){a[h]=0,a[h+1]=0;for(let p=2;p<i;p++)a[h+p]=s[p]}const l=[a.length],u=new Zh(a,r,l);return wY(u,s,n.getRadius(),t),u}function wY(n,e,t,i){const r=n.getFlatCoordinates(),s=n.getStride(),o=r.length/s-1,a=i||0;for(let l=0;l<=o;++l){const u=l*s,h=a+Qa(l,o)*2*Math.PI/o;r[u]=e[0]+t*Math.cos(h),r[u+1]=e[1]+t*Math.sin(h)}n.changed()}const Vn={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},EY={ERROR:"error"};class TY extends Vi{constructor(e){super(EY.ERROR),this.code=e.code,this.message=e.message}}class SY extends to{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=_E,this.watchId_=void 0,this.addChangeListener(Vn.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(Vn.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=Uc(_t("EPSG:4326"),e),this.position_&&this.set(Vn.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(Vn.ACCURACY,t.accuracy),this.set(Vn.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(Vn.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(Vn.HEADING,t.heading===null?void 0:Fh(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const i=this.transform_(this.position_);this.set(Vn.POSITION,i.slice()),this.set(Vn.SPEED,t.speed===null?void 0:t.speed);const r=vY(this.position_,t.accuracy);r.applyTransform(this.transform_),this.set(Vn.ACCURACY_GEOMETRY,r),this.changed()}positionError_(e){this.dispatchEvent(new TY(e))}getAccuracy(){return this.get(Vn.ACCURACY)}getAccuracyGeometry(){return this.get(Vn.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(Vn.ALTITUDE)}getAltitudeAccuracy(){return this.get(Vn.ALTITUDE_ACCURACY)}getHeading(){return this.get(Vn.HEADING)}getPosition(){return this.get(Vn.POSITION)}getProjection(){return this.get(Vn.PROJECTION)}getSpeed(){return this.get(Vn.SPEED)}getTracking(){return this.get(Vn.TRACKING)}getTrackingOptions(){return this.get(Vn.TRACKING_OPTIONS)}setProjection(e){this.set(Vn.PROJECTION,_t(e))}setTracking(e){this.set(Vn.TRACKING,e)}setTrackingOptions(e){this.set(Vn.TRACKING_OPTIONS,e)}}const CY=SY,is={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class BA{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null}clone(){const e=this.getColor();return new BA({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){this.color_=e}}const Ws=BA;function Hx(n,e,t,i,r,s,o){let a,l;const u=(t-e)/i;if(u===1)a=e;else if(u===2)a=e,l=r;else if(u!==0){let h=n[e],p=n[e+1],m=0;const y=[0];for(let R=e+i;R<t;R+=i){const E=n[R],T=n[R+1];m+=Math.sqrt((E-h)*(E-h)+(T-p)*(T-p)),y.push(m),h=E,p=T}const x=r*m,w=rK(y,x);w<0?(l=(x-y[-w-2])/(y[-w-1]-y[-w-2]),a=e+(-w-2)*i):a=e+w*i}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?n[a+h]:Dl(n[a+h],n[a+i+h],l);return s}function aR(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,l=t/i;for(;a<l;){const m=a+l>>1;r<n[(m+1)*i-1]?l=m:a=m+1}const u=n[a*i-1];if(r==u)return n.slice((a-1)*i,(a-1)*i+i);const h=n[(a+1)*i-1],p=(r-u)/(h-u);o=[];for(let m=0;m<i-1;++m)o.push(Dl(n[(a-1)*i+m],n[a*i+m],p));return o.push(r),o}function IY(n,e,t,i,r,s,o){if(o)return aR(n,e,t[t.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let l=0,u=t.length;l<u;++l){const h=t[l];if(e!=h){if(r<n[e+i-1])return null;if(r<=n[h-1])return aR(n,e,h,i,r,!1);e=h}}return null}function D3(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const l=n[a],u=n[a+1];o+=Math.sqrt((l-r)*(l-r)+(u-s)*(u-s)),r=l,s=u}return o}class Xx extends uu{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){this.flatCoordinates?qs(this.flatCoordinates,e):this.flatCoordinates=e.slice(),this.changed()}clone(){const e=new Xx(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Rf(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(LA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),DA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return k3(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,aR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return Hx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return D3(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=NA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Xx(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return wE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xE(this.flatCoordinates,0,e,this.stride),this.changed()}}const da=Xx;class VA{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new VA({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}const Ts=VA,st={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function KM(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]+2*e,t[1]=n[1]+2*e,t}function YM(n){return n[0]>0&&n[1]>0}function $A(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function dn(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class WA{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=dn(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new WA({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return et()}getImage(e){return et()}getHitDetectionImage(){return et()}getPixelRatio(e){return 1}getImageState(){return et()}getImageSize(){return et()}getOrigin(){return et()}getSize(){return et()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=dn(e)}listenImageChange(e){et()}load(){et()}unlistenImageChange(e){et()}}const HA=WA,F3=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,O3=/^([a-z]*)$|^hsla?\(.*\)$/i;function N3(n){return typeof n=="string"?n:G3(n)}function z3(n){const e=document.createElement("div");if(e.style.color=n,e.style.color!==""){document.body.appendChild(e);const t=getComputedStyle(e).color;return document.body.removeChild(e),t}return""}const U3=function(){const e={};let t=0;return function(i){let r;if(e.hasOwnProperty(i))r=e[i];else{if(t>=1024){let s=0;for(const o in e)s++&3||(delete e[o],--t)}r=RY(i),e[i]=r,++t}return r}}();function Qy(n){return Array.isArray(n)?n:U3(n)}function RY(n){let e,t,i,r,s;if(O3.exec(n)&&(n=z3(n)),F3.exec(n)){const o=n.length-1;let a;o<=4?a=1:a=2;const l=o===4||o===8;e=parseInt(n.substr(1+0*a,a),16),t=parseInt(n.substr(1+1*a,a),16),i=parseInt(n.substr(1+2*a,a),16),l?r=parseInt(n.substr(1+3*a,a),16):r=255,a==1&&(e=(e<<4)+e,t=(t<<4)+t,i=(i<<4)+i,l&&(r=(r<<4)+r)),s=[e,t,i,r/255]}else n.startsWith("rgba(")?(s=n.slice(5,-1).split(",").map(Number),ZM(s)):n.startsWith("rgb(")?(s=n.slice(4,-1).split(",").map(Number),s.push(1),ZM(s)):Ye(!1,14);return s}function ZM(n){return n[0]=ot(n[0]+.5|0,0,255),n[1]=ot(n[1]+.5|0,0,255),n[2]=ot(n[2]+.5|0,0,255),n[3]=ot(n[3],0,1),n}function G3(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*100)/100;return"rgba("+e+","+t+","+i+","+r+")"}function bY(n){return O3.test(n)&&(n=z3(n)),F3.test(n)||n.startsWith("rgba(")||n.startsWith("rgb(")}function Ka(n){return Array.isArray(n)?G3(n):n}function mn(n,e,t,i){let r;return t&&t.length?r=t.shift():vA?r=new OffscreenCanvas(n||300,e||300):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}function Qh(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function AY(n){let e=n.offsetWidth;const t=getComputedStyle(n);return e+=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10),e}function kY(n){let e=n.offsetHeight;const t=getComputedStyle(n);return e+=parseInt(t.marginTop,10)+parseInt(t.marginBottom,10),e}function Wg(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function qx(n){return n&&n.parentNode?n.parentNode.removeChild(n):null}function j3(n){for(;n.lastChild;)n.removeChild(n.lastChild)}function PY(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}const u1="ol-hidden",LY="ol-selectable",rl="ol-unselectable",QM="ol-unsupported",kf="ol-control",Kx="ol-collapsed",MY=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),JM=["style","variant","weight","size","lineHeight","family"],B3=function(n){const e=n.match(MY);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,r=JM.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[JM[i]]=s)}return t.families=t.family.split(/,\s?/),t},V3="10px sans-serif",Hl="#000",Yx="round",Jy=[],e0=0,Hg="round",t0=10,n0="#000",i0="center",Zx="middle",Ih=[0,0,0,0],r0=1,Ba=new to;let Od=null,lR;const uR={},$3=function(){const e="32px ",t=["monospace","serif"],i=t.length,r="wmytzilWMYTZIL@#/&?$%10";let s,o;function a(u,h,p){let m=!0;for(let y=0;y<i;++y){const x=t[y];if(o=Qx(u+" "+h+" "+e+x,r),p!=x){const w=Qx(u+" "+h+" "+e+p+","+x,r);m=m&&w!=o}}return!!m}function l(){let u=!0;const h=Ba.getKeys();for(let p=0,m=h.length;p<m;++p){const y=h[p];Ba.get(y)<100&&(a.apply(this,y.split(`
`))?(If(uR),Od=null,lR=void 0,Ba.set(y,100)):(Ba.set(y,Ba.get(y)+1,!0),u=!1))}u&&(clearInterval(s),s=void 0)}return function(u){const h=B3(u);if(!h)return;const p=h.families;for(let m=0,y=p.length;m<y;++m){const x=p[m],w=h.style+`
`+h.weight+`
`+x;Ba.get(w)===void 0&&(Ba.set(w,100,!0),a(h.style,h.weight,x)||(Ba.set(w,0,!0),s===void 0&&(s=setInterval(l,32))))}}}(),DY=function(){let n;return function(e){let t=uR[e];if(t==null){if(vA){const i=B3(e),r=W3(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);uR[e]=t}return t}}();function W3(n,e){return Od||(Od=mn(1,1)),n!=lR&&(Od.font=n,lR=Od.font),Od.measureText(e)}function Qx(n,e){return W3(n,e).width}function eD(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Qx(n,s)),0);return t[e]=i,i}function FY(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const p=e[u];if(p===`
`||u===h){s=Math.max(s,o),r.push(o),o=0,a+=l;continue}const m=e[u+1]||n.font,y=Qx(m,p);t.push(y),o+=y;const x=DY(m);i.push(x),l=Math.max(l,x)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function OY(n,e,t,i,r,s,o,a,l,u,h){n.save(),t!==1&&(n.globalAlpha*=t),e&&n.setTransform.apply(n,e),i.contextInstructions?(n.translate(l,u),n.scale(h[0],h[1]),NY(i,n)):h[0]<0||h[1]<0?(n.translate(l,u),n.scale(h[0],h[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,l,u,o*h[0],a*h[1]),n.restore()}function NY(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class XA extends HA{constructor(e){const t=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:1,rotateWithView:t,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=e.radius!==void 0?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const e=this.getScale(),t=new XA({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_;if(!e)return null;const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(e){let t=this.canvas_[e];if(!t){const i=this.renderOptions_,r=mn(i.size*e,i.size*e);this.draw_(i,r,e),t=r.canvas,this.canvas_[e]=t}return t}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return st.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius_,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const F=r;r=s,s=F}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),u=Math.sqrt(s*s-l*l),h=r-u,p=Math.sqrt(l*l+h*h),m=p/l;if(e==="miter"&&m<=i)return m*t;const y=t/2/m,x=t/2*(h/p),R=Math.sqrt((r+y)*(r+y)+x*x)-r;if(this.radius2_===void 0||e==="bevel")return R*2;const E=r*Math.sin(a),T=Math.sqrt(r*r-E*E),I=s-T,L=Math.sqrt(E*E+I*I)/E;if(L<=i){const F=L*t/2-s-r;return 2*Math.max(R,F)}return R*2}createRenderOptions(){let e=Hg,t=0,i=null,r=0,s,o=0;this.stroke_&&(s=this.stroke_.getColor(),s===null&&(s=n0),s=Ka(s),o=this.stroke_.getWidth(),o===void 0&&(o=r0),i=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),e=this.stroke_.getLineJoin(),e===void 0&&(e=Hg),t=this.stroke_.getMiterLimit(),t===void 0&&(t=t0));const a=this.calculateLineJoinSize_(e,o,t),l=Math.max(this.radius_,this.radius2_||0),u=Math.ceil(2*l+a);return{strokeStyle:s,strokeWidth:o,size:u,lineDash:i,lineDashOffset:r,lineJoin:e,miterLimit:t}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.canvas_={},this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=Hl),t.fillStyle=Ka(r),t.fill()}this.stroke_&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){if(this.fill_){let t=this.fill_.getColor(),i=0;if(typeof t=="string"&&(t=Qy(t)),t===null?i=1:Array.isArray(t)&&(i=t.length===4?t[3]:1),i===0){const r=mn(e.size,e.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(e,r)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(e){let t=this.points_;const i=this.radius_;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const l=s+a*o,u=a%2===0?i:r;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Hl,t.fill(),this.stroke_&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}}const qA=XA;class KA extends qA{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new KA({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius_=e,this.render()}}const gp=KA;class oc{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=tD,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new oc({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=tD,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function zY(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Ye(typeof n.getZIndex=="function",41),t=[n]),e=function(){return t}}return e}let US=null;function UY(n,e){if(!US){const t=new Ws({color:"rgba(255,255,255,0.4)"}),i=new Ts({color:"#3399CC",width:1.25});US=[new oc({image:new gp({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return US}function Y0(){const n={},e=[255,255,255,1],t=[0,153,255,1],i=3;return n.Polygon=[new oc({fill:new Ws({color:[255,255,255,.5]})})],n.MultiPolygon=n.Polygon,n.LineString=[new oc({stroke:new Ts({color:e,width:i+2})}),new oc({stroke:new Ts({color:t,width:i})})],n.MultiLineString=n.LineString,n.Circle=n.Polygon.concat(n.LineString),n.Point=[new oc({image:new gp({radius:i*2,fill:new Ws({color:t}),stroke:new Ts({color:e,width:i/2})}),zIndex:1/0})],n.MultiPoint=n.Point,n.GeometryCollection=n.Polygon.concat(n.LineString,n.Point),n}function tD(n){return n.getGeometry()}const ws=oc,GY="#333";class YA{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=dn(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ws({color:GY}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding}clone(){const e=this.getScale();return new YA({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRotateWithView(e){this.rotateWithView_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=dn(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const s0=YA,Zt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class jY extends to{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Zt.OPACITY]=e.opacity!==void 0?e.opacity:1,Ye(typeof t[Zt.OPACITY]=="number",64),t[Zt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Zt.Z_INDEX]=e.zIndex,t[Zt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Zt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Zt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Zt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=ot(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return et()}getLayerStatesArray(e){return et()}getExtent(){return this.get(Zt.EXTENT)}getMaxResolution(){return this.get(Zt.MAX_RESOLUTION)}getMinResolution(){return this.get(Zt.MIN_RESOLUTION)}getMinZoom(){return this.get(Zt.MIN_ZOOM)}getMaxZoom(){return this.get(Zt.MAX_ZOOM)}getOpacity(){return this.get(Zt.OPACITY)}getSourceState(){return et()}getVisible(){return this.get(Zt.VISIBLE)}getZIndex(){return this.get(Zt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Zt.EXTENT,e)}setMaxResolution(e){this.set(Zt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Zt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Zt.MAX_ZOOM,e)}setMinZoom(e){this.set(Zt.MIN_ZOOM,e)}setOpacity(e){Ye(typeof e=="number",64),this.set(Zt.OPACITY,e)}setVisible(e){this.set(Zt.VISIBLE,e)}setZIndex(e){this.set(Zt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const H3=jY;class BY extends H3{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Zt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Zt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(zt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Ve(e,Re.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}render(e,t){const i=this.getRenderer();if(i.prepareFrame(e))return this.rendered=!0,i.renderFrame(e,t)}unrender(){this.rendered=!1}setMapInternal(e){e||this.unrender(),this.set(Zt.MAP,e)}getMapInternal(){return this.get(Zt.MAP)}setMap(e){this.mapPrecomposeKey_&&(zt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(zt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Ve(e,is.PRECOMPOSE,function(t){const r=t.frameState.layerStatesArray,s=this.getLayerState(!1);Ye(!r.some(function(o){return o.layer===s.layer}),67),r.push(s)},this),this.mapRenderKey_=Ve(this,Re.CHANGE,e.render,e),this.changed())}setSource(e){this.set(Zt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function ZA(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const cu=BY;function VY(n,e,t,i,r){X3(n,e,t||0,i||n.length-1,r||$Y)}function X3(n,e,t,i,r){for(;i>t;){if(i-t>600){var s=i-t+1,o=e-t+1,a=Math.log(s),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1),h=Math.max(t,Math.floor(e-o*l/s+u)),p=Math.min(i,Math.floor(e+(s-o)*l/s+u));X3(n,e,h,p,r)}var m=n[e],y=t,x=i;for(zm(n,t,e),r(n[i],m)>0&&zm(n,t,i);y<x;){for(zm(n,y,x),y++,x--;r(n[y],m)<0;)y++;for(;r(n[x],m)>0;)x--}r(n[t],m)===0?zm(n,t,x):(x++,zm(n,x,i)),x<=e&&(t=x+1),e<=x&&(i=x-1)}}function zm(n,e,t){var i=n[e];n[e]=n[t],n[t]=i}function $Y(n,e){return n<e?-1:n>e?1:0}let QA=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!h1(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],l=t.leaf?r(a):a;h1(e,l)&&(t.leaf?i.push(a):jS(e,l)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!h1(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(h1(e,o)){if(t.leaf||jS(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Nd([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,l,u;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),u=!0),i.leaf){const h=WY(e,i.children,t);if(h!==-1)return i.children.splice(h,1),s.push(i),this._condense(s),this}!u&&!i.leaf&&jS(i,r)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],u=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=Nd(e.slice(t,i+1)),bd(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Nd([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),u=l*Math.ceil(Math.sqrt(o));nD(e,t,i,u,this.compareMinX);for(let h=t;h<=i;h+=u){const p=Math.min(h+u-1,i);nD(e,h,p,l,this.compareMinY);for(let m=h;m<=p;m+=l){const y=Math.min(m+l-1,p);a.children.push(this._build(e,m,y,r-1))}}return bd(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<t.children.length;l++){const u=t.children[l],h=GS(u),p=qY(e,u)-h;p<o?(o=p,s=h<s?h:s,a=u):p===o&&h<s&&(s=h,a=u)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Jm(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Nd(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,bd(i,this.toBBox),bd(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=Nd([e,t]),this.data.height=e.height+1,this.data.leaf=!1,bd(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const l=Qm(e,0,a,this.toBBox),u=Qm(e,a,i,this.toBBox),h=KY(l,u),p=GS(l)+GS(u);h<s?(s=h,r=a,o=p<o?p:o):h===s&&p<o&&(o=p,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:HY,s=e.leaf?this.compareMinY:XY,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Qm(e,0,t,s),a=Qm(e,i-t,i,s);let l=c1(o)+c1(a);for(let u=t;u<i-t;u++){const h=e.children[u];Jm(o,e.leaf?s(h):h),l+=c1(o)}for(let u=i-t-1;u>=t;u--){const h=e.children[u];Jm(a,e.leaf?s(h):h),l+=c1(a)}return l}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Jm(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():bd(e[t],this.toBBox)}};function WY(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function bd(n,e){Qm(n,0,n.children.length,e,n)}function Qm(n,e,t,i,r){r||(r=Nd(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Jm(r,n.leaf?i(o):o)}return r}function Jm(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function HY(n,e){return n.minX-e.minX}function XY(n,e){return n.minY-e.minY}function GS(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function c1(n){return n.maxX-n.minX+(n.maxY-n.minY)}function qY(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function KY(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function jS(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function h1(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Nd(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function nD(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;VY(n,o,e,t,r),s.push(e,o,o,t)}}class YY{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];!(e++&3)&&!i.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}}get(e,t,i){const r=iD(e,t,i);return r in this.cache_?this.cache_[r]:null}set(e,t,i,r){const s=iD(e,t,i);this.cache_[s]=r,++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function iD(n,e,t){const i=t?N3(t):"null";return e+":"+n+":"+i}const Jx=new YY;class ZY extends fp{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=r}changed(){this.dispatchEvent(Re.CHANGE)}getExtent(){return this.extent}getImage(){return et()}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){et()}}const EE=ZY;class QY extends EE{constructor(e,t,i,r,s,o){super(e,t,i,st.IDLE),this.src_=r,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.state=st.IDLE,this.imageLoadFunction_=o}getImage(){return this.image_}handleImageError_(){this.state=st.ERROR,this.unlistenImage_(),this.changed()}handleImageLoad_(){this.resolution===void 0&&(this.resolution=rn(this.extent)/this.image_.height),this.state=st.LOADED,this.unlistenImage_(),this.changed()}load(){(this.state==st.IDLE||this.state==st.ERROR)&&(this.state=st.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=JA(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}setImage(e){this.image_=e,this.resolution=rn(this.extent)/this.image_.height}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function JA(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[jg(i,Re.LOAD,function(){o=!0,s||e()})];return i.src&&wK?(s=!0,i.decode().then(function(){r&&e()}).catch(function(l){r&&(o?e():t())})):a.push(jg(i,Re.ERROR,t)),function(){r=!1,a.forEach(zt)}}const Z0=QY;let Um=null;class q3 extends fp{constructor(e,t,i,r,s,o){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=o,this.unlisten_=null,this.imageState_=s,this.size_=i,this.src_=t,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===st.LOADED){Um||(Um=mn(1,1,void 0,{willReadFrequently:!0})),Um.drawImage(this.image_,0,0);try{Um.getImageData(0,0,1,1),this.tainted_=!1}catch{Um=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Re.CHANGE)}handleImageError_(){this.imageState_=st.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=st.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=mn(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===st.IDLE){this.image_||this.initializeImage_(),this.imageState_=st.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=JA(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==st.LOADED)return;const t=this.image_,i=document.createElement("canvas");i.width=Math.ceil(t.width*e),i.height=Math.ceil(t.height*e);const r=i.getContext("2d");r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=N3(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function JY(n,e,t,i,r,s){let o=Jx.get(e,i,s);return o||(o=new q3(n,e,t,i,r,s),Jx.set(e,i,s,o)),o}const e7=q3;class ek extends HA{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;this.imgSize_=e.imgSize;let a=e.src;Ye(!(a!==void 0&&o),4),Ye(!o||o&&this.imgSize_,5),(a===void 0||a.length===0)&&o&&(a=o.src||be(o)),Ye(a!==void 0&&a.length>0,6),Ye(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),69);const l=e.src!==void 0?st.IDLE:st.LOADED;if(this.color_=e.color!==void 0?Qy(e.color):null,this.iconImage_=JY(o,a,this.imgSize_!==void 0?this.imgSize_:null,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.width_=e.width,this.height_=e.height,this.width_!==void 0||this.height_!==void 0){const u=this.getImage(1),h=()=>{this.updateScaleFromWidthAndHeight(this.width_,this.height_)};u.width>0?this.updateScaleFromWidthAndHeight(this.width_,this.height_):u.addEventListener("load",h)}}clone(){const e=this.getScale();return new ek({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(e)?e.slice():e,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode(),width:this.width_,height:this.height_})}updateScaleFromWidthAndHeight(e,t){const i=this.getImage(1);e!==void 0&&t!==void 0?super.setScale([e/i.width,t/i.height]):e!==void 0?super.setScale([e/i.width,e/i.width]):t!==void 0?super.setScale([t/i.height,t/i.height]):super.setScale([1,1])}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){return this.width_}getHeight(){return this.height_}setWidth(e){this.width_=e,this.updateScaleFromWidthAndHeight(e,this.height_)}setHeight(e){this.height_=e,this.updateScaleFromWidthAndHeight(this.width_,e)}setScale(e){super.setScale(e);const t=this.getImage(1);if(t){const i=Array.isArray(e)?e[0]:e;i!==void 0&&(this.width_=i*t.width);const r=Array.isArray(e)?e[1]:e;r!==void 0&&(this.height_=r*t.height)}}listenImageChange(e){this.iconImage_.addEventListener(Re.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Re.CHANGE,e)}}const xg=ek;function rD(n){return new ws({fill:o0(n,""),stroke:a0(n,""),text:t7(n),image:n7(n)})}function o0(n,e){const t=n[e+"fill-color"];if(t)return new Ws({color:t})}function a0(n,e){const t=n[e+"stroke-width"],i=n[e+"stroke-color"];if(!(!t&&!i))return new Ts({width:t,color:i,lineCap:n[e+"stroke-line-cap"],lineJoin:n[e+"stroke-line-join"],lineDash:n[e+"stroke-line-dash"],lineDashOffset:n[e+"stroke-line-dash-offset"],miterLimit:n[e+"stroke-miter-limit"]})}function t7(n){const e=n["text-value"];return e?new s0({text:e,font:n["text-font"],maxAngle:n["text-max-angle"],offsetX:n["text-offset-x"],offsetY:n["text-offset-y"],overflow:n["text-overflow"],placement:n["text-placement"],scale:n["text-scale"],rotateWithView:n["text-rotate-with-view"],rotation:n["text-rotation"],textAlign:n["text-align"],justify:n["text-justify"],textBaseline:n["text-baseline"],padding:n["text-padding"],fill:o0(n,"text-"),backgroundFill:o0(n,"text-background-"),stroke:a0(n,"text-"),backgroundStroke:a0(n,"text-background-")}):void 0}function n7(n){const e=n["icon-src"],t=n["icon-img"];if(e||t)return new xg({src:e,img:t,imgSize:n["icon-img-size"],anchor:n["icon-anchor"],anchorOrigin:n["icon-anchor-origin"],anchorXUnits:n["icon-anchor-x-units"],anchorYUnits:n["icon-anchor-y-units"],color:n["icon-color"],crossOrigin:n["icon-cross-origin"],offset:n["icon-offset"],displacement:n["icon-displacement"],opacity:n["icon-opacity"],scale:n["icon-scale"],rotation:n["icon-rotation"],rotateWithView:n["icon-rotate-with-view"],size:n["icon-size"],declutterMode:n["icon-declutter-mode"]});const i=n["shape-points"];if(i){const s="shape-";return new qA({points:i,fill:o0(n,s),stroke:a0(n,s),radius:n["shape-radius"],radius1:n["shape-radius1"],radius2:n["shape-radius2"],angle:n["shape-angle"],displacement:n["shape-displacement"],rotation:n["shape-rotation"],rotateWithView:n["shape-rotate-with-view"],scale:n["shape-scale"],declutterMode:n["shape-declutter-mode"]})}const r=n["circle-radius"];if(r){const s="circle-";return new gp({radius:r,fill:o0(n,s),stroke:a0(n,s),displacement:n["circle-displacement"],scale:n["circle-scale"],rotation:n["circle-rotation"],rotateWithView:n["circle-rotate-with-view"],declutterMode:n["circle-declutter-mode"]})}}const sD={RENDER_ORDER:"renderOrder"};class i7 extends cu{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter!==void 0?e.declutter:!1,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(sD.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e){e.declutterTree||(e.declutterTree=new QA(9)),this.getRenderer().renderDeclutter(e)}setRenderOrder(e){this.set(sD.RENDER_ORDER,e)}setStyle(e){let t;if(e===void 0)t=UY;else if(e===null)t=null;else if(typeof e=="function")t=e;else if(e instanceof ws)t=e;else if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s){const o=e[s];o instanceof ws?r[s]=o:r[s]=rD(o)}t=r}else t=rD(e);this.style_=t,this.styleFunction_=e===null?void 0:zY(this.style_),this.changed()}}const Q0=i7,J0={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},f1=[J0.FILL],ac=[J0.STROKE],Rh=[J0.BEGIN_PATH],oD=[J0.CLOSE_PATH],it=J0;class r7{drawCustom(e,t,i,r){}drawGeometry(e){}setStyle(e){}drawCircle(e,t){}drawFeature(e,t){}drawGeometryCollection(e,t){}drawLineString(e,t){}drawMultiLineString(e,t){}drawMultiPoint(e,t){}drawMultiPolygon(e,t){}drawPoint(e,t){}drawPolygon(e,t){}drawText(e,t){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const K3=r7;class s7 extends K3{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=t)r[0]=e[a],r[1]=e[a+1],la(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let l=a.length;const u=this.getBufferedMaxExtent();o&&(t+=r);let h=e[t],p=e[t+1];const m=this.tmpCoordinate_;let y=!0,x,w,R;for(x=t+r;x<i;x+=r)m[0]=e[x],m[1]=e[x+1],R=JI(u,m),R!==w?(y&&(a[l++]=h,a[l++]=p,y=!1),a[l++]=m[0],a[l++]=m[1]):R===Yi.INTERSECTING?(a[l++]=m[0],a[l++]=m[1],y=!1):y=!0,h=m[0],p=m[1],w=R;return(s&&y||x===t+r)&&(a[l++]=h,a[l++]=p),l}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],u=this.appendFlatLineCoordinates(e,t,l,r,!1,!1);s.push(u),t=l}return t}drawCustom(e,t,i,r){this.beginGeometry(e,t);const s=e.getType(),o=e.getStride(),a=this.coordinates.length;let l,u,h,p,m;switch(s){case"MultiPolygon":l=e.getOrientedFlatCoordinates(),p=[];const y=e.getEndss();m=0;for(let x=0,w=y.length;x<w;++x){const R=[];m=this.drawCustomCoordinates_(l,m,y[x],o,R),p.push(R)}this.instructions.push([it.CUSTOM,a,p,e,i,rR]),this.hitDetectionInstructions.push([it.CUSTOM,a,p,e,r||i,rR]);break;case"Polygon":case"MultiLineString":h=[],l=s=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),m=this.drawCustomCoordinates_(l,0,e.getEnds(),o,h),this.instructions.push([it.CUSTOM,a,h,e,i,Zy]),this.hitDetectionInstructions.push([it.CUSTOM,a,h,e,r||i,Zy]);break;case"LineString":case"Circle":l=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([it.CUSTOM,a,u,e,i,sc]),this.hitDetectionInstructions.push([it.CUSTOM,a,u,e,r||i,sc]);break;case"MultiPoint":l=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(l,o),u>a&&(this.instructions.push([it.CUSTOM,a,u,e,i,sc]),this.hitDetectionInstructions.push([it.CUSTOM,a,u,e,r||i,sc]));break;case"Point":l=e.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),u=this.coordinates.length,this.instructions.push([it.CUSTOM,a,u,e,i]),this.hitDetectionInstructions.push([it.CUSTOM,a,u,e,r||i]);break}this.endGeometry(t)}beginGeometry(e,t){this.beginGeometryInstruction1_=[it.BEGIN_GEOMETRY,t,0,e],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[it.BEGIN_GEOMETRY,t,0,e],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==it.END_GEOMETRY?o=t:s==it.BEGIN_GEOMETRY&&(r[2]=t,sK(this.hitDetectionInstructions,o,t),o=-1)}setFillStrokeStyle(e,t){const i=this.state;if(e){const r=e.getColor();i.fillStyle=Ka(r||Hl)}else i.fillStyle=void 0;if(t){const r=t.getColor();i.strokeStyle=Ka(r||n0);const s=t.getLineCap();i.lineCap=s!==void 0?s:Yx;const o=t.getLineDash();i.lineDash=o?o.slice():Jy;const a=t.getLineDashOffset();i.lineDashOffset=a||e0;const l=t.getLineJoin();i.lineJoin=l!==void 0?l:Hg;const u=t.getWidth();i.lineWidth=u!==void 0?u:r0;const h=t.getMiterLimit();i.miterLimit=h!==void 0?h:t0,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(e){const t=e.fillStyle,i=[it.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(!0),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[it.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,this.applyPixelRatio(e.lineDash),e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!cl(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(i!==void 0&&t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[it.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=d3(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Rs(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const e_=s7;class o7 extends e_{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t){if(!this.image_)return;this.beginGeometry(e,t);const i=e.getFlatCoordinates(),r=e.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(i,r);this.instructions.push([it.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([it.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t){if(!this.image_)return;this.beginGeometry(e,t);const i=e.getFlatCoordinates(),r=e.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(i,r);this.instructions.push([it.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([it.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const a7=o7;class l7 extends e_{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[it.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t){const i=this.state,r=i.strokeStyle,s=i.lineWidth;if(r===void 0||s===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t),this.hitDetectionInstructions.push([it.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Jy,e0],Rh);const o=e.getFlatCoordinates(),a=e.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(ac),this.endGeometry(t)}drawMultiLineString(e,t){const i=this.state,r=i.strokeStyle,s=i.lineWidth;if(r===void 0||s===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t),this.hitDetectionInstructions.push([it.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Rh);const o=e.getEnds(),a=e.getFlatCoordinates(),l=e.getStride();let u=0;for(let h=0,p=o.length;h<p;++h)u=this.drawFlatCoordinates_(a,u,o[h],l);this.hitDetectionInstructions.push(ac),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(ac),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(ac),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Rh)}}const u7=l7;class c7 extends e_{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(Rh),this.hitDetectionInstructions.push(Rh);for(let u=0;u<l;++u){const h=i[u],p=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,h,r,!0,!a),y=[it.MOVE_TO_LINE_TO,p,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),a&&(this.instructions.push(oD),this.hitDetectionInstructions.push(oD)),t=h}return o&&(this.instructions.push(f1),this.hitDetectionInstructions.push(f1)),a&&(this.instructions.push(ac),this.hitDetectionInstructions.push(ac)),t}drawCircle(e,t){const i=this.state,r=i.fillStyle,s=i.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([it.SET_FILL_STYLE,Hl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([it.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=e.getFlatCoordinates(),a=e.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const u=[it.CIRCLE,l];this.instructions.push(Rh,u),this.hitDetectionInstructions.push(Rh,u),i.fillStyle!==void 0&&(this.instructions.push(f1),this.hitDetectionInstructions.push(f1)),i.strokeStyle!==void 0&&(this.instructions.push(ac),this.hitDetectionInstructions.push(ac)),this.endGeometry(t)}drawPolygon(e,t){const i=this.state,r=i.fillStyle,s=i.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([it.SET_FILL_STYLE,Hl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([it.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=e.getEnds(),a=e.getOrientedFlatCoordinates(),l=e.getStride();this.drawFlatCoordinatess_(a,0,o,l),this.endGeometry(t)}drawMultiPolygon(e,t){const i=this.state,r=i.fillStyle,s=i.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([it.SET_FILL_STYLE,Hl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([it.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=e.getEndss(),a=e.getOrientedFlatCoordinates(),l=e.getStride();let u=0;for(let h=0,p=o.length;h<p;++h)u=this.drawFlatCoordinatess_(a,u,o[h],l);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=vh(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;e.fillStyle!==void 0&&this.updateFillStyle(e,this.createFill),e.strokeStyle!==void 0&&this.updateStrokeStyle(e,this.applyStroke)}}const aD=c7;function h7(n,e,t,i,r){let s=t,o=t,a=0,l=0,u=t,h,p,m,y,x,w,R,E,T,I;for(p=t;p<i;p+=r){const A=e[p],L=e[p+1];x!==void 0&&(T=A-x,I=L-w,y=Math.sqrt(T*T+I*I),R!==void 0&&(l+=m,h=Math.acos((R*T+E*I)/(m*y)),h>n&&(l>a&&(a=l,s=u,o=p),l=0,u=p-r)),m=y,R=T,E=I),x=A,w=L}return l+=y,l>a?[u,p]:[s,o]}const my={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class f7 extends e_{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t){const i=this.textFillState_,r=this.textStrokeState_,s=this.textState_;if(this.text_===""||!s||!i&&!r)return;const o=this.coordinates;let a=o.length;const l=e.getType();let u=null,h=e.getStride();if(s.placement==="line"&&(l=="LineString"||l=="MultiLineString"||l=="Polygon"||l=="MultiPolygon")){if(!un(this.getBufferedMaxExtent(),e.getExtent()))return;let p;if(u=e.getFlatCoordinates(),l=="LineString")p=[u.length];else if(l=="MultiLineString")p=e.getEnds();else if(l=="Polygon")p=e.getEnds().slice(0,1);else if(l=="MultiPolygon"){const w=e.getEndss();p=[];for(let R=0,E=w.length;R<E;++R)p.push(w[R][0])}this.beginGeometry(e,t);const m=s.textAlign;let y=0,x;for(let w=0,R=p.length;w<R;++w){if(m==null){const T=h7(s.maxAngle,u,y,p[w],h);y=T[0],x=T[1]}else x=p[w];for(let T=y;T<x;T+=h)o.push(u[T],u[T+1]);const E=o.length;y=p[w],this.drawChars_(a,E),a=E}this.endGeometry(t)}else{let p=s.overflow?null:[];switch(l){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),h=2;break;case"Polygon":u=e.getFlatInteriorPoint(),s.overflow||p.push(u[2]/this.resolution),h=3;break;case"MultiPolygon":const R=e.getFlatInteriorPoints();u=[];for(let E=0,T=R.length;E<T;E+=3)s.overflow||p.push(R[E+2]/this.resolution),u.push(R[E],R[E+1]);if(u.length===0)return;h=2;break}const m=this.appendFlatPointCoordinates(u,h);if(m===a)return;if(p&&(m-a)/2!==u.length/h){let R=a/2;p=p.filter((E,T)=>{const I=o[(R+T)*2]===u[T*h]&&o[(R+T)*2+1]===u[T*h+1];return I||--R,I})}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(e,t);let y=s.padding;if(y!=Ih&&(s.scale[0]<0||s.scale[1]<0)){let R=s.padding[0],E=s.padding[1],T=s.padding[2],I=s.padding[3];s.scale[0]<0&&(E=-E,I=-I),s.scale[1]<0&&(R=-R,T=-T),y=[R,E,T,I]}const x=this.pixelRatio;this.instructions.push([it.DRAW_IMAGE,a,m,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,y==Ih?Ih:y.map(function(R){return R*x}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,p]);const w=1/x;this.hitDetectionInstructions.push([it.DRAW_IMAGE,a,m,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[w,w],NaN,void 0,this.declutterImageWithText_,y,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,p]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||i0,justify:t.justify,textBaseline:t.textBaseline||Zx,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=my[r.textBaseline],h=this.textOffsetY_*l,p=this.text_,m=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([it.DRAW_CHARS,e,t,u,r.overflow,a,r.maxAngle,l,h,s,m*l,p,o,1]),this.hitDetectionInstructions.push([it.DRAW_CHARS,e,t,u,r.overflow,a,r.maxAngle,1,h,s,m,p,o,1/l])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Ka(o.getColor()||Hl)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=a.getLineDash(),w=a.getLineDashOffset(),R=a.getWidth(),E=a.getMiterLimit();s.lineCap=a.getLineCap()||Yx,s.lineDash=x?x.slice():Jy,s.lineDashOffset=w===void 0?e0:w,s.lineJoin=a.getLineJoin()||Hg,s.lineWidth=R===void 0?r0:R,s.miterLimit=E===void 0?t0:E,s.strokeStyle=Ka(a.getColor()||n0)}i=this.textState_;const l=e.getFont()||V3;$3(l);const u=e.getScaleArray();i.overflow=e.getOverflow(),i.font=l,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Zx,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Ih,i.scale=u===void 0?[1,1]:u;const h=e.getOffsetX(),p=e.getOffsetY(),m=e.getRotateWithView(),y=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=m===void 0?!1:m,this.textRotation_=y===void 0?0:y,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:be(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r?typeof r.fillStyle=="string"?r.fillStyle:"|"+be(r.fillStyle):""}this.declutterImageWithText_=t}}const d7={Circle:aD,Default:e_,Image:a7,LineString:u7,Polygon:aD,Text:f7};class g7{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=d7[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}const ew=g7;class p7 extends yA{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.declutterExecutorGroup=null}getFeatures(e){return et()}getData(e){return null}prepareFrame(e){return et()}renderFrame(e,t){return et()}loadedTileCallback(e,t,i){e[t]||(e[t]={}),e[t][i.tileCoord.toString()]=i}createLoadedTileFinder(e,t,i){return(r,s)=>{const o=this.loadedTileCallback.bind(this,i,r);return e.forEachLoadedTile(t,r,s,o)}}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){e.target.getState()===st.LOADED&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=st.LOADED&&t!=st.ERROR&&e.addEventListener(Re.CHANGE,this.boundHandleImageChange_),t==st.IDLE&&(e.load(),t=e.getState()),t==st.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}const Y3=p7;class m7 extends Vi{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const yy=m7,lD=[];let zd=null;function y7(){zd=mn(1,1,void 0,{willReadFrequently:!0})}class _7 extends Y3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Hn(),this.pixelTransform=Hn(),this.inversePixelTransform=Hn(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(e,t,i){zd||y7(),zd.clearRect(0,0,1,1);let r;try{zd.drawImage(e,t,i,1,1,0,0,1,1),r=zd.getImageData(0,0,1,1).data}catch{return zd=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&cl(Qy(e.style.backgroundColor),Qy(i)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=mn();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=va(i),s=gE(i),o=q0(i),a=dE(i);Tn(t.coordinateToPixelTransform,r),Tn(t.coordinateToPixelTransform,s),Tn(t.coordinateToPixelTransform,o),Tn(t.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Tn(l,r),Tn(l,s),Tn(l,o),Tn(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new yy(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,this.dispatchRenderEvent_(is.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(is.POSTRENDER,e,t)}getRenderTransform(e,t,i,r,s,o,a){const l=s/2,u=o/2,h=r/t,p=-h,m=-e[0]+a,y=-e[1];return As(this.tempTransform,l,u,h,p,-i,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const tk=_7;function v7(n,e,t,i,r,s,o,a,l,u,h,p){let m=n[e],y=n[e+1],x=0,w=0,R=0,E=0;function T(){x=m,w=y,e+=i,m=n[e],y=n[e+1],E+=R,R=Math.sqrt((m-x)*(m-x)+(y-w)*(y-w))}do T();while(e<t-i&&E+R<s);let I=R===0?0:(s-E)/R;const A=Dl(x,m,I),L=Dl(w,y,I),F=e-i,O=E,N=s+a*l(u,r,h);for(;e<t-i&&E+R<N;)T();I=R===0?0:(N-E)/R;const B=Dl(x,m,I),V=Dl(w,y,I);let J;if(p){const _e=[A,L,B,V];kA(_e,0,4,2,p,_e,_e),J=_e[0]>_e[2]}else J=A>B;const ge=Math.PI,he=[],de=F+i===e;e=F,R=0,E=O,m=n[e],y=n[e+1];let oe;if(de){T(),oe=Math.atan2(y-w,m-x),J&&(oe+=oe>0?-ge:ge);const _e=(B+A)/2,se=(V+L)/2;return he[0]=[_e,se,(N-s)/2,oe,r],he}r=r.replace(/\n/g," ");for(let _e=0,se=r.length;_e<se;){T();let Z=Math.atan2(y-w,m-x);if(J&&(Z+=Z>0?-ge:ge),oe!==void 0){let q=Z-oe;if(q+=q>ge?-2*ge:q<-ge?2*ge:0,Math.abs(q)>o)return null}oe=Z;const pe=_e;let ne=0;for(;_e<se;++_e){const q=J?se-_e-1:_e,H=a*l(u,r[q],h);if(e+i<t&&E+R<s+ne+H/2)break;ne+=H}if(_e===pe)continue;const ee=J?r.substring(se-pe,se-_e):r.substring(pe,_e);I=R===0?0:(s+ne/2-E)/R;const j=Dl(x,m,I),ie=Dl(w,y,I);he.push([j,ie,ne/2,Z,ee]),s+=ne}return he}const Ad=xr(),Gu=[],Al=[],kl=[],ju=[];function uD(n){return n[3].declutterBox}const x7=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function cD(n,e){return(e==="start"||e==="end")&&!x7.test(n)&&(e=e==="start"?"left":"right"),my[e]}function w7(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}class E7{constructor(e,t,i,r){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Hn(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[t],u=this.pixelRatio,h=[l.scale[0]*u,l.scale[1]*u],p=Array.isArray(e),m=l.justify?my[l.justify]:cD(Array.isArray(e)?e[0]:e,l.textAlign||i0),y=r&&o.lineWidth?o.lineWidth:0,x=p?e:e.split(`
`).reduce(w7,[]),{width:w,height:R,widths:E,heights:T,lineWidths:I}=FY(l,x),A=w+y,L=[],F=(A+2)*h[0],O=(R+y)*h[1],N={width:F<0?Math.floor(F):Math.ceil(F),height:O<0?Math.floor(O):Math.ceil(O),contextInstructions:L};(h[0]!=1||h[1]!=1)&&L.push("scale",h),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",y),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",a.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const B=.5-m;let V=m*A+B*y;const J=[],ge=[];let he=0,de=0,oe=0,_e=0,se;for(let Z=0,pe=x.length;Z<pe;Z+=2){const ne=x[Z];if(ne===`
`){de+=he,he=0,V=m*A+B*y,++_e;continue}const ee=x[Z+1]||l.font;ee!==se&&(r&&J.push("font",ee),i&&ge.push("font",ee),se=ee),he=Math.max(he,T[oe]);const j=[ne,V+B*E[oe]+m*(E[oe]-I[_e]),.5*(y+he)+de];V+=E[oe],r&&J.push("strokeText",j),i&&ge.push("fillText",j),++oe}return Array.prototype.push.apply(L,J),Array.prototype.push.apply(L,ge),this.labels_[s]=N,N}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignFill_=o[2],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,l,u,h,p,m,y,x,w,R){a*=m[0],l*=m[1];let E=i-a,T=r-l;const I=s+u>e?e-u:s,A=o+h>t?t-h:o,L=x[3]+I*m[0]+x[1],F=x[0]+A*m[1]+x[2],O=E-x[3],N=T-x[0];(w||p!==0)&&(Gu[0]=O,ju[0]=O,Gu[1]=N,Al[1]=N,Al[0]=O+L,kl[0]=Al[0],kl[1]=N+F,ju[1]=kl[1]);let B;return p!==0?(B=As(Hn(),i,r,1,1,p,-i,-r),Tn(B,Gu),Tn(B,Al),Tn(B,kl),Tn(B,ju),ma(Math.min(Gu[0],Al[0],kl[0],ju[0]),Math.min(Gu[1],Al[1],kl[1],ju[1]),Math.max(Gu[0],Al[0],kl[0],ju[0]),Math.max(Gu[1],Al[1],kl[1],ju[1]),Ad)):ma(Math.min(O,O+L),Math.min(N,N+F),Math.max(O,O+L),Math.max(N,N+F),Ad),y&&(E=Math.round(E),T=Math.round(T)),{drawImageX:E,drawImageY:T,drawImageW:I,drawImageH:A,originX:u,originY:h,declutterBox:{minX:Ad[0],minY:Ad[1],maxX:Ad[2],maxY:Ad[3],value:R},canvasTransform:B,scale:m}}replayImageOrLabel_(e,t,i,r,s,o,a){const l=!!(o||a),u=r.declutterBox,h=e.canvas,p=a?a[2]*r.scale[0]/2:0;return u.minX-p<=h.width/t&&u.maxX+p>=0&&u.minY-p<=h.height/t&&u.maxY+p>=0&&(l&&this.replayTextBackground_(e,Gu,Al,kl,ju,o,a),OY(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){if(this.alignFill_){const t=Tn(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(t[0]%i,t[1]%i),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],l=this.pixelRatio,u=cD(Array.isArray(e)?e[0]:e,s.textAlign||i0),h=my[s.textBaseline||Zx],p=a&&a.lineWidth?a.lineWidth:0,m=o.width/l-2*s.scale[0],y=u*m+2*(.5-u)*p,x=h*o.height/l+2*(.5-h)*p;return{label:o,anchorX:y,anchorY:x}}execute_(e,t,i,r,s,o,a,l){let u;this.pixelCoordinates_&&cl(i,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=_c(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),EK(this.renderedTransform_,i));let h=0;const p=r.length;let m=0,y,x,w,R,E,T,I,A,L,F,O,N,B=0,V=0,J=null,ge=null;const he=this.coordinateCache_,de=this.viewRotation_,oe=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,_e={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:de},se=this.instructions!=r||this.overlaps?0:200;let Z,pe,ne,ee;for(;h<p;){const j=r[h];switch(j[0]){case it.BEGIN_GEOMETRY:Z=j[1],ee=j[3],Z.getGeometry()?a!==void 0&&!un(a,ee.getExtent())?h=j[2]+1:++h:h=j[2];break;case it.BEGIN_PATH:B>se&&(this.fill_(e),B=0),V>se&&(e.stroke(),V=0),!B&&!V&&(e.beginPath(),R=NaN,E=NaN),++h;break;case it.CIRCLE:m=j[1];const q=u[m],H=u[m+1],te=u[m+2],ue=u[m+3],K=te-q,Te=ue-H,lt=Math.sqrt(K*K+Te*Te);e.moveTo(q+lt,H),e.arc(q,H,lt,0,2*Math.PI,!0),++h;break;case it.CLOSE_PATH:e.closePath(),++h;break;case it.CUSTOM:m=j[1],y=j[2];const It=j[3],rt=j[4],ut=j.length==6?j[5]:void 0;_e.geometry=It,_e.feature=Z,h in he||(he[h]=[]);const ct=he[h];ut?ut(u,m,y,2,ct):(ct[0]=u[m],ct[1]=u[m+1],ct.length=2),rt(ct,_e),++h;break;case it.DRAW_IMAGE:m=j[1],y=j[2],A=j[3],x=j[4],w=j[5];let rr=j[6];const Mn=j[7],$i=j[8],Ie=j[9],U=j[10];let Wr=j[11];const ks=j[12];let ei=j[13];const Wt=j[14],yn=j[15];if(!A&&j.length>=20){L=j[19],F=j[20],O=j[21],N=j[22];const _n=this.drawLabelWithPointPlacement_(L,F,O,N);A=_n.label,j[3]=A;const ro=j[23];x=(_n.anchorX-ro)*this.pixelRatio,j[4]=x;const ri=j[24];w=(_n.anchorY-ri)*this.pixelRatio,j[5]=w,rr=A.height,j[6]=rr,ei=A.width,j[13]=ei}let Wi;j.length>25&&(Wi=j[25]);let cs,Hi,Rn;j.length>17?(cs=j[16],Hi=j[17],Rn=j[18]):(cs=Ih,Hi=!1,Rn=!1),U&&oe?Wr+=de:!U&&!oe&&(Wr-=de);let Ft=0;for(;m<y;m+=2){if(Wi&&Wi[Ft++]<ei/this.pixelRatio)continue;const _n=this.calculateImageOrLabelDimensions_(A.width,A.height,u[m],u[m+1],ei,rr,x,w,$i,Ie,Wr,ks,s,cs,Hi||Rn,Z),ro=[e,t,A,_n,Mn,Hi?J:null,Rn?ge:null];if(l){if(Wt==="none")continue;if(Wt==="obstacle"){l.insert(_n.declutterBox);continue}else{let ri,Ti;if(yn){const Fn=y-m;if(!yn[Fn]){yn[Fn]=ro;continue}if(ri=yn[Fn],delete yn[Fn],Ti=uD(ri),l.collides(Ti))continue}if(l.collides(_n.declutterBox))continue;ri&&(l.insert(Ti),this.replayImageOrLabel_.apply(this,ri)),l.insert(_n.declutterBox)}}this.replayImageOrLabel_.apply(this,ro)}++h;break;case it.DRAW_CHARS:const sr=j[1],Xt=j[2],cn=j[3],ti=j[4];N=j[5];const or=j[6],no=j[7],Dn=j[8];O=j[9];const ar=j[10];L=j[11],F=j[12];const bn=[j[13],j[13]],lr=this.textStates[F],ni=lr.font,ii=[lr.scale[0]*no,lr.scale[1]*no];let Ps;ni in this.widths_?Ps=this.widths_[ni]:(Ps={},this.widths_[ni]=Ps);const zo=D3(u,sr,Xt,2),io=Math.abs(ii[0])*eD(ni,L,Ps);if(ti||io<=zo){const _n=this.textStates[F].textAlign,ro=(zo-io)*my[_n],ri=v7(u,sr,Xt,2,L,ro,or,Math.abs(ii[0]),eD,ni,Ps,oe?0:this.viewRotation_);e:if(ri){const Ti=[];let Fn,On,Rt,bt,sn;if(O)for(Fn=0,On=ri.length;Fn<On;++Fn){sn=ri[Fn],Rt=sn[4],bt=this.createLabel(Rt,F,"",O),x=sn[2]+(ii[0]<0?-ar:ar),w=cn*bt.height+(.5-cn)*2*ar*ii[1]/ii[0]-Dn;const Pt=this.calculateImageOrLabelDimensions_(bt.width,bt.height,sn[0],sn[1],bt.width,bt.height,x,w,0,0,sn[3],bn,!1,Ih,!1,Z);if(l&&l.collides(Pt.declutterBox))break e;Ti.push([e,t,bt,Pt,1,null,null])}if(N)for(Fn=0,On=ri.length;Fn<On;++Fn){sn=ri[Fn],Rt=sn[4],bt=this.createLabel(Rt,F,N,""),x=sn[2],w=cn*bt.height-Dn;const Pt=this.calculateImageOrLabelDimensions_(bt.width,bt.height,sn[0],sn[1],bt.width,bt.height,x,w,0,0,sn[3],bn,!1,Ih,!1,Z);if(l&&l.collides(Pt.declutterBox))break e;Ti.push([e,t,bt,Pt,1,null,null])}l&&l.load(Ti.map(uD));for(let Pt=0,si=Ti.length;Pt<si;++Pt)this.replayImageOrLabel_.apply(this,Ti[Pt])}}++h;break;case it.END_GEOMETRY:if(o!==void 0){Z=j[1];const _n=o(Z,ee);if(_n)return _n}++h;break;case it.FILL:se?B++:this.fill_(e),++h;break;case it.MOVE_TO_LINE_TO:for(m=j[1],y=j[2],pe=u[m],ne=u[m+1],T=pe+.5|0,I=ne+.5|0,(T!==R||I!==E)&&(e.moveTo(pe,ne),R=T,E=I),m+=2;m<y;m+=2)pe=u[m],ne=u[m+1],T=pe+.5|0,I=ne+.5|0,(m==y-2||T!==R||I!==E)&&(e.lineTo(pe,ne),R=T,E=I);++h;break;case it.SET_FILL_STYLE:J=j,this.alignFill_=j[2],B&&(this.fill_(e),B=0,V&&(e.stroke(),V=0)),e.fillStyle=j[1],++h;break;case it.SET_STROKE_STYLE:ge=j,V&&(e.stroke(),V=0),this.setStrokeStyle_(e,j),++h;break;case it.STROKE:se?V++:e.stroke(),++h;break;default:++h;break}}B&&this.fill_(e),V&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,1,t,this.hitDetectionInstructions,!0,r,s)}}const T7=E7,BS=["Polygon","Circle","LineString","Image","Text","Default"];class S7{constructor(e,t,i,r,s,o){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Hn(),this.createExecutors_(s)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e){for(const t in e){let i=this.executorsByZIndex_[t];i===void 0&&(i={},this.executorsByZIndex_[t]=i);const r=e[t];for(const s in r){const o=r[s];i[s]=new T7(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,l=As(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=mn(a,a,void 0,{willReadFrequently:!0}));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):u||h.clearRect(0,0,a,a);let p;this.renderBuffer_!==void 0&&(p=xr(),py(p,e),Rs(p,t*(this.renderBuffer_+r),p));const m=C7(r);let y;function x(L,F){const O=h.getImageData(0,0,a,a).data;for(let N=0,B=m.length;N<B;N++)if(O[m[N]]>0){if(!o||y!=="Image"&&y!=="Text"||o.includes(L)){const V=(m[N]-3)/4,J=r-V%a,ge=r-(V/a|0),he=s(L,F,J*J+ge*ge);if(he)return he}h.clearRect(0,0,a,a);break}}const w=Object.keys(this.executorsByZIndex_).map(Number);w.sort(Ac);let R,E,T,I,A;for(R=w.length-1;R>=0;--R){const L=w[R].toString();for(T=this.executorsByZIndex_[L],E=BS.length-1;E>=0;--E)if(y=BS[E],I=T[y],I!==void 0&&(A=I.executeHitDetection(h,l,i,x,p),A))return A}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return _c(a,0,8,2,e,a),a}isEmpty(){return Xh(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(Ac),this.maxExtent_&&(e.save(),this.clip(e,i)),o=o||BS;let u,h,p,m,y,x;for(a&&l.reverse(),u=0,h=l.length;u<h;++u){const w=l[u].toString();for(y=this.executorsByZIndex_[w],p=0,m=o.length;p<m;++p){const R=o[p];x=y[R],x!==void 0&&x.execute(e,t,i,r,s,a)}}this.maxExtent_&&e.restore()}}const VS={};function C7(n){if(VS[n]!==void 0)return VS[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let l=i[a];l||(l=[],i[a]=l),l.push(((n+s)*e+(n+o))*4+3),s>0&&l.push(((n-s)*e+(n+o))*4+3),o>0&&(l.push(((n+s)*e+(n-o))*4+3),s>0&&l.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return VS[n]=r,r}const tw=S7,ln={ANIMATING:0,INTERACTING:1};class I7 extends K3{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Af(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Hn()}drawImages_(e,t,i,r){if(!this.image_)return;const s=_c(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let h=0,p=s.length;h<p;h+=2){const m=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const x=m+this.imageAnchorX_,w=y+this.imageAnchorY_;As(a,x,w,1,1,u,-x,-w),o.setTransform.apply(o,a),o.translate(x,w),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=_c(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const l=s[t]+this.textOffsetX_,u=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.translate(l-this.textOffsetX_,u-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=_c(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let u=2;u<l;u+=2)o.lineTo(a[u],a[u+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(un(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=rY(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);!i||!un(this.extent_,i.getExtent())||(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!un(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(un(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let l=0,u=o.length;l<u;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!un(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!un(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,l=s.length;a<l;++a){const u=s[a];r=this.drawRings_(i,r,u,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),cl(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:i0;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Ka(i||Hl)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),u=t.getMiterLimit(),h=s||Jy;this.strokeState_={lineCap:r!==void 0?r:Yx,lineDash:this.pixelRatio_===1?h:h.map(p=>p*this.pixelRatio_),lineDashOffset:(o||e0)*this.pixelRatio_,lineJoin:a!==void 0?a:Hg,lineWidth:(l!==void 0?l:r0)*this.pixelRatio_,miterLimit:u!==void 0?u:t0,strokeStyle:Ka(i||n0)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Ka(y||Hl)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const y=i.getColor(),x=i.getLineCap(),w=i.getLineDash(),R=i.getLineDashOffset(),E=i.getLineJoin(),T=i.getWidth(),I=i.getMiterLimit();this.textStrokeState_={lineCap:x!==void 0?x:Yx,lineDash:w||Jy,lineDashOffset:R||e0,lineJoin:E!==void 0?E:Hg,lineWidth:T!==void 0?T:r0,miterLimit:I!==void 0?I:t0,strokeStyle:Ka(y||n0)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),h=e.getText(),p=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:r!==void 0?r:V3,textAlign:p!==void 0?p:i0,textBaseline:m!==void 0?m:Zx},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,x,w)=>y+=w%2?" ":x,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const Z3=I7,R7=Object.freeze(Object.defineProperty({__proto__:null,Circle:gp,Fill:Ws,Icon:xg,IconImage:e7,Image:HA,RegularShape:qA,Stroke:Ts,Style:ws,Text:s0},Symbol.toStringTag,{value:"Module"})),Vs=.5;function Q3(n,e,t,i,r,s,o){const a=n[0]*Vs,l=n[1]*Vs,u=mn(a,l);u.imageSmoothingEnabled=!1;const h=u.canvas,p=new Z3(u,Vs,r,null,o),m=t.length,y=Math.floor((256*256*256-1)/m),x={};for(let R=1;R<=m;++R){const E=t[R-1],T=E.getStyleFunction()||i;if(!i)continue;let I=T(E,s);if(!I)continue;Array.isArray(I)||(I=[I]);const L=(R*y).toString(16).padStart(7,"#00000");for(let F=0,O=I.length;F<O;++F){const N=I[F],B=N.getGeometryFunction()(E);if(!B||!un(r,B.getExtent()))continue;const V=N.clone(),J=V.getFill();J&&J.setColor(L);const ge=V.getStroke();ge&&(ge.setColor(L),ge.setLineDash(null)),V.setText(void 0);const he=N.getImage();if(he&&he.getOpacity()!==0){const se=he.getImageSize();if(!se)continue;const Z=mn(se[0],se[1],void 0,{alpha:!1}),pe=Z.canvas;Z.fillStyle=L,Z.fillRect(0,0,pe.width,pe.height),V.setImage(new xg({img:pe,imgSize:se,anchor:he.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:he.getOrigin(),opacity:1,size:he.getSize(),scale:he.getScale(),rotation:he.getRotation(),rotateWithView:he.getRotateWithView()}))}const de=V.getZIndex()||0;let oe=x[de];oe||(oe={},x[de]=oe,oe.Polygon=[],oe.Circle=[],oe.LineString=[],oe.Point=[]);const _e=B.getType();if(_e==="GeometryCollection"){const se=B.getGeometriesArrayRecursive();for(let Z=0,pe=se.length;Z<pe;++Z){const ne=se[Z];oe[ne.getType().replace("Multi","")].push(ne,V)}}else oe[_e.replace("Multi","")].push(B,V)}}const w=Object.keys(x).map(Number).sort(Ac);for(let R=0,E=w.length;R<E;++R){const T=x[w[R]];for(const I in T){const A=T[I];for(let L=0,F=A.length;L<F;L+=2){p.setStyle(A[L+1]);for(let O=0,N=e.length;O<N;++O)p.setTransform(e[O]),p.drawGeometry(A[L])}}}return u.getImageData(0,0,h.width,h.height)}function J3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Vs),s=Math.floor(Math.round(n[1])*Vs),o=(ot(r,0,t.width-1)+ot(s,0,t.height-1)*t.width)*4,a=t.data[o],l=t.data[o+1],h=t.data[o+2]+256*(l+256*a),p=Math.floor((256*256*256-1)/e.length);h&&h%p===0&&i.push(e[h/p-1])}return i}const b7=.5,eU={Point:O7,LineString:M7,Polygon:z7,MultiPoint:N7,MultiLineString:D7,MultiPolygon:F7,GeometryCollection:L7,Circle:k7};function A7(n,e){return parseInt(be(n),10)-parseInt(be(e),10)}function nk(n,e){const t=cR(n,e);return t*t}function cR(n,e){return b7*n/e}function k7(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,i)}const a=t.getText();if(a&&a.getText()){const l=(r||n).getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function nw(n,e,t,i,r,s,o){let a=!1;const l=t.getImage();if(l){const u=l.getImageState();u==st.LOADED||u==st.ERROR?l.unlistenImageChange(r):(u==st.IDLE&&l.load(),l.listenImageChange(r),a=!0)}return P7(n,e,t,i,s,o),a}function P7(n,e,t,i,r,s){const o=t.getGeometryFunction()(e);if(!o)return;const a=o.simplifyTransformed(i,r);if(t.getRenderer())tU(n,a,t,e);else{const u=eU[a.getType()];u(n,a,t,e,s)}}function tU(n,e,t,i){if(e.getType()=="GeometryCollection"){const s=e.getGeometries();for(let o=0,a=s.length;o<a;++o)tU(n,s[o],t,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer())}function L7(n,e,t,i,r){const s=e.getGeometriesArray();let o,a;for(o=0,a=s.length;o<a;++o){const l=eU[s[o].getType()];l(n,s[o],t,i,r)}}function M7(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i)}const o=t.getText();if(o&&o.getText()){const a=(r||n).getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i)}}function D7(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i)}const o=t.getText();if(o&&o.getText()){const a=(r||n).getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i)}}function F7(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,i)}const a=t.getText();if(a&&a.getText()){const l=(r||n).getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function O7(n,e,t,i,r){const s=t.getImage(),o=t.getText();let a;if(s){if(s.getImageState()!=st.LOADED)return;let l=n;if(r){const h=s.getDeclutterMode();if(h!=="none")if(l=r,h==="obstacle"){const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(s,a),p.drawPoint(e,i)}else o&&o.getText()&&(a={})}const u=l.getBuilder(t.getZIndex(),"Image");u.setImageStyle(s,a),u.drawPoint(e,i)}if(o&&o.getText()){let l=n;r&&(l=r);const u=l.getBuilder(t.getZIndex(),"Text");u.setTextStyle(o,a),u.drawText(e,i)}}function N7(n,e,t,i,r){const s=t.getImage(),o=t.getText();let a;if(s){if(s.getImageState()!=st.LOADED)return;let l=n;if(r){const h=s.getDeclutterMode();if(h!=="none")if(l=r,h==="obstacle"){const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(s,a),p.drawMultiPoint(e,i)}else o&&o.getText()&&(a={})}const u=l.getBuilder(t.getZIndex(),"Image");u.setImageStyle(s,a),u.drawMultiPoint(e,i)}if(o&&o.getText()){let l=n;r&&(l=r);const u=l.getBuilder(t.getZIndex(),"Text");u.setTextStyle(o,a),u.drawText(e,i)}}function z7(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,i)}const a=t.getText();if(a&&a.getText()){const l=(r||n).getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}class U7 extends tk{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=xr(),this.wrappedRenderedExtent_=xr(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,l=s.projection,u=s.rotation,h=l.getExtent(),p=this.getLayer().getSource(),m=t.pixelRatio,y=t.viewHints,x=!(y[ln.ANIMATING]||y[ln.INTERACTING]),w=this.compositionContext_,R=Math.round(t.size[0]*m),E=Math.round(t.size[1]*m),T=p.getWrapX()&&l.canWrapX(),I=T?gt(h):null,A=T?Math.ceil((r[2]-h[2])/I)+1:1;let L=T?Math.floor((r[0]-h[0])/I):0;do{const F=this.getRenderTransform(o,a,u,m,R,E,L*I);e.execute(w,1,F,u,x,void 0,i)}while(++L<A)}setupCompositionContext_(){if(this.opacity_!==1){const e=mn(this.context.canvas.width,this.context.canvas.height,lD);this.compositionContext_=e}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const e=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=e,Qh(this.compositionContext_),lD.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(e){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,e,e.declutterTree),this.releaseCompositionContext_())}renderFrame(e,t){const i=e.pixelRatio,r=e.layerStatesArray[e.layerIndex];TK(this.pixelTransform,1/i,1/i),H0(this.inversePixelTransform,this.pixelTransform);const s=wA(this.pixelTransform);this.useContainer(t,s,this.getBackground(e));const o=this.context,a=o.canvas,l=this.replayGroup_,u=this.declutterExecutorGroup;if((!l||l.isEmpty())&&(!u||u.isEmpty()))return null;const h=Math.round(e.size[0]*i),p=Math.round(e.size[1]*i);a.width!=h||a.height!=p?(a.width=h,a.height=p,a.style.transform!==s&&(a.style.transform=s)):this.containerReused||o.clearRect(0,0,h,p),this.preRender(o,e);const m=e.viewState;m.projection,this.opacity_=r.opacity,this.setupCompositionContext_();let y=!1,x=!0;if(r.extent&&this.clipping){const w=bo(r.extent);x=un(w,e.extent),y=x&&!zr(w,e.extent),y&&this.clipUnrotated(this.compositionContext_,e,w)}return x&&this.renderWorlds(l,e),y&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,e),this.renderedRotation_!==m.rotation&&(this.renderedRotation_=m.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(e){return new Promise(t=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=[this.context.canvas.width,this.context.canvas.height];Tn(this.pixelTransform,i);const r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),h=[],p=i[0]*Vs,m=i[1]*Vs;h.push(this.getRenderTransform(r,s,o,Vs,p,m,0).slice());const y=u.getSource(),x=a.getExtent();if(y.getWrapX()&&a.canWrapX()&&!zr(x,l)){let w=l[0];const R=gt(x);let E=0,T;for(;w<x[0];)--E,T=R*E,h.push(this.getRenderTransform(r,s,o,Vs,p,m,T).slice()),w+=R;for(E=0,w=l[2];w>x[2];)++E,T=R*E,h.push(this.getRenderTransform(r,s,o,Vs,p,m,T).slice()),w-=R}this.hitDetectionImageData_=Q3(i,h,this.renderedFeatures_,u.getStyleFunction(),l,s,o)}t(J3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),u={},h=function(y,x,w){const R=be(y),E=u[R];if(E){if(E!==!0&&w<E.distanceSq){if(w===0)return u[R]=!0,s.splice(s.lastIndexOf(E),1),r(y,l,x);E.geometry=x,E.distanceSq=w}}else{if(w===0)return u[R]=!0,r(y,l,x);s.push(u[R]={feature:y,layer:l,geometry:x,distanceSq:w,callback:r})}};let p;const m=[this.replayGroup_];return this.declutterExecutorGroup&&m.push(this.declutterExecutorGroup),m.some(y=>p=y.forEachFeatureAtCoordinate(e,o,a,i,h,y===this.declutterExecutorGroup&&t.declutterTree?t.declutterTree.all().map(x=>x.value):null)),p}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[ln.ANIMATING],s=e.viewHints[ln.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,u=e.viewState,h=u.projection,p=u.resolution,m=e.pixelRatio,y=t.getRevision(),x=t.getRenderBuffer();let w=t.getRenderOrder();w===void 0&&(w=A7);const R=u.center.slice(),E=Rs(l,x*p),T=E.slice(),I=[E.slice()],A=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!zr(A,e.extent)){const oe=gt(A),_e=Math.max(gt(E)/2,oe);E[0]=A[0]-_e,E[2]=A[2]+_e,yE(R,h);const se=CA(I[0],h);se[0]<A[0]&&se[2]<A[2]?I.push([se[0]+oe,se[1],se[2]+oe,se[3]]):se[0]>A[0]&&se[2]>A[2]&&I.push([se[0]-oe,se[1],se[2]-oe,se[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==y&&this.renderedRenderOrder_==w&&zr(this.wrappedRenderedExtent_,E))return cl(this.renderedExtent_,T)||(this.hitDetectionImageData_=null,this.renderedExtent_=T),this.renderedCenter_=R,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const L=new ew(cR(p,m),E,p,m);let F;this.getLayer().getDeclutter()&&(F=new ew(cR(p,m),E,p,m));let O;for(let oe=0,_e=I.length;oe<_e;++oe)i.loadFeatures(I[oe],p,h);const N=nk(p,m);let B=!0;const V=oe=>{let _e;const se=oe.getStyleFunction()||t.getStyleFunction();if(se&&(_e=se(oe,p)),_e){const Z=this.renderFeature(oe,N,_e,L,O,F);B=B&&!Z}},J=dp(E),ge=i.getFeaturesInExtent(J);w&&ge.sort(w);for(let oe=0,_e=ge.length;oe<_e;++oe)V(ge[oe]);this.renderedFeatures_=ge,this.ready=B;const he=L.finish(),de=new tw(E,p,m,i.getOverlaps(),he,t.getRenderBuffer());return F&&(this.declutterExecutorGroup=new tw(E,p,m,i.getOverlaps(),F.finish(),t.getRenderBuffer())),this.renderedResolution_=p,this.renderedRevision_=y,this.renderedRenderOrder_=w,this.renderedExtent_=T,this.wrappedRenderedExtent_=E,this.renderedCenter_=R,this.renderedProjection_=h,this.replayGroup_=de,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,u=i.length;l<u;++l)a=nw(r,e,i[l],t,this.boundHandleStyleImageChange_,s,o)||a;else a=nw(r,e,i,t,this.boundHandleStyleImageChange_,s,o);return a}}const nU=U7;class G7 extends Q0{constructor(e){super(e)}createRenderer(){return new nU(this)}}const Lc=G7;class j7{constructor(e){this.rbush_=new QA(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[be(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[be(a)]=l}this.rbush_.load(i)}remove(e){const t=be(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[be(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Oo(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return Xh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ma(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}const iw=j7;class B7 extends to{constructor(e){super(),this.projection=_t(e.projection),this.attributions_=hD(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible!==void 0?e.attributionsCollapsible:!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=hD(e),this.changed()}setState(e){this.state_=e,this.changed()}}function hD(n){return n?Array.isArray(n)?function(e){return n}:typeof n=="function"?n:function(e){return[n]}:null}const Pf=B7,Fi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function V7(n,e){return[[-1/0,-1/0,1/0,1/0]]}function $7(n,e){return[n]}let W7=!1;function iU(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=W7,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const u=e.getType();let h;u=="json"||u=="text"?h=a.responseText:u=="xml"?(h=a.responseXML,h||(h=new DOMParser().parseFromString(a.responseText,"application/xml"))):u=="arraybuffer"&&(h=a.response),h?s(e.readFeatures(h,{extent:t,featureProjection:r}),e.readProjection(h)):o()}else o()},a.onerror=o,a.send()}function fD(n,e){return function(t,i,r,s,o){const a=this;iU(n,e,t,i,r,function(l,u){a.addFeatures(l),s!==void 0&&s(l)},o||Hh)}}class Bu extends Vi{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class H7 extends Pf{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Hh,this.format_=e.format,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Ye(this.format_,7),this.loader_=fD(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:V7;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new iw:null,this.loadedExtentsRtree_=new iw,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Ei(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=be(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Bu(Fi.ADDFEATURE,e))}setupChangeEvents_(e,t){this.featureChangeKeys_[e]=[Ve(t,Re.CHANGE,this.handleFeatureChange_,this),Ve(t,Wh.PROPERTYCHANGE,this.handleFeatureChange_,this)]}addToIndex_(e,t){let i=!0;const r=t.getId();return r!==void 0&&(r.toString()in this.idIndex_?i=!1:this.idIndex_[r.toString()]=t),i&&(Ye(!(e in this.uidIndex_),30),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=be(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=be(a);this.setupChangeEvents_(l,a);const u=a.getGeometry();if(u){const h=u.getExtent();t.push(h),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Fi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Bu(Fi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Fi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Fi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Qn.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Qn.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(zt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=r=>{this.removeFeatureInternal(r)};this.featuresRtree_.forEach(i);for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Bu(Fi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){if(r.getGeometry().intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){if(i.getGeometry().intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Xh(this.nullGeometryFeatures_)||qs(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=PK(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}else if(this.featuresCollection_)return this.featuresCollection_.getArray().slice(0);return[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||Fo,this.featuresRtree_.forEachInExtent(l,function(u){if(t(u)){const h=u.getGeometry(),p=a;if(a=h.closestPointXY(i,r,o,a),a<p){s=u;const m=Math.sqrt(a);l[0]=i-m,l[1]=r-m,l[2]=i+m,l[3]=r+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=be(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Bu(Fi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:be(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Xh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return zr(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Bu(Fi.FEATURESLOADSTART)),this.loader_.call(this,l,t,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Bu(Fi.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Bu(Fi.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_;let i;t.forEachInExtent(e,function(r){if(Oo(r.extent,e))return i=r,!0}),i&&t.remove(i)}removeFeature(e){if(!e)return;const t=be(e);t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=be(e),i=this.featureChangeKeys_[t];if(!i)return;i.forEach(zt),delete this.featureChangeKeys_[t];const r=e.getId();return r!==void 0&&delete this.idIndex_[r.toString()],delete this.uidIndex_[t],this.dispatchEvent(new Bu(Fi.REMOVEFEATURE,e)),e}removeFromIdIndex_(e){let t=!1;for(const i in this.idIndex_)if(this.idIndex_[i]===e){delete this.idIndex_[i],t=!0;break}return t}setLoader(e){this.loader_=e}setUrl(e){Ye(this.format_,7),this.url_=e,this.setLoader(fD(e,this.format_))}}const Ja=H7;function X7(n){if(!(n.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");const e=n.inversePixelTransform[0],t=n.inversePixelTransform[1],i=Math.sqrt(e*e+t*t),r=n.frameState,s=qh(n.inversePixelTransform.slice(),r.coordinateToPixelTransform),o=nk(r.viewState.resolution,i);let a;return new Z3(n.context,i,r.extent,s,r.viewState.rotation,o,a)}function rU(n,e,t){const i=[];let r=n(0),s=n(1),o=e(r),a=e(s);const l=[s,r],u=[a,o],h=[1,0],p={};let m=1e5,y,x,w,R,E,T;for(;--m>0&&h.length>0;)w=h.pop(),r=l.pop(),o=u.pop(),T=w.toString(),T in p||(i.push(o[0],o[1]),p[T]=!0),R=h.pop(),s=l.pop(),a=u.pop(),E=(w+R)/2,y=n(E),x=e(y),m3(x[0],x[1],o[0],o[1],a[0],a[1])<t?(i.push(a[0],a[1]),T=R.toString(),p[T]=!0):(h.push(R,E,E,w),u.push(a,x,x,o),l.push(s,y,y,r));return i}function q7(n,e,t,i,r){const s=_t("EPSG:4326");return rU(function(o){return[n,e+(t-e)*o]},eu(s,i),r)}function K7(n,e,t,i,r){const s=_t("EPSG:4326");return rU(function(o){return[e+(t-e)*o,n]},eu(s,i),r)}const Y7=new Ts({color:"rgba(0,0,0,0.2)"}),Z7=[90,45,30,20,10,5,2,1,30/60,20/60,10/60,5/60,2/60,1/60,30/3600,20/3600,10/3600,5/3600,2/3600,1/3600];class Q7 extends Lc{constructor(e){e=e||{};const t=Object.assign({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},e);delete t.maxLines,delete t.strokeStyle,delete t.targetSize,delete t.showLabels,delete t.lonLabelFormatter,delete t.latLabelFormatter,delete t.lonLabelPosition,delete t.latLabelPosition,delete t.lonLabelStyle,delete t.latLabelStyle,delete t.intervals,super(t),this.projection_=null,this.maxLat_=1/0,this.maxLon_=1/0,this.minLat_=-1/0,this.minLon_=-1/0,this.maxX_=1/0,this.maxY_=1/0,this.minX_=-1/0,this.minY_=-1/0,this.targetSize_=e.targetSize!==void 0?e.targetSize:100,this.maxLines_=e.maxLines!==void 0?e.maxLines:100,this.meridians_=[],this.parallels_=[],this.strokeStyle_=e.strokeStyle!==void 0?e.strokeStyle:Y7,this.fromLonLatTransform_=void 0,this.toLonLatTransform_=void 0,this.projectionCenterLonLat_=null,this.bottomLeft_=null,this.bottomRight_=null,this.topLeft_=null,this.topRight_=null,this.meridiansLabels_=null,this.parallelsLabels_=null,e.showLabels&&(this.lonLabelFormatter_=e.lonLabelFormatter==null?jM.bind(this,"EW"):e.lonLabelFormatter,this.latLabelFormatter_=e.latLabelFormatter==null?jM.bind(this,"NS"):e.latLabelFormatter,this.lonLabelPosition_=e.lonLabelPosition==null?0:e.lonLabelPosition,this.latLabelPosition_=e.latLabelPosition==null?1:e.latLabelPosition,this.lonLabelStyleBase_=new ws({text:e.lonLabelStyle!==void 0?e.lonLabelStyle.clone():new s0({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new Ws({color:"rgba(0,0,0,1)"}),stroke:new Ts({color:"rgba(255,255,255,1)",width:3})})}),this.lonLabelStyle_=i=>{const r=i.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(r),this.lonLabelStyleBase_},this.latLabelStyleBase_=new ws({text:e.latLabelStyle!==void 0?e.latLabelStyle.clone():new s0({font:"12px Calibri,sans-serif",textAlign:"right",fill:new Ws({color:"rgba(0,0,0,1)"}),stroke:new Ts({color:"rgba(255,255,255,1)",width:3})})}),this.latLabelStyle_=i=>{const r=i.get("graticule_label");return this.latLabelStyleBase_.getText().setText(r),this.latLabelStyleBase_},this.meridiansLabels_=[],this.parallelsLabels_=[],this.addEventListener(is.POSTRENDER,this.drawLabels_.bind(this))),this.intervals_=e.intervals!==void 0?e.intervals:Z7,this.setSource(new Ja({loader:this.loaderFunction.bind(this),strategy:this.strategyFunction.bind(this),features:new Ei,overlaps:!1,useSpatialIndex:!1,wrapX:e.wrapX})),this.featurePool_=[],this.lineStyle_=new ws({stroke:this.strokeStyle_}),this.loadedExtent_=null,this.renderedExtent_=null,this.renderedResolution_=null,this.setRenderOrder(null)}strategyFunction(e,t){let i=e.slice();return this.projection_&&this.getSource().getWrapX()&&CA(i,this.projection_),this.loadedExtent_&&(IK(this.loadedExtent_,i,t)?i=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[i]}loaderFunction(e,t,i){this.loadedExtent_=e;const r=this.getSource(),s=this.getExtent()||[-1/0,-1/0,1/0,1/0],o=tr(s,e);if(this.renderedExtent_&&Oo(this.renderedExtent_,o)&&this.renderedResolution_===t||(this.renderedExtent_=o,this.renderedResolution_=t,bf(o)))return;const a=er(o),l=t*t/4;(!this.projection_||!rs(this.projection_,i))&&this.updateProjectionInfo_(i),this.createGraticule_(o,a,t,l);let h=this.meridians_.length+this.parallels_.length;this.meridiansLabels_&&(h+=this.meridians_.length),this.parallelsLabels_&&(h+=this.parallels_.length);let p;for(;h>this.featurePool_.length;)p=new pr,this.featurePool_.push(p);const m=r.getFeaturesCollection();m.clear();let y=0,x,w;for(x=0,w=this.meridians_.length;x<w;++x)p=this.featurePool_[y++],p.setGeometry(this.meridians_[x]),p.setStyle(this.lineStyle_),m.push(p);for(x=0,w=this.parallels_.length;x<w;++x)p=this.featurePool_[y++],p.setGeometry(this.parallels_[x]),p.setStyle(this.lineStyle_),m.push(p)}addMeridian_(e,t,i,r,s,o){const a=this.getMeridian_(e,t,i,r,o);if(un(a.getExtent(),s)){if(this.meridiansLabels_){const l=this.lonLabelFormatter_(e);o in this.meridiansLabels_?this.meridiansLabels_[o].text=l:this.meridiansLabels_[o]={geom:new bs([]),text:l}}this.meridians_[o++]=a}return o}addParallel_(e,t,i,r,s,o){const a=this.getParallel_(e,t,i,r,o);if(un(a.getExtent(),s)){if(this.parallelsLabels_){const l=this.latLabelFormatter_(e);o in this.parallelsLabels_?this.parallelsLabels_[o].text=l:this.parallelsLabels_[o]={geom:new bs([]),text:l}}this.parallels_[o++]=a}return o}drawLabels_(e){const t=e.frameState.viewState.rotation,i=e.frameState.viewState.resolution,r=e.frameState.size,s=e.frameState.extent,o=er(s);let a=s;if(t){const x=r[0]*i,w=r[1]*i;a=[o[0]-x/2,o[1]-w/2,o[0]+x/2,o[1]+w/2]}let l=0,u=0,h=this.latLabelPosition_<.5;const p=this.projection_.getExtent(),m=gt(p);if(this.getSource().getWrapX()&&this.projection_.canWrapX()&&!zr(p,s)){l=Math.floor((s[0]-p[0])/m),u=Math.ceil((s[2]-p[2])/m);const x=Math.abs(t)>Math.PI/2;h=h!==x}const y=X7(e);for(let x=l;x<=u;++x){let w=this.meridians_.length+this.parallels_.length,R,E,T,I;if(this.meridiansLabels_)for(E=0,T=this.meridiansLabels_.length;E<T;++E){const A=this.meridians_[E];if(!t&&x===0)I=this.getMeridianPoint_(A,s,E);else{const L=A.clone();L.translate(x*m,0),L.rotate(-t,o),I=this.getMeridianPoint_(L,a,E),I.rotate(t,o)}R=this.featurePool_[w++],R.setGeometry(I),R.set("graticule_label",this.meridiansLabels_[E].text),y.drawFeature(R,this.lonLabelStyle_(R))}if(this.parallelsLabels_&&(x===l&&h||x===u&&!h))for(E=0,T=this.parallels_.length;E<T;++E){const A=this.parallels_[E];if(!t&&x===0)I=this.getParallelPoint_(A,s,E);else{const L=A.clone();L.translate(x*m,0),L.rotate(-t,o),I=this.getParallelPoint_(L,a,E),I.rotate(t,o)}R=this.featurePool_[w++],R.setGeometry(I),R.set("graticule_label",this.parallelsLabels_[E].text),y.drawFeature(R,this.latLabelStyle_(R))}}}createGraticule_(e,t,i,r){const s=this.getInterval_(i);if(s==-1){this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),this.parallelsLabels_&&(this.parallelsLabels_.length=0);return}let o=!1;const a=this.projection_.getExtent(),l=gt(a);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!zr(a,e)&&(gt(e)>=l?(e[0]=a[0],e[2]=a[2]):o=!0);const u=[ot(t[0],this.minX_,this.maxX_),ot(t[1],this.minY_,this.maxY_)],h=this.toLonLatTransform_(u);isNaN(h[1])&&(h[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);let p=ot(h[0],this.minLon_,this.maxLon_),m=ot(h[1],this.minLat_,this.maxLat_);const y=this.maxLines_;let x,w,R,E,T=e;o||(T=[ot(e[0],this.minX_,this.maxX_),ot(e[1],this.minY_,this.maxY_),ot(e[2],this.minX_,this.maxX_),ot(e[3],this.minY_,this.maxY_)]);const I=Vg(T,this.toLonLatTransform_,void 0,8);let A=I[3],L=I[2],F=I[1],O=I[0];if(o||(la(T,this.bottomLeft_)&&(O=this.minLon_,F=this.minLat_),la(T,this.bottomRight_)&&(L=this.maxLon_,F=this.minLat_),la(T,this.topLeft_)&&(O=this.minLon_,A=this.maxLat_),la(T,this.topRight_)&&(L=this.maxLon_,A=this.maxLat_),A=ot(A,m,this.maxLat_),L=ot(L,p,this.maxLon_),F=ot(F,this.minLat_,m),O=ot(O,this.minLon_,p)),p=Math.floor(p/s)*s,E=ot(p,this.minLon_,this.maxLon_),w=this.addMeridian_(E,F,A,r,e,0),x=0,o)for(;(E-=s)>=O&&x++<y;)w=this.addMeridian_(E,F,A,r,e,w);else for(;E!=this.minLon_&&x++<y;)E=Math.max(E-s,this.minLon_),w=this.addMeridian_(E,F,A,r,e,w);if(E=ot(p,this.minLon_,this.maxLon_),x=0,o)for(;(E+=s)<=L&&x++<y;)w=this.addMeridian_(E,F,A,r,e,w);else for(;E!=this.maxLon_&&x++<y;)E=Math.min(E+s,this.maxLon_),w=this.addMeridian_(E,F,A,r,e,w);for(this.meridians_.length=w,this.meridiansLabels_&&(this.meridiansLabels_.length=w),m=Math.floor(m/s)*s,R=ot(m,this.minLat_,this.maxLat_),w=this.addParallel_(R,O,L,r,e,0),x=0;R!=this.minLat_&&x++<y;)R=Math.max(R-s,this.minLat_),w=this.addParallel_(R,O,L,r,e,w);for(R=ot(m,this.minLat_,this.maxLat_),x=0;R!=this.maxLat_&&x++<y;)R=Math.min(R+s,this.maxLat_),w=this.addParallel_(R,O,L,r,e,w);this.parallels_.length=w,this.parallelsLabels_&&(this.parallelsLabels_.length=w)}getInterval_(e){const t=this.projectionCenterLonLat_[0],i=this.projectionCenterLonLat_[1];let r=-1;const s=Math.pow(this.targetSize_*e,2),o=[],a=[];for(let l=0,u=this.intervals_.length;l<u;++l){const h=ot(this.intervals_[l]/2,0,90),p=ot(i,-90+h,90-h);if(o[0]=t-h,o[1]=p-h,a[0]=t+h,a[1]=p+h,this.fromLonLatTransform_(o,o),this.fromLonLatTransform_(a,a),Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)<=s)break;r=this.intervals_[l]}return r}getMeridian_(e,t,i,r,s){const o=q7(e,t,i,this.projection_,r);let a=this.meridians_[s];return a?(a.setFlatCoordinates("XY",o),a.changed()):(a=new da(o,"XY"),this.meridians_[s]=a),a}getMeridianPoint_(e,t,i){const r=e.getFlatCoordinates();let s=1,o=r.length-1;r[s]>r[o]&&(s=o,o=1);const a=Math.max(t[1],r[s]),l=Math.min(t[3],r[o]),u=ot(t[1]+Math.abs(t[1]-t[3])*this.lonLabelPosition_,a,l),p=[r[s-1]+(r[o-1]-r[s-1])*(u-r[s])/(r[o]-r[s]),u],m=this.meridiansLabels_[i].geom;return m.setCoordinates(p),m}getMeridians(){return this.meridians_}getParallel_(e,t,i,r,s){const o=K7(e,t,i,this.projection_,r);let a=this.parallels_[s];return a?(a.setFlatCoordinates("XY",o),a.changed()):a=new da(o,"XY"),a}getParallelPoint_(e,t,i){const r=e.getFlatCoordinates();let s=0,o=r.length-2;r[s]>r[o]&&(s=o,o=0);const a=Math.max(t[0],r[s]),l=Math.min(t[2],r[o]),u=ot(t[0]+Math.abs(t[0]-t[2])*this.latLabelPosition_,a,l),h=r[s+1]+(r[o+1]-r[s+1])*(u-r[s])/(r[o]-r[s]),p=[u,h],m=this.parallelsLabels_[i].geom;return m.setCoordinates(p),m}getParallels(){return this.parallels_}updateProjectionInfo_(e){const t=_t("EPSG:4326"),i=e.getWorldExtent();this.maxLat_=i[3],this.maxLon_=i[2],this.minLat_=i[1],this.minLon_=i[0];const r=eu(e,t);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=r;else{const o=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(a,l,u){u=u||2;const h=r(a,l,u);for(let p=0,m=h.length;p<m;p+=u)h[p]<o&&(h[p]+=360);return h}}this.fromLonLatTransform_=eu(t,e);const s=Vg([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=s[0],this.maxX_=s[2],this.minY_=s[1],this.maxY_=s[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_(er(e.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=e}}const sU=Q7;class J7 extends EE{constructor(e,t,i,r,s){const o=s!==void 0?st.IDLE:st.LOADED;super(e,t,i,o),this.loader_=s!==void 0?s:null,this.canvas_=r,this.error_=null}getError(){return this.error_}handleLoad_(e){e?(this.error_=e,this.state=st.ERROR):this.state=st.LOADED,this.changed()}load(){this.state==st.IDLE&&(this.state=st.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}}const TE=J7,ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function oU(n){return Math.pow(n,3)}function Lf(n){return 1-oU(1-n)}function e9(n){return 3*n*n-2*n*n*n}function t9(n){return n}let n9=class extends fp{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.interimTile=null,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Re.CHANGE)}release(){this.state===ce.ERROR&&this.setState(ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let e=this.interimTile;do{if(e.getState()==ce.LOADED)return this.transition_=0,e;e=e.interimTile}while(e);return this}refreshInterimChain(){if(!this.interimTile)return;let e=this.interimTile,t=this;do{if(e.getState()==ce.LOADED){e.interimTile=null;break}else e.getState()==ce.LOADING?t=e:e.getState()==ce.IDLE?t.interimTile=e.interimTile:t=e;e=t.interimTile}while(e)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}load(){et()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:oU(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}};const Mf=n9;class i9 extends Mf{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=ce.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=ce.ERROR,this.unlistenImage_(),this.image_=r9(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=ce.LOADED:this.state=ce.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==ce.ERROR&&(this.state=ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ce.IDLE&&(this.state=ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=JA(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function r9(){const n=mn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}const Xg=i9;class s9{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const aU=s9;class o9 extends hp{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){et()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;As(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),H0(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,l){let u;const h=t.viewState;function p(A,L,F,O){return s.call(o,L,A?F:null,O)}const m=h.projection,y=yE(e.slice(),m),x=[[0,0]];if(m.canWrapX()&&r){const A=m.getExtent(),L=gt(A);x.push([-L,0],[L,0])}const w=t.layerStatesArray,R=w.length,E=[],T=[];for(let A=0;A<x.length;A++)for(let L=R-1;L>=0;--L){const F=w[L],O=F.layer;if(O.hasRenderer()&&ZA(F,h)&&a.call(l,O)){const N=O.getRenderer(),B=O.getSource();if(N&&B){const V=B.getWrapX()?y:e,J=p.bind(null,F.managed);T[0]=V[0]+x[A][0],T[1]=V[1]+x[A][1],u=N.forEachFeatureAtCoordinate(T,t,i,J,E)}if(u)return u}}if(E.length===0)return;const I=1/E.length;return E.forEach((A,L)=>A.distanceSq+=L*I),E.sort((A,L)=>A.distanceSq-L.distanceSq),E.some(A=>u=A.callback(A.feature,A.layer,A.geometry)),u}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Fo,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){et()}scheduleExpireIconCache(e){Jx.canExpireCache()&&e.postRenderFunctions.push(a9)}}function a9(n,e){Jx.expire()}const l9=o9;class u9 extends l9{constructor(e){super(e),this.fontChangeListenerKey_=Ve(Ba,Wh.PROPERTYCHANGE,e.redrawText.bind(e)),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=rl+" ol-layers";const i=e.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new yy(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){zt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(is.PRECOMPOSE,e);const t=e.layerStatesArray.sort(function(o,a){return o.zIndex-a.zIndex}),i=e.viewState;this.children_.length=0;const r=[];let s=null;for(let o=0,a=t.length;o<a;++o){const l=t[o];e.layerIndex=o;const u=l.layer,h=u.getSourceState();if(!ZA(l,i)||h!="ready"&&h!="undefined"){u.unrender();continue}const p=u.render(e,s);p&&(p!==s&&(this.children_.push(p),s=p),"getDeclutter"in u&&r.push(u))}for(let o=r.length-1;o>=0;--o)r[o].renderDeclutter(e);PY(this.element_,this.children_),this.dispatchRenderEvent(is.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}}const c9=u9;class Yu extends Vi{constructor(e,t){super(e),this.layer=t}}const $S={LAYERS:"layers"};class ik extends H3{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener($S.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Ei(i.slice(),{unique:!0}):Ye(typeof i.getArray=="function",43):i=new Ei(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(zt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Ve(e,Qn.ADD,this.handleLayersAdd_,this),Ve(e,Qn.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(zt);If(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Yu("addlayer",s))}this.changed()}registerLayerListeners_(e){const t=[Ve(e,Wh.PROPERTYCHANGE,this.handleLayerChange_,this),Ve(e,Re.CHANGE,this.handleLayerChange_,this)];e instanceof ik&&t.push(Ve(e,"addlayer",this.handleLayerGroupAdd_,this),Ve(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[be(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Yu("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Yu("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Yu("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=be(t);this.listenerKeys_[i].forEach(zt),delete this.listenerKeys_[i],this.dispatchEvent(new Yu("removelayer",t)),this.changed()}getLayers(){return this.get($S.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Yu("removelayer",i[r]))}this.set($S.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const l=t[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=tr(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}}const pp=ik;class h9 extends Vi{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}const wh=h9;class f9 extends wh{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Va=f9,Dt={SINGLECLICK:"singleclick",CLICK:Re.CLICK,DBLCLICK:Re.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Ha={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class d9 extends fp{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=Ve(i,Ha.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Ve(i,Ha.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Re.TOUCHMOVE,this.boundHandleTouchMove_,h3?{passive:!1}:!1)}emulateClick_(e){let t=new Va(Dt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Va(Dt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Va(Dt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Dt.POINTERUP||t.type==Dt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Dt.POINTERDOWN||t.type==Dt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Va(Dt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(zt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Va(Dt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.down_={};for(const i in e){const r=e[i];this.down_[i]=typeof r=="function"?Hh:r}if(this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Ve(i,Dt.POINTERMOVE,this.handlePointerMove_,this),Ve(i,Dt.POINTERUP,this.handlePointerUp_,this),Ve(this.element_,Dt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(Ve(this.element_.getRootNode(),Dt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Va(Dt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Va(Dt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(zt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Re.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(zt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(zt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const lU=d9,oa={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},hi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},rw=1/0;class g9{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,If(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){Ye(!(this.keyFunction_(e)in this.queuedElements_),31);const t=this.priorityFunction_(e);return t!=rw?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),h=u<r&&i[u]<i[l]?u:l;t[e]=t[h],i[e]=i[h],e=h}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,l;for(a=0;a<s;++a)o=t[a],l=e(o),l==rw?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}const p9=g9;class m9 extends p9{constructor(e,t){super(function(i){return e.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Re.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===ce.LOADED||i===ce.ERROR||i===ce.EMPTY){i!==ce.ERROR&&t.removeEventListener(Re.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0,r,s,o;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;)s=this.dequeue()[0],o=s.getKey(),r=s.getState(),r===ce.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++i,s.load())}}const rk=m9;function y9(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return rw;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}const js={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},uU=42,qg=256;function dD(n,e,t){return function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const l=e?0:s[0]*r,u=e?0:s[1]*r,h=a?a[0]:0,p=a?a[1]:0;let m=n[0]+l/2+h,y=n[2]-l/2+h,x=n[1]+u/2+p,w=n[3]-u/2+p;m>y&&(m=(y+m)/2,y=m),x>w&&(x=(w+x)/2,w=x);let R=ot(i[0],m,y),E=ot(i[1],x,w);if(o&&t&&r){const T=30*r;R+=-T*Math.log(1+Math.max(0,m-i[0])/T)+T*Math.log(1+Math.max(0,i[0]-y)/T),E+=-T*Math.log(1+Math.max(0,x-i[1])/T)+T*Math.log(1+Math.max(0,i[1]-w)/T)}return[R,E]}}function _9(n){return n}function sk(n,e,t,i){const r=gt(e)/t[0],s=rn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function ok(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),ot(i,t/2,e*2)}function v9(n,e,t,i){return e=e!==void 0?e:!0,function(r,s,o,a){if(r!==void 0){const l=n[0],u=n[n.length-1],h=t?sk(l,t,o,i):l;if(a)return e?ok(r,h,u):ot(r,u,h);const p=Math.min(h,r),m=Math.floor(hE(n,p,s));return n[m]>h&&m<n.length-1?n[m+1]:n[m]}}}function x9(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,function(o,a,l,u){if(o!==void 0){const h=r?sk(e,r,l,s):e;if(u)return i?ok(o,h,t):ot(o,t,h);const p=1e-9,m=Math.ceil(Math.log(e/h)/Math.log(n)-p),y=-a*(.5-p)+.5,x=Math.min(h,o),w=Math.floor(Math.log(e/x)/Math.log(n)+y),R=Math.max(m,w),E=e/Math.pow(n,R);return ot(E,t,h)}}}function gD(n,e,t,i,r){return t=t!==void 0?t:!0,function(s,o,a,l){if(s!==void 0){const u=i?sk(n,i,a,r):n;return!t||!l?ot(s,e,u):ok(s,u,e)}}}function ak(n){if(n!==void 0)return 0}function pD(n){if(n!==void 0)return n}function w9(n){const e=2*Math.PI/n;return function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function E9(n){return n=n||Fh(5),function(e,t){if(t)return e;if(e!==void 0)return Math.abs(e)<=n?0:e}}const WS=0;class T9 extends to{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=AA(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&T3(),e.center&&(e.center=Sn(e.center,this.projection_)),e.extent&&(e.extent=bo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in js)delete t[a];this.setProperties(t,!0);const i=C9(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=S9(e),s=i.constraint,o=I9(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenter();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Sn(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Sn(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const h=arguments[r];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(r===t){i&&d1(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const u=[];for(;r<t;++r){const h=arguments[r],p={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||e9,callback:i};if(h.center&&(p.sourceCenter=o,p.targetCenter=h.center.slice(),o=p.targetCenter),h.zoom!==void 0?(p.sourceResolution=a,p.targetResolution=this.getResolutionForZoom(h.zoom),a=p.targetResolution):h.resolution&&(p.sourceResolution=a,p.targetResolution=h.resolution,a=p.targetResolution),h.rotation!==void 0){p.sourceRotation=l;const m=Qa(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=l+m,l=p.targetRotation}R9(p)?p.complete=!0:s+=p.duration,u.push(p)}this.animations_.push(u),this.setHint(ln.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ln.ANIMATING]>0}getInteracting(){return this.hints_[ln.INTERACTING]>0}cancelAnimations(){this.setHint(ln.ANIMATING,-this.hints_[ln.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&d1(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const u=e-l.start;let h=l.duration>0?u/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const p=l.easing(h);if(l.sourceCenter){const m=l.sourceCenter[0],y=l.sourceCenter[1],x=l.targetCenter[0],w=l.targetCenter[1];this.nextCenter_=l.targetCenter;const R=m+p*(x-m),E=y+p*(w-y);this.targetCenter_=[R,E]}if(l.sourceResolution&&l.targetResolution){const m=p===1?l.targetResolution:l.sourceResolution+p*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),x=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(x,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const m=p===1?Qa(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+p*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(ln.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&d1(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],IA(i,e-this.getRotation()),_3(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Yh(e,this.getProjection())}getCenterInternal(){return this.get(js.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return dp(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Ye(t,1);const i=this.getResolution();Ye(i!==void 0,2);const r=this.getRotation();return Ye(r!==void 0,3),_g(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(js.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(bo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=gt(e)/t[0],r=rn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return function(s){return t/Math.pow(e,s*r)}}getRotation(){return this.get(js.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return function(o){return Math.log(i/o)/t/s}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=HS(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=hE(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const t=ot(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,ot(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(Ye(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function",24),Array.isArray(e)){Ye(!bf(e),25);const r=bo(e,this.getProjection());i=$g(r)}else if(e.getType()==="Circle"){const r=bo(e.getExtent(),this.getProjection());i=$g(r),i.rotate(this.getRotation(),er(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,u=-1/0,h=-1/0;for(let p=0,m=s.length;p<m;p+=o){const y=s[p]*i-s[p+1]*r,x=s[p]*r+s[p+1]*i;a=Math.min(a,y),l=Math.min(l,x),u=Math.max(u,y),h=Math.max(h,x)}return[a,l,u,h]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),h=Math.sin(u),p=Math.cos(u),m=er(a);m[0]+=(r[1]-r[3])/2*l,m[1]+=(r[0]-r[2])/2*l;const y=m[0]*p-m[1]*h,x=m[1]*p+m[0]*h,w=this.getConstrainedCenter([y,x],l),R=t.callback?t.callback:Hh;t.duration!==void 0?this.animateInternal({resolution:l,center:w,duration:t.duration,easing:t.easing},R):(this.targetResolution_=l,this.targetCenter_=w,this.applyTargetState_(!1,!0),d1(R,!0))}centerOn(e,t,i){this.centerOnInternal(Sn(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(HS(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),l=HS(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Yh(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Sn(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Sn(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Sn(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(js.ROTATION)!==r&&this.set(js.ROTATION,r),this.get(js.RESOLUTION)!==o&&(this.set(js.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(js.CENTER)||!sa(this.get(js.CENTER),a))&&this.set(js.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!sa(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:Lf,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ln.INTERACTING,1)}endInteraction(e,t,i){i=i&&Sn(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.setHint(ln.INTERACTING,-1),this.resolveConstraints(e,t,i)}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function d1(n,e){setTimeout(function(){n(e)},0)}function S9(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return dD(n.extent,n.constrainOnlyCenter,t)}const e=AA(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,dD(t,!1,!1)}return _9}function C9(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:WS,a=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,u=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,m=AA(n.projection,"EPSG:3857"),y=m.getExtent();let x=n.constrainOnlyCenter,w=n.extent;if(!u&&!w&&m.isGlobal()&&(x=!1,w=y),n.resolutions!==void 0){const R=n.resolutions;t=R[o],i=R[a]!==void 0?R[a]:R[R.length-1],n.constrainResolution?e=v9(R,h,!x&&w,p):e=gD(t,i,h,!x&&w,p)}else{const E=(y?Math.max(gt(y),rn(y)):360*Kh.degrees/m.getMetersPerUnit())/qg/Math.pow(2,WS),T=E/Math.pow(2,28-WS);t=n.maxResolution,t!==void 0?o=0:t=E/Math.pow(l,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(l,a):i=E/Math.pow(l,a):i=T),a=o+Math.floor(Math.log(t/i)/Math.log(l)),i=t/Math.pow(l,a-o),n.constrainResolution?e=x9(l,t,i,h,!x&&w,p):e=gD(t,i,h,!x&&w,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:l}}function I9(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?E9():t===!1?pD:typeof t=="number"?w9(t):pD}return ak}function R9(n){return!(n.sourceCenter&&n.targetCenter&&!sa(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function HS(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,l=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,l+=(t[1]-e[1]/2)*i,o=-o;const u=a*s-l*o,h=l*s+a*o;return[u,h]}const Fl=T9;class b9 extends to{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){qx(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&qx(this.element);for(let t=0,i=this.listenerKeys.length;t<i;++t)zt(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=e,e&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Hh&&this.listenerKeys.push(Ve(e,oa.POSTRENDER,this.render,this)),e.render())}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}const hl=b9;class A9 extends hl{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Re.CLICK,this.handleClick_.bind(this),!1);const u=t+" "+rl+" "+kf+(this.collapsed_&&this.collapsible_?" "+Kx:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t={},i=[];let r=!0;const s=e.layerStatesArray;for(let o=0,a=s.length;o<a;++o){const l=s[o];if(!ZA(l,e.viewState))continue;const u=l.layer.getSource();if(!u)continue;const h=u.getAttributions();if(!h)continue;const p=h(e);if(p)if(r=r&&u.getAttributionsCollapsible()!==!1,Array.isArray(p))for(let m=0,y=p.length;m<y;++m)p[m]in t||(i.push(p[m]),t[p[m]]=!0);else p in t||(i.push(p),t[p]=!0)}return this.overrideCollapsible_||this.setCollapsible(r),i}updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=this.collectSourceAttributions_(e),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!cl(t,this.renderedAttributions_)){j3(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Kx),this.collapsed_?Wg(this.collapseLabel_,this.label_):Wg(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}const cU=A9;class k9 extends hl{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Re.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+rl+" "+kf,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(u1)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Lf}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(u1);!s&&i===0?this.element.classList.add(u1):s&&i!==0&&this.element.classList.remove(u1)}this.label_.style.transform=r}this.rotation_=i}}const hU=k9;class P9 extends hl{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(Re.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=u,p.appendChild(typeof a=="string"?document.createTextNode(a):a),p.addEventListener(Re.CLICK,this.handleClick_.bind(this,-i),!1);const m=t+" "+rl+" "+kf,y=this.element;y.className=m,y.appendChild(h),y.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Lf})):i.setZoom(s)}}}const fU=P9;function dU(n){n=n||{};const e=new Ei;return(n.zoom!==void 0?n.zoom:!0)&&e.push(new fU(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&e.push(new hU(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&e.push(new cU(n.attributionOptions)),e}const sw={ACTIVE:"active"};class L9 extends to{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(sw.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(sw.ACTIVE,e)}setMap(e){this.map_=e}}function M9(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:t9,center:n.getConstrainedCenter(r)})}}function lk(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Lf})}const hu=L9;class D9 extends hu{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Dt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();lk(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}const gU=D9;class F9 extends hu{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Dt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Dt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Dt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Dt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function uk(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}const No=F9;function hR(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const O9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},N9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},z9=function(n){const e=n.map.getTargetElement(),t=n.map.getOwnerDocument().activeElement;return e.contains(t)},pU=function(n){return n.map.getTargetElement().hasAttribute("tabindex")?z9(n):!0},Kg=Fo,U9=function(n){return n.type==Dt.CLICK},mU=function(n){const e=n.originalEvent;return e.button==0&&!(vK&&xK&&e.ctrlKey)},fR=Cf,G9=function(n){return n.type=="pointermove"},yU=function(n){return n.type==Dt.SINGLECLICK},ck=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},SE=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},_U=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},wg=function(n){const e=n.originalEvent;return Ye(e!==void 0,56),e.pointerType=="mouse"},vU=function(n){const e=n.originalEvent;return Ye(e!==void 0,56),e.isPrimary&&e.button===0};class j9 extends No{constructor(e){super({stopDown:Cf}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:hR(ck,vU);this.condition_=e.onFocusOnly?hR(pU,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(uk(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();v3(s,a.getResolution()),IA(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),l=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Lf})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}const xU=j9;class B9 extends No{constructor(e){e=e||{},super({stopDown:Cf}),this.condition_=e.condition?e.condition:N9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!wg(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===ak)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return wg(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return wg(e)&&mU(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}const wU=B9;class V9 extends hp{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Pc([r])}getGeometry(){return this.geometry_}}const $9=V9,g1={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class XS extends Vi{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class W9 extends No{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.box_=new $9(e.className||"ol-dragbox"),this.minArea_=e.minArea!==void 0?e.minArea:64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition?e.condition:mU,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new XS(g1.BOXDRAG,e.coordinate,e))}handleUpEvent(e){this.box_.setMap(null);const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new XS(t?g1.BOXEND:g1.BOXCANCEL,e.coordinate,e)),!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new XS(g1.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}}const EU=W9;class H9 extends EU{constructor(e){e=e||{};const t=e.condition?e.condition:SE;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Lf})}}const TU=H9,dh={LEFT:37,UP:38,RIGHT:39,DOWN:40};class X9 extends hu{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return ck(t)&&_U(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Re.KEYDOWN){const i=e.originalEvent,r=i.keyCode;if(this.condition_(e)&&(r==dh.DOWN||r==dh.LEFT||r==dh.RIGHT||r==dh.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,u=0;r==dh.DOWN?u=-a:r==dh.LEFT?l=-a:r==dh.RIGHT?l=a:u=a;const h=[l,u];IA(h,o.getRotation()),M9(o,h,this.duration_),i.preventDefault(),t=!0}}return!t}}const SU=X9;class q9 extends hu{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:_U,this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Re.KEYDOWN||e.type==Re.KEYPRESS){const i=e.originalEvent,r=i.charCode;if(this.condition_(e)&&(r=="+".charCodeAt(0)||r=="-".charCodeAt(0))){const s=e.map,o=r=="+".charCodeAt(0)?this.delta_:-this.delta_,a=s.getView();lk(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const CU=q9;class K9 extends hu{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:Kg;this.condition_=e.onFocusOnly?hR(pU,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(e){if(!this.condition_(e)||e.type!==Re.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.coordinate);let s;if(e.type==Re.WHEEL&&(s=r.deltaY,mK&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=c3),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-ot(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),lk(t,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}const IU=K9;class Y9 extends No{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Cf),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==ak&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(uk(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}const RU=Y9;class Z9 extends No{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Cf),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,u=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(uk(this.targetPointers))),l.render(),u.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}const bU=Z9;function AU(n){n=n||{};const e=new Ei,t=new aU(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&e.push(new wU),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&e.push(new gU({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&e.push(new xU({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&e.push(new RU),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&e.push(new bU({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(e.push(new SU),e.push(new CU({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&e.push(new IU({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&e.push(new TU({duration:n.zoomDuration})),e}function kU(n){if(n instanceof cu){n.setMapInternal(null);return}n instanceof pp&&n.getLayers().forEach(kU)}function PU(n,e){if(n instanceof cu){n.setMapInternal(e);return}if(n instanceof pp){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)PU(t[i],e)}}let Q9=class extends to{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=J9(e);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:c3,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Hn(),this.pixelToCoordinateTransform_=Hn(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||dU(),this.interactions=t.interactions||AU({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new rk(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(hi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(hi.VIEW,this.handleViewChanged_),this.addChangeListener(hi.SIZE,this.handleSizeChanged_),this.addChangeListener(hi.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Fl)&&e.view.then(function(r){i.setView(new Fl(r))}),this.controls.addEventListener(Qn.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Qn.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Qn.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Qn.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Qn.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Qn.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){PU(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Fo,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof pp?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Fo,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(hi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Yh(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Tn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(hi.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ei){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Sn(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Tn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(hi.SIZE)}getView(){return this.get(hi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return y9(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Va(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Ha.POINTERDOWN||i===Re.WHEEL||i===Re.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target;if(this.overlayContainerStopEvent_.contains(o)||!(s===r?r.documentElement:s).contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[ln.ANIMATING]||o[ln.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_===!0?(this.hasListener(is.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(is.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new wh(oa.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new wh(oa.LOADSTART,this,e))));const i=this.postRenderFunctions_;for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)zt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Re.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Re.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,qx(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new c9(this)),this.mapBrowserEventHandler_=new lU(this,this.moveTolerance_);for(const s in Dt)this.mapBrowserEventHandler_.addEventListener(Dt[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Re.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Re.WHEEL,this.boundHandleBrowserEvent_,h3?{passive:!1}:!1);const i=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.targetChangeHandlerKeys_=[Ve(i,Re.KEYDOWN,this.handleBrowserEvent,this),Ve(i,Re.KEYPRESS,this.handleBrowserEvent,this)];const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(zt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(zt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Ve(e,Wh.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Ve(e,Re.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(zt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Yu("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Ve(e,Wh.PROPERTYCHANGE,this.render,this),Ve(e,Re.CHANGE,this.render,this),Ve(e,"addlayer",this.handleLayerAdd_,this),Ve(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){kU(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&YM(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:_g(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:be(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=_g(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!bf(this.previousExtent_)&&!Oo(s.extent,this.previousExtent_))&&(this.dispatchEvent(new wh(oa.MOVESTART,this,r)),this.previousExtent_=X0(this.previousExtent_)),this.previousExtent_&&!s.viewHints[ln.ANIMATING]&&!s.viewHints[ln.INTERACTING]&&!Oo(s.extent,this.previousExtent_)&&(this.dispatchEvent(new wh(oa.MOVEEND,this,s)),d3(s.extent,this.previousExtent_))),this.dispatchEvent(new wh(oa.POSTRENDER,this,s)),this.renderComplete_=this.hasListener(oa.LOADSTART)||this.hasListener(oa.LOADEND)||this.hasListener(is.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Yu("removelayer",t)),this.set(hi.LAYERGROUP,e)}setSize(e){this.set(hi.SIZE,e)}setTarget(e){this.set(hi.TARGET,e)}setView(e){if(!e||e instanceof Fl){this.set(hi.VIEW,e);return}this.set(hi.VIEW,new Fl);const t=this;e.then(function(i){t.setView(new Fl(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){const r=getComputedStyle(e),s=e.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=e.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(t=[s,o],!YM(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&E3("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!cl(t,i))&&(this.setSize(t),this.updateViewportSize_())}updateViewportSize_(){const e=this.getView();if(e){let t;const i=getComputedStyle(this.viewport_);i.width&&i.height&&(t=[parseInt(i.width,10),parseInt(i.height,10)]),e.setViewportSize(t)}}};function J9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new pp({layers:n.layers});t[hi.LAYERGROUP]=i,t[hi.TARGET]=n.target,t[hi.VIEW]=n.view instanceof Fl?n.view:new Fl;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ei(n.controls.slice()):(Ye(typeof n.controls.getArray=="function",47),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ei(n.interactions.slice()):(Ye(typeof n.interactions.getArray=="function",48),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Ei(n.overlays.slice()):(Ye(typeof n.overlays.getArray=="function",49),o=n.overlays):o=new Ei,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const hk=Q9,Mr={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class eZ extends to{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+LY,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Mr.ELEMENT,this.handleElementChanged),this.addChangeListener(Mr.MAP,this.handleMapChanged),this.addChangeListener(Mr.OFFSET,this.handleOffsetChanged),this.addChangeListener(Mr.POSITION,this.handlePositionChanged),this.addChangeListener(Mr.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(Mr.ELEMENT)}getId(){return this.id}getMap(){return this.get(Mr.MAP)||null}getOffset(){return this.get(Mr.OFFSET)}getPosition(){return this.get(Mr.POSITION)}getPositioning(){return this.get(Mr.POSITIONING)}handleElementChanged(){j3(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(qx(this.element),zt(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Ve(e,oa.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(Mr.ELEMENT,e)}setMap(e){this.set(Mr.MAP,e)}setOffset(e){this.set(Mr.OFFSET,e)}setPosition(e){this.set(Mr.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(Mr.POSITION))return;const i=this.getRect(t.getTargetElement(),t.getSize()),r=this.getElement(),s=this.getRect(r,[AY(r),kY(r)]);e=e||{};const o=e.margin===void 0?20:e.margin;if(!zr(i,s)){const a=s[0]-i[0],l=i[2]-s[2],u=s[1]-i[1],h=i[3]-s[3],p=[0,0];if(a<0?p[0]=a-o:l<0&&(p[0]=Math.abs(l)+o),u<0?p[1]=u-o:h<0&&(p[1]=Math.abs(h)+o),p[0]!==0||p[1]!==0){const m=t.getView().getCenterInternal(),y=t.getPixelFromCoordinateInternal(m);if(!y)return;const x=[y[0]+p[0],y[1]+p[1]],w=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(x),duration:w.duration,easing:w.easing})}}}getRect(e,t){const i=e.getBoundingClientRect(),r=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[r,s,r+t[0],s+t[1]]}setPositioning(e){this.set(Mr.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const i=e.getPixelFromCoordinate(t),r=e.getSize();this.updateRenderedPosition(i,r)}updateRenderedPosition(e,t){const i=this.element.style,r=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const o=Math.round(e[0]+r[0])+"px",a=Math.round(e[1]+r[1])+"px";let l="0%",u="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?l="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(l="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?u="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(u="-50%");const h=`translate(${l}, ${u}) translate(${o}, ${a})`;this.rendered.transform_!=h&&(this.rendered.transform_=h,i.transform=h)}getOptions(){return this.options}}const LU=eZ;class tZ{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return Ye(i!==void 0,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return Ye(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){if(this.containsKey(e))return this.entries_[e].value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Ye(!(e in this.entries_),16);const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}const fk=tZ;function l0(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function sl(n,e,t){return n+"/"+e+"/"+t}function u0(n){return sl(n[0],n[1],n[2])}function nZ(n){const[e,t,i]=n.substring(n.lastIndexOf("/")+1,n.length).split(",").map(Number);return sl(e,t,i)}function MU(n){return n.split("/").map(Number)}function dk(n){return(n[1]<<n[0])+n[2]}function iZ(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}class rZ extends fk{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(e){for(;this.canExpireCache()&&!(this.peekLast().getKey()in e);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const e=this.peekFirstKey(),i=MU(e)[0];this.forEach(r=>{r.tileCoord[0]!==i&&(this.remove(u0(r.tileCoord)),r.release())})}}const t_=rZ;class DU{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function kd(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new DU(n,e,t,i)}const CE=DU,mD=[];class sZ extends Mf{constructor(e,t,i,r){super(e,t,{transition:0}),this.context_={},this.executorGroups={},this.declutterExecutorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=r.bind(void 0,this),this.wrappedTileCoord=i}getContext(e){const t=be(e);return t in this.context_||(this.context_[t]=mn(1,1,mD)),this.context_[t]}hasContext(e){return be(e)in this.context_}getImage(e){return this.hasContext(e)?this.getContext(e).canvas:null}getReplayState(e){const t=be(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){for(const e in this.context_){const t=this.context_[e];Qh(t),mD.push(t.canvas),delete this.context_[e]}super.release()}}const FU=sZ;let oZ=class extends Mf{constructor(e,t,i,r,s,o){super(e,t,o),this.extent=null,this.format_=r,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=s,this.url_=i,this.key=i}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==ce.IDLE&&(this.setState(ce.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(ce.ERROR)}setFeatures(e){this.features_=e,this.setState(ce.LOADED)}setLoader(e){this.loader_=e}};const OU=oZ,aZ=Object.freeze(Object.defineProperty({__proto__:null,AssertionError:mA,Collection:Ei,Disposable:hp,Feature:pr,Geolocation:CY,Graticule:sU,Image:Z0,ImageBase:EE,ImageCanvas:TE,ImageTile:Xg,Kinetic:aU,Map:hk,MapBrowserEvent:Va,MapBrowserEventHandler:lU,MapEvent:wh,Object:to,Observable:yA,Overlay:LU,Tile:Mf,TileCache:t_,TileQueue:rk,TileRange:CE,VERSION:fK,VectorRenderTile:FU,VectorTile:OU,View:Fl,getUid:be},Symbol.toStringTag,{value:"Module"})),c0=34962,IE=34963,lZ=35040,gk=35044,ix=35048,uZ=5121,cZ=5123,hZ=5125,NU=5126,yD=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function zU(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!_K},e);const t=yD.length;for(let i=0;i<t;++i)try{const r=n.getContext(yD[i],e);if(r)return r}catch{}return null}const fZ={STATIC_DRAW:gk,STREAM_DRAW:lZ,DYNAMIC_DRAW:ix};class dZ{constructor(e,t){this.array=null,this.type=e,Ye(e===c0||e===IE,62),this.usage=t!==void 0?t:fZ.STATIC_DRAW}ofSize(e){this.array=new(qS(this.type))(e)}fromArray(e){this.array=qS(this.type).from(e)}fromArrayBuffer(e){this.array=new(qS(this.type))(e)}getType(){return this.type}getArray(){return this.array}getUsage(){return this.usage}getSize(){return this.array?this.array.length:0}}function qS(n){switch(n){case c0:return Float32Array;case IE:return Uint32Array;default:return Float32Array}}const _y=dZ,p1={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},gZ=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,pZ=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class mZ{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();const i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,e.vertexShader||gZ),t.compileShader(i);const r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,e.fragmentShader||pZ),t.compileShader(r),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,i),t.attachShader(this.renderTargetProgram_,r),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:t.getUniformLocation(this.renderTargetProgram_,o)})})}getGL(){return this.gl_}init(e){const t=this.getGL(),i=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,i[0],i[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==i[0]||this.renderTargetTextureSize_[1]!==i[1]){this.renderTargetTextureSize_=i;const r=0,s=t.RGBA,o=0,a=t.RGBA,l=t.UNSIGNED_BYTE,u=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,r,s,i[0],i[1],o,a,l,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}}apply(e,t,i,r){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=be(s.canvas);if(!e.renderTargets[l]){const u=s.getContextAttributes();u&&u.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT)),e.renderTargets[l]=!0}}s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),i&&i(s,e),s.drawArrays(s.TRIANGLES,0,6),r&&r(s,e)}getFrameBuffer(){return this.frameBuffer_}applyUniforms(e){const t=this.getGL();let i,r=1;this.uniforms_.forEach(function(s){if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${r}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,i.width,i.height,0,t.UNSIGNED_BYTE,new Uint8Array(i.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),t.uniform1i(s.location,r++);else if(Array.isArray(i))switch(i.length){case 2:t.uniform2f(s.location,i[0],i[1]);return;case 3:t.uniform3f(s.location,i[0],i[1],i[2]);return;case 4:t.uniform4f(s.location,i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&t.uniform1f(s.location,i)})}}const _D=mZ;function UU(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function rx(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const Hu={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",SIZE_PX:"u_sizePx",PIXEL_RATIO:"u_pixelRatio"},Eo={UNSIGNED_BYTE:uZ,UNSIGNED_SHORT:cZ,UNSIGNED_INT:hZ,FLOAT:NU},ow={};function vD(n){return"shared/"+n}let xD=0;function yZ(){const n="unique/"+xD;return xD+=1,n}function _Z(n){let e=ow[n];if(!e){const t=document.createElement("canvas");t.style.position="absolute",t.style.left="0",e={users:0,canvas:t},ow[n]=e}return e.users+=1,e.canvas}function vZ(n){const e=ow[n];if(!e||(e.users-=1,e.users>0))return;const t=e.canvas,r=zU(t).getExtension("WEBGL_lose_context");r&&r.loseContext(),delete ow[n]}class xZ extends hp{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?vD(e.canvasCacheKey):yZ(),this.canvas_=_Z(this.canvasCacheKey_),this.gl_=zU(this.canvas_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.canvas_.addEventListener(p1.LOST,this.boundHandleWebGLContextLost_),this.canvas_.addEventListener(p1.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Hn(),this.offsetScaleMatrix_=Hn(),this.tmpMat4_=UU(),this.uniformLocations_={},this.attribLocations_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms);const t=this.getGL();this.postProcessPasses_=e.postProcesses?e.postProcesses.map(function(i){return new _D({webGlContext:t,scaleRatio:i.scaleRatio,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,uniforms:i.uniforms})}):[new _D({webGlContext:t})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(e){this.uniforms_=[];for(const t in e)this.uniforms_.push({name:t,value:e[t]});this.uniformLocations_={}}canvasCacheKeyMatches(e){return this.canvasCacheKey_===vD(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}bindBuffer(e){const t=this.getGL(),i=be(e);let r=this.bufferCache_[i];if(!r){const s=t.createBuffer();r={buffer:e,webGlBuffer:s},this.bufferCache_[i]=r}t.bindBuffer(e.getType(),r.webGlBuffer)}flushBufferData(e){const t=this.getGL();this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=this.getGL(),i=be(e),r=this.bufferCache_[i];r&&!t.isContextLost()&&t.deleteBuffer(r.webGlBuffer),delete this.bufferCache_[i]}disposeInternal(){this.canvas_.removeEventListener(p1.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(p1.RESTORED,this.boundHandleWebGLContextRestored_),vZ(this.canvasCacheKey_),delete this.gl_,delete this.canvas_}prepareDraw(e,t){const i=this.getGL(),r=this.getCanvas(),s=e.size,o=e.pixelRatio;r.width=s[0]*o,r.height=s[1]*o,r.style.width=s[0]+"px",r.style.height=s[1]+"px";for(let a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA)}prepareDrawToRenderTarget(e,t,i){const r=this.getGL(),s=t.getSize();r.bindFramebuffer(r.FRAMEBUFFER,t.getFramebuffer()),r.viewport(0,0,s[0],s[1]),r.bindTexture(r.TEXTURE_2D,t.getTexture()),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,i?r.ZERO:r.ONE_MINUS_SRC_ALPHA)}drawElements(e,t){const i=this.getGL();this.getExtension("OES_element_index_uint");const r=i.UNSIGNED_INT,s=4,o=t-e,a=e*s;i.drawElements(i.TRIANGLES,o,r,a)}finalizeDraw(e,t,i){for(let r=0,s=this.postProcessPasses_.length;r<s;r++)r===s-1?this.postProcessPasses_[r].apply(e,null,t,i):this.postProcessPasses_[r].apply(e,this.postProcessPasses_[r+1])}getCanvas(){return this.canvas_}getGL(){return this.gl_}applyFrameState(e){const t=e.size,i=e.viewState.rotation,r=e.pixelRatio,s=pg(this.offsetScaleMatrix_);mg(s,2/t[0],2/t[1]);const o=pg(this.offsetRotateMatrix_);i!==0&&f3(o,-i),this.setUniformMatrixValue(Hu.OFFSET_SCALE_MATRIX,rx(this.tmpMat4_,s)),this.setUniformMatrixValue(Hu.OFFSET_ROTATION_MATRIX,rx(this.tmpMat4_,o)),this.setUniformFloatValue(Hu.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Hu.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Hu.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Hu.PIXEL_RATIO,r),this.setUniformFloatVec2(Hu.SIZE_PX,[t[0],t[1]])}applyUniforms(e){const t=this.getGL();let i,r=0;this.uniforms_.forEach(s=>{if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData)s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${r}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(!(i instanceof HTMLImageElement)||i.complete)&&s.prevValue!==i&&(s.prevValue=i,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)),t.uniform1i(this.getUniformLocation(s.name),r++);else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(s.name,rx(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:t.uniform2f(this.getUniformLocation(s.name),i[0],i[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),i[0],i[1],i[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&t.uniform1f(this.getUniformLocation(s.name),i)})}useProgram(e,t){this.getGL().useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},this.applyFrameState(t),this.applyUniforms(t)}compileShader(e,t){const i=this.getGL(),r=i.createShader(t);return i.shaderSource(r,e),i.compileShader(r),r}getProgram(e,t){const i=this.getGL(),r=this.compileShader(e,i.FRAGMENT_SHADER),s=this.compileShader(t,i.VERTEX_SHADER),o=i.createProgram();if(i.attachShader(o,r),i.attachShader(o,s),i.linkProgram(o),!i.getShaderParameter(r,i.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${i.getShaderInfoLog(r)}`;throw new Error(a)}if(i.deleteShader(r),!i.getShaderParameter(s,i.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${i.getShaderInfoLog(s)}`;throw new Error(a)}if(i.deleteShader(s),!i.getProgramParameter(o,i.LINK_STATUS)){const a=`GL program linking failed: ${i.getShaderInfoLog(s)}`;throw new Error(a)}return o}getUniformLocation(e){return this.uniformLocations_[e]===void 0&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]}getAttributeLocation(e){return this.attribLocations_[e]===void 0&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]}makeProjectionTransform(e,t){const i=e.size,r=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return pg(t),As(t,0,0,2/(s*i[0]),2/(s*i[1]),-r,-o[0],-o[1]),t}setUniformFloatValue(e,t){this.getGL().uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.getGL().uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.getGL().uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,t)}enableAttributeArray_(e,t,i,r,s){const o=this.getAttributeLocation(e);o<0||(this.getGL().enableVertexAttribArray(o),this.getGL().vertexAttribPointer(o,t,i,!1,r,s))}enableAttributes(e){const t=wZ(e);let i=0;for(let r=0;r<e.length;r++){const s=e[r];this.enableAttributeArray_(s.name,s.size,s.type||NU,t,i),i+=s.size*GU(s.type)}}handleWebGLContextLost(){If(this.bufferCache_),this.currentProgram_=null}handleWebGLContextRestored(){}createTexture(e,t,i){const r=this.getGL();i=i||r.createTexture();const s=0,o=r.RGBA,a=0,l=r.RGBA,u=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,i),t?r.texImage2D(r.TEXTURE_2D,s,o,l,u,t):r.texImage2D(r.TEXTURE_2D,s,o,e[0],e[1],a,l,u,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),i}}function wZ(n){let e=0;for(let t=0;t<n.length;t++){const i=n[t];e+=i.size*GU(i.type)}return e}function GU(n){switch(n){case Eo.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Eo.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Eo.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Eo.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class pk extends Y3{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=Hn(),this.pixelContext_=null,this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,e.addChangeListener(Zt.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const i=this.getLayer();if(i.hasListener(is.PRECOMPOSE)){const r=new yy(is.PRECOMPOSE,void 0,t,e);i.dispatchEvent(r)}}dispatchPostComposeEvent(e,t){const i=this.getLayer();if(i.hasListener(is.POSTCOMPOSE)){const r=new yy(is.POSTCOMPOSE,void 0,t,e);i.dispatchEvent(r)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,i=-1,r;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,u=l.getRenderer();if(!(u instanceof pk)){t=!0;continue}const h=l.getClassName();if((t||h!==r)&&(i+=1,t=!1),r=h,u===this)break}const s="map/"+e.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(s))&&(this.removeHelper(),this.helper=new xZ({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),r&&(this.helper.getCanvas().className=r),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){As(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);const s=new yy(e,this.inversePixelTransform_,i,t);r.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(is.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(is.POSTRENDER,e,t)}}const jU=pk,Na=new Uint8Array(4);class EZ{constructor(e,t){this.helper_=e;const i=e.getGL();this.texture_=i.createTexture(),this.framebuffer_=i.createFramebuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){cl(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return Na[0]=0,Na[1]=0,Na[2]=0,Na[3]=0,Na;this.readAll();const i=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return Na[0]=this.data_[i*4],Na[1]=this.data_[i*4+1],Na[2]=this.data_[i*4+2],Na[3]=this.data_[i*4+3],Na}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(e[0]*e[1]*4)}}const TZ=EZ,KS={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};var dR={},SZ={get exports(){return dR},set exports(n){dR=n}};SZ.exports=RE;dR.default=RE;function RE(n,e,t){t=t||2;var i=e&&e.length,r=i?e[0]*t:n.length,s=BU(n,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,h,p,m,y;if(i&&(s=AZ(n,e,s,t)),n.length>80*t){a=u=n[0],l=h=n[1];for(var x=t;x<r;x+=t)p=n[x],m=n[x+1],p<a&&(a=p),m<l&&(l=m),p>u&&(u=p),m>h&&(h=m);y=Math.max(u-a,h-l),y=y!==0?32767/y:0}return h0(s,o,t,a,l,y,0),o}function BU(n,e,t,i,r){var s,o;if(r===mR(n,e,t,i)>0)for(s=e;s<t;s+=i)o=wD(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=wD(s,n[s],n[s+1],o);return o&&bE(o,o.next)&&(d0(o),o=o.next),o}function Jh(n,e){if(!n)return n;e||(e=n);var t=n,i;do if(i=!1,!t.steiner&&(bE(t,t.next)||Wn(t.prev,t,t.next)===0)){if(d0(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function h0(n,e,t,i,r,s,o){if(n){!o&&s&&DZ(n,i,r,s);for(var a=n,l,u;n.prev!==n.next;){if(l=n.prev,u=n.next,s?IZ(n,i,r,s):CZ(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),d0(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=RZ(Jh(n),e,t),h0(n,e,t,i,r,s,2)):o===2&&bZ(n,e,t,i,r,s):h0(Jh(n),e,t,i,r,s,1);break}}}}function CZ(n){var e=n.prev,t=n,i=n.next;if(Wn(e,t,i)>=0)return!1;for(var r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,h=r<s?r<o?r:o:s<o?s:o,p=a<l?a<u?a:u:l<u?l:u,m=r>s?r>o?r:o:s>o?s:o,y=a>l?a>u?a:u:l>u?l:u,x=i.next;x!==e;){if(x.x>=h&&x.x<=m&&x.y>=p&&x.y<=y&&ig(r,a,s,l,o,u,x.x,x.y)&&Wn(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function IZ(n,e,t,i){var r=n.prev,s=n,o=n.next;if(Wn(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,u=o.x,h=r.y,p=s.y,m=o.y,y=a<l?a<u?a:u:l<u?l:u,x=h<p?h<m?h:m:p<m?p:m,w=a>l?a>u?a:u:l>u?l:u,R=h>p?h>m?h:m:p>m?p:m,E=gR(y,x,e,t,i),T=gR(w,R,e,t,i),I=n.prevZ,A=n.nextZ;I&&I.z>=E&&A&&A.z<=T;){if(I.x>=y&&I.x<=w&&I.y>=x&&I.y<=R&&I!==r&&I!==o&&ig(a,h,l,p,u,m,I.x,I.y)&&Wn(I.prev,I,I.next)>=0||(I=I.prevZ,A.x>=y&&A.x<=w&&A.y>=x&&A.y<=R&&A!==r&&A!==o&&ig(a,h,l,p,u,m,A.x,A.y)&&Wn(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;I&&I.z>=E;){if(I.x>=y&&I.x<=w&&I.y>=x&&I.y<=R&&I!==r&&I!==o&&ig(a,h,l,p,u,m,I.x,I.y)&&Wn(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;A&&A.z<=T;){if(A.x>=y&&A.x<=w&&A.y>=x&&A.y<=R&&A!==r&&A!==o&&ig(a,h,l,p,u,m,A.x,A.y)&&Wn(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function RZ(n,e,t){var i=n;do{var r=i.prev,s=i.next.next;!bE(r,s)&&VU(r,i,i.next,s)&&f0(r,s)&&f0(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),d0(i),d0(i.next),i=n=s),i=i.next}while(i!==n);return Jh(i)}function bZ(n,e,t,i,r,s){var o=n;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&NZ(o,a)){var l=$U(o,a);o=Jh(o,o.next),l=Jh(l,l.next),h0(o,e,t,i,r,s,0),h0(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function AZ(n,e,t,i){var r=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=BU(n,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(OZ(u));for(r.sort(kZ),s=0;s<r.length;s++)t=PZ(r[s],t);return t}function kZ(n,e){return n.x-e.x}function PZ(n,e){var t=LZ(n,e);if(!t)return e;var i=$U(t,n);return Jh(i,i.next),Jh(t,t.next)}function LZ(n,e){var t=e,i=n.x,r=n.y,s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var a=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,u=o.x,h=o.y,p=1/0,m;t=o;do i>=t.x&&t.x>=u&&i!==t.x&&ig(r<h?i:s,r,u,h,r<h?s:i,r,t.x,t.y)&&(m=Math.abs(r-t.y)/(i-t.x),f0(t,n)&&(m<p||m===p&&(t.x>o.x||t.x===o.x&&MZ(o,t)))&&(o=t,p=m)),t=t.next;while(t!==l);return o}function MZ(n,e){return Wn(n.prev,n,e.prev)<0&&Wn(e.next,n,n.next)<0}function DZ(n,e,t,i){var r=n;do r.z===0&&(r.z=gR(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,FZ(r)}function FZ(n){var e,t,i,r,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(o>1);return n}function gR(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function OZ(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function ig(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function NZ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!zZ(n,e)&&(f0(n,e)&&f0(e,n)&&UZ(n,e)&&(Wn(n.prev,n,e.prev)||Wn(n,e.prev,e))||bE(n,e)&&Wn(n.prev,n,n.next)>0&&Wn(e.prev,e,e.next)>0)}function Wn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function bE(n,e){return n.x===e.x&&n.y===e.y}function VU(n,e,t,i){var r=y1(Wn(n,e,t)),s=y1(Wn(n,e,i)),o=y1(Wn(t,i,n)),a=y1(Wn(t,i,e));return!!(r!==s&&o!==a||r===0&&m1(n,t,e)||s===0&&m1(n,i,e)||o===0&&m1(t,n,i)||a===0&&m1(t,e,i))}function m1(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function y1(n){return n>0?1:n<0?-1:0}function zZ(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&VU(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function f0(n,e){return Wn(n.prev,n,n.next)<0?Wn(n,e,n.next)>=0&&Wn(n,n.prev,e)>=0:Wn(n,e,n.prev)<0||Wn(n,n.next,e)<0}function UZ(n,e){var t=n,i=!1,r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function $U(n,e){var t=new pR(n.i,n.x,n.y),i=new pR(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function wD(n,e,t,i){var r=new pR(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function d0(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function pR(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}RE.deviation=function(n,e,t,i){var r=e&&e.length,s=r?e[0]*t:n.length,o=Math.abs(mR(n,0,s,t));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*t,h=a<l-1?e[a+1]*t:n.length;o-=Math.abs(mR(n,u,h,t))}var p=0;for(a=0;a<i.length;a+=3){var m=i[a]*t,y=i[a+1]*t,x=i[a+2]*t;p+=Math.abs((n[m]-n[x])*(n[y+1]-n[m+1])-(n[m]-n[y])*(n[x+1]-n[m+1]))}return o===0&&p===0?0:Math.abs((p-o)/o)};function mR(n,e,t,i){for(var r=0,s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}RE.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,r=0;r<n.length;r++){for(var s=0;s<n[r].length;s++)for(var o=0;o<e;o++)t.vertices.push(n[r][s][o]);r>0&&(i+=n[r-1].length,t.holes.push(i))}return t};function GZ(n,e){e=e||[];const t=256,i=t-1;return e[0]=Math.floor(n/t/t/t)/i,e[1]=Math.floor(n/t/t)%t/i,e[2]=Math.floor(n/t)%t/i,e[3]=n%t/i,e}function jZ(n){let e=0;const t=256,i=t-1;return e+=Math.round(n[0]*t*t*t*i),e+=Math.round(n[1]*t*t*i),e+=Math.round(n[2]*t*i),e+=Math.round(n[3]*i),e}function BZ(){const n='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS",r={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:\'`renderMode` must be `"hybrid"` or `"vector"`\',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class o extends Error{constructor(e){const t=r[e];super(t),this.code=e,this.name="AssertionError",this.message=t}}var i=o;function a(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function s(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new i(t)}(0!==n,32);const o=t[0],a=t[1],s=t[2],u=t[3],f=t[4],x=t[5];return e[0]=u/n,e[1]=-a/n,e[2]=-s/n,e[3]=o/n,e[4]=(s*x-u*f)/n,e[5]=-(o*x-a*f)/n,e}new Array(6);var u={};function f(e,t,n){n=n||2;var r,o,i,a,s,u,f,l=t&&t.length,c=l?t[0]*n:e.length,v=x(e,0,c,n,!0),d=[];if(!v||v.next===v.prev)return d;if(l&&(v=function(e,t,n,r){var o,i,a,s=[];for(o=0,i=t.length;o<i;o++)(a=x(e,t[o]*r,o<i-1?t[o+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(w(a));for(s.sort(p),o=0;o<s.length;o++)n=b(s[o],n);return n}(e,t,v,n)),e.length>80*n){r=i=e[0],o=a=e[1];for(var y=n;y<c;y+=n)(s=e[y])<r&&(r=s),(u=e[y+1])<o&&(o=u),s>i&&(i=s),u>a&&(a=u);f=0!==(f=Math.max(i-r,a-o))?32767/f:0}return h(v,d,n,r,o,f,0),d}function x(e,t,n,r,o){var i,a;if(o===B(e,t,n,r)>0)for(i=t;i<n;i+=r)a=k(i,e[i],e[i+1],a);else for(i=n-r;i>=t;i-=r)a=k(i,e[i],e[i+1],a);return a&&M(a,a.next)&&(z(a),a=a.next),a}function l(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!M(r,r.next)&&0!==Z(r.prev,r,r.next))r=r.next;else{if(z(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function h(e,t,n,r,o,i,a){if(e){!a&&i&&function(e,t,n,r){var o=e;do{0===o.z&&(o.z=m(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,r,o,i,a,s,u,f=1;do{for(n=e,e=null,i=null,a=0;n;){for(a++,r=n,s=0,t=0;t<f&&(s++,r=r.nextZ);t++);for(u=f;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(o=n,n=n.nextZ,s--):(o=r,r=r.nextZ,u--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,f*=2}while(a>1)}(o)}(e,r,o,i);for(var s,u,f=e;e.prev!==e.next;)if(s=e.prev,u=e.next,i?v(e,r,o,i):c(e))t.push(s.i/n|0),t.push(e.i/n|0),t.push(u.i/n|0),z(e),e=u.next,f=u.next;else if((e=u)===f){a?1===a?h(e=d(l(e),t,n),t,n,r,o,i,2):2===a&&y(e,t,n,r,o,i):h(l(e),t,n,r,o,i,1);break}}}function c(e){var t=e.prev,n=e,r=e.next;if(Z(t,n,r)>=0)return!1;for(var o=t.x,i=n.x,a=r.x,s=t.y,u=n.y,f=r.y,x=o<i?o<a?o:a:i<a?i:a,l=s<u?s<f?s:f:u<f?u:f,h=o>i?o>a?o:a:i>a?i:a,c=s>u?s>f?s:f:u>f?u:f,v=r.next;v!==t;){if(v.x>=x&&v.x<=h&&v.y>=l&&v.y<=c&&A(o,s,i,u,a,f,v.x,v.y)&&Z(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function v(e,t,n,r){var o=e.prev,i=e,a=e.next;if(Z(o,i,a)>=0)return!1;for(var s=o.x,u=i.x,f=a.x,x=o.y,l=i.y,h=a.y,c=s<u?s<f?s:f:u<f?u:f,v=x<l?x<h?x:h:l<h?l:h,d=s>u?s>f?s:f:u>f?u:f,y=x>l?x>h?x:h:l>h?l:h,p=m(c,v,t,n,r),b=m(d,y,t,n,r),g=e.prevZ,w=e.nextZ;g&&g.z>=p&&w&&w.z<=b;){if(g.x>=c&&g.x<=d&&g.y>=v&&g.y<=y&&g!==o&&g!==a&&A(s,x,u,l,f,h,g.x,g.y)&&Z(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,w.x>=c&&w.x<=d&&w.y>=v&&w.y<=y&&w!==o&&w!==a&&A(s,x,u,l,f,h,w.x,w.y)&&Z(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;g&&g.z>=p;){if(g.x>=c&&g.x<=d&&g.y>=v&&g.y<=y&&g!==o&&g!==a&&A(s,x,u,l,f,h,g.x,g.y)&&Z(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;w&&w.z<=b;){if(w.x>=c&&w.x<=d&&w.y>=v&&w.y<=y&&w!==o&&w!==a&&A(s,x,u,l,f,h,w.x,w.y)&&Z(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function d(e,t,n){var r=e;do{var o=r.prev,i=r.next.next;!M(o,i)&&F(o,r,r.next,i)&&S(o,i)&&S(i,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(i.i/n|0),z(r),z(r.next),r=e=i),r=r.next}while(r!==e);return l(r)}function y(e,t,n,r,o,i){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&E(a,s)){var u=U(a,s);return a=l(a,a.next),u=l(u,u.next),h(a,t,n,r,o,i,0),void h(u,t,n,r,o,i,0)}s=s.next}a=a.next}while(a!==e)}function p(e,t){return e.x-t.x}function b(e,t){var n=function(e,t){var n,r=t,o=e.x,i=e.y,a=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=o&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===o))return n}r=r.next}while(r!==t);if(!n)return null;var u,f=n,x=n.x,l=n.y,h=1/0;r=n;do{o>=r.x&&r.x>=x&&o!==r.x&&A(i<l?o:a,i,x,l,i<l?a:o,i,r.x,r.y)&&(u=Math.abs(i-r.y)/(o-r.x),S(r,e)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&g(n,r)))&&(n=r,h=u)),r=r.next}while(r!==f);return n}(e,t);if(!n)return t;var r=U(n,e);return l(r,r.next),l(n,n.next)}function g(e,t){return Z(e.prev,e,t.prev)<0&&Z(t.next,e,e.next)<0}function m(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function w(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function A(e,t,n,r,o,i,a,s){return(o-a)*(t-s)>=(e-a)*(i-s)&&(e-a)*(r-s)>=(n-a)*(t-s)&&(n-a)*(i-s)>=(o-a)*(r-s)}function E(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&F(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Z(e.prev,e,t.prev)||Z(e,t.prev,t))||M(e,t)&&Z(e.prev,e,e.next)>0&&Z(t.prev,t,t.next)>0)}function Z(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function M(e,t){return e.x===t.x&&e.y===t.y}function F(e,t,n,r){var o=I(Z(e,t,n)),i=I(Z(e,t,r)),a=I(Z(n,r,e)),s=I(Z(n,r,t));return o!==i&&a!==s||(!(0!==o||!T(e,n,t))||(!(0!==i||!T(e,r,t))||(!(0!==a||!T(n,e,r))||!(0!==s||!T(n,t,r)))))}function T(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function I(e){return e>0?1:e<0?-1:0}function S(e,t){return Z(e.prev,e,e.next)<0?Z(e,t,e.next)>=0&&Z(e,e.prev,t)>=0:Z(e,t,e.prev)<0||Z(e,e.next,t)<0}function U(e,t){var n=new R(e.i,e.x,e.y),r=new R(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function k(e,t,n,r){var o=new R(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function R(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function B(e,t,n,r){for(var o=0,i=t,a=n-r;i<n;i+=r)o+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;return o}({get exports(){return u},set exports(e){u=e}}).exports=f,u.default=f,f.deviation=function(e,t,n,r){var o=t&&t.length,i=o?t[0]*n:e.length,a=Math.abs(B(e,0,i,n));if(o)for(var s=0,u=t.length;s<u;s++){var f=t[s]*n,x=s<u-1?t[s+1]*n:e.length;a-=Math.abs(B(e,f,x,n))}var l=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,c=r[s+1]*n,v=r[s+2]*n;l+=Math.abs((e[h]-e[v])*(e[c+1]-e[h+1])-(e[h]-e[c])*(e[v+1]-e[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},f.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var a=0;a<t;a++)n.vertices.push(e[o][i][a]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};const N=[],P={vertexPosition:0,indexPosition:0};function C(e,t,n,r,o){e[t+0]=n,e[t+1]=r,e[t+2]=o}function _(e,t,n,r,o,i){const a=3+o,s=e[t+0],u=e[t+1],f=N;f.length=o;for(let n=0;n<f.length;n++)f[n]=e[t+2+n];let x=i?i.vertexPosition:0,l=i?i.indexPosition:0;const h=x/a;return C(n,x,s,u,0),f.length&&n.set(f,x+3),x+=a,C(n,x,s,u,1),f.length&&n.set(f,x+3),x+=a,C(n,x,s,u,2),f.length&&n.set(f,x+3),x+=a,C(n,x,s,u,3),f.length&&n.set(f,x+3),x+=a,r[l++]=h,r[l++]=h+1,r[l++]=h+3,r[l++]=h+1,r[l++]=h+2,r[l++]=h+3,P.vertexPosition=x,P.indexPosition=l,P}function q(e,t,n,r,o,i,s,u,f,x){const l=5+u.length,h=i.length/l,c=[e[t+0],e[t+1]],v=[e[n],e[n+1]],d=a(x,[...c]),y=a(x,[...v]);function p(e,t,n){const r=1e4;return Math.round(1500*t)+Math.round(1500*n)*r+e*r*r}function b(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),o=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-o[1],o[0]],a=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),s=[(n[0]-e[0])/a,(n[1]-e[1])/a],u=0===r||0===a?0:Math.acos((f=s[0]*o[0]+s[1]*o[1],x=-1,l=1,Math.min(Math.max(f,x),l)));var f,x,l;return s[0]*i[0]+s[1]*i[1]>0?u:2*Math.PI-u}const g=null!==o;let m=0,w=0;if(null!==r){m=b(d,y,a(x,[...[e[r],e[r+1]]]))}if(g){w=b(y,d,a(x,[...[e[o],e[o+1]]]))}i.push(c[0],c[1],v[0],v[1],p(0,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(1,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(2,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(3,m,w)),i.push(...u),s.push(h,h+1,h+2,h+1,h+3,h+2)}function L(e,t,n,r,o){const i=2+o;let a=t;const s=e.slice(a,a+o);a+=o;const f=e[a++];let x=0;const l=new Array(f-1);for(let t=0;t<f;t++)x+=e[a++],t<f-1&&(l[t]=x);const h=e.slice(a,a+2*x),c=u(h,l,2);for(let e=0;e<c.length;e++)r.push(c[e]+n.length/i);for(let e=0;e<h.length;e+=2)n.push(h[e],h[e+1],...s);return a+2*x}const G=self;G.onmessage=r=>{const o=r.data;switch(o.type){case t:{const e=3,t=2,n=o.customAttributesCount,r=t+n,i=new Float32Array(o.renderInstructions),a=i.length/r,s=4*a*(n+e),u=new Uint32Array(6*a),f=new Float32Array(s);let x;for(let e=0;e<i.length;e+=r)x=_(i,e,f,u,n,x);const l=Object.assign({vertexBuffer:f.buffer,indexBuffer:u.buffer,renderInstructions:i.buffer},o);G.postMessage(l,[f.buffer,u.buffer,i.buffer]);break}case n:{const e=[],t=[],n=o.customAttributesCount,r=2,i=new Float32Array(o.renderInstructions);let a=0;const u=o.renderInstructionsTransform,f=[1,0,0,1,0,0];let x,l;for(s(f,u);a<i.length;){l=Array.from(i.slice(a,a+n)),a+=n,x=i[a++];for(let n=0;n<x-1;n++)q(i,a+n*r,a+(n+1)*r,n>0?a+(n-1)*r:null,n<x-2?a+(n+2)*r:null,e,t,l,0,f);a+=x*r}const h=Uint32Array.from(t),c=Float32Array.from(e),v=Object.assign({vertexBuffer:c.buffer,indexBuffer:h.buffer,renderInstructions:i.buffer},o);G.postMessage(v,[c.buffer,h.buffer,i.buffer]);break}case e:{const e=[],t=[],n=o.customAttributesCount,r=new Float32Array(o.renderInstructions);let i=0;for(;i<r.length;)i=L(r,i,e,t,n);const a=Uint32Array.from(t),s=Float32Array.from(e),u=Object.assign({vertexBuffer:s.buffer,indexBuffer:a.buffer,renderInstructions:r.buffer},o);G.postMessage(u,[s.buffer,a.buffer,r.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}class VZ extends jU{constructor(e,t){const i=t.uniforms||{},r=Hn();i[Hu.PROJECTION_MATRIX]=r,super(e,{uniforms:i,postProcesses:t.postProcesses}),this.ready=!1,this.sourceRevision_=-1,this.verticesBuffer_=new _y(c0,ix),this.hitVerticesBuffer_=new _y(c0,ix),this.indicesBuffer_=new _y(IE,ix),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.program_,this.hitDetectionEnabled_=!!(t.hitFragmentShader&&t.hitVertexShader),this.hitVertexShader_=t.hitVertexShader,this.hitFragmentShader_=t.hitFragmentShader,this.hitProgram_;const s=t.attributes?t.attributes.map(function(a){return{name:"a_"+a.name,size:1,type:Eo.FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:Eo.FLOAT},{name:"a_index",size:1,type:Eo.FLOAT}].concat(s),this.hitDetectionAttributes=[{name:"a_position",size:2,type:Eo.FLOAT},{name:"a_index",size:1,type:Eo.FLOAT},{name:"a_hitColor",size:4,type:Eo.FLOAT},{name:"a_featureUid",size:1,type:Eo.FLOAT}].concat(s),this.customAttributes=t.attributes?t.attributes:[],this.previousExtent_=xr(),this.currentTransform_=r,this.renderTransform_=Hn(),this.invertRenderTransform_=Hn(),this.renderInstructions_=new Float32Array(0),this.hitRenderInstructions_=new Float32Array(0),this.hitRenderTarget_,this.generateBuffersRun_=0,this.worker_=BZ(),this.worker_.addEventListener("message",a=>{const l=a.data;if(l.type===KS.GENERATE_POINT_BUFFERS){const u=l.projectionTransform;l.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(l.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(l.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(l.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=u,H0(this.invertRenderTransform_,this.renderTransform_),l.hitDetection?this.hitRenderInstructions_=new Float32Array(a.data.renderInstructions):(this.renderInstructions_=new Float32Array(a.data.renderInstructions),l.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;const o=this.getLayer().getSource();this.sourceListenKeys_=[Ve(o,Fi.ADDFEATURE,this.handleSourceFeatureAdded_,this),Ve(o,Fi.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),Ve(o,Fi.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),Ve(o,Fi.CLEAR,this.handleSourceFeatureClear_,this)],o.forEachFeature(a=>{this.featureCache_[be(a)]={feature:a,properties:a.getProperties(),geometry:a.getGeometry()},this.featureCount_++})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new TZ(this.helper))}handleSourceFeatureAdded_(e){const t=e.feature;this.featureCache_[be(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++}handleSourceFeatureChanged_(e){const t=e.feature;this.featureCache_[be(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}}handleSourceFeatureDelete_(e){const t=e.feature;delete this.featureCache_[be(t)],this.featureCount_--}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const i=e.viewState.projection,o=this.getLayer().getSource().getWrapX()&&i.canWrapX(),a=i.getExtent(),l=e.extent,u=o?gt(a):null,h=o?Math.ceil((l[2]-a[2])/u)+1:1,p=o?Math.floor((l[0]-a[0])/u):0;let m=p;const y=this.indicesBuffer_.getSize();do this.helper.makeProjectionTransform(e,this.currentTransform_),jx(this.currentTransform_,m*u,0),qh(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.drawElements(0,y);while(++m<h);this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const x=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(e,p,h,u),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),x}prepareFrameInternal(e){const t=this.getLayer(),i=t.getSource(),r=e.viewState,s=!e.viewHints[ln.ANIMATING]&&!e.viewHints[ln.INTERACTING],o=!Oo(this.previousExtent_,e.extent),a=this.sourceRevision_<i.getRevision();if(a&&(this.sourceRevision_=i.getRevision()),s&&(o||a)){const l=r.projection,u=r.resolution,h=t instanceof Q0?t.getRenderBuffer():0,p=Rs(e.extent,h*u);i.loadFeatures(p,u,l),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(e){const t=Hn();this.helper.makeProjectionTransform(e,t);const i=(2+this.customAttributes.length)*this.featureCount_;if((!this.renderInstructions_||this.renderInstructions_.length!==i)&&(this.renderInstructions_=new Float32Array(i)),this.hitDetectionEnabled_){const m=(7+this.customAttributes.length)*this.featureCount_;(!this.hitRenderInstructions_||this.hitRenderInstructions_.length!==m)&&(this.hitRenderInstructions_=new Float32Array(m))}let r,s;const o=[],a=[];let l=0,u=0,h;for(const m in this.featureCache_){if(r=this.featureCache_[m],s=r.geometry,!s||s.getType()!=="Point")continue;o[0]=s.getFlatCoordinates()[0],o[1]=s.getFlatCoordinates()[1],Tn(t,o),h=GZ(u+6,a),this.renderInstructions_[l++]=o[0],this.renderInstructions_[l++]=o[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=o[0],this.hitRenderInstructions_[u++]=o[1],this.hitRenderInstructions_[u++]=h[0],this.hitRenderInstructions_[u++]=h[1],this.hitRenderInstructions_[u++]=h[2],this.hitRenderInstructions_[u++]=h[3],this.hitRenderInstructions_[u++]=Number(m));let y;for(let x=0;x<this.customAttributes.length;x++)y=this.customAttributes[x].callback(r.feature,r.properties),this.renderInstructions_[l++]=y,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=y)}const p={id:0,type:KS.GENERATE_POINT_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(p.projectionTransform=t,p.generateBuffersRun=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(p,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){const m={id:0,type:KS.GENERATE_POINT_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};m.projectionTransform=t,m.hitDetection=!0,this.worker_.postMessage(m,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}}forEachFeatureAtCoordinate(e,t,i,r,s){if(Ye(this.hitDetectionEnabled_,66),!this.hitRenderInstructions_)return;const o=Tn(t.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],u=jZ(l),h=this.hitRenderInstructions_[u],p=Math.floor(h).toString(),y=this.getLayer().getSource().getFeatureByUid(p);if(y)return r(y,this.getLayer(),null)}renderHitDetection(e,t,i,r){if(!this.hitVerticesBuffer_.getSize())return;let s=t;this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_,e),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),jx(this.currentTransform_,s*r,0),qh(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e);const o=this.indicesBuffer_.getSize();this.helper.drawElements(0,o)}while(++s<i)}disposeInternal(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(e){zt(e)}),this.sourceListenKeys_=null,super.disposeInternal()}}const WU=VZ,na={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},$Z=["#00f","#0ff","#0f0","#ff0","#f00"];class WZ extends Q0{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.gradient_=null,this.addChangeListener(na.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:$Z),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const i=e.weight?e.weight:"weight";typeof i=="string"?this.weightFunction_=function(r){return r.get(i)}:this.weightFunction_=i,this.setRenderOrder(null)}getBlur(){return this.get(na.BLUR)}getGradient(){return this.get(na.GRADIENT)}getRadius(){return this.get(na.RADIUS)}handleGradientChanged_(){this.gradient_=HZ(this.getGradient())}setBlur(e){this.set(na.BLUR,e)}setGradient(e){this.set(na.GRADIENT,e)}setRadius(e){this.set(na.RADIUS,e)}createRenderer(){return new WU(this,{className:this.getClassName(),attributes:[{name:"weight",callback:e=>{const t=this.weightFunction_(e);return t!==void 0?ot(t,0,1):1}}],vertexShader:`
        precision mediump float;
        uniform mat4 u_projectionMatrix;
        uniform mat4 u_offsetScaleMatrix;
        uniform float u_size;
        attribute vec2 a_position;
        attribute float a_index;
        attribute float a_weight;

        varying vec2 v_texCoord;
        varying float v_weight;

        void main(void) {
          mat4 offsetMatrix = u_offsetScaleMatrix;
          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;
          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;
          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;
          v_texCoord = vec2(u, v);
          v_weight = a_weight;
        }`,fragmentShader:`
        precision mediump float;
        uniform float u_blurSlope;

        varying vec2 v_texCoord;
        varying float v_weight;

        void main(void) {
          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);
          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;
          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;
          float alpha = smoothstep(0.0, 1.0, value) * v_weight;
          gl_FragColor = vec4(alpha, alpha, alpha, alpha);
        }`,hitVertexShader:`
        precision mediump float;
        uniform mat4 u_projectionMatrix;
        uniform mat4 u_offsetScaleMatrix;
        uniform float u_size;
        attribute vec2 a_position;
        attribute float a_index;
        attribute float a_weight;
        attribute vec4 a_hitColor;

        varying vec2 v_texCoord;
        varying float v_weight;
        varying vec4 v_hitColor;

        void main(void) {
          mat4 offsetMatrix = u_offsetScaleMatrix;
          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;
          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;
          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;
          v_texCoord = vec2(u, v);
          v_hitColor = a_hitColor;
          v_weight = a_weight;
        }`,hitFragmentShader:`
        precision mediump float;
        uniform float u_blurSlope;

        varying vec2 v_texCoord;
        varying float v_weight;
        varying vec4 v_hitColor;

        void main(void) {
          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);
          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;
          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;
          float alpha = smoothstep(0.0, 1.0, value) * v_weight;
          if (alpha < 0.05) {
            discard;
          }

          gl_FragColor = v_hitColor;
        }`,uniforms:{u_size:()=>(this.get(na.RADIUS)+this.get(na.BLUR))*2,u_blurSlope:()=>this.get(na.RADIUS)/Math.max(1,this.get(na.BLUR))},postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}renderDeclutter(){}}function HZ(n){const i=mn(1,256),r=i.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let o=0,a=n.length;o<a;++o)r.addColorStop(o*s,n[o]);return i.fillStyle=r,i.fillRect(0,0,1,256),i.canvas}const XZ=WZ;class qZ extends cu{constructor(e){e=e||{},super(e)}}const KZ=qZ;class YZ extends tk{constructor(e){super(e),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],i=e.pixelRatio,r=e.viewState,s=r.resolution,o=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=tr(l,bo(t.extent,r.projection))),!a[ln.ANIMATING]&&!a[ln.INTERACTING]&&!bf(l))if(o){const u=r.projection,h=o.getImage(l,s,i,u);h&&(this.loadImage(h)?this.image_=h:h.getState()===st.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Tn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!la(s,r))return null;const o=this.image_.getExtent(),a=this.image_.getImage(),l=gt(o),u=Math.floor(a.width*((r[0]-o[0])/l));if(u<0||u>=a.width)return null;const h=rn(o),p=Math.floor(a.height*((o[3]-r[1])/h));return p<0||p>=a.height?null:this.getImageData(a,u,p)}renderFrame(e,t){const i=this.image_,r=i.getExtent(),s=i.getResolution(),o=i.getPixelRatio(),a=e.layerStatesArray[e.layerIndex],l=e.pixelRatio,u=e.viewState,h=u.center,p=u.resolution,m=l*s/(p*o),y=e.extent,x=u.resolution,w=u.rotation,R=Math.round(gt(y)/x*l),E=Math.round(rn(y)/x*l);As(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/l,1/l,w,-R/2,-E/2),H0(this.inversePixelTransform,this.pixelTransform);const T=wA(this.pixelTransform);this.useContainer(t,T,this.getBackground(e));const I=this.context,A=I.canvas;A.width!=R||A.height!=E?(A.width=R,A.height=E):this.containerReused||I.clearRect(0,0,R,E);let L=!1,F=!0;if(a.extent){const J=bo(a.extent,u.projection);F=un(J,e.extent),L=F&&!zr(J,e.extent),L&&this.clipUnrotated(I,e,J)}const O=i.getImage(),N=As(this.tempTransform,R/2,E/2,m,m,0,o*(r[0]-h[0])/s,o*(h[1]-r[3])/s);this.renderedResolution=s*l/o;const B=O.width*N[0],V=O.height*N[3];if(this.getLayer().getSource().getInterpolate()||(I.imageSmoothingEnabled=!1),this.preRender(I,e),F&&B>=.5&&V>=.5){const J=N[4],ge=N[5],he=a.opacity;let de;he!==1&&(de=I.globalAlpha,I.globalAlpha=he),I.drawImage(O,0,0,+O.width,+O.height,J,ge,B,V),he!==1&&(I.globalAlpha=de)}return this.postRender(I,e),L&&I.restore(),I.imageSmoothingEnabled=!0,T!==A.style.transform&&(A.style.transform=T),this.container}}const HU=YZ;class ZZ extends KZ{constructor(e){super(e)}createRenderer(){return new HU(this)}getData(e){return super.getData(e)}}const XU=ZZ;class QZ{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let i=t.dataProjection?_t(t.dataProjection):this.readProjection(e);t.extent&&i&&i.getUnits()==="tile-pixels"&&(i=_t(i),i.setWorldExtent(t.extent)),t={dataProjection:i,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},e)}getType(){return et()}readFeature(e,t){return et()}readFeatures(e,t){return et()}readGeometry(e,t){return et()}readProjection(e){return et()}writeFeature(e,t){return et()}writeFeatures(e,t){return et()}writeGeometry(e,t){return et()}}const qU=QZ;function mk(n,e,t){const i=t?_t(t.featureProjection):null,r=t?_t(t.dataProjection):null;let s;if(i&&r&&!rs(i,r)?s=(e?n.clone():n).transform(e?i:r,e?r:i):s=n,e&&t&&t.decimals!==void 0){const o=Math.pow(10,t.decimals),a=function(l){for(let u=0,h=l.length;u<h;++u)l[u]=Math.round(l[u]*o)/o;return l};s===n&&(s=n.clone()),s.applyTransform(a)}return s}class aw extends uu{constructor(e,t,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&i)this.setFlatCoordinates(t,e),this.ends_=i;else{let r=this.getLayout();const s=e,o=[],a=[];for(let l=0,u=s.length;l<u;++l){const h=s[l];l===0&&(r=h.getLayout()),qs(o,h.getFlatCoordinates()),a.push(o.length)}this.setFlatCoordinates(r,o),this.ends_=a}}appendLineString(e){this.flatCoordinates?qs(this.flatCoordinates,e.getFlatCoordinates().slice()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new aw(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Rf(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(MA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),FA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,i,r))}getCoordinateAtM(e,t,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,i=i!==void 0?i:!1,IY(this.flatCoordinates,0,this.ends_,this.stride,e,t,i))}getCoordinates(){return Zy(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new da(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o],u=new da(e.slice(s,l),i);r.push(u),s=l}return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],u=Hx(t,i,l,s,.5);qs(e,u),i=l}return e}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=lY(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,i),new aw(t,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(e){return gY(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=OA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}const n_=aw;class yk extends uu{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){this.flatCoordinates?qs(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.changed()}clone(){const e=new yk(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Rf(this.getExtent(),e,t))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const u=Wl(e,t,s[a],s[a+1]);if(u<r){r=u;for(let h=0;h<o;++h)i[h]=s[a+h];i.length=o}}return r}getCoordinates(){return sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return e<0||t<=e?null:new bs(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,i=this.stride,r=[];for(let s=0,o=e.length;s<o;s+=i){const a=new bs(e.slice(s,s+i),t);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,i=this.stride;for(let r=0,s=t.length;r<s;r+=i){const o=t[r],a=t[r+1];if(EA(e,o,a))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xE(this.flatCoordinates,0,e,this.stride),this.changed()}}const i_=yk;function KU(n,e,t,i){const r=[];let s=xr();for(let o=0,a=t.length;o<a;++o){const l=t[o];s=TA(n,e,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return r}class lw extends uu{constructor(e,t,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){let r=this.getLayout();const s=e,o=[],a=[];for(let l=0,u=s.length;l<u;++l){const h=s[l];l===0&&(r=h.getLayout());const p=o.length,m=h.getEnds();for(let y=0,x=m.length;y<x;++y)m[y]+=p;qs(o,h.getFlatCoordinates()),a.push(m)}t=r,e=o,i=a}t!==void 0&&i?(this.setFlatCoordinates(t,e),this.endss_=i):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;qs(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let r=0,s=t.length;r<s;++r)t[r]+=i}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let r=0;r<e;++r)t[r]=this.endss_[r].slice();const i=new lw(this.flatCoordinates.slice(),this.layout,t);return i.applyProperties(this),i}closestPointXY(e,t,i,r){return r<Rf(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sY(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),oY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return dY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return hY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),qM(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,rR(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=KU(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=A3(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new i_(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;yY(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=qM(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=cY(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,i),new lw(t,"XY",i)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const i=this.endss_[e].slice(),r=i[i.length-1];if(t!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=t;return new Pc(this.flatCoordinates.slice(t,r),this.layout,i)}getPolygons(){const e=this.layout,t=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),u=l[l.length-1];if(s!==0)for(let p=0,m=l.length;p<m;++p)l[p]-=s;const h=new Pc(t.slice(s,u),e,l);r.push(h),s=u}return r}getType(){return"MultiPolygon"}intersectsExtent(e){return pY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=aY(this.flatCoordinates,0,e,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const r_=lw;var _k={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */_k.read=function(n,e,t,i,r){var s,o,a=r*8-i-1,l=(1<<a)-1,u=l>>1,h=-7,p=t?r-1:0,m=t?-1:1,y=n[e+p];for(p+=m,s=y&(1<<-h)-1,y>>=-h,h+=a;h>0;s=s*256+n[e+p],p+=m,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=i;h>0;o=o*256+n[e+p],p+=m,h-=8);if(s===0)s=1-u;else{if(s===l)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(y?-1:1)*o*Math.pow(2,s-i)};_k.write=function(n,e,t,i,r,s){var o,a,l,u=s*8-r-1,h=(1<<u)-1,p=h>>1,m=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:s-1,x=i?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+p>=1?e+=m/l:e+=m*Math.pow(2,1-p),e*l>=2&&(o++,l/=2),o+p>=h?(a=0,o=h):o+p>=1?(a=(e*l-1)*Math.pow(2,r),o=o+p):(a=e*Math.pow(2,p-1)*Math.pow(2,r),o=0));r>=8;n[t+y]=a&255,y+=x,a/=256,r-=8);for(o=o<<r|a,u+=r;u>0;n[t+y]=o&255,y+=x,o/=256,u-=8);n[t+y-x]|=w*128};var JZ=Yt,_1=_k;function Yt(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}Yt.Varint=0;Yt.Fixed64=1;Yt.Bytes=2;Yt.Fixed32=5;var yR=(1<<16)*(1<<16),ED=1/yR,eQ=12,YU=typeof TextDecoder>"u"?null:new TextDecoder("utf8");Yt.prototype={destroy:function(){this.buf=null},readFields:function(n,e,t){for(t=t||this.length;this.pos<t;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=i&7,n(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=v1(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=SD(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=v1(this.buf,this.pos)+v1(this.buf,this.pos+4)*yR;return this.pos+=8,n},readSFixed64:function(){var n=v1(this.buf,this.pos)+SD(this.buf,this.pos+4)*yR;return this.pos+=8,n},readFloat:function(){var n=_1.read(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=_1.read(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e=this.buf,t,i;return i=e[this.pos++],t=i&127,i<128||(i=e[this.pos++],t|=(i&127)<<7,i<128)||(i=e[this.pos++],t|=(i&127)<<14,i<128)||(i=e[this.pos++],t|=(i&127)<<21,i<128)?t:(i=e[this.pos],t|=(i&15)<<28,tQ(t,n,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2===1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=eQ&&YU?pQ(this.buf,e,n):gQ(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==Yt.Bytes)return n.push(this.readVarint(e));var t=Pl(this);for(n=n||[];this.pos<t;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==Yt.Bytes)return n.push(this.readSVarint());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==Yt.Bytes)return n.push(this.readBoolean());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==Yt.Bytes)return n.push(this.readFloat());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==Yt.Bytes)return n.push(this.readDouble());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==Yt.Bytes)return n.push(this.readFixed32());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==Yt.Bytes)return n.push(this.readSFixed32());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==Yt.Bytes)return n.push(this.readFixed64());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==Yt.Bytes)return n.push(this.readSFixed64());var e=Pl(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=n&7;if(e===Yt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Yt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Yt.Fixed32)this.pos+=4;else if(e===Yt.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var t=new Uint8Array(e);t.set(this.buf),this.buf=t,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Ld(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Ld(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Ld(this.buf,n&-1,this.pos),Ld(this.buf,Math.floor(n*ED),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Ld(this.buf,n&-1,this.pos),Ld(this.buf,Math.floor(n*ED),this.pos+4),this.pos+=8},writeVarint:function(n){if(n=+n||0,n>268435455||n<0){nQ(n,this);return}this.realloc(4),this.buf[this.pos++]=n&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=n>>>7&127)))},writeSVarint:function(n){this.writeVarint(n<0?-n*2-1:n*2)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(n.length*4),this.pos++;var e=this.pos;this.pos=mQ(this.buf,n,this.pos);var t=this.pos-e;t>=128&&TD(e,t,this),this.pos=e-1,this.writeVarint(t),this.pos+=t},writeFloat:function(n){this.realloc(4),_1.write(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),_1.write(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var t=0;t<e;t++)this.buf[this.pos++]=n[t]},writeRawMessage:function(n,e){this.pos++;var t=this.pos;n(e,this);var i=this.pos-t;i>=128&&TD(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeMessage:function(n,e,t){this.writeTag(n,Yt.Bytes),this.writeRawMessage(e,t)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,sQ,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,oQ,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,uQ,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,aQ,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,lQ,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,cQ,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,hQ,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,fQ,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,dQ,e)},writeBytesField:function(n,e){this.writeTag(n,Yt.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,Yt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,Yt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,Yt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,Yt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,Yt.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,Yt.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,Yt.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,Yt.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,Yt.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,Boolean(e))}};function tQ(n,e,t){var i=t.buf,r,s;if(s=i[t.pos++],r=(s&112)>>4,s<128||(s=i[t.pos++],r|=(s&127)<<3,s<128)||(s=i[t.pos++],r|=(s&127)<<10,s<128)||(s=i[t.pos++],r|=(s&127)<<17,s<128)||(s=i[t.pos++],r|=(s&127)<<24,s<128)||(s=i[t.pos++],r|=(s&1)<<31,s<128))return Pd(n,r,e);throw new Error("Expected varint not more than 10 bytes")}function Pl(n){return n.type===Yt.Bytes?n.readVarint()+n.pos:n.pos+1}function Pd(n,e,t){return t?e*4294967296+(n>>>0):(e>>>0)*4294967296+(n>>>0)}function nQ(n,e){var t,i;if(n>=0?(t=n%4294967296|0,i=n/4294967296|0):(t=~(-n%4294967296),i=~(-n/4294967296),t^4294967295?t=t+1|0:(t=0,i=i+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),iQ(t,i,e),rQ(i,e)}function iQ(n,e,t){t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos]=n&127}function rQ(n,e){var t=(n&7)<<4;e.buf[e.pos++]|=t|((n>>>=3)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127)))))}function TD(n,e,t){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(i);for(var r=t.pos-1;r>=n;r--)t.buf[r+i]=t.buf[r]}function sQ(n,e){for(var t=0;t<n.length;t++)e.writeVarint(n[t])}function oQ(n,e){for(var t=0;t<n.length;t++)e.writeSVarint(n[t])}function aQ(n,e){for(var t=0;t<n.length;t++)e.writeFloat(n[t])}function lQ(n,e){for(var t=0;t<n.length;t++)e.writeDouble(n[t])}function uQ(n,e){for(var t=0;t<n.length;t++)e.writeBoolean(n[t])}function cQ(n,e){for(var t=0;t<n.length;t++)e.writeFixed32(n[t])}function hQ(n,e){for(var t=0;t<n.length;t++)e.writeSFixed32(n[t])}function fQ(n,e){for(var t=0;t<n.length;t++)e.writeFixed64(n[t])}function dQ(n,e){for(var t=0;t<n.length;t++)e.writeSFixed64(n[t])}function v1(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+n[e+3]*16777216}function Ld(n,e,t){n[t]=e,n[t+1]=e>>>8,n[t+2]=e>>>16,n[t+3]=e>>>24}function SD(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function gQ(n,e,t){for(var i="",r=e;r<t;){var s=n[r],o=null,a=s>239?4:s>223?3:s>191?2:1;if(r+a>t)break;var l,u,h;a===1?s<128&&(o=s):a===2?(l=n[r+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=n[r+1],u=n[r+2],(l&192)===128&&(u&192)===128&&(o=(s&15)<<12|(l&63)<<6|u&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=n[r+1],u=n[r+2],h=n[r+3],(l&192)===128&&(u&192)===128&&(h&192)===128&&(o=(s&15)<<18|(l&63)<<12|(u&63)<<6|h&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),r+=a}return i}function pQ(n,e,t){return YU.decode(n.subarray(e,t))}function mQ(n,e,t){for(var i=0,r,s;i<e.length;i++){if(r=e.charCodeAt(i),r>55295&&r<57344)if(s)if(r<56320){n[t++]=239,n[t++]=191,n[t++]=189,s=r;continue}else r=s-55296<<10|r-56320|65536,s=null;else{r>56319||i+1===e.length?(n[t++]=239,n[t++]=191,n[t++]=189):s=r;continue}else s&&(n[t++]=239,n[t++]=191,n[t++]=189,s=null);r<128?n[t++]=r:(r<2048?n[t++]=r>>6|192:(r<65536?n[t++]=r>>12|224:(n[t++]=r>>18|240,n[t++]=r>>12&63|128),n[t++]=r>>6&63|128),n[t++]=r&63|128)}return t}class AE extends uu{constructor(e,t,i){super(),i!==void 0&&t===void 0?this.setFlatCoordinates(i,e):(t=t||0,this.setCenterAndRadius(e,t,i))}clone(){const e=new AE(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=e-s[0],a=t-s[1],l=o*o+a*a;if(l<r){if(l===0)for(let u=0;u<this.stride;++u)i[u]=s[u];else{const u=this.getRadius()/Math.sqrt(l);i[0]=s[0]+u*o,i[1]=s[1]+u*a;for(let h=2;h<this.stride;++h)i[h]=s[h]}return i.length=this.stride,l}return r}containsXY(e,t){const i=this.flatCoordinates,r=e-i[0],s=t-i[1];return r*r+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,i=t[this.stride]-t[0];return ma(t[0]-i,t[1]-i,t[0]+i,t[1]+i,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(un(e,t)){const i=this.getCenter();return e[0]<=i[0]&&e[2]>=i[0]||e[1]<=i[1]&&e[3]>=i[1]?!0:SA(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,i=this.flatCoordinates[t]-this.flatCoordinates[0],r=e.slice();r[t]=r[0]+i;for(let s=1;s<t;++s)r[t+s]=e[s];this.setFlatCoordinates(this.layout,r),this.changed()}setCenterAndRadius(e,t,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const r=this.flatCoordinates;let s=C3(r,0,e,this.stride);r[s++]=r[0]+t;for(let o=1,a=this.stride;o<a;++o)r[s++]=r[o];r.length=s,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const i=this.getCenter(),r=this.getStride();this.setCenter(kA(i,0,i.length,r,e,t,i)),this.changed()}translate(e,t){const i=this.getCenter(),r=this.getStride();this.setCenter(S3(i,0,i.length,r,e,t,i)),this.changed()}}AE.prototype.transform;const ZU=AE;class uw extends PA{constructor(e){super(),this.geometries_=e||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(zt),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(Ve(this.geometries_[e],Re.CHANGE,this.changed,this))}clone(){const e=new uw(null);return e.setGeometries(this.geometries_),e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Rf(this.getExtent(),e,t))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(e,t,i,r);return r}containsXY(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(e,t))return!0;return!1}computeExtent(e){X0(e);const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)g3(e,t[i].getExtent());return e}getGeometries(){return CD(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].getType()===this.getType()?e=e.concat(t[i].getGeometriesArrayRecursive()):e.push(t[i]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(e);t.push(l),l!==a&&(r=!0)}if(r){const s=new uw(null);return s.setGeometriesArray(t),s}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)if(t[i].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(e,t);this.changed()}scale(e,t,i){i||(i=er(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(e,t,i);this.changed()}setGeometries(e){this.setGeometriesArray(CD(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].applyTransform(e);this.changed()}translate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function CD(n){const e=[];for(let t=0,i=n.length;t<i;++t)e.push(n[t].clone());return e}const vk=uw,yQ=Object.freeze(Object.defineProperty({__proto__:null,Circle:ZU,Geometry:PA,GeometryCollection:vk,LineString:da,LinearRing:sR,MultiLineString:n_,MultiPoint:i_,MultiPolygon:r_,Point:bs,Polygon:Pc,SimpleGeometry:uu},Symbol.toStringTag,{value:"Module"})),ID=Hn();class g0{constructor(e,t,i,r,s){this.styleFunction,this.extent_,this.id_=s,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=r}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?yg(this.flatCoordinates_):TA(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=er(this.getExtent());this.flatInteriorPoints_=GA(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=KU(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=A3(this.flatCoordinates_,0,this.ends_,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Hx(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=Hx(e,t,o,2,.5);qs(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getStride(){return 2}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=_t(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=rn(i)/rn(t);As(ID,i[0],i[3],r,-r,0,0,0),_c(this.flatCoordinates_,0,this.flatCoordinates_.length,2,ID,this.flatCoordinates_)}}getEnds(){return this.ends_}}g0.prototype.getEndss=g0.prototype.getEnds;g0.prototype.getFlatCoordinates=g0.prototype.getOrientedFlatCoordinates;const _R=g0;class _Q extends qU{constructor(e){super(),e=e||{},this.dataProjection=new Ky({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:_R,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,i,r){e.pos=t.geometry;const s=e.readVarint()+e.pos;let o=1,a=0,l=0,u=0,h=0,p=0;for(;e.pos<s;){if(!a){const m=e.readVarint();o=m&7,a=m>>3}a--,o===1||o===2?(l+=e.readSVarint(),u+=e.readSVarint(),o===1&&h>p&&(r.push(h),p=h),i.push(l,u),h+=2):o===7?h>p&&(i.push(i[p],i[p+1]),h+=2):Ye(!1,59)}h>p&&(r.push(h),p=h)}createFeature_(e,t,i){const r=t.type;if(r===0)return null;let s;const o=t.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=t.id,o[this.layerName_]=t.layer.name;const l=[],u=[];this.readRawGeometry_(e,t,l,u);const h=TQ(r,u.length);if(this.featureClass_===_R)s=new this.featureClass_(h,l,u,o,a),s.transform(i.dataProjection);else{let p;if(h=="Polygon"){const x=_Y(l,u);p=x.length>1?new r_(l,"XY",x):new Pc(l,"XY",u)}else p=h==="Point"?new bs(l,"XY"):h==="LineString"?new da(l,"XY"):h==="MultiPoint"?new i_(l,"XY"):h==="MultiLineString"?new n_(l,"XY",u):null;const m=this.featureClass_;s=new m,this.geometryName_&&s.setGeometryName(this.geometryName_);const y=mk(p,!1,i);s.setGeometry(y),a!==void 0&&s.setId(a),s.setProperties(o,!0)}return s}getType(){return"arraybuffer"}readFeatures(e,t){const i=this.layers_;t=this.adaptOptions(t);const r=_t(t.dataProjection);r.setWorldExtent(t.extent),t.dataProjection=r;const s=new JZ(e),o=s.readFields(vQ,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const u=o[l],h=u?[0,0,u.extent,u.extent]:null;r.setExtent(h);for(let p=0,m=u.length;p<m;++p){const y=EQ(s,u,p),x=this.createFeature_(s,y,t);x!==null&&a.push(x)}}return a}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function vQ(n,e,t){if(n===3){const i={keys:[],values:[],features:[]},r=t.readVarint()+t.pos;t.readFields(xQ,i,r),i.length=i.features.length,i.length&&(e[i.name]=i)}}function xQ(n,e,t){if(n===15)e.version=t.readVarint();else if(n===1)e.name=t.readString();else if(n===5)e.extent=t.readVarint();else if(n===2)e.features.push(t.pos);else if(n===3)e.keys.push(t.readString());else if(n===4){let i=null;const r=t.readVarint()+t.pos;for(;t.pos<r;)n=t.readVarint()>>3,i=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null;e.values.push(i)}}function wQ(n,e,t){if(n==1)e.id=t.readVarint();else if(n==2){const i=t.readVarint()+t.pos;for(;t.pos<i;){const r=e.layer.keys[t.readVarint()],s=e.layer.values[t.readVarint()];e.properties[r]=s}}else n==3?e.type=t.readVarint():n==4&&(e.geometry=t.pos)}function EQ(n,e,t){n.pos=e.features[t];const i=n.readVarint()+n.pos,r={layer:e,type:0,properties:{}};return n.readFields(wQ,r,i),r}function TQ(n,e){let t;return n===1?t=e===1?"Point":"MultiPoint":n===2?t=e===1?"LineString":"MultiLineString":n===3&&(t="Polygon"),t}const QU=_Q,xk=.5,SQ=10,RD=.25;class CQ{constructor(e,t,i,r,s,o){this.sourceProj_=e,this.targetProj_=t;let a={};const l=eu(this.targetProj_,this.sourceProj_);this.transformInv_=function(T){const I=T[0]+"/"+T[1];return a[I]||(a[I]=l(T)),a[I]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&gt(r)==gt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?gt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?gt(this.targetProj_.getExtent()):null;const u=va(i),h=gE(i),p=q0(i),m=dE(i),y=this.transformInv_(u),x=this.transformInv_(h),w=this.transformInv_(p),R=this.transformInv_(m),E=SQ+(o?Math.max(0,Math.ceil(Math.log2(Bg(i)/(o*o*256*256)))):0);if(this.addQuad_(u,h,p,m,y,x,w,R,E),this.wrapsXInSource_){let T=1/0;this.triangles_.forEach(function(I,A,L){T=Math.min(T,I.source[0][0],I.source[1][0],I.source[2][0])}),this.triangles_.forEach(I=>{if(Math.max(I.source[0][0],I.source[1][0],I.source[2][0])-T>this.sourceWorldWidth_/2){const A=[[I.source[0][0],I.source[0][1]],[I.source[1][0],I.source[1][1]],[I.source[2][0],I.source[2][1]]];A[0][0]-T>this.sourceWorldWidth_/2&&(A[0][0]-=this.sourceWorldWidth_),A[1][0]-T>this.sourceWorldWidth_/2&&(A[1][0]-=this.sourceWorldWidth_),A[2][0]-T>this.sourceWorldWidth_/2&&(A[2][0]-=this.sourceWorldWidth_);const L=Math.min(A[0][0],A[1][0],A[2][0]);Math.max(A[0][0],A[1][0],A[2][0])-L<this.sourceWorldWidth_/2&&(I.source=A)}})}a={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,l,u){const h=_i([s,o,a,l]),p=this.sourceWorldWidth_?gt(h)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&p>.5&&p<1;let x=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const R=_i([e,t,i,r]);x=gt(R)/this.targetWorldWidth_>RD||x}!y&&this.sourceProj_.isGlobal()&&p&&(x=p>RD||x)}if(!x&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!un(h,this.maxSourceExtent_))return;let w=0;if(!x&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)x=!0;else if(w=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),w!=1&&w!=2&&w!=4&&w!=8)return}if(u>0){if(!x){const R=[(e[0]+i[0])/2,(e[1]+i[1])/2],E=this.transformInv_(R);let T;y?T=(Qa(s[0],m)+Qa(a[0],m))/2-Qa(E[0],m):T=(s[0]+a[0])/2-E[0];const I=(s[1]+a[1])/2-E[1];x=T*T+I*I>this.errorThresholdSquared_}if(x){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const R=[(t[0]+i[0])/2,(t[1]+i[1])/2],E=this.transformInv_(R),T=[(r[0]+e[0])/2,(r[1]+e[1])/2],I=this.transformInv_(T);this.addQuad_(e,t,R,T,s,o,E,I,u-1),this.addQuad_(T,R,i,r,I,E,a,l,u-1)}else{const R=[(e[0]+t[0])/2,(e[1]+t[1])/2],E=this.transformInv_(R),T=[(i[0]+r[0])/2,(i[1]+r[1])/2],I=this.transformInv_(T);this.addQuad_(e,R,T,r,s,E,I,l,u-1),this.addQuad_(R,t,i,T,E,o,a,I,u-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}w&11||this.addTriangle_(e,i,r,s,a,l),w&14||this.addTriangle_(e,i,t,s,a,o),w&&(w&13||this.addTriangle_(t,r,e,o,l,s),w&7||this.addTriangle_(t,r,i,o,l,a))}calculateSourceExtent(){const e=xr();return this.triangles_.forEach(function(t,i,r){const s=t.source;py(e,s[0]),py(e,s[1]),py(e,s[2])}),e}getTriangles(){return this.triangles_}}const wk=CQ;let YS;const Xl=[];function bD(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function ZS(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function IQ(){if(YS===void 0){const n=mn(6,6,Xl);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",bD(n,4,5,4,0),bD(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;YS=ZS(e,0)||ZS(e,4)||ZS(e,8),Qh(n),Xl.push(n.canvas)}return YS}function p0(n,e,t,i){const r=vE(t,e,n);let s=Vx(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const l=n.getExtent();if(!l||la(l,r)){const u=Vx(n,s,r)/s;isFinite(u)&&u>0&&(s/=u)}return s}function JU(n,e,t,i){const r=er(t);let s=p0(n,e,r,i);return(!isFinite(s)||s<=0)&&SA(t,function(o){return s=p0(n,e,o,i),isFinite(s)&&s>0}),s}function Ek(n,e,t,i,r,s,o,a,l,u,h,p){const m=mn(Math.round(t*n),Math.round(t*e),Xl);if(p||(m.imageSmoothingEnabled=!1),l.length===0)return m.canvas;m.scale(t,t);function y(A){return Math.round(A*t)/t}m.globalCompositeOperation="lighter";const x=xr();l.forEach(function(A,L,F){g3(x,A.extent)});const w=gt(x),R=rn(x),E=mn(Math.round(t*w/i),Math.round(t*R/i),Xl);p||(E.imageSmoothingEnabled=!1);const T=t/i;l.forEach(function(A,L,F){const O=A.extent[0]-x[0],N=-(A.extent[3]-x[3]),B=gt(A.extent),V=rn(A.extent);A.image.width>0&&A.image.height>0&&E.drawImage(A.image,u,u,A.image.width-2*u,A.image.height-2*u,O*T,N*T,B*T,V*T)});const I=va(o);return a.getTriangles().forEach(function(A,L,F){const O=A.source,N=A.target;let B=O[0][0],V=O[0][1],J=O[1][0],ge=O[1][1],he=O[2][0],de=O[2][1];const oe=y((N[0][0]-I[0])/s),_e=y(-(N[0][1]-I[1])/s),se=y((N[1][0]-I[0])/s),Z=y(-(N[1][1]-I[1])/s),pe=y((N[2][0]-I[0])/s),ne=y(-(N[2][1]-I[1])/s),ee=B,j=V;B=0,V=0,J-=ee,ge-=j,he-=ee,de-=j;const ie=[[J,ge,0,0,se-oe],[he,de,0,0,pe-oe],[0,0,J,ge,Z-_e],[0,0,he,de,ne-_e]],q=VK(ie);if(q){if(m.save(),m.beginPath(),IQ()||!p){m.moveTo(se,Z);const H=4,te=oe-se,ue=_e-Z;for(let K=0;K<H;K++)m.lineTo(se+y((K+1)*te/H),Z+y(K*ue/(H-1))),K!=H-1&&m.lineTo(se+y((K+1)*te/H),Z+y((K+1)*ue/(H-1)));m.lineTo(pe,ne)}else m.moveTo(se,Z),m.lineTo(oe,_e),m.lineTo(pe,ne);m.clip(),m.transform(q[0],q[2],q[1],q[3],oe,_e),m.translate(x[0]-ee,x[3]-j),m.scale(i/t,-i/t),m.drawImage(E.canvas,0,0),m.restore()}}),Qh(E),Xl.push(E.canvas),h&&(m.save(),m.globalCompositeOperation="source-over",m.strokeStyle="black",m.lineWidth=1,a.getTriangles().forEach(function(A,L,F){const O=A.target,N=(O[0][0]-I[0])/s,B=-(O[0][1]-I[1])/s,V=(O[1][0]-I[0])/s,J=-(O[1][1]-I[1])/s,ge=(O[2][0]-I[0])/s,he=-(O[2][1]-I[1])/s;m.beginPath(),m.moveTo(V,J),m.lineTo(N,B),m.lineTo(ge,he),m.closePath(),m.stroke()}),m.restore()),m.canvas}class RQ extends Mf{constructor(e,t,i,r,s,o,a,l,u,h,p,m){super(s,ce.IDLE,{interpolate:!!m}),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const y=r.getTileCoordExtent(this.wrappedTileCoord_),x=this.targetTileGrid_.getExtent();let w=this.sourceTileGrid_.getExtent();const R=x?tr(y,x):y;if(Bg(R)===0){this.state=ce.EMPTY;return}const E=e.getExtent();E&&(w?w=tr(w,E):w=E);const T=r.getResolution(this.wrappedTileCoord_[0]),I=JU(e,i,R,T);if(!isFinite(I)||I<=0){this.state=ce.EMPTY;return}const A=h!==void 0?h:xk;if(this.triangulation_=new wk(e,i,R,w,I*A,T),this.triangulation_.getTriangles().length===0){this.state=ce.EMPTY;return}this.sourceZ_=t.getZForResolution(I);let L=this.triangulation_.calculateSourceExtent();if(w&&(e.canWrapX()?(L[1]=ot(L[1],w[1],w[3]),L[3]=ot(L[3],w[1],w[3])):L=tr(L,w)),!Bg(L))this.state=ce.EMPTY;else{const F=t.getTileRangeForExtentAndZ(L,this.sourceZ_);for(let O=F.minX;O<=F.maxX;O++)for(let N=F.minY;N<=F.maxY;N++){const B=u(this.sourceZ_,O,N,a);B&&this.sourceTiles_.push(B)}this.sourceTiles_.length===0&&(this.state=ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{t&&t.getState()==ce.LOADED&&e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})}),this.sourceTiles_.length=0,e.length===0)this.state=ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Ek(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=ce.LOADED}this.changed()}load(){if(this.state==ce.IDLE){this.state=ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const i=t.getState();if(i==ce.IDLE||i==ce.LOADING){e++;const r=Ve(t,Re.CHANGE,function(s){const o=t.getState();(o==ce.LOADED||o==ce.ERROR||o==ce.EMPTY)&&(zt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t,i,r){t.getState()==ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(zt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Qh(this.canvas_.getContext("2d")),Xl.push(this.canvas_),this.canvas_=null),super.release()}}const Yg=RQ;class bQ extends tk{constructor(e){super(e),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=xr(),this.tmpTileRange_=new CE(0,0,0,0)}isDrawableTile(e){const t=this.getLayer(),i=e.getState(),r=t.getUseInterimTilesOnError();return i==ce.LOADED||i==ce.EMPTY||i==ce.ERROR&&!r}getTile(e,t,i,r){const s=r.pixelRatio,o=r.viewState.projection,a=this.getLayer();let u=a.getSource().getTile(e,t,i,s,o);return u.getState()==ce.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(u)||(u=u.getInterimTile()),u}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Tn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!la(s,r))return null;const o=t.pixelRatio,a=t.viewState.projection,l=t.viewState,u=i.getRenderSource(),h=u.getTileGridForProjection(l.projection),p=u.getTilePixelRatio(t.pixelRatio);for(let m=h.getZForResolution(l.resolution);m>=h.getMinZoom();--m){const y=h.getTileCoordForCoordAndZ(r,m),x=u.getTile(m,y[1],y[2],o,a);if(!(x instanceof Xg||x instanceof Yg)||x instanceof Yg&&x.getState()===ce.EMPTY)return null;if(x.getState()!==ce.LOADED)continue;const w=h.getOrigin(m),R=dn(h.getTileSize(m)),E=h.getResolution(m),T=Math.floor(p*((r[0]-w[0])/E-y[1]*R[0])),I=Math.floor(p*((w[1]-r[1])/E-y[2]*R[1])),A=Math.round(p*u.getGutterForProjection(l.projection));return this.getImageData(x.getImage(),T+A,I+A)}return null}loadedTileCallback(e,t,i){return this.isDrawableTile(i)?super.loadedTileCallback(e,t,i):!1}prepareFrame(e){return!!this.getLayer().getSource()}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,l=r.rotation,u=e.pixelRatio,h=this.getLayer(),p=h.getSource(),m=p.getRevision(),y=p.getTileGridForProjection(s),x=y.getZForResolution(o,p.zDirection),w=y.getResolution(x);let R=e.extent;const E=e.viewState.resolution,T=p.getTilePixelRatio(u),I=Math.round(gt(R)/E*u),A=Math.round(rn(R)/E*u),L=i.extent&&bo(i.extent);L&&(R=tr(R,bo(i.extent)));const F=w*I/2/T,O=w*A/2/T,N=[a[0]-F,a[1]-O,a[0]+F,a[1]+O],B=y.getTileRangeForExtentAndZ(R,x),V={};V[x]={};const J=this.createLoadedTileFinder(p,s,V),ge=this.tmpExtent,he=this.tmpTileRange_;this.newTiles_=!1;const de=l?eR(r.center,E,l,e.size):void 0;for(let ie=B.minX;ie<=B.maxX;++ie)for(let q=B.minY;q<=B.maxY;++q){if(l&&!y.tileCoordIntersectsViewport([x,ie,q],de))continue;const H=this.getTile(x,ie,q,e);if(this.isDrawableTile(H)){const K=be(this);if(H.getState()==ce.LOADED){V[x][H.tileCoord.toString()]=H;let Te=H.inTransition(K);Te&&i.opacity!==1&&(H.endTransition(K),Te=!1),!this.newTiles_&&(Te||!this.renderedTiles.includes(H))&&(this.newTiles_=!0)}if(H.getAlpha(K,e.time)===1)continue}const te=y.getTileCoordChildTileRange(H.tileCoord,he,ge);let ue=!1;te&&(ue=J(x+1,te)),ue||y.forEachTileCoordParentTileRange(H.tileCoord,J,he,ge)}const oe=w/o*u/T;As(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/u,1/u,l,-I/2,-A/2);const _e=wA(this.pixelTransform);this.useContainer(t,_e,this.getBackground(e));const se=this.context,Z=se.canvas;H0(this.inversePixelTransform,this.pixelTransform),As(this.tempTransform,I/2,A/2,oe,oe,0,-I/2,-A/2),Z.width!=I||Z.height!=A?(Z.width=I,Z.height=A):this.containerReused||se.clearRect(0,0,I,A),L&&this.clipUnrotated(se,e,L),p.getInterpolate()||(se.imageSmoothingEnabled=!1),this.preRender(se,e),this.renderedTiles.length=0;let pe=Object.keys(V).map(Number);pe.sort(Ac);let ne,ee,j;i.opacity===1&&(!this.containerReused||p.getOpaque(e.viewState.projection))?pe=pe.reverse():(ne=[],ee=[]);for(let ie=pe.length-1;ie>=0;--ie){const q=pe[ie],H=p.getTilePixelSize(q,u,s),ue=y.getResolution(q)/w,K=H[0]*ue*oe,Te=H[1]*ue*oe,lt=y.getTileCoordForCoordAndZ(va(N),q),It=y.getTileCoordExtent(lt),rt=Tn(this.tempTransform,[T*(It[0]-N[0])/w,T*(N[3]-It[3])/w]),ut=T*p.getGutterForProjection(s),ct=V[q];for(const rr in ct){const Mn=ct[rr],$i=Mn.tileCoord,Ie=lt[1]-$i[1],U=Math.round(rt[0]-(Ie-1)*K),Wr=lt[2]-$i[2],ks=Math.round(rt[1]-(Wr-1)*Te),ei=Math.round(rt[0]-Ie*K),Wt=Math.round(rt[1]-Wr*Te),yn=U-ei,Wi=ks-Wt,cs=x===q,Hi=cs&&Mn.getAlpha(be(this),e.time)!==1;let Rn=!1;if(!Hi)if(ne){j=[ei,Wt,ei+yn,Wt,ei+yn,Wt+Wi,ei,Wt+Wi];for(let Ft=0,sr=ne.length;Ft<sr;++Ft)if(x!==q&&q<ee[Ft]){const Xt=ne[Ft];un([ei,Wt,ei+yn,Wt+Wi],[Xt[0],Xt[3],Xt[4],Xt[7]])&&(Rn||(se.save(),Rn=!0),se.beginPath(),se.moveTo(j[0],j[1]),se.lineTo(j[2],j[3]),se.lineTo(j[4],j[5]),se.lineTo(j[6],j[7]),se.moveTo(Xt[6],Xt[7]),se.lineTo(Xt[4],Xt[5]),se.lineTo(Xt[2],Xt[3]),se.lineTo(Xt[0],Xt[1]),se.clip())}ne.push(j),ee.push(q)}else se.clearRect(ei,Wt,yn,Wi);this.drawTileImage(Mn,e,ei,Wt,yn,Wi,ut,cs),ne&&!Hi?(Rn&&se.restore(),this.renderedTiles.unshift(Mn)):this.renderedTiles.push(Mn),this.updateUsedTiles(e.usedTiles,p,Mn)}}return this.renderedRevision=m,this.renderedResolution=w,this.extentChanged=!this.renderedExtent_||!Oo(this.renderedExtent_,N),this.renderedExtent_=N,this.renderedPixelRatio=u,this.renderedProjection=s,this.manageTilePyramid(e,p,y,u,s,R,x,h.getPreload()),this.scheduleExpireCache(e,p),this.postRender(se,e),i.extent&&se.restore(),se.imageSmoothingEnabled=!0,_e!==Z.style.transform&&(Z.style.transform=_e),this.container}drawTileImage(e,t,i,r,s,o,a,l){const u=this.getTileImage(e);if(!u)return;const h=be(this),p=t.layerStatesArray[t.layerIndex],m=p.opacity*(l?e.getAlpha(h,t.time):1),y=m!==this.context.globalAlpha;y&&(this.context.save(),this.context.globalAlpha=m),this.context.drawImage(u,a,a,u.width-2*a,u.height-2*a,i,r,s,o),y&&this.context.restore(),m!==p.opacity?t.animate=!0:l&&e.endTransition(h)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}scheduleExpireCache(e,t){if(t.canExpireCache()){const i=function(r,s,o){const a=be(r);a in o.usedTiles&&r.expireCache(o.viewState.projection,o.usedTiles[a])}.bind(null,t);e.postRenderFunctions.push(i)}}updateUsedTiles(e,t,i){const r=be(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}manageTilePyramid(e,t,i,r,s,o,a,l,u){const h=be(t);h in e.wantedTiles||(e.wantedTiles[h]={});const p=e.wantedTiles[h],m=e.tileQueue,y=i.getMinZoom(),x=e.viewState.rotation,w=x?eR(e.viewState.center,e.viewState.resolution,x,e.size):void 0;let R=0,E,T,I,A,L,F;for(F=y;F<=a;++F)for(T=i.getTileRangeForExtentAndZ(o,F,T),I=i.getResolution(F),A=T.minX;A<=T.maxX;++A)for(L=T.minY;L<=T.maxY;++L)x&&!i.tileCoordIntersectsViewport([F,A,L],w)||(a-F<=l?(++R,E=t.getTile(F,A,L,r,s),E.getState()==ce.IDLE&&(p[E.getKey()]=!0,m.isKeyQueued(E.getKey())||m.enqueue([E,h,i.getTileCoordCenter(E.tileCoord),I])),u!==void 0&&u(E)):t.useTile(F,A,L,s));t.updateCacheSize(R,s)}}const eG=bQ,AQ={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},kQ={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class PQ extends eG{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.tmpTransform_=Hn()}prepareTile(e,t,i){let r;const s=e.getState();return(s===ce.LOADED||s===ce.ERROR)&&(this.updateExecutorGroup_(e,t,i),this.tileImageNeedsRender_(e)&&(r=!0)),r}getTile(e,t,i,r){const s=r.pixelRatio,o=r.viewState,a=o.resolution,l=o.projection,u=this.getLayer(),h=u.getSource().getTile(e,t,i,s,l),p=r.viewHints,m=!(p[ln.ANIMATING]||p[ln.INTERACTING]);return(m||!h.wantedResolution)&&(h.wantedResolution=a),this.prepareTile(h,s,l)&&(m||Date.now()-r.time<8)&&u.getRenderMode()!=="vector"&&this.renderTileImage_(h,r),super.getTile(e,t,i,r)}isDrawableTile(e){const t=this.getLayer();return super.isDrawableTile(e)&&(t.getRenderMode()==="vector"?be(t)in e.executorGroups:e.hasContext(t))}getTileImage(e){return e.getImage(this.getLayer())}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,i){const r=this.getLayer(),s=r.getRevision(),o=r.getRenderOrder()||null,a=e.wantedResolution,l=e.getReplayState(r);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==s&&l.renderedRenderOrder==o)return;const u=r.getSource(),h=r.getDeclutter(),p=u.getTileGrid(),y=u.getTileGridForProjection(i).getTileCoordExtent(e.wrappedTileCoord),x=u.getSourceTiles(t,i,e),w=be(r);delete e.hitDetectionImageData[w],e.executorGroups[w]=[],h&&(e.declutterExecutorGroups[w]=[]),l.dirty=!1;for(let R=0,E=x.length;R<E;++R){const T=x[R];if(T.getState()!=ce.LOADED)continue;const I=T.tileCoord,A=p.getTileCoordExtent(I),L=tr(y,A),F=Rs(L,r.getRenderBuffer()*a,this.tmpExtent),O=Oo(A,L)?null:F,N=new ew(0,F,a,t),B=h?new ew(0,L,a,t):void 0,V=nk(a,t),J=function(_e){let se;const Z=_e.getStyleFunction()||r.getStyleFunction();if(Z&&(se=Z(_e,a)),se){const pe=this.renderFeature(_e,V,se,N,B);l.dirty=l.dirty||pe}},ge=T.getFeatures();o&&o!==l.renderedRenderOrder&&ge.sort(o);for(let _e=0,se=ge.length;_e<se;++_e){const Z=ge[_e];(!O||un(O,Z.getGeometry().getExtent()))&&J.call(this,Z)}const he=N.finish(),de=r.getRenderMode()!=="vector"&&h&&x.length===1?null:L,oe=new tw(de,a,t,u.getOverlaps(),he,r.getRenderBuffer());if(e.executorGroups[w].push(oe),B){const _e=new tw(null,a,t,u.getOverlaps(),B.finish(),r.getRenderBuffer());e.declutterExecutorGroups[w].push(_e)}}l.renderedRevision=s,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(e,t,i,r,s){const o=t.viewState.resolution,a=t.viewState.rotation;i=i??0;const l=this.getLayer(),h=l.getSource().getTileGridForProjection(t.viewState.projection),p=_i([e]);Rs(p,o*i,p);const m={},y=function(R,E,T){let I=R.getId();I===void 0&&(I=be(R));const A=m[I];if(A){if(A!==!0&&T<A.distanceSq){if(T===0)return m[I]=!0,s.splice(s.lastIndexOf(A),1),r(R,l,E);A.geometry=E,A.distanceSq=T}}else{if(T===0)return m[I]=!0,r(R,l,E);s.push(m[I]={feature:R,layer:l,geometry:E,distanceSq:T,callback:r})}},x=this.renderedTiles;let w;for(let R=0,E=x.length;!w&&R<E;++R){const T=x[R],I=h.getTileCoordExtent(T.wrappedTileCoord);if(!un(I,p))continue;const A=be(l),L=[T.executorGroups[A]],F=T.declutterExecutorGroups[A];F&&L.push(F),L.some(O=>{const N=O===F?t.declutterTree.all().map(B=>B.value):null;for(let B=0,V=O.length;B<V;++B)if(w=O[B].forEachFeatureAtCoordinate(e,o,a,i,y,N),w)return!0})}return w}getFeatures(e){return new Promise((t,i)=>{const r=this.getLayer(),s=be(r),o=r.getSource(),a=this.renderedProjection,l=a.getExtent(),u=this.renderedResolution,h=o.getTileGridForProjection(a),p=Tn(this.renderedPixelToCoordinateTransform_,e.slice()),m=h.getTileCoordForCoordAndResolution(p,u);let y;for(let I=0,A=this.renderedTiles.length;I<A;++I)if(m.toString()===this.renderedTiles[I].tileCoord.toString()){if(y=this.renderedTiles[I],y.getState()===ce.LOADED){const L=h.getTileCoordExtent(y.tileCoord);o.getWrapX()&&a.canWrapX()&&!zr(l,L)&&yE(p,a);break}y=void 0}if(!y||y.loadingSourceTiles>0){t([]);return}const x=h.getTileCoordExtent(y.wrappedTileCoord),w=va(x),R=[(p[0]-w[0])/u,(w[1]-p[1])/u],E=y.getSourceTiles().reduce(function(I,A){return I.concat(A.getFeatures())},[]);let T=y.hitDetectionImageData[s];if(!T){const I=dn(h.getTileSize(h.getZForResolution(u,o.zDirection))),A=this.renderedRotation_,L=[this.getRenderTransform(h.getTileCoordCenter(y.wrappedTileCoord),u,0,Vs,I[0]*Vs,I[1]*Vs,0)];T=Q3(I,L,E,r.getStyleFunction(),h.getTileCoordExtent(y.wrappedTileCoord),y.getReplayState(r).renderedResolution,A),y.hitDetectionImageData[s]=T}t(J3(R,E,T))})}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e){const t=this.context,i=t.globalAlpha;t.globalAlpha=this.getLayer().getOpacity();const r=e.viewHints,s=!(r[ln.ANIMATING]||r[ln.INTERACTING]),o=this.renderedTiles;for(let a=0,l=o.length;a<l;++a){const u=o[a],h=u.declutterExecutorGroups[be(this.getLayer())];if(h)for(let p=h.length-1;p>=0;--p)h[p].execute(this.context,1,this.getTileRenderTransform(u,e),e.viewState.rotation,s,void 0,e.declutterTree)}t.globalAlpha=i}getTileRenderTransform(e,t){const i=t.pixelRatio,r=t.viewState,s=r.center,o=r.resolution,a=r.rotation,l=t.size,u=Math.round(l[0]*i),h=Math.round(l[1]*i),m=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),y=e.tileCoord,x=m.getTileCoordExtent(e.wrappedTileCoord),w=m.getTileCoordExtent(y,this.tmpExtent)[0]-x[0];return qh(mg(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(s,o,a,i,u,h,w))}postRender(e,t){const i=t.viewHints,r=!(i[ln.ANIMATING]||i[ln.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;const s=this.getLayer(),o=s.getRenderMode(),a=e.globalAlpha;e.globalAlpha=s.getOpacity();const l=kQ[o],u=t.viewState,h=u.rotation,p=s.getSource(),y=p.getTileGridForProjection(u.projection).getZForResolution(u.resolution,p.zDirection),x=this.renderedTiles,w=[],R=[];let E=!0;for(let T=x.length-1;T>=0;--T){const I=x[T];E=E&&!I.getReplayState(s).dirty;const A=I.executorGroups[be(s)].filter(B=>B.hasExecutors(l));if(A.length===0)continue;const L=this.getTileRenderTransform(I,t),F=I.tileCoord[0];let O=!1;const N=A[0].getClipCoords(L);if(N){for(let B=0,V=w.length;B<V;++B)if(y!==F&&F<R[B]){const J=w[B];un([N[0],N[3],N[4],N[7]],[J[0],J[3],J[4],J[7]])&&(O||(e.save(),O=!0),e.beginPath(),e.moveTo(N[0],N[1]),e.lineTo(N[2],N[3]),e.lineTo(N[4],N[5]),e.lineTo(N[6],N[7]),e.moveTo(J[6],J[7]),e.lineTo(J[4],J[5]),e.lineTo(J[2],J[3]),e.lineTo(J[0],J[1]),e.clip())}w.push(N),R.push(F)}for(let B=0,V=A.length;B<V;++B)A[B].execute(e,1,L,h,r,l);O&&e.restore()}e.globalAlpha=a,this.ready=E,super.postRender(e,t)}renderFeature(e,t,i,r,s){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let a=0,l=i.length;a<l;++a)o=nw(r,e,i[a],t,this.boundHandleStyleImageChange_,void 0,s)||o;else o=nw(r,e,i,t,this.boundHandleStyleImageChange_,void 0,s);return o}tileImageNeedsRender_(e){const t=this.getLayer();if(t.getRenderMode()==="vector")return!1;const i=e.getReplayState(t),r=t.getRevision(),s=e.wantedResolution;return i.renderedTileResolution!==s||i.renderedTileRevision!==r}renderTileImage_(e,t){const i=this.getLayer(),r=e.getReplayState(i),s=i.getRevision(),o=e.executorGroups[be(i)];r.renderedTileRevision=s;const a=e.wrappedTileCoord,l=a[0],u=i.getSource();let h=t.pixelRatio;const m=t.viewState.projection,y=u.getTileGridForProjection(m),x=y.getResolution(e.tileCoord[0]),w=t.pixelRatio/e.wantedResolution*x,R=y.getResolution(l),E=e.getContext(i);h=Math.round(Math.max(h,w/h));const T=u.getTilePixelSize(l,h,m);E.canvas.width=T[0],E.canvas.height=T[1];const I=h/w;if(I!==1){const O=pg(this.tmpTransform_);mg(O,I,I),E.setTransform.apply(E,O)}const A=y.getTileCoordExtent(a,this.tmpExtent),L=w/R,F=pg(this.tmpTransform_);mg(F,L,-L),jx(F,-A[0],-A[3]);for(let O=0,N=o.length;O<N;++O)o[O].execute(E,I,F,0,!0,AQ[i.getRenderMode()]);r.renderedTileResolution=e.wantedResolution}}const LQ=PQ,lc={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class MQ extends Q0{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un;const i=e.renderMode||"hybrid";Ye(i=="hybrid"||i=="vector",28),this.renderMode_=i,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new LQ(this)}getFeatures(e){return super.getFeatures(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(lc.PRELOAD)}getUseInterimTilesOnError(){return this.get(lc.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(lc.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(lc.USE_INTERIM_TILES_ON_ERROR,e)}}const vy=MQ,Md=[0,0,0],Vu=5;class DQ{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Ye(oK(this.resolutions_,function(r,s){return s-r},!0),17);let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Ye(this.origins_.length==this.resolutions_.length,20));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=va(i)),Ye(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Ye(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:qg,Ye(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(r,s){const o=new CE(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o},this):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,l=null,u=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,r);u>=this.minZoom;){if(this.zoomFactor_===2?(o=Math.floor(o/2),a=Math.floor(a/2),s=kd(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,u,i),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return kd(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return kd(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-r),u=Math.floor(s*l),h=Math.floor(o*l);if(t<r)return kd(u,u,h,h,i);const p=Math.floor(l*(s+1))-1,m=Math.floor(l*(o+1))-1;return kd(u,p,h,m,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeExtent(e,t,i){const r=this.getOrigin(e),s=this.getResolution(e),o=dn(this.getTileSize(e),this.tmpSize_),a=r[0]+t.minX*o[0]*s,l=r[0]+(t.maxX+1)*o[0]*s,u=r[1]+t.minY*o[1]*s,h=r[1]+(t.maxY+1)*o[1]*s;return ma(a,u,l,h,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Md);const r=Md[1],s=Md[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Md);const o=Md[1],a=Md[2];return kd(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=dn(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=dn(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,l=o+s[0]*r,u=a+s[1]*r;return ma(o,a,l,u,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),u=dn(this.getTileSize(o),this.tmpSize_);let h=a*(e-l[0])/i/u[0],p=a*(l[1]-t)/i/u[1];return r?(h=rc(h,Vu)-1,p=rc(p,Vu)-1):(h=ng(h,Vu),p=ng(p,Vu)),l0(o,h,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=dn(this.getTileSize(i),this.tmpSize_);let u=(e-o[0])/a/l[0],h=(o[1]-t)/a/l[1];return r?(u=rc(u,Vu)-1,h=rc(h,Vu)-1):(u=ng(u,Vu),h=ng(h,Vu)),l0(i,u,h,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=hE(this.resolutions_,e,t||0);return ot(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return P3(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}const fu=DQ,Eg={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};function Tk(n){let e=n.getDefaultTileGrid();return e||(e=NQ(n),n.setDefaultTileGrid(e)),e}function FQ(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=Gc(t);if(!la(s,r)){const o=gt(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function OQ(n,e,t,i){i=i!==void 0?i:"top-left";const r=tG(n,e,t);return new fu({extent:n,origin:bK(n,i),resolutions:r,tileSize:t})}function Df(n){const e=n||{},t=e.extent||_t("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:tG(t,e.maxZoom,e.tileSize,e.maxResolution)};return new fu(i)}function tG(n,e,t,i){e=e!==void 0?e:uU,t=dn(t!==void 0?t:qg);const r=rn(n),s=gt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function NQ(n,e,t,i){const r=Gc(n);return OQ(r,e,t,i)}function Gc(n){n=_t(n);let e=n.getExtent();if(!e){const t=180*Kh.degrees/n.getMetersPerUnit();e=ma(-t,-t,t,t)}return e}class zQ extends Pf{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.opaque_=e.opaque!==void 0?e.opaque:!1,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&dn(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tileCache=new t_(e.cacheSize||0),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(e,t){const i=this.getTileCacheForProjection(e);i&&i.expireCache(t)}forEachLoadedTile(e,t,i,r){const s=this.getTileCacheForProjection(e);if(!s)return!1;let o=!0,a,l,u;for(let h=i.minX;h<=i.maxX;++h)for(let p=i.minY;p<=i.maxY;++p)l=sl(t,h,p),u=!1,s.containsKey(l)&&(a=s.get(l),u=a.getState()===ce.LOADED,u&&(u=r(a)!==!1)),u||(o=!1);return o}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getOpaque(e){return this.opaque_}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s){return et()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:Tk(e)}getTileCacheForProjection(e){const t=this.getProjection();return Ye(t===null||rs(t,e),68),this.tileCache}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=dn(r.getTileSize(e),this.tmpSize);return s==1?o:$A(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){t=t!==void 0?t:this.getProjection();const i=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=FQ(i,e,t)),iZ(e,i)?e:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(e,t){const i=this.getTileCacheForProjection(t);e>i.highWaterMark&&(i.highWaterMark=e)}useTile(e,t,i,r){}}class nG extends Vi{constructor(e,t){super(e),this.tile=t}}const s_=zQ;function UQ(n,e){const t=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,l){if(o)return n.replace(t,o[0].toString()).replace(i,o[1].toString()).replace(r,o[2].toString()).replace(s,function(){const u=o[0],h=e.getFullTileRange(u);return Ye(h,55),(h.getHeight()-o[2]-1).toString()})}}function Sk(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=UQ(n[r],e);return m0(i)}function m0(n){return n.length===1?n[0]:function(e,t,i){if(!e)return;const r=dk(e),s=Qa(r,n.length);return n[s](e,t,i)}}function GQ(n,e,t){}function kE(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}class Ck extends s_{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Ck.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=be(t),r=t.getState();let s;r==ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=Eg.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==ce.ERROR?Eg.TILELOADERROR:r==ce.LOADED?Eg.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new nG(s,t))}setTileLoadFunction(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=kE(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Sk(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}useTile(e,t,i){const r=sl(e,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}const Ik=Ck;class jQ extends Ik{constructor(e){const t=e.projection||"EPSG:3857",i=e.extent||Gc(t),r=e.tileGrid||Df({extent:i,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,opaque:!1,projection:t,state:e.state,tileGrid:r,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:iG,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.sourceTileCache=new t_(this.tileCache.highWaterMark),this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:OU,this.tileGrids_={}}getFeaturesInExtent(e){const t=[],i=this.tileCache;if(i.getCount()===0)return t;const r=MU(i.peekFirstKey())[0],s=this.tileGrid;return i.forEach(function(o){if(o.tileCoord[0]!==r||o.getState()!==ce.LOADED)return;const a=o.getSourceTiles();for(let l=0,u=a.length;l<u;++l){const h=a[l],p=h.tileCoord;if(un(e,s.getTileCoordExtent(p))){const m=h.getFeatures();if(m)for(let y=0,x=m.length;y<x;++y){const w=m[y],R=w.getGeometry();un(e,R.getExtent())&&t.push(w)}}}}),t}getOverlaps(){return this.overlaps_}clear(){this.tileCache.clear(),this.sourceTileCache.clear()}expireCache(e,t){const i=this.getTileCacheForProjection(e),r=Object.keys(t).reduce((s,o)=>{const a=nZ(o),l=i.peek(a);if(l){const u=l.sourceTiles;for(let h=0,p=u.length;h<p;++h)s[u[h].getKey()]=!0}return s},{});super.expireCache(e,t),this.sourceTileCache.expireCache(r)}getSourceTiles(e,t,i){if(i.getState()===ce.IDLE){i.setState(ce.LOADING);const r=i.wrappedTileCoord,s=this.getTileGridForProjection(t),o=s.getTileCoordExtent(r),a=r[0],l=s.getResolution(a);Rs(o,-l,o);const u=this.tileGrid,h=u.getExtent();h&&tr(o,h,o);const p=u.getZForResolution(l,this.zDirection);u.forEachTileCoord(o,p,m=>{const y=this.tileUrlFunction(m,e,t),x=this.sourceTileCache.containsKey(y)?this.sourceTileCache.get(y):new this.tileClass(m,y?ce.IDLE:ce.EMPTY,y,this.format_,this.tileLoadFunction);i.sourceTiles.push(x);const w=x.getState();if(w<ce.LOADED){const R=E=>{this.handleTileChange(E);const T=x.getState();if(T===ce.LOADED||T===ce.ERROR){const I=x.getKey();I in i.errorTileKeys?x.getState()===ce.LOADED&&delete i.errorTileKeys[I]:i.loadingSourceTiles--,T===ce.ERROR?i.errorTileKeys[I]=!0:x.removeEventListener(Re.CHANGE,R),i.loadingSourceTiles===0&&i.setState(Xh(i.errorTileKeys)?ce.LOADED:ce.ERROR)}};x.addEventListener(Re.CHANGE,R),i.loadingSourceTiles++}w===ce.IDLE&&(x.extent=u.getTileCoordExtent(m),x.projection=t,x.resolution=u.getResolution(m[0]),this.sourceTileCache.set(y,x),x.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(m=>m.getState()===ce.ERROR)?ce.ERROR:ce.LOADED)}return i.sourceTiles}getTile(e,t,i,r,s){const o=sl(e,t,i),a=this.getKey();let l;if(this.tileCache.containsKey(o)&&(l=this.tileCache.get(o),l.key===a))return l;const u=[e,t,i];let h=this.getTileCoordForTileUrlFunction(u,s);const p=this.getTileGrid().getExtent(),m=this.getTileGridForProjection(s);if(h&&p){const w=m.getTileCoordExtent(h);Rs(w,-m.getResolution(e),w),un(p,w)||(h=null)}let y=!0;if(h!==null){const w=this.tileGrid,R=m.getResolution(e),E=w.getZForResolution(R,1),T=m.getTileCoordExtent(h);Rs(T,-R,T),w.forEachTileCoord(T,E,I=>{y=y&&!this.tileUrlFunction(I,r,s)})}const x=new FU(u,y?ce.EMPTY:ce.IDLE,h,this.getSourceTiles.bind(this,r,s));return x.key=a,l?(x.interimTile=l,x.refreshInterimChain(),this.tileCache.replace(o,x)):this.tileCache.set(o,x),x}getTileGridForProjection(e){const t=e.getCode();let i=this.tileGrids_[t];if(!i){const r=this.tileGrid,s=r.getResolutions().slice(),o=s.map(function(u,h){return r.getOrigin(h)}),a=s.map(function(u,h){return r.getTileSize(h)}),l=uU+1;for(let u=s.length;u<l;++u)s.push(s[u-1]/2),o.push(o[u-1]),a.push(a[u-1]);i=new fu({extent:r.getExtent(),origins:o,resolutions:s,tileSizes:a}),this.tileGrids_[t]=i}return i}getTilePixelRatio(e){return e}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=dn(r.getTileSize(e),this.tmpSize);return[Math.round(s[0]*t),Math.round(s[1]*t)]}updateCacheSize(e,t){super.updateCacheSize(e*2,t),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(t).highWaterMark}}const Rk=jQ;function iG(n,e){n.setLoader(function(t,i,r){iU(e,n.getFormat(),t,i,r,n.onLoad.bind(n),n.onError.bind(n))})}class BQ extends qU{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(x1(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(x1(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return et()}readFeaturesFromObject(e,t){return et()}readGeometry(e,t){return this.readGeometryFromObject(x1(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return et()}readProjection(e){return this.readProjectionFromObject(x1(e))}readProjectionFromObject(e){return et()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return et()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return et()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return et()}}function x1(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}else if(n!==null)return n;return null}const VQ=BQ;class $Q extends VQ{constructor(e){e=e||{},super(),this.dataProjection=_t(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=_t(e.featureProjection)),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let i=null;e.type==="Feature"?i=e:i={type:"Feature",geometry:e,properties:null};const r=vR(i.geometry,t),s=new pr;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&s.setGeometryName(i.geometry_name),s.setGeometry(r),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(e,t){const i=e;let r=null;if(i.type==="FeatureCollection"){const s=e;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a)r.push(this.readFeatureFromObject(o[a],t))}else r=[this.readFeatureFromObject(e,t)];return r}readGeometryFromObject(e,t){return vR(e,t)}readProjectionFromObject(e){const t=e.crs;let i;return t?t.type=="name"?i=_t(t.properties.name):t.type==="EPSG"?i=_t("EPSG:"+t.properties.code):Ye(!1,36):i=this.dataProjection,i}writeFeatureObject(e,t){t=this.adaptOptions(t);const i={type:"Feature",geometry:null,properties:null},r=e.getId();if(r!==void 0&&(i.id=r),!e.hasProperties())return i;const s=e.getProperties(),o=e.getGeometry();return o&&(i.geometry=xR(o,t),delete s[e.getGeometryName()]),Xh(s)||(i.properties=s),i}writeFeaturesObject(e,t){t=this.adaptOptions(t);const i=[];for(let r=0,s=e.length;r<s;++r)i.push(this.writeFeatureObject(e[r],t));return{type:"FeatureCollection",features:i}}writeGeometryObject(e,t){return xR(e,this.adaptOptions(t))}}function vR(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=HQ(n);break}case"LineString":{t=XQ(n);break}case"Polygon":{t=ZQ(n);break}case"MultiPoint":{t=KQ(n);break}case"MultiLineString":{t=qQ(n);break}case"MultiPolygon":{t=YQ(n);break}case"GeometryCollection":{t=WQ(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return mk(t,!1,e)}function WQ(n,e){const t=n.geometries.map(function(i){return vR(i,e)});return new vk(t)}function HQ(n){return new bs(n.coordinates)}function XQ(n){return new da(n.coordinates)}function qQ(n){return new n_(n.coordinates)}function KQ(n){return new i_(n.coordinates)}function YQ(n){return new r_(n.coordinates)}function ZQ(n){return new Pc(n.coordinates)}function xR(n,e){n=mk(n,!0,e);const t=n.getType();let i;switch(t){case"Point":{i=iJ(n);break}case"LineString":{i=JQ(n);break}case"Polygon":{i=rJ(n,e);break}case"MultiPoint":{i=tJ(n);break}case"MultiLineString":{i=eJ(n);break}case"MultiPolygon":{i=nJ(n,e);break}case"GeometryCollection":{i=QQ(n,e);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return i}function QQ(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return xR(i,e)})}}function JQ(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function eJ(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function tJ(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function nJ(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function iJ(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function rJ(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const sJ=$Q;class oJ extends EE{constructor(e,t,i,r,s,o,a){const l=e.getExtent(),u=t.getExtent(),h=u?tr(i,u):i,p=er(h),m=p0(e,t,p,r),y=xk,x=new wk(e,t,h,l,m*y,r),w=x.calculateSourceExtent(),R=o(w,m,s),E=R?st.IDLE:st.EMPTY,T=R?R.getPixelRatio():1;super(i,r,T,E),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=x,this.targetResolution_=r,this.targetExtent_=i,this.sourceImage_=R,this.sourcePixelRatio_=T,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==st.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==st.LOADED){const t=gt(this.targetExtent_)/this.targetResolution_,i=rn(this.targetExtent_)/this.targetResolution_;this.canvas_=Ek(t,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_)}this.state=e,this.changed()}load(){if(this.state==st.IDLE){this.state=st.LOADING,this.changed();const e=this.sourceImage_.getState();e==st.LOADED||e==st.ERROR?this.reproject_():(this.sourceListenerKey_=Ve(this.sourceImage_,Re.CHANGE,function(t){const i=this.sourceImage_.getState();(i==st.LOADED||i==st.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}unlistenSource_(){zt(this.sourceListenerKey_),this.sourceListenerKey_=null}}const aJ=oJ,QS={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class lJ extends Vi{constructor(e,t){super(e),this.image=t}}class uJ extends Pf{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const i=hE(t,e,0);e=t[i]}return e}getImage(e,t,i,r){const s=this.getProjection();if(!s||!r||rs(s,r))return s&&(r=s),this.getImageInternal(e,t,i,r);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&rs(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==t&&Oo(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new aJ(s,r,e,t,i,(o,a,l)=>this.getImageInternal(o,a,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,i,r){return et()}handleImageChange(e){const t=e.target;let i;switch(t.getState()){case st.LOADING:this.loading=!0,i=QS.IMAGELOADSTART;break;case st.LOADED:this.loading=!1,i=QS.IMAGELOADEND;break;case st.ERROR:this.loading=!1,i=QS.IMAGELOADERROR;break;default:return}this.hasListener(i)&&this.dispatchEvent(new lJ(i,t))}}function PE(n,e){n.getImage().src=e}const jc=uJ;class cJ extends cu{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getPreload(){return this.get(lc.PRELOAD)}setPreload(e){this.set(lc.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(lc.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(lc.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}const rG=cJ;class hJ extends rG{constructor(e){super(e)}createRenderer(){return new eG(this)}}const sG=hJ;let oG=!0;try{new ImageData(10,10)}catch{oG=!1}let JS;function fJ(n,e,t){if(oG)return new ImageData(n,e,t);JS||(JS=document.createElement("canvas").getContext("2d"));const i=JS.createImageData(e,t);return i.data.set(n),i}function aG(n){let e=!0;try{new ImageData(10,10)}catch{e=!1}function t(i,r,s){return e?new ImageData(i,r,s):{data:i,width:r,height:s}}return function(i){const r=i.buffers,s=i.meta,o=i.imageOps,a=i.width,l=i.height,u=r.length,h=r[0].byteLength;if(o){const x=new Array(u);for(let R=0;R<u;++R)x[R]=t(new Uint8ClampedArray(r[R]),a,l);return n(x,s).data.buffer}const p=new Uint8ClampedArray(h),m=new Array(u),y=new Array(u);for(let x=0;x<u;++x)m[x]=new Uint8ClampedArray(r[x]),y[x]=[0,0,0,0];for(let x=0;x<h;x+=4){for(let R=0;R<u;++R){const E=m[R];y[R][0]=E[x],y[R][1]=E[x+1],y[R][2]=E[x+2],y[R][3]=E[x+3]}const w=n(y,s);p[x]=w[0],p[x+1]=w[1],p[x+2]=w[2],p[x+3]=w[3]}return p.buffer}}function dJ(n,e){const i=Object.keys(n.lib||{}).map(function(s){return"const "+s+" = "+n.lib[s].toString()+";"}).concat(["const __minion__ = ("+aG.toString()+")(",n.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),r=new Worker(typeof Blob>"u"?"data:text/javascript;base64,"+Buffer.from(i.join(`
`),"binary").toString("base64"):URL.createObjectURL(new Blob(i,{type:"text/javascript"})));return r.addEventListener("message",e),r}function gJ(n,e){const t=aG(n.operation);let i=!1;return{postMessage:function(r){setTimeout(function(){i||e({data:{buffer:t(r),meta:r.meta}})},0)},terminate:function(){i=!0}}}class pJ extends hp{constructor(e){super(),this._imageOps=!!e.imageOps;let t;e.threads===0?t=0:this._imageOps?t=1:t=e.threads||1;const i=new Array(t);if(t)for(let r=0;r<t;++r)i[r]=dJ(e,this._onWorkerMessage.bind(this,r));else i[0]=gJ(e,this._onWorkerMessage.bind(this,0));this._workers=i,this._queue=[],this._maxQueueLength=e.queue||1/0,this._running=0,this._dataLookup={},this._job=null}process(e,t,i){this._enqueue({inputs:e,meta:t,callback:i}),this._dispatch()}_enqueue(e){for(this._queue.push(e);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)}_dispatch(){if(this._running||this._queue.length===0)return;const e=this._queue.shift();this._job=e;const t=e.inputs[0].width,i=e.inputs[0].height,r=e.inputs.map(function(l){return l.data.buffer}),s=this._workers.length;if(this._running=s,s===1){this._workers[0].postMessage({buffers:r,meta:e.meta,imageOps:this._imageOps,width:t,height:i},r);return}const o=e.inputs[0].data.length,a=4*Math.ceil(o/4/s);for(let l=0;l<s;++l){const u=l*a,h=[];for(let p=0,m=r.length;p<m;++p)h.push(r[p].slice(u,u+a));this._workers[l].postMessage({buffers:h,meta:e.meta,imageOps:this._imageOps,width:t,height:i},h)}}_onWorkerMessage(e,t){this.disposed||(this._dataLookup[e]=t.data,--this._running,this._running===0&&this._resolveJob())}_resolveJob(){const e=this._job,t=this._workers.length;let i,r;if(t===1)i=new Uint8ClampedArray(this._dataLookup[0].buffer),r=this._dataLookup[0].meta;else{const s=e.inputs[0].data.length;i=new Uint8ClampedArray(s),r=new Array(t);const o=4*Math.ceil(s/4/t);for(let a=0;a<t;++a){const l=this._dataLookup[a].buffer,u=a*o;i.set(new Uint8ClampedArray(l),u),r[a]=this._dataLookup[a].meta}}this._job=null,this._dataLookup={},e.callback(null,fJ(i,e.inputs[0].width,e.inputs[0].height),r),this._dispatch()}disposeInternal(){for(let e=0;e<this._workers.length;++e)this._workers[e].terminate();this._workers.length=0}}const AD={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"};class kD extends Vi{constructor(e,t,i){super(e),this.extent=t.extent,this.resolution=t.viewState.resolution/t.pixelRatio,this.data=i}}class lG extends jc{constructor(e){super({projection:null}),this.on,this.once,this.un,this.processor_=null,this.operationType_=e.operationType!==void 0?e.operationType:"pixel",this.threads_=e.threads!==void 0?e.threads:1,this.layers_=_J(e.sources);const t=this.changed.bind(this);for(let i=0,r=this.layers_.length;i<r;++i)this.layers_[i].addEventListener(Re.CHANGE,t);this.useResolutions_=e.resolutions!==null,this.tileQueue_=new rk(function(){return 1},this.changed.bind(this)),this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:Hn(),declutterTree:null,extent:null,index:0,layerIndex:0,layerStatesArray:yJ(this.layers_),pixelRatio:1,pixelToCoordinateTransform:Hn(),postRenderFunctions:[],size:[0,0],tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:be(this),renderTargets:{}},this.setAttributions(function(i){const r=[];for(let s=0,o=e.sources.length;s<o;++s){const a=e.sources[s],l=a instanceof Pf?a:a.getSource();if(!l)continue;const u=l.getAttributions();if(typeof u=="function"){const h=u(i);r.push.apply(r,h)}}return r.length!==0?r:null}),e.operation!==void 0&&this.setOperation(e.operation,e.lib)}setOperation(e,t){this.processor_&&this.processor_.dispose(),this.processor_=new pJ({operation:e,imageOps:this.operationType_==="image",queue:1,lib:t,threads:this.threads_}),this.changed()}updateFrameState_(e,t,i){const r=Object.assign({},this.frameState_);r.viewState=Object.assign({},r.viewState);const s=er(e);r.size[0]=Math.ceil(gt(e)/t),r.size[1]=Math.ceil(rn(e)/t),r.extent=[s[0]-r.size[0]*t/2,s[1]-r.size[1]*t/2,s[0]+r.size[0]*t/2,s[1]+r.size[1]*t/2],r.time=Date.now();const o=r.viewState;return o.center=s,o.projection=i,o.resolution=t,r}allSourcesReady_(){let e=!0,t;for(let i=0,r=this.layers_.length;i<r;++i)if(t=this.layers_[i].getSource(),!t||t.getState()!=="ready"){e=!1;break}return e}getImage(e,t,i,r){if(!this.allSourcesReady_())return null;t=this.findNearestResolution(t);const s=this.updateFrameState_(e,t,r);if(this.requestedFrameState_=s,this.renderedImageCanvas_){const o=this.renderedImageCanvas_.getResolution(),a=this.renderedImageCanvas_.getExtent();(t!==o||!Oo(s.extent,a))&&(this.renderedImageCanvas_=null)}return(!this.renderedImageCanvas_||this.getRevision()!==this.renderedRevision_)&&this.processSources_(),s.tileQueue.loadMoreTiles(16,16),s.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_}processSources_(){const e=this.requestedFrameState_,t=this.layers_.length,i=new Array(t);for(let s=0;s<t;++s){e.layerIndex=s;const o=mJ(this.layers_[s],e);if(o)i[s]=o;else return}const r={};this.dispatchEvent(new kD(AD.BEFOREOPERATIONS,e,r)),this.processor_.process(i,r,this.onWorkerComplete_.bind(this,e))}onWorkerComplete_(e,t,i,r){if(t||!i)return;const s=e.extent,o=e.viewState.resolution;if(o!==this.requestedFrameState_.viewState.resolution||!Oo(s,this.requestedFrameState_.extent))return;let a;if(this.renderedImageCanvas_)a=this.renderedImageCanvas_.getImage().getContext("2d");else{const l=Math.round(gt(s)/o),u=Math.round(rn(s)/o);a=mn(l,u),this.renderedImageCanvas_=new TE(s,o,1,a.canvas)}a.putImageData(i,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new kD(AD.AFTEROPERATIONS,e,r)),e.animate&&requestAnimationFrame(this.changed.bind(this))}getResolutions(e){if(!this.useResolutions_)return null;let t=super.getResolutions();if(!t)for(let i=0,r=this.layers_.length;i<r&&(t=this.layers_[i].getSource().getResolutions(e),!t);++i);return t}disposeInternal(){this.processor_&&this.processor_.dispose(),super.disposeInternal()}}lG.prototype.dispose;let gh=null;function mJ(n,e){const t=n.getRenderer();if(!t)throw new Error("Unsupported layer type: "+n);if(!t.prepareFrame(e))return null;const i=e.size[0],r=e.size[1];if(i===0||r===0)return null;const s=t.renderFrame(e,null);let o;if(s instanceof HTMLCanvasElement)o=s;else{if(s&&(o=s.firstElementChild),!(o instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+o);if(o.width===i&&o.height===r)return o.getContext("2d").getImageData(0,0,i,r)}if(!gh)gh=mn(i,r,void 0,{willReadFrequently:!0});else{const a=gh.canvas;a.width!==i||a.height!==r?gh=mn(i,r,void 0,{willReadFrequently:!0}):gh.clearRect(0,0,i,r)}return gh.drawImage(o,0,0,i,r),gh.getImageData(0,0,i,r)}function yJ(n){return n.map(function(e){return e.getLayerState()})}function _J(n){const e=n.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=vJ(n[i]);return t}function vJ(n){let e;return n instanceof Pf?n instanceof s_?e=new sG({source:n}):n instanceof jc&&(e=new XU({source:n})):e=n,e}const xJ=lG;class wJ extends Ik{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:EJ,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Xg,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const r in this.tileCacheForProjection){const s=this.tileCacheForProjection[r];s.expireCache(s==i?t:{})}}getGutterForProjection(e){return this.getProjection()&&e&&!rs(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getOpaque(e){return this.getProjection()&&e&&!rs(this.getProjection(),e)?!1:super.getOpaque(e)}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||rs(t,e)))return this.tileGrid;const i=be(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Tk(e)),this.tileGridForProjection[i]}getTileCacheForProjection(e){const t=this.getProjection();if(!t||rs(t,e))return this.tileCache;const i=be(e);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new t_(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],l=this.getTileCoordForTileUrlFunction(a,s),u=l?this.tileUrlFunction(l,r,s):void 0,h=new this.tileClass(a,u!==void 0?ce.IDLE:ce.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(Re.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,i,r,s){const o=this.getProjection();if(!o||!s||rs(o,s))return this.getTileInternal(e,t,i,r,o||s);const a=this.getTileCacheForProjection(s),l=[e,t,i];let u;const h=u0(l);a.containsKey(h)&&(u=a.get(h));const p=this.getKey();if(u&&u.key==p)return u;const m=this.getTileGridForProjection(o),y=this.getTileGridForProjection(s),x=this.getTileCoordForTileUrlFunction(l,s),w=new Yg(o,m,s,y,l,x,this.getTilePixelRatio(r),this.getGutter(),(R,E,T,I)=>this.getTileInternal(R,E,T,I,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return w.key=p,u?(w.interimTile=u,w.refreshInterimChain(),a.replace(h,w)):a.set(h,w),w}getTileInternal(e,t,i,r,s){let o=null;const a=sl(e,t,i),l=this.getKey();if(!this.tileCache.containsKey(a))o=this.createTile_(e,t,i,r,s,l),this.tileCache.set(a,o);else if(o=this.tileCache.get(a),o.key!=l){const u=o;o=this.createTile_(e,t,i,r,s,l),u.getState()==ce.IDLE?o.interimTile=u.interimTile:o.interimTile=u,o.refreshInterimChain(),this.tileCache.replace(a,o)}return o}setRenderReprojectionEdges(e){if(this.renderReprojectionEdges_!=e){this.renderReprojectionEdges_=e;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(e,t){const i=_t(e);if(i){const r=be(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}clear(){super.clear();for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}function EJ(n,e){n.getImage().src=e}const du=wJ;function LE(n,e,t,i){const r=document.createElement("script"),s="olc_"+be(e);function o(){delete window[s],r.parentNode.removeChild(r)}r.async=!0,r.src=n+(n.includes("?")?"&":"?")+(i||"callback")+"="+s;const a=setTimeout(function(){o(),t&&t()},1e4);window[s]=function(l){clearTimeout(a),o(),e(l)},document.head.appendChild(r)}class TJ extends du{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:_t("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)LE(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):Ye(!1,51)}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let i;try{i=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){const t=_t("EPSG:4326"),i=this.getProjection();let r;if(e.bounds!==void 0){const u=Uc(t,i);r=Vg(e.bounds,u)}const s=Gc(i),o=e.minzoom||0,a=e.maxzoom||22,l=Df({extent:s,maxZoom:a,minZoom:o,tileSize:this.tileSize_});if(this.tileGrid=l,this.tileUrlFunction=Sk(e.tiles,l),e.attribution&&!this.getAttributions()){const u=r!==void 0?r:s;this.setAttributions(function(h){return un(u,h.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}}const uG=TJ;var SJ={},cG,PD={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function xy(n){return n=Math.round(n),n<0?0:n>255?255:n}function LD(n){return n<0?0:n>1?1:n}function eC(n){return n[n.length-1]==="%"?xy(parseFloat(n)/100*255):xy(parseInt(n))}function w1(n){return n[n.length-1]==="%"?LD(parseFloat(n)/100):LD(parseFloat(n))}function tC(n,e,t){return t<0?t+=1:t>1&&(t-=1),t*6<1?n+(e-n)*t*6:t*2<1?e:t*3<2?n+(e-n)*(2/3-t)*6:n}function CJ(n){var e=n.replace(/ /g,"").toLowerCase();if(e in PD)return PD[e].slice();if(e[0]==="#"){if(e.length===4){var t=parseInt(e.substr(1),16);return t>=0&&t<=4095?[(t&3840)>>4|(t&3840)>>8,t&240|(t&240)>>4,t&15|(t&15)<<4,1]:null}else if(e.length===7){var t=parseInt(e.substr(1),16);return t>=0&&t<=16777215?[(t&16711680)>>16,(t&65280)>>8,t&255,1]:null}return null}var i=e.indexOf("("),r=e.indexOf(")");if(i!==-1&&r+1===e.length){var s=e.substr(0,i),o=e.substr(i+1,r-(i+1)).split(","),a=1;switch(s){case"rgba":if(o.length!==4)return null;a=w1(o.pop());case"rgb":return o.length!==3?null:[eC(o[0]),eC(o[1]),eC(o[2]),a];case"hsla":if(o.length!==4)return null;a=w1(o.pop());case"hsl":if(o.length!==3)return null;var l=(parseFloat(o[0])%360+360)%360/360,u=w1(o[1]),h=w1(o[2]),p=h<=.5?h*(u+1):h+u-h*u,m=h*2-p;return[xy(tC(m,p,l+1/3)*255),xy(tC(m,p,l)*255),xy(tC(m,p,l-1/3)*255),a];default:return null}}return null}try{cG=SJ.parseCSSColor=CJ}catch{}var nr=function(e,t,i,r){r===void 0&&(r=1),this.r=e,this.g=t,this.b=i,this.a=r};nr.parse=function(e){if(e){if(e instanceof nr)return e;if(typeof e=="string"){var t=cG(e);if(t)return new nr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}};nr.prototype.toString=function(){var e=this.toArray(),t=e[0],i=e[1],r=e[2],s=e[3];return"rgba("+Math.round(t)+","+Math.round(i)+","+Math.round(r)+","+s+")"};nr.prototype.toArray=function(){var e=this,t=e.r,i=e.g,r=e.b,s=e.a;return s===0?[0,0,0,0]:[t*255/s,i*255/s,r*255/s,s]};nr.prototype.toArray01=function(){var e=this,t=e.r,i=e.g,r=e.b,s=e.a;return s===0?[0,0,0,0]:[t/s,i/s,r/s,s]};nr.prototype.toArray01PremultipliedAlpha=function(){var e=this,t=e.r,i=e.g,r=e.b,s=e.a;return[t,i,r,s]};nr.black=new nr(0,0,0,1);nr.white=new nr(1,1,1,1);nr.transparent=new nr(0,0,0,0);nr.red=new nr(1,0,0,1);nr.blue=new nr(0,0,1,1);var Zs=nr;function y0(n){return typeof n=="object"?["literal",n]:n}function IJ(n,e){var t=n.stops;if(!t)return RJ(n,e);var i=t&&typeof t[0][0]=="object",r=i||n.property!==void 0,s=i||!r;return t=t.map(function(o){return!r&&e.tokens&&typeof o[1]=="string"?[o[0],PJ(o[1])]:[o[0],y0(o[1])]}),i?bJ(n,e,t):s?kJ(n,e,t):wR(n,e,t)}function RJ(n,e){var t=["get",n.property];if(n.default===void 0)return e.type==="string"?["string",t]:t;if(e.type==="enum")return["match",t,Object.keys(e.values),t,n.default];var i=[e.type==="color"?"to-color":e.type,t,y0(n.default)];return e.type==="array"&&i.splice(1,0,e.value,e.length||null),i}function bk(n){switch(n.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function bJ(n,e,t){for(var i={},r={},s=[],o=0;o<t.length;o++){var a=t[o],l=a[0].zoom;i[l]===void 0&&(i[l]={zoom:l,type:n.type,property:n.property,default:n.default},r[l]=[],s.push(l)),r[l].push([a[0].value,a[1]])}var u=kk({},e);if(u==="exponential"){for(var h=[bk(n),["linear"],["zoom"]],p=0,m=s;p<m.length;p+=1){var y=m[p],x=wR(i[y],e,r[y]);Tg(h,y,x,!1)}return h}else{for(var w=["step",["zoom"]],R=0,E=s;R<E.length;R+=1){var T=E[R],I=wR(i[T],e,r[T]);Tg(w,T,I,!0)}return Ak(w),w}}function AJ(n,e){if(n!==void 0)return n;if(e!==void 0)return e}function MD(n,e){var t=y0(AJ(n.default,e.default));return t===void 0&&e.type==="resolvedImage"?"":t}function wR(n,e,t){var i=kk(n,e),r=["get",n.property];if(i==="categorical"&&typeof t[0][0]=="boolean"){for(var s=["case"],o=0,a=t;o<a.length;o+=1){var l=a[o];s.push(["==",r,l[0]],l[1])}return s.push(MD(n,e)),s}else if(i==="categorical"){for(var u=["match",r],h=0,p=t;h<p.length;h+=1){var m=p[h];Tg(u,m[0],m[1],!1)}return u.push(MD(n,e)),u}else if(i==="interval"){for(var y=["step",["number",r]],x=0,w=t;x<w.length;x+=1){var R=w[x];Tg(y,R[0],R[1],!0)}return Ak(y),n.default===void 0?y:["case",["==",["typeof",r],"number"],y,y0(n.default)]}else if(i==="exponential"){for(var E=n.base!==void 0?n.base:1,T=[bk(n),E===1?["linear"]:["exponential",E],["number",r]],I=0,A=t;I<A.length;I+=1){var L=A[I];Tg(T,L[0],L[1],!1)}return n.default===void 0?T:["case",["==",["typeof",r],"number"],T,y0(n.default)]}else throw new Error("Unknown property function type "+i)}function kJ(n,e,t,i){i===void 0&&(i=["zoom"]);var r=kk(n,e),s,o=!1;if(r==="interval")s=["step",i],o=!0;else if(r==="exponential"){var a=n.base!==void 0?n.base:1;s=[bk(n),a===1?["linear"]:["exponential",a],i]}else throw new Error('Unknown zoom function type "'+r+'"');for(var l=0,u=t;l<u.length;l+=1){var h=u[l];Tg(s,h[0],h[1],o)}return Ak(s),s}function Ak(n){n[0]==="step"&&n.length===3&&(n.push(0),n.push(n[3]))}function Tg(n,e,t,i){n.length>3&&e===n[n.length-2]||(i&&n.length===2||n.push(e),n.push(t))}function kk(n,e){return n.type?n.type:e.expression.interpolated?"exponential":"interval"}function PJ(n){for(var e=["concat"],t=/{([^{}]+)}/g,i=0,r=t.exec(n);r!==null;r=t.exec(n)){var s=n.slice(i,t.lastIndex-r[0].length);i=t.lastIndex,s.length>0&&e.push(s),e.push(["get",r[1]])}if(e.length===1)return n;if(i<n.length)e.push(n.slice(i));else if(e.length===2)return["to-string",e[1]];return e}var LJ=function(n){function e(t,i){n.call(this,i),this.message=i,this.key=t}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(Error),Xa=LJ,_0=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,r=t;i<r.length;i+=1){var s=r[i],o=s[0],a=s[1];this.bindings[o]=a}};_0.prototype.concat=function(e){return new _0(this,e)};_0.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")};_0.prototype.has=function(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1};var MJ=_0,ME={kind:"null"},Ee={kind:"number"},kt={kind:"string"},xt={kind:"boolean"},ql={kind:"color"},Sg={kind:"object"},wt={kind:"value"},DJ={kind:"error"},DE={kind:"collator"},FE={kind:"formatted"},o_={kind:"resolvedImage"};function Co(n,e){return{kind:"array",itemType:n,N:e}}function Pn(n){if(n.kind==="array"){var e=Pn(n.itemType);return typeof n.N=="number"?"array<"+e+", "+n.N+">":n.itemType.kind==="value"?"array":"array<"+e+">"}else return n.kind}var FJ=[ME,Ee,kt,xt,ql,FE,Sg,Co(wt),o_];function v0(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!v0(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value")for(var t=0,i=FJ;t<i.length;t+=1){var r=i[t];if(!v0(r,e))return null}}return"Expected "+Pn(n)+" but found "+Pn(e)+" instead."}function Pk(n,e){return e.some(function(t){return t.kind===n.kind})}function x0(n,e){return e.some(function(t){return t==="null"?n===null:t==="array"?Array.isArray(n):t==="object"?n&&!Array.isArray(n)&&typeof n=="object":t===typeof n})}var Lk=function(e,t,i){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Lk.prototype.compare=function(e,t){return this.collator.compare(e,t)};Lk.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Mk=Lk,ER=function(e,t,i,r,s){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=i,this.fontStack=r,this.textColor=s},Kl=function(e){this.sections=e};Kl.fromString=function(e){return new Kl([new ER(e,null,null,null,null)])};Kl.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})};Kl.factory=function(e){return e instanceof Kl?e:Kl.fromString(e)};Kl.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")};Kl.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var r=i[t];if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);var s={};r.fontStack&&(s["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(s["font-scale"]=r.scale),r.textColor&&(s["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(s)}return e};var mp=Kl,w0=function(e){this.name=e.name,this.available=e.available};w0.prototype.toString=function(){return this.name};w0.fromString=function(e){return e?new w0({name:e,available:!1}):null};w0.prototype.serialize=function(){return["image",this.name]};var yp=w0;function hG(n,e,t,i){if(!(typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255)){var r=typeof i=="number"?[n,e,t,i]:[n,e,t];return"Invalid rgba value ["+r.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof i>"u"||typeof i=="number"&&i>=0&&i<=1?null:"Invalid rgba value ["+[n,e,t,i].join(", ")+"]: 'a' must be between 0 and 1."}function cw(n){if(n===null)return!0;if(typeof n=="string")return!0;if(typeof n=="boolean")return!0;if(typeof n=="number")return!0;if(n instanceof Zs)return!0;if(n instanceof Mk)return!0;if(n instanceof mp)return!0;if(n instanceof yp)return!0;if(Array.isArray(n)){for(var e=0,t=n;e<t.length;e+=1){var i=t[e];if(!cw(i))return!1}return!0}else if(typeof n=="object"){for(var r in n)if(!cw(n[r]))return!1;return!0}else return!1}function Ui(n){if(n===null)return ME;if(typeof n=="string")return kt;if(typeof n=="boolean")return xt;if(typeof n=="number")return Ee;if(n instanceof Zs)return ql;if(n instanceof Mk)return DE;if(n instanceof mp)return FE;if(n instanceof yp)return o_;if(Array.isArray(n)){for(var e=n.length,t,i=0,r=n;i<r.length;i+=1){var s=r[i],o=Ui(s);if(!t)t=o;else{if(t===o)continue;t=wt;break}}return Co(t||wt,e)}else return Sg}function wy(n){var e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Zs||n instanceof mp||n instanceof yp?n.toString():JSON.stringify(n)}var ef=function(e,t){this.type=e,this.value=t};ef.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!cw(e[1]))return t.error("invalid value");var i=e[1],r=Ui(i),s=t.expectedType;return r.kind==="array"&&r.N===0&&s&&s.kind==="array"&&(typeof s.N!="number"||s.N===0)&&(r=s),new ef(r,i)};ef.prototype.evaluate=function(){return this.value};ef.prototype.eachChild=function(){};ef.prototype.outputDefined=function(){return!0};ef.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Zs?["rgba"].concat(this.value.toArray()):this.value instanceof mp?this.value.serialize():this.value};var hw=ef,fG=function(e){this.name="ExpressionEvaluationError",this.message=e};fG.prototype.toJSON=function(){return this.message};var yr=fG,nC={string:kt,number:Ee,boolean:xt,object:Sg},tf=function(e,t){this.type=e,this.args=t};tf.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=1,r,s=e[0];if(s==="array"){var o;if(e.length>2){var a=e[1];if(typeof a!="string"||!(a in nC)||a==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=nC[a],i++}else o=wt;var l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);l=e[2],i++}r=Co(o,l)}else r=nC[s];for(var u=[];i<e.length;i++){var h=t.parse(e[i],i,wt);if(!h)return null;u.push(h)}return new tf(r,u)};tf.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e),r=v0(this.type,Ui(i));if(r){if(t===this.args.length-1)throw new yr("Expected value to be of type "+Pn(this.type)+", but found "+Pn(Ui(i))+" instead.")}else return i}return null};tf.prototype.eachChild=function(e){this.args.forEach(e)};tf.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})};tf.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var r=e.N;(typeof r=="number"||this.args.length>1)&&t.push(r)}}return t.concat(this.args.map(function(s){return s.serialize()}))};var Ol=tf,nf=function(e){this.type=FE,this.sections=e};nf.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var r=[],s=!1,o=1;o<=e.length-1;++o){var a=e[o];if(s&&typeof a=="object"&&!Array.isArray(a)){s=!1;var l=null;if(a["font-scale"]&&(l=t.parse(a["font-scale"],1,Ee),!l))return null;var u=null;if(a["text-font"]&&(u=t.parse(a["text-font"],1,Co(kt)),!u))return null;var h=null;if(a["text-color"]&&(h=t.parse(a["text-color"],1,ql),!h))return null;var p=r[r.length-1];p.scale=l,p.font=u,p.textColor=h}else{var m=t.parse(e[o],1,wt);if(!m)return null;var y=m.type.kind;if(y!=="string"&&y!=="value"&&y!=="null"&&y!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");s=!0,r.push({content:m,scale:null,font:null,textColor:null})}}return new nf(r)};nf.prototype.evaluate=function(e){var t=function(i){var r=i.content.evaluate(e);return Ui(r)===o_?new ER("",r,null,null,null):new ER(wy(r),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)};return new mp(this.sections.map(t))};nf.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var r=i[t];e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}};nf.prototype.outputDefined=function(){return!1};nf.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var r=i[t];e.push(r.content.serialize());var s={};r.scale&&(s["font-scale"]=r.scale.serialize()),r.font&&(s["text-font"]=r.font.serialize()),r.textColor&&(s["text-color"]=r.textColor.serialize()),e.push(s)}return e};var dG=nf,rf=function(e){this.type=o_,this.input=e};rf.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,kt);return i?new rf(i):t.error("No image name provided.")};rf.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=yp.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i};rf.prototype.eachChild=function(e){e(this.input)};rf.prototype.outputDefined=function(){return!1};rf.prototype.serialize=function(){return["image",this.input.serialize()]};var gG=rf,OJ={"to-boolean":xt,"to-color":ql,"to-number":Ee,"to-string":kt},sf=function(e,t){this.type=e,this.args=t};sf.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var r=OJ[i],s=[],o=1;o<e.length;o++){var a=t.parse(e[o],o,wt);if(!a)return null;s.push(a)}return new sf(r,s)};sf.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,i,r=0,s=this.args;r<s.length;r+=1){var o=s[r];if(t=o.evaluate(e),i=null,t instanceof Zs)return t;if(typeof t=="string"){var a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&(t.length<3||t.length>4?i="Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":i=hG(t[0],t[1],t[2],t[3]),!i))return new Zs(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new yr(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}else if(this.type.kind==="number"){for(var l=null,u=0,h=this.args;u<h.length;u+=1){var p=h[u];if(l=p.evaluate(e),l===null)return 0;var m=Number(l);if(!isNaN(m))return m}throw new yr("Could not convert "+JSON.stringify(l)+" to number.")}else return this.type.kind==="formatted"?mp.fromString(wy(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?yp.fromString(wy(this.args[0].evaluate(e))):wy(this.args[0].evaluate(e))};sf.prototype.eachChild=function(e){this.args.forEach(e)};sf.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})};sf.prototype.serialize=function(){if(this.type.kind==="formatted")return new dG([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new gG(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var rg=sf,NJ=["Unknown","Point","LineString","Polygon"],Bc=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null};Bc.prototype.id=function(){return this.feature&&this.feature.id!==void 0?this.feature.id:null};Bc.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?NJ[this.feature.type]:this.feature.type:null};Bc.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null};Bc.prototype.canonicalID=function(){return this.canonical};Bc.prototype.properties=function(){return this.feature&&this.feature.properties||{}};Bc.prototype.distanceFromCenter=function(){if(this.featureTileCoord&&this.featureDistanceData){var e=this.featureDistanceData.center,t=this.featureDistanceData.scale,i=this.featureTileCoord,r=i.x,s=i.y,o=r*t-e[0],a=s*t-e[1],l=this.featureDistanceData.bearing[0],u=this.featureDistanceData.bearing[1],h=l*o+u*a;return h}return 0};Bc.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Zs.parse(e)),t};var pG=Bc,ga=function(e,t,i,r){this.name=e,this.type=t,this._evaluate=i,this.args=r};ga.prototype.evaluate=function(e){return this._evaluate(e,this.args)};ga.prototype.eachChild=function(e){this.args.forEach(e)};ga.prototype.outputDefined=function(){return!1};ga.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))};ga.parse=function(e,t){var i,r=e[0],s=ga.definitions[r];if(!s)return t.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(s)?s[0]:s.type,a=Array.isArray(s)?[[s[1],s[2]]]:s.overloads,l=a.filter(function(he){var de=he[0];return!Array.isArray(de)||de.length===e.length-1}),u=null,h=0,p=l;h<p.length;h+=1){var m=p[h],y=m[0],x=m[1];u=new wG(t.registry,t.path,null,t.scope);for(var w=[],R=!1,E=1;E<e.length;E++){var T=e[E],I=Array.isArray(y)?y[E-1]:y.type,A=u.parse(T,1+w.length,I);if(!A){R=!0;break}w.push(A)}if(!R){if(Array.isArray(y)&&y.length!==w.length){u.error("Expected "+y.length+" arguments, but found "+w.length+" instead.");continue}for(var L=0;L<w.length;L++){var F=Array.isArray(y)?y[L]:y.type,O=w[L];u.concat(L+1).checkSubtype(F,O.type)}if(u.errors.length===0)return new ga(r,o,x,w)}}if(l.length===1)(i=t.errors).push.apply(i,u.errors);else{for(var N=l.length?l:a,B=N.map(function(he){var de=he[0];return zJ(de)}).join(" | "),V=[],J=1;J<e.length;J++){var ge=t.parse(e[J],1+V.length);if(!ge)return null;V.push(Pn(ge.type))}t.error("Expected arguments of type "+B+", but found ("+V.join(", ")+") instead.")}return null};ga.register=function(e,t){ga.definitions=t;for(var i in t)e[i]=ga};function zJ(n){return Array.isArray(n)?"("+n.map(Pn).join(", ")+")":"("+Pn(n.type)+"...)"}var _p=ga,of=function(e,t,i){this.type=DE,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};of.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var r=t.parse(i["case-sensitive"]===void 0?!1:i["case-sensitive"],1,xt);if(!r)return null;var s=t.parse(i["diacritic-sensitive"]===void 0?!1:i["diacritic-sensitive"],1,xt);if(!s)return null;var o=null;return i.locale&&(o=t.parse(i.locale,1,kt),!o)?null:new of(r,s,o)};of.prototype.evaluate=function(e){return new Mk(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)};of.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)};of.prototype.outputDefined=function(){return!1};of.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var mG=of,vc=8192;function Dk(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function UJ(n){return(180+n)/360}function GJ(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function fw(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function jJ(n,e){var t=UJ(n[0]),i=GJ(n[1]),r=Math.pow(2,e.z);return[Math.round(t*r*vc),Math.round(i*r*vc)]}function BJ(n,e,t){var i=n[0]-e[0],r=n[1]-e[1],s=n[0]-t[0],o=n[1]-t[1];return i*o-s*r===0&&i*s<=0&&r*o<=0}function VJ(n,e,t){return e[1]>n[1]!=t[1]>n[1]&&n[0]<(t[0]-e[0])*(n[1]-e[1])/(t[1]-e[1])+e[0]}function Fk(n,e){for(var t=!1,i=0,r=e.length;i<r;i++)for(var s=e[i],o=0,a=s.length;o<a-1;o++){if(BJ(n,s[o],s[o+1]))return!1;VJ(n,s[o],s[o+1])&&(t=!t)}return t}function $J(n,e){for(var t=0;t<e.length;t++)if(Fk(n,e[t]))return!0;return!1}function WJ(n,e){return n[0]*e[1]-n[1]*e[0]}function DD(n,e,t,i){var r=n[0]-t[0],s=n[1]-t[1],o=e[0]-t[0],a=e[1]-t[1],l=i[0]-t[0],u=i[1]-t[1],h=r*u-l*s,p=o*u-l*a;return h>0&&p<0||h<0&&p>0}function HJ(n,e,t,i){var r=[e[0]-n[0],e[1]-n[1]],s=[i[0]-t[0],i[1]-t[1]];return WJ(s,r)===0?!1:!!(DD(n,e,t,i)&&DD(t,i,n,e))}function XJ(n,e,t){for(var i=0,r=t;i<r.length;i+=1)for(var s=r[i],o=0;o<s.length-1;++o)if(HJ(n,e,s[o],s[o+1]))return!0;return!1}function yG(n,e){for(var t=0;t<n.length;++t)if(!Fk(n[t],e))return!1;for(var i=0;i<n.length-1;++i)if(XJ(n[i],n[i+1],e))return!1;return!0}function qJ(n,e){for(var t=0;t<e.length;t++)if(yG(n,e[t]))return!0;return!1}function Ok(n,e,t){for(var i=[],r=0;r<n.length;r++){for(var s=[],o=0;o<n[r].length;o++){var a=jJ(n[r][o],t);Dk(e,a),s.push(a)}i.push(s)}return i}function _G(n,e,t){for(var i=[],r=0;r<n.length;r++){var s=Ok(n[r],e,t);i.push(s)}return i}function vG(n,e,t,i){if(n[0]<t[0]||n[0]>t[2]){var r=i*.5,s=n[0]-t[0]>r?-i:t[0]-n[0]>r?i:0;s===0&&(s=n[0]-t[2]>r?-i:t[2]-n[0]>r?i:0),n[0]+=s}Dk(e,n)}function KJ(n){n[0]=n[1]=1/0,n[2]=n[3]=-1/0}function FD(n,e,t,i){var r=Math.pow(2,i.z)*vc,s=[i.x*vc,i.y*vc],o=[];if(!n)return o;for(var a=0,l=n;a<l.length;a+=1)for(var u=l[a],h=0,p=u;h<p.length;h+=1){var m=p[h],y=[m.x+s[0],m.y+s[1]];vG(y,e,t,r),o.push(y)}return o}function OD(n,e,t,i){var r=Math.pow(2,i.z)*vc,s=[i.x*vc,i.y*vc],o=[];if(!n)return o;for(var a=0,l=n;a<l.length;a+=1){for(var u=l[a],h=[],p=0,m=u;p<m.length;p+=1){var y=m[p],x=[y.x+s[0],y.y+s[1]];Dk(e,x),h.push(x)}o.push(h)}if(e[2]-e[0]<=r/2){KJ(e);for(var w=0,R=o;w<R.length;w+=1)for(var E=R[w],T=0,I=E;T<I.length;T+=1){var A=I[T];vG(A,e,t,r)}}return o}function YJ(n,e){var t=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=n.canonicalID();if(!r)return!1;if(e.type==="Polygon"){var s=Ok(e.coordinates,i,r),o=FD(n.geometry(),t,i,r);if(!fw(t,i))return!1;for(var a=0,l=o;a<l.length;a+=1){var u=l[a];if(!Fk(u,s))return!1}}if(e.type==="MultiPolygon"){var h=_G(e.coordinates,i,r),p=FD(n.geometry(),t,i,r);if(!fw(t,i))return!1;for(var m=0,y=p;m<y.length;m+=1){var x=y[m];if(!$J(x,h))return!1}}return!0}function ZJ(n,e){var t=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=n.canonicalID();if(!r)return!1;if(e.type==="Polygon"){var s=Ok(e.coordinates,i,r),o=OD(n.geometry(),t,i,r);if(!fw(t,i))return!1;for(var a=0,l=o;a<l.length;a+=1){var u=l[a];if(!yG(u,s))return!1}}if(e.type==="MultiPolygon"){var h=_G(e.coordinates,i,r),p=OD(n.geometry(),t,i,r);if(!fw(t,i))return!1;for(var m=0,y=p;m<y.length;m+=1){var x=y[m];if(!qJ(x,h))return!1}}return!0}var Gl=function(e,t){this.type=xt,this.geojson=e,this.geometries=t};Gl.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(cw(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var r=0;r<i.features.length;++r){var s=i.features[r].geometry.type;if(s==="Polygon"||s==="MultiPolygon")return new Gl(i,i.features[r].geometry)}else if(i.type==="Feature"){var o=i.geometry.type;if(o==="Polygon"||o==="MultiPolygon")return new Gl(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Gl(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")};Gl.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return YJ(e,this.geometries);if(e.geometryType()==="LineString")return ZJ(e,this.geometries)}return!1};Gl.prototype.eachChild=function(){};Gl.prototype.outputDefined=function(){return!0};Gl.prototype.serialize=function(){return["within",this.geojson]};var Nk=Gl;function OE(n){if(n instanceof _p){if(n.name==="get"&&n.args.length===1)return!1;if(n.name==="feature-state")return!1;if(n.name==="has"&&n.args.length===1)return!1;if(n.name==="properties"||n.name==="geometry-type"||n.name==="id")return!1;if(/^filter-/.test(n.name))return!1}if(n instanceof Nk)return!1;var e=!0;return n.eachChild(function(t){e&&!OE(t)&&(e=!1)}),e}function zk(n){if(n instanceof _p&&n.name==="feature-state")return!1;var e=!0;return n.eachChild(function(t){e&&!zk(t)&&(e=!1)}),e}function Uk(n,e){if(n instanceof _p&&e.indexOf(n.name)>=0)return!1;var t=!0;return n.eachChild(function(i){t&&!Uk(i,e)&&(t=!1)}),t}var af=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};af.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new af(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)};af.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)};af.prototype.eachChild=function(){};af.prototype.outputDefined=function(){return!1};af.prototype.serialize=function(){return["var",this.name]};var xG=af,lf=function(e,t,i,r,s){t===void 0&&(t=[]),r===void 0&&(r=new MJ),s===void 0&&(s=[]),this.registry=e,this.path=t,this.key=t.map(function(o){return"["+o+"]"}).join(""),this.scope=r,this.errors=s,this.expectedType=i};lf.prototype.parse=function(e,t,i,r,s){return s===void 0&&(s={}),t?this.concat(t,i,r)._parse(e,s):this._parse(e,s)};lf.prototype._parse=function(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function i(h,p,m){return m==="assert"?new Ol(p,[h]):m==="coerce"?new rg(p,[h]):h}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=e[0];if(typeof r!="string")return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var s=this.registry[r];if(s){var o=s.parse(e,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,l=o.type;if((a.kind==="string"||a.kind==="number"||a.kind==="boolean"||a.kind==="object"||a.kind==="array")&&l.kind==="value")o=i(o,a,t.typeAnnotation||"assert");else if((a.kind==="color"||a.kind==="formatted"||a.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))o=i(o,a,t.typeAnnotation||"coerce");else if(this.checkSubtype(a,l))return null}if(!(o instanceof hw)&&o.type.kind!=="resolvedImage"&&TR(o)){var u=new pG;try{o=new hw(o.type,o.evaluate(u))}catch(h){return this.error(h.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof e+" instead.")};lf.prototype.concat=function(e,t,i){var r=typeof e=="number"?this.path.concat(e):this.path,s=i?this.scope.concat(i):this.scope;return new lf(this.registry,r,t||null,s,this.errors)};lf.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var r=""+this.key+t.map(function(s){return"["+s+"]"}).join("");this.errors.push(new Xa(r,e))};lf.prototype.checkSubtype=function(e,t){var i=v0(e,t);return i&&this.error(i),i};var wG=lf;function TR(n){if(n instanceof xG)return TR(n.boundExpression);if(n instanceof _p&&n.name==="error")return!1;if(n instanceof mG)return!1;if(n instanceof Nk)return!1;var e=n instanceof rg||n instanceof Ol,t=!0;return n.eachChild(function(i){e?t=t&&TR(i):t=t&&i instanceof hw}),t?OE(n)&&Uk(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]):!1}function EG(n,e){for(var t=n.length-1,i=0,r=t,s=0,o,a;i<=r;)if(s=Math.floor((i+r)/2),o=n[s],a=n[s+1],o<=e){if(s===t||e<a)return s;i=s+1}else if(o>e)r=s-1;else throw new yr("Input is not a number.");return 0}var uf=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var r=0,s=i;r<s.length;r+=1){var o=s[r],a=o[0],l=o[1];this.labels.push(a),this.outputs.push(l)}};uf.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Ee);if(!i)return null;var r=[],s=null;t.expectedType&&t.expectedType.kind!=="value"&&(s=t.expectedType);for(var o=1;o<e.length;o+=2){var a=o===1?-1/0:e[o],l=e[o+1],u=o,h=o+1;if(typeof a!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var p=t.parse(l,h,s);if(!p)return null;s=s||p.type,r.push([a,p])}return new uf(s,i,r)};uf.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var r=this.input.evaluate(e);if(r<=t[0])return i[0].evaluate(e);var s=t.length;if(r>=t[s-1])return i[s-1].evaluate(e);var o=EG(t,r);return i[o].evaluate(e)};uf.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1){var r=i[t];e(r)}};uf.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})};uf.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var TG=uf,QJ=vp;function vp(n,e,t,i){this.cx=3*n,this.bx=3*(t-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=i,this.p2x=t,this.p2y=i}vp.prototype.sampleCurveX=function(n){return((this.ax*n+this.bx)*n+this.cx)*n};vp.prototype.sampleCurveY=function(n){return((this.ay*n+this.by)*n+this.cy)*n};vp.prototype.sampleCurveDerivativeX=function(n){return(3*this.ax*n+2*this.bx)*n+this.cx};vp.prototype.solveCurveX=function(n,e){typeof e>"u"&&(e=1e-6);var t,i,r,s,o;for(r=n,o=0;o<8;o++){if(s=this.sampleCurveX(r)-n,Math.abs(s)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r=r-s/a}if(t=0,i=1,r=n,r<t)return t;if(r>i)return i;for(;t<i;){if(s=this.sampleCurveX(r),Math.abs(s-n)<e)return r;n>s?t=r:i=r,r=(i-t)*.5+t}return r};vp.prototype.solve=function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))};function Hs(n,e,t){return n*(1-t)+e*t}function JJ(n,e,t){return new Zs(Hs(n.r,e.r,t),Hs(n.g,e.g,t),Hs(n.b,e.b,t),Hs(n.a,e.a,t))}function eee(n,e,t){return n.map(function(i,r){return Hs(i,e[r],t)})}var tee=Object.freeze({__proto__:null,number:Hs,color:JJ,array:eee}),SG=.95047,CG=1,IG=1.08883,RG=4/29,Cg=6/29,bG=3*Cg*Cg,nee=Cg*Cg*Cg,iee=Math.PI/180,ree=180/Math.PI;function iC(n){return n>nee?Math.pow(n,1/3):n/bG+RG}function rC(n){return n>Cg?n*n*n:bG*(n-RG)}function sC(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function oC(n){return n/=255,n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function AG(n){var e=oC(n.r),t=oC(n.g),i=oC(n.b),r=iC((.4124564*e+.3575761*t+.1804375*i)/SG),s=iC((.2126729*e+.7151522*t+.072175*i)/CG),o=iC((.0193339*e+.119192*t+.9503041*i)/IG);return{l:116*s-16,a:500*(r-s),b:200*(s-o),alpha:n.a}}function kG(n){var e=(n.l+16)/116,t=isNaN(n.a)?e:e+n.a/500,i=isNaN(n.b)?e:e-n.b/200;return e=CG*rC(e),t=SG*rC(t),i=IG*rC(i),new Zs(sC(3.2404542*t-1.5371385*e-.4985314*i),sC(-.969266*t+1.8760108*e+.041556*i),sC(.0556434*t-.2040259*e+1.0572252*i),n.alpha)}function see(n,e,t){return{l:Hs(n.l,e.l,t),a:Hs(n.a,e.a,t),b:Hs(n.b,e.b,t),alpha:Hs(n.alpha,e.alpha,t)}}function oee(n){var e=AG(n),t=e.l,i=e.a,r=e.b,s=Math.atan2(r,i)*ree;return{h:s<0?s+360:s,c:Math.sqrt(i*i+r*r),l:t,alpha:n.a}}function aee(n){var e=n.h*iee,t=n.c,i=n.l;return kG({l:i,a:Math.cos(e)*t,b:Math.sin(e)*t,alpha:n.alpha})}function lee(n,e,t){var i=e-n;return n+t*(i>180||i<-180?i-360*Math.round(i/360):i)}function uee(n,e,t){return{h:lee(n.h,e.h,t),c:Hs(n.c,e.c,t),l:Hs(n.l,e.l,t),alpha:Hs(n.alpha,e.alpha,t)}}var E1={forward:AG,reverse:kG,interpolate:see},T1={forward:oee,reverse:aee,interpolate:uee},tu=function(e,t,i,r,s){this.type=e,this.operator=t,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=s;o<a.length;o+=1){var l=a[o],u=l[0],h=l[1];this.labels.push(u),this.outputs.push(h)}};tu.interpolationFactor=function(e,t,i,r){var s=0;if(e.name==="exponential")s=aC(t,e.base,i,r);else if(e.name==="linear")s=aC(t,1,i,r);else if(e.name==="cubic-bezier"){var o=e.controlPoints,a=new QJ(o[0],o[1],o[2],o[3]);s=a.solve(aC(t,1,i,r))}return s};tu.parse=function(e,t){var i=e[0],r=e[1],s=e[2],o=e.slice(3);if(!Array.isArray(r)||r.length===0)return t.error("Expected an interpolation type expression.",1);if(r[0]==="linear")r={name:"linear"};else if(r[0]==="exponential"){var a=r[1];if(typeof a!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else if(r[0]==="cubic-bezier"){var l=r.slice(1);if(l.length!==4||l.some(function(E){return typeof E!="number"||E<0||E>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:l}}else return t.error("Unknown interpolation type "+String(r[0]),1,0);if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(s=t.parse(s,2,Ee),!s)return null;var u=[],h=null;i==="interpolate-hcl"||i==="interpolate-lab"?h=ql:t.expectedType&&t.expectedType.kind!=="value"&&(h=t.expectedType);for(var p=0;p<o.length;p+=2){var m=o[p],y=o[p+1],x=p+3,w=p+4;if(typeof m!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',x);if(u.length&&u[u.length-1][0]>=m)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',x);var R=t.parse(y,w,h);if(!R)return null;h=h||R.type,u.push([m,R])}return h.kind!=="number"&&h.kind!=="color"&&!(h.kind==="array"&&h.itemType.kind==="number"&&typeof h.N=="number")?t.error("Type "+Pn(h)+" is not interpolatable."):new tu(h,i,r,s,u)};tu.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var r=this.input.evaluate(e);if(r<=t[0])return i[0].evaluate(e);var s=t.length;if(r>=t[s-1])return i[s-1].evaluate(e);var o=EG(t,r),a=t[o],l=t[o+1],u=tu.interpolationFactor(this.interpolation,r,a,l),h=i[o].evaluate(e),p=i[o+1].evaluate(e);return this.operator==="interpolate"?tee[this.type.kind.toLowerCase()](h,p,u):this.operator==="interpolate-hcl"?T1.reverse(T1.interpolate(T1.forward(h),T1.forward(p),u)):E1.reverse(E1.interpolate(E1.forward(h),E1.forward(p),u))};tu.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1){var r=i[t];e(r)}};tu.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})};tu.prototype.serialize=function(){var e;this.interpolation.name==="linear"?e=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?e=["linear"]:e=["exponential",this.interpolation.base]:e=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};function aC(n,e,t,i){var r=i-t,s=n-t;return r===0?0:e===1?s/r:(Math.pow(e,s)-1)/(Math.pow(e,r)-1)}var Oh=tu,xc=function(e,t){this.type=e,this.args=t};xc.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,r=t.expectedType;r&&r.kind!=="value"&&(i=r);for(var s=[],o=0,a=e.slice(1);o<a.length;o+=1){var l=a[o],u=t.parse(l,1+s.length,i,void 0,{typeAnnotation:"omit"});if(!u)return null;i=i||u.type,s.push(u)}var h=r&&s.some(function(p){return v0(r,p.type)});return h?new xc(wt,s):new xc(i,s)};xc.prototype.evaluate=function(e){for(var t=null,i=0,r,s=0,o=this.args;s<o.length;s+=1){var a=o[s];if(i++,t=a.evaluate(e),t&&t instanceof yp&&!t.available&&(r||(r=t),t=null,i===this.args.length))return r;if(t!==null)break}return t};xc.prototype.eachChild=function(e){this.args.forEach(e)};xc.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})};xc.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var PG=xc,cf=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};cf.prototype.evaluate=function(e){return this.result.evaluate(e)};cf.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1){var r=i[t];e(r[1])}e(this.result)};cf.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],r=1;r<e.length-1;r+=2){var s=e[r];if(typeof s!="string")return t.error("Expected string, but found "+typeof s+" instead.",r);if(/[^a-zA-Z0-9_]/.test(s))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=t.parse(e[r+1],r+1);if(!o)return null;i.push([s,o])}var a=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return a?new cf(i,a):null};cf.prototype.outputDefined=function(){return this.result.outputDefined()};cf.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var r=i[t],s=r[0],o=r[1];e.push(s,o.serialize())}return e.push(this.result.serialize()),e};var LG=cf,hf=function(e,t,i){this.type=e,this.index=t,this.input=i};hf.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ee),r=t.parse(e[2],2,Co(t.expectedType||wt));if(!i||!r)return null;var s=r.type;return new hf(s.itemType,i,r)};hf.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new yr("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new yr("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new yr("Array index must be an integer, but found "+t+" instead.");return i[t]};hf.prototype.eachChild=function(e){e(this.index),e(this.input)};hf.prototype.outputDefined=function(){return!1};hf.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var cee=hf,ff=function(e,t){this.type=xt,this.needle=e,this.haystack=t};ff.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,wt),r=t.parse(e[2],2,wt);return!i||!r?null:Pk(i.type,[xt,kt,Ee,ME,wt])?new ff(i,r):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Pn(i.type)+" instead")};ff.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(i==null)return!1;if(!x0(t,["boolean","string","number","null"]))throw new yr("Expected first argument to be of type boolean, string, number or null, but found "+Pn(Ui(t))+" instead.");if(!x0(i,["string","array"]))throw new yr("Expected second argument to be of type array or string, but found "+Pn(Ui(i))+" instead.");return i.indexOf(t)>=0};ff.prototype.eachChild=function(e){e(this.needle),e(this.haystack)};ff.prototype.outputDefined=function(){return!0};ff.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var hee=ff,wc=function(e,t,i){this.type=Ee,this.needle=e,this.haystack=t,this.fromIndex=i};wc.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,wt),r=t.parse(e[2],2,wt);if(!i||!r)return null;if(!Pk(i.type,[xt,kt,Ee,ME,wt]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Pn(i.type)+" instead");if(e.length===4){var s=t.parse(e[3],3,Ee);return s?new wc(i,r,s):null}else return new wc(i,r)};wc.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!x0(t,["boolean","string","number","null"]))throw new yr("Expected first argument to be of type boolean, string, number or null, but found "+Pn(Ui(t))+" instead.");if(!x0(i,["string","array"]))throw new yr("Expected second argument to be of type array or string, but found "+Pn(Ui(i))+" instead.");if(this.fromIndex){var r=this.fromIndex.evaluate(e);return i.indexOf(t,r)}return i.indexOf(t)};wc.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)};wc.prototype.outputDefined=function(){return!1};wc.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fee=wc,df=function(e,t,i,r,s,o){this.inputType=e,this.type=t,this.input=i,this.cases=r,this.outputs=s,this.otherwise=o};df.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!==1)return t.error("Expected an even number of arguments.");var i,r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var s={},o=[],a=2;a<e.length-1;a+=2){var l=e[a],u=e[a+1];Array.isArray(l)||(l=[l]);var h=t.concat(a);if(l.length===0)return h.error("Expected at least one branch label.");for(var p=0,m=l;p<m.length;p+=1){var y=m[p];if(typeof y!="number"&&typeof y!="string")return h.error("Branch labels must be numbers or strings.");if(typeof y=="number"&&Math.abs(y)>Number.MAX_SAFE_INTEGER)return h.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof y=="number"&&Math.floor(y)!==y)return h.error("Numeric branch labels must be integer values.");if(!i)i=Ui(y);else if(h.checkSubtype(i,Ui(y)))return null;if(typeof s[String(y)]<"u")return h.error("Branch labels must be unique.");s[String(y)]=o.length}var x=t.parse(u,a,r);if(!x)return null;r=r||x.type,o.push(x)}var w=t.parse(e[1],1,wt);if(!w)return null;var R=t.parse(e[e.length-1],e.length-1,r);return!R||w.type.kind!=="value"&&t.concat(1).checkSubtype(i,w.type)?null:new df(i,r,w,s,o,R)};df.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Ui(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise;return i.evaluate(e)};df.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)};df.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()};df.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),r=[],s={},o=0,a=i;o<a.length;o+=1){var l=a[o],u=s[this.cases[l]];u===void 0?(s[this.cases[l]]=r.length,r.push([this.cases[l],[l]])):r[u][1].push(l)}for(var h=function(w){return e.inputType.kind==="number"?Number(w):w},p=0,m=r;p<m.length;p+=1){var y=m[p],u=y[0],x=y[1];x.length===1?t.push(h(x[0])):t.push(x.map(h)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var dee=df,gf=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};gf.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!==0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var r=[],s=1;s<e.length-1;s+=2){var o=t.parse(e[s],s,xt);if(!o)return null;var a=t.parse(e[s+1],s+1,i);if(!a)return null;r.push([o,a]),i=i||a.type}var l=t.parse(e[e.length-1],e.length-1,i);return l?new gf(i,r,l):null};gf.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var r=i[t],s=r[0],o=r[1];if(s.evaluate(e))return o.evaluate(e)}return this.otherwise.evaluate(e)};gf.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var r=i[t],s=r[0],o=r[1];e(s),e(o)}e(this.otherwise)};gf.prototype.outputDefined=function(){return this.branches.every(function(e){e[0];var t=e[1];return t.outputDefined()})&&this.otherwise.outputDefined()};gf.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var gee=gf,Ec=function(e,t,i,r){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=r};Ec.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,wt),r=t.parse(e[2],2,Ee);if(!i||!r)return null;if(!Pk(i.type,[Co(wt),kt,wt]))return t.error("Expected first argument to be of type array or string, but found "+Pn(i.type)+" instead");if(e.length===4){var s=t.parse(e[3],3,Ee);return s?new Ec(i.type,i,r,s):null}else return new Ec(i.type,i,r)};Ec.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!x0(t,["string","array"]))throw new yr("Expected first argument to be of type array or string, but found "+Pn(Ui(t))+" instead.");if(this.endIndex){var r=this.endIndex.evaluate(e);return t.slice(i,r)}return t.slice(i)};Ec.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)};Ec.prototype.outputDefined=function(){return!1};Ec.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var pee=Ec;function ND(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function mee(n,e,t){return e===t}function yee(n,e,t){return e!==t}function _ee(n,e,t){return e<t}function vee(n,e,t){return e>t}function xee(n,e,t){return e<=t}function wee(n,e,t){return e>=t}function MG(n,e,t,i){return i.compare(e,t)===0}function Eee(n,e,t,i){return!MG(n,e,t,i)}function Tee(n,e,t,i){return i.compare(e,t)<0}function See(n,e,t,i){return i.compare(e,t)>0}function Cee(n,e,t,i){return i.compare(e,t)<=0}function Iee(n,e,t,i){return i.compare(e,t)>=0}function xp(n,e,t){var i=n!=="=="&&n!=="!=";return function(){function r(s,o,a){this.type=xt,this.lhs=s,this.rhs=o,this.collator=a,this.hasUntypedArgument=s.type.kind==="value"||o.type.kind==="value"}return r.parse=function(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");var l=o[0],u=a.parse(o[1],1,wt);if(!u)return null;if(!ND(l,u.type))return a.concat(1).error('"'+l+`" comparisons are not supported for type '`+Pn(u.type)+"'.");var h=a.parse(o[2],2,wt);if(!h)return null;if(!ND(l,h.type))return a.concat(2).error('"'+l+`" comparisons are not supported for type '`+Pn(h.type)+"'.");if(u.type.kind!==h.type.kind&&u.type.kind!=="value"&&h.type.kind!=="value")return a.error("Cannot compare types '"+Pn(u.type)+"' and '"+Pn(h.type)+"'.");i&&(u.type.kind==="value"&&h.type.kind!=="value"?u=new Ol(h.type,[u]):u.type.kind!=="value"&&h.type.kind==="value"&&(h=new Ol(u.type,[h])));var p=null;if(o.length===4){if(u.type.kind!=="string"&&h.type.kind!=="string"&&u.type.kind!=="value"&&h.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(p=a.parse(o[3],3,DE),!p)return null}return new r(u,h,p)},r.prototype.evaluate=function(o){var a=this.lhs.evaluate(o),l=this.rhs.evaluate(o);if(i&&this.hasUntypedArgument){var u=Ui(a),h=Ui(l);if(u.kind!==h.kind||!(u.kind==="string"||u.kind==="number"))throw new yr('Expected arguments for "'+n+'" to be (string, string) or (number, number), but found ('+u.kind+", "+h.kind+") instead.")}if(this.collator&&!i&&this.hasUntypedArgument){var p=Ui(a),m=Ui(l);if(p.kind!=="string"||m.kind!=="string")return e(o,a,l)}return this.collator?t(o,a,l,this.collator.evaluate(o)):e(o,a,l)},r.prototype.eachChild=function(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)},r.prototype.outputDefined=function(){return!0},r.prototype.serialize=function(){var o=[n];return this.eachChild(function(a){o.push(a.serialize())}),o},r}()}var Ree=xp("==",mee,MG),bee=xp("!=",yee,Eee),Aee=xp("<",_ee,Tee),kee=xp(">",vee,See),Pee=xp("<=",xee,Cee),Lee=xp(">=",wee,Iee),pf=function(e,t,i,r,s,o){this.type=kt,this.number=e,this.locale=t,this.currency=i,this.unit=r,this.minFractionDigits=s,this.maxFractionDigits=o};pf.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Ee);if(!i)return null;var r=e[2];if(typeof r!="object"||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");var s=null;if(r.locale&&(s=t.parse(r.locale,1,kt),!s))return null;var o=null;if(r.currency&&(o=t.parse(r.currency,1,kt),!o))return null;var a=null;if(r.unit&&(a=t.parse(r.unit,1,kt),!a))return null;var l=null;if(r["min-fraction-digits"]&&(l=t.parse(r["min-fraction-digits"],1,Ee),!l))return null;var u=null;return r["max-fraction-digits"]&&(u=t.parse(r["max-fraction-digits"],1,Ee),!u)?null:new pf(i,s,o,a,l,u)};pf.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency&&"currency"||this.unit&&"unit"||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))};pf.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)};pf.prototype.outputDefined=function(){return!1};pf.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Mee=pf,mf=function(e){this.type=Ee,this.input=e};mf.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Pn(i.type)+" instead."):new mf(i):null};mf.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new yr("Expected value to be of type string or array, but found "+Pn(Ui(t))+" instead.")};mf.prototype.eachChild=function(e){e(this.input)};mf.prototype.outputDefined=function(){return!1};mf.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Dee=mf,DG={"==":Ree,"!=":bee,">":kee,"<":Aee,">=":Lee,"<=":Pee,array:Ol,at:cee,boolean:Ol,case:gee,coalesce:PG,collator:mG,format:dG,image:gG,in:hee,"index-of":fee,interpolate:Oh,"interpolate-hcl":Oh,"interpolate-lab":Oh,length:Dee,let:LG,literal:hw,match:dee,number:Ol,"number-format":Mee,object:Ol,slice:pee,step:TG,string:Ol,"to-boolean":rg,"to-color":rg,"to-number":rg,"to-string":rg,var:xG,within:Nk};function zD(n,e){var t=e[0],i=e[1],r=e[2],s=e[3];t=t.evaluate(n),i=i.evaluate(n),r=r.evaluate(n);var o=s?s.evaluate(n):1,a=hG(t,i,r,o);if(a)throw new yr(a);return new Zs(t/255*o,i/255*o,r/255*o,o)}function UD(n,e){return n in e}function lC(n,e){var t=e[n];return typeof t>"u"?null:t}function Fee(n,e,t,i){for(;t<=i;){var r=t+i>>1;if(e[r]===n)return!0;e[r]>n?i=r-1:t=r+1}return!1}function ph(n){return{type:n}}_p.register(DG,{error:[DJ,[kt],function(n,e){var t=e[0];throw new yr(t.evaluate(n))}],typeof:[kt,[wt],function(n,e){var t=e[0];return Pn(Ui(t.evaluate(n)))}],"to-rgba":[Co(Ee,4),[ql],function(n,e){var t=e[0];return t.evaluate(n).toArray()}],rgb:[ql,[Ee,Ee,Ee],zD],rgba:[ql,[Ee,Ee,Ee,Ee],zD],has:{type:xt,overloads:[[[kt],function(n,e){var t=e[0];return UD(t.evaluate(n),n.properties())}],[[kt,Sg],function(n,e){var t=e[0],i=e[1];return UD(t.evaluate(n),i.evaluate(n))}]]},get:{type:wt,overloads:[[[kt],function(n,e){var t=e[0];return lC(t.evaluate(n),n.properties())}],[[kt,Sg],function(n,e){var t=e[0],i=e[1];return lC(t.evaluate(n),i.evaluate(n))}]]},"feature-state":[wt,[kt],function(n,e){var t=e[0];return lC(t.evaluate(n),n.featureState||{})}],properties:[Sg,[],function(n){return n.properties()}],"geometry-type":[kt,[],function(n){return n.geometryType()}],id:[wt,[],function(n){return n.id()}],zoom:[Ee,[],function(n){return n.globals.zoom}],pitch:[Ee,[],function(n){return n.globals.pitch||0}],"distance-from-center":[Ee,[],function(n){return n.distanceFromCenter()}],"heatmap-density":[Ee,[],function(n){return n.globals.heatmapDensity||0}],"line-progress":[Ee,[],function(n){return n.globals.lineProgress||0}],"sky-radial-progress":[Ee,[],function(n){return n.globals.skyRadialProgress||0}],accumulated:[wt,[],function(n){return n.globals.accumulated===void 0?null:n.globals.accumulated}],"+":[Ee,ph(Ee),function(n,e){for(var t=0,i=0,r=e;i<r.length;i+=1){var s=r[i];t+=s.evaluate(n)}return t}],"*":[Ee,ph(Ee),function(n,e){for(var t=1,i=0,r=e;i<r.length;i+=1){var s=r[i];t*=s.evaluate(n)}return t}],"-":{type:Ee,overloads:[[[Ee,Ee],function(n,e){var t=e[0],i=e[1];return t.evaluate(n)-i.evaluate(n)}],[[Ee],function(n,e){var t=e[0];return-t.evaluate(n)}]]},"/":[Ee,[Ee,Ee],function(n,e){var t=e[0],i=e[1];return t.evaluate(n)/i.evaluate(n)}],"%":[Ee,[Ee,Ee],function(n,e){var t=e[0],i=e[1];return t.evaluate(n)%i.evaluate(n)}],ln2:[Ee,[],function(){return Math.LN2}],pi:[Ee,[],function(){return Math.PI}],e:[Ee,[],function(){return Math.E}],"^":[Ee,[Ee,Ee],function(n,e){var t=e[0],i=e[1];return Math.pow(t.evaluate(n),i.evaluate(n))}],sqrt:[Ee,[Ee],function(n,e){var t=e[0];return Math.sqrt(t.evaluate(n))}],log10:[Ee,[Ee],function(n,e){var t=e[0];return Math.log(t.evaluate(n))/Math.LN10}],ln:[Ee,[Ee],function(n,e){var t=e[0];return Math.log(t.evaluate(n))}],log2:[Ee,[Ee],function(n,e){var t=e[0];return Math.log(t.evaluate(n))/Math.LN2}],sin:[Ee,[Ee],function(n,e){var t=e[0];return Math.sin(t.evaluate(n))}],cos:[Ee,[Ee],function(n,e){var t=e[0];return Math.cos(t.evaluate(n))}],tan:[Ee,[Ee],function(n,e){var t=e[0];return Math.tan(t.evaluate(n))}],asin:[Ee,[Ee],function(n,e){var t=e[0];return Math.asin(t.evaluate(n))}],acos:[Ee,[Ee],function(n,e){var t=e[0];return Math.acos(t.evaluate(n))}],atan:[Ee,[Ee],function(n,e){var t=e[0];return Math.atan(t.evaluate(n))}],min:[Ee,ph(Ee),function(n,e){return Math.min.apply(Math,e.map(function(t){return t.evaluate(n)}))}],max:[Ee,ph(Ee),function(n,e){return Math.max.apply(Math,e.map(function(t){return t.evaluate(n)}))}],abs:[Ee,[Ee],function(n,e){var t=e[0];return Math.abs(t.evaluate(n))}],round:[Ee,[Ee],function(n,e){var t=e[0],i=t.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Ee,[Ee],function(n,e){var t=e[0];return Math.floor(t.evaluate(n))}],ceil:[Ee,[Ee],function(n,e){var t=e[0];return Math.ceil(t.evaluate(n))}],"filter-==":[xt,[kt,wt],function(n,e){var t=e[0],i=e[1];return n.properties()[t.value]===i.value}],"filter-id-==":[xt,[wt],function(n,e){var t=e[0];return n.id()===t.value}],"filter-type-==":[xt,[kt],function(n,e){var t=e[0];return n.geometryType()===t.value}],"filter-<":[xt,[kt,wt],function(n,e){var t=e[0],i=e[1],r=n.properties()[t.value],s=i.value;return typeof r==typeof s&&r<s}],"filter-id-<":[xt,[wt],function(n,e){var t=e[0],i=n.id(),r=t.value;return typeof i==typeof r&&i<r}],"filter->":[xt,[kt,wt],function(n,e){var t=e[0],i=e[1],r=n.properties()[t.value],s=i.value;return typeof r==typeof s&&r>s}],"filter-id->":[xt,[wt],function(n,e){var t=e[0],i=n.id(),r=t.value;return typeof i==typeof r&&i>r}],"filter-<=":[xt,[kt,wt],function(n,e){var t=e[0],i=e[1],r=n.properties()[t.value],s=i.value;return typeof r==typeof s&&r<=s}],"filter-id-<=":[xt,[wt],function(n,e){var t=e[0],i=n.id(),r=t.value;return typeof i==typeof r&&i<=r}],"filter->=":[xt,[kt,wt],function(n,e){var t=e[0],i=e[1],r=n.properties()[t.value],s=i.value;return typeof r==typeof s&&r>=s}],"filter-id->=":[xt,[wt],function(n,e){var t=e[0],i=n.id(),r=t.value;return typeof i==typeof r&&i>=r}],"filter-has":[xt,[wt],function(n,e){var t=e[0];return t.value in n.properties()}],"filter-has-id":[xt,[],function(n){return n.id()!==null&&n.id()!==void 0}],"filter-type-in":[xt,[Co(kt)],function(n,e){var t=e[0];return t.value.indexOf(n.geometryType())>=0}],"filter-id-in":[xt,[Co(wt)],function(n,e){var t=e[0];return t.value.indexOf(n.id())>=0}],"filter-in-small":[xt,[kt,Co(wt)],function(n,e){var t=e[0],i=e[1];return i.value.indexOf(n.properties()[t.value])>=0}],"filter-in-large":[xt,[kt,Co(wt)],function(n,e){var t=e[0],i=e[1];return Fee(n.properties()[t.value],i.value,0,i.value.length-1)}],all:{type:xt,overloads:[[[xt,xt],function(n,e){var t=e[0],i=e[1];return t.evaluate(n)&&i.evaluate(n)}],[ph(xt),function(n,e){for(var t=0,i=e;t<i.length;t+=1){var r=i[t];if(!r.evaluate(n))return!1}return!0}]]},any:{type:xt,overloads:[[[xt,xt],function(n,e){var t=e[0],i=e[1];return t.evaluate(n)||i.evaluate(n)}],[ph(xt),function(n,e){for(var t=0,i=e;t<i.length;t+=1){var r=i[t];if(r.evaluate(n))return!0}return!1}]]},"!":[xt,[xt],function(n,e){var t=e[0];return!t.evaluate(n)}],"is-supported-script":[xt,[kt],function(n,e){var t=e[0],i=n.globals&&n.globals.isSupportedScript;return i?i(t.evaluate(n)):!0}],upcase:[kt,[kt],function(n,e){var t=e[0];return t.evaluate(n).toUpperCase()}],downcase:[kt,[kt],function(n,e){var t=e[0];return t.evaluate(n).toLowerCase()}],concat:[kt,ph(wt),function(n,e){return e.map(function(t){return wy(t.evaluate(n))}).join("")}],"resolved-locale":[kt,[DE],function(n,e){var t=e[0];return t.evaluate(n).resolvedLocale()}]});var FG=DG;function SR(n){return{result:"success",value:n}}function Ud(n){return{result:"error",value:n}}function Oee(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Nee(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function zee(n){return!!n.expression&&n.expression.interpolated}function OG(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}var Gk=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new pG,this._defaultValue=t?Bee(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};Gk.prototype.evaluateWithoutErrorHandling=function(e,t,i,r,s,o,a,l){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=r||null,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=l||null,this.expression.evaluate(this._evaluator)};Gk.prototype.evaluate=function(e,t,i,r,s,o,a,l){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r||null,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=l||null;try{var u=this.expression.evaluate(this._evaluator);if(u==null||typeof u=="number"&&u!==u)return this._defaultValue;if(this._enumValues&&!(u in this._enumValues))throw new yr("Expected value to be one of "+Object.keys(this._enumValues).map(function(h){return JSON.stringify(h)}).join(", ")+", but found "+JSON.stringify(u)+" instead.");return u}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}};function Uee(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in FG}function CR(n,e){var t=new wG(FG,[],e?jee(e):void 0),i=t.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return i?SR(new Gk(i,e)):Ud(t.errors)}var dw=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!zk(t.expression)};dw.prototype.evaluateWithoutErrorHandling=function(e,t,i,r,s,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,r,s,o)};dw.prototype.evaluate=function(e,t,i,r,s,o){return this._styleExpression.evaluate(e,t,i,r,s,o)};var E0=function(e,t,i,r){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!zk(t.expression),this.interpolationType=r};E0.prototype.evaluateWithoutErrorHandling=function(e,t,i,r,s,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,r,s,o)};E0.prototype.evaluate=function(e,t,i,r,s,o){return this._styleExpression.evaluate(e,t,i,r,s,o)};E0.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?Oh.interpolationFactor(this.interpolationType,e,t,i):0};function Gee(n,e){if(n=CR(n,e),n.result==="error")return n;var t=n.value.expression,i=OE(t);if(!i&&!Oee(e))return Ud([new Xa("","data expressions not supported")]);var r=Uk(t,["zoom","pitch","distance-from-center"]);if(!r&&!Nee(e))return Ud([new Xa("","zoom expressions not supported")]);var s=sx(t);if(!s&&!r)return Ud([new Xa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(s instanceof Xa)return Ud([s]);if(s instanceof Oh&&!zee(e))return Ud([new Xa("",'"interpolate" expressions cannot be used with this property')]);if(!s)return SR(i?new dw("constant",n.value):new dw("source",n.value));var o=s instanceof Oh?s.interpolation:void 0;return SR(i?new E0("camera",n.value,s.labels,o):new E0("composite",n.value,s.labels,o))}function sx(n){var e=null;if(n instanceof LG)e=sx(n.result);else if(n instanceof PG)for(var t=0,i=n.args;t<i.length;t+=1){var r=i[t];if(e=sx(r),e)break}else(n instanceof TG||n instanceof Oh)&&n.input instanceof _p&&n.input.name==="zoom"&&(e=n);return e instanceof Xa||n.eachChild(function(s){var o=sx(s);o instanceof Xa?e=o:!e&&o?e=new Xa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new Xa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function jee(n){var e={color:ql,string:kt,number:Ee,enum:kt,boolean:xt,formatted:FE,resolvedImage:o_};return n.type==="array"?Co(e[n.value]||wt,n.length):e[n.type]}function Bee(n){return n.type==="color"&&(OG(n.default)||Array.isArray(n.default))?new Zs(0,0,0,0):n.type==="color"?Zs.parse(n.default)||null:n.default===void 0?null:n.default}function Vee(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function IR(n){if(Array.isArray(n))return n.map(IR);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){var e={};for(var t in n)e[t]=IR(n[t]);return e}return Vee(n)}var NG={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{},globe:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["source"]}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function zG(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(var e=0,t=n.slice(1);e<t.length;e+=1){var i=t[e];if(!zG(i)&&typeof i!="boolean")return!1}return!0;default:return!0}}function $ee(n,e){if(e===void 0&&(e="fill"),n==null)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};zG(n)||(n=gw(n));var t=n,i=!0;try{i=Wee(t)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
`+JSON.stringify(t,null,2)+`
        `)}var r=NG["filter_"+e],s=CR(i,r),o=null;if(s.result==="error")throw new Error(s.value.map(function(p){return p.key+": "+p.message}).join(", "));o=function(p,m,y){return s.value.evaluate(p,m,{},y)};var a=null,l=null;if(i!==t){var u=CR(t,r);if(u.result==="error")throw new Error(u.value.map(function(p){return p.key+": "+p.message}).join(", "));a=function(p,m,y,x,w){return u.value.evaluate(p,m,{},y,void 0,void 0,x,w)},l=!OE(u.value.expression)}o=o;var h=jG(i);return{filter:o,dynamicFilter:a||void 0,needGeometry:h,needFeature:!!l}}function Wee(n){if(!Ig(n))return n;var e=IR(n);return GG(e),e=UG(e),e}function UG(n){if(!Array.isArray(n))return n;var e=qee(n);return e===!0?e:e.map(function(t){return UG(t)})}function GG(n){var e=!1,t=[];if(n[0]==="case"){for(var i=1;i<n.length-1;i+=2)e=e||Ig(n[i]),t.push(n[i+1]);t.push(n[n.length-1])}else if(n[0]==="match"){e=e||Ig(n[1]);for(var r=2;r<n.length-1;r+=2)t.push(n[r+1]);t.push(n[n.length-1])}else if(n[0]==="step"){e=e||Ig(n[1]);for(var s=1;s<n.length-1;s+=2)t.push(n[s+1])}e&&(n.length=0,n.push.apply(n,["any"].concat(t)));for(var o=1;o<n.length;o++)GG(n[o])}function Ig(n){if(!Array.isArray(n))return!1;if(Hee(n[0]))return!0;for(var e=1;e<n.length;e++){var t=n[e];if(Ig(t))return!0}return!1}function Hee(n){return n==="pitch"||n==="distance-from-center"}var Xee=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function qee(n){if(Xee.has(n[0]))for(var e=1;e<n.length;e++){var t=n[e];if(Ig(t))return!0}return n}function Kee(n,e){return n<e?-1:n>e?1:0}function jG(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(var e=1;e<n.length;e++)if(jG(n[e]))return!0;return!1}function gw(n){if(!n)return!0;var e=n[0];if(n.length<=1)return e!=="any";var t=e==="=="?uC(n[1],n[2],"=="):e==="!="?S1(uC(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?uC(n[1],n[2],e):e==="any"?Yee(n.slice(1)):e==="all"?["all"].concat(n.slice(1).map(gw)):e==="none"?["all"].concat(n.slice(1).map(gw).map(S1)):e==="in"?GD(n[1],n.slice(2)):e==="!in"?S1(GD(n[1],n.slice(2))):e==="has"?jD(n[1]):e==="!has"?S1(jD(n[1])):e==="within"?n:!0;return t}function uC(n,e,t){switch(n){case"$type":return["filter-type-"+t,e];case"$id":return["filter-id-"+t,e];default:return["filter-"+t,n,e]}}function Yee(n){return["any"].concat(n.map(gw))}function GD(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",n,["literal",e.sort(Kee)]]:["filter-in-small",n,["literal",e]]}}function jD(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function S1(n){return["!",n]}var Zee=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Qee(n,e){var t={};for(var i in n)i!=="ref"&&(t[i]=n[i]);return Zee.forEach(function(r){r in e&&(t[r]=e[r])}),t}function Jee(n){n=n.slice();for(var e=Object.create(null),t=0;t<n.length;t++)e[n[t].id]=n[t];for(var i=0;i<n.length;i++)"ref"in n[i]&&(n[i]=Qee(n[i],e[n[i].ref]));return n}var BD={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},Gm=" ",VD=/(italic|oblique)$/i,$D={},RR=function(n,e,t){var i=$D[n];if(!i){Array.isArray(n)||(n=[n]);for(var r=400,s="normal",o=[],a,l,u=0,h=n.length;u<h;++u){var p=n[u],m=p.split(" "),y=m[m.length-1].toLowerCase();y=="normal"||y=="italic"||y=="oblique"?(s=l?s:y,m.pop(),y=m[m.length-1].toLowerCase()):VD.test(y)&&(y=y.replace(VD,""),s=l?s:m[m.length-1].replace(y,""));for(var x in BD){var w=m.length>1?m[m.length-2].toLowerCase():"";if(y==x||y==x.replace("-","")||w+"-"+y==x){r=a?r:BD[x],m.pop(),w&&x.startsWith(w)&&m.pop();break}}!a&&typeof y=="number"&&(r=y);var R=m.join(Gm).replace("Klokantech Noto Sans","Noto Sans");R.indexOf(Gm)!==-1&&(R='"'+R+'"'),o.push(R)}i=$D[n]=[s,r,o]}return i[0]+Gm+i[1]+Gm+e+"px"+(t?"/"+t:"")+Gm+i[2]},BG="https://api.mapbox.com";function jk(n){var e="mapbox://";return n.indexOf(e)!==0?"":n.slice(e.length)}function ete(n,e,t){var i=jk(n);if(!i)return decodeURI(new URL(n,t).href);var r="sprites/";if(i.indexOf(r)!==0)throw new Error("unexpected sprites url: "+n);var s=i.slice(r.length);return BG+"/styles/v1/"+s+"/sprite?access_token="+e}function VG(n,e){var t=jk(n);if(!t)return decodeURI(new URL(n,location.href).href);var i="styles/";if(t.indexOf(i)!==0)throw new Error("unexpected style url: "+n);var r=t.slice(i.length);return BG+"/styles/v1/"+r+"?&access_token="+e}function ox(n,e,t,i){var r=new URL(n,i),s=jk(n);if(!s)return e&&r.searchParams.set(t,e),decodeURI(r.href);if(s==="mapbox.satellite"){var o=window.devicePixelRatio>=1.5?"@2x":"";return"https://api.mapbox.com/v4/"+s+"/{z}/{x}/{y}"+o+".webp?access_token="+e}return"https://{a-d}.tiles.mapbox.com/v4/"+s+"/{z}/{x}/{y}.vector.pbf?access_token="+e}function cC(n){return n*Math.PI/180}var NE=function(){for(var n=[],e=78271.51696402048;n.length<=24;e/=2)n.push(e);return n}();function $G(n,e){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(n,e);var t=document.createElement("canvas");return t.width=n,t.height=e,t}function WG(n,e){for(var t=0,i=e.length;t<i;++t){var r=e[t];if(r<n&&t+1<i){var s=e[t]/e[t+1];return t+Math.log(e[t]/n)/Math.log(s)}}return i-1}var Dd={};function pw(n,e,t,i){if(t===void 0&&(t={}),e in Dd)return i&&(i.request=Dd[e][0]),Dd[e][1];var r=t.transformRequest?t.transformRequest(e,n)||new Request(e):new Request(e);r.headers.get("Accept")||r.headers.set("Accept","application/json"),i&&(i.request=r);var s=fetch(r).then(function(o){return delete Dd[e],o.ok?o.json():Promise.reject(new Error("Error fetching source "+e))}).catch(function(o){return delete Dd[e],Promise.reject(new Error("Error fetching source "+e))});return Dd[e]=[r,s],s}function HG(n,e){if(typeof n=="string")if(n.trim().startsWith("{"))try{var t=JSON.parse(n);return Promise.resolve(t)}catch(i){return Promise.reject(i)}else return n=VG(n,e.accessToken),pw("Style",n,e);else return Promise.resolve(n)}function WD(n,e){if(e.transformRequest){var t=e.transformRequest(n,"Tiles");if(t instanceof Request)return decodeURI(t.url)}return n}var HD={};function tte(n,e,t){t===void 0&&(t={});var i=[e,JSON.stringify(n)].toString(),r=HD[i];if(!r||t.transformRequest){var s=n.url;if(s&&!n.tiles){var o=ox(s,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(s.startsWith("mapbox://"))r=Promise.resolve(Object.assign({},n,{url:void 0,tiles:kE(o)}));else{var a={};r=pw("Source",o,t,a).then(function(l){return l.tiles=l.tiles.map(function(u){return WD(ox(u,t.accessToken,t.accessTokenParam||"access_token",a.request.url),t)}),Promise.resolve(l)})}}else n=Object.assign({},n,{tiles:n.tiles.map(function(l){return WD(ox(l,t.accessToken,t.accessTokenParam||"access_token",e||location.href),t)})}),r=Promise.resolve(Object.assign({},n));HD[i]=r}return r}var nte=Array(256).join("");function bR(n,e){if(e>=.05){for(var t="",i=n.split(`
`),r=nte.slice(0,Math.round(e/.1)),s=0,o=i.length;s<o;++s)s>0&&(t+=`
`),t+=i[s].split("").join(r);return t}return n}var hC;function XG(){return hC||(hC=$G(1,1).getContext("2d")),hC}function mh(n,e){return XG().measureText(n).width+(n.length-1)*e}var XD={};function AR(n,e,t,i){if(n.indexOf(`
`)!==-1){for(var r=n.split(`
`),s=[],o=0,a=r.length;o<a;++o)s.push(AR(r[o],e,t,i));return s.join(`
`)}var l=t+","+e+","+n+","+i,u=XD[l];if(!u){var h=n.split(" ");if(h.length>1){var p=XG();p.font=e;for(var m=p.measureText("M").width,y=m*t,x="",w=[],R=0,E=h.length;R<E;++R){var T=h[R],I=x+(x?" ":"")+T;mh(I,i)<=y?x=I:(x&&w.push(x),x=T)}x&&w.push(x);for(var A=0,L=w.length;A<L&&L>1;++A){var F=w[A];if(mh(F,i)<y*.35){var O=A>0?mh(w[A-1],i):1/0,N=A<L-1?mh(w[A+1],i):1/0;w.splice(A,1),L-=1,O<N?(w[A-1]+=" "+F,A-=1):w[A]=F+" "+w[A]}}for(var B=0,V=w.length-1;B<V;++B){var J=w[B],ge=w[B+1];if(mh(J,i)>y*.7&&mh(ge,i)<y*.6){var he=J.split(" "),de=he.pop();mh(de,i)<y*.2&&(w[B]=he.join(" "),w[B+1]=de+" "+ge),V-=1}}u=w.join(`
`)}else u=n;u=bR(u,i),XD[l]=u}return u}var ite=/font-family: ?([^;]*);/,rte=/("|')/g,C1;function ste(n){if(!C1){C1={};for(var e=document.styleSheets,t=0,i=e.length;t<i;++t){var r=e[t];try{var s=r.rules||r.cssRules;if(s)for(var o=0,a=s.length;o<a;++o){var l=s[o];if(l.type==5){var u=l.cssText.match(ite);C1[u[1].replace(rte,"")]=!0}}}catch{}}}return n in C1}var fC={};function ote(n){var e=n.toString();if(e in fC)return fC[e];for(var t=[],i=0,r=n.length;i<r;++i){n[i]=n[i].replace("Arial Unicode MS","Arial");var s=n[i],o=RR(s,1);$3(o);var a=o.split(" ");t.push([a.slice(3).join(" ").replace(/"/g,""),a[1],a[0]])}for(var l=0,u=t.length;l<u;++l){var h=t[l],p=h[0];if(!ste(p)&&Ba.get(h[2]+`
`+h[1]+` 
`+p)!==100){var m="https://fonts.googleapis.com/css?family="+p.replace(/ /g,"+")+":"+h[1]+h[2];if(!document.querySelector('link[href="'+m+'"]')){var y=document.createElement("link");y.href=m,y.rel="stylesheet",document.head.appendChild(y)}}}return fC[e]=n,n}var ate={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},lte={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},ute=function(n,e){var t=Gee(n,e);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return t.value},kR={},mw={zoom:0},I1,dC;function Je(n,e,t,i,r,s,o){var a=n.id;s||(s={},console.warn("No functionCache provided to getValue()")),s[a]||(s[a]={});var l=s[a];if(!l[t]){var u=(n[e]||kR)[t],h=NG[e+"_"+n.type][t];u===void 0&&(u=h.default);var p=Uee(u);if(!p&&OG(u)&&(u=IJ(u,h),p=!0),p){var m=ute(u,h);l[t]=m.evaluate.bind(m)}else h.type=="color"&&(u=Zs.parse(u)),l[t]=function(){return u}}return mw.zoom=i,l[t](mw,r,o)}function cte(n,e,t,i){var r=Je(n,"layout","icon-allow-overlap",e,t,i);if(!r)return"declutter";var s=Je(n,"layout","icon-ignore-placement",e,t,i);return s?"none":"obstacle"}function hte(n,e,t,i,r){return r||console.warn("No filterCache provided to evaluateFilter()"),n in r||(r[n]=$ee(e).filter),mw.zoom=i,r[n](mw,t)}function Xu(n,e){if(n){if(n.a===0||e===0)return;var t=n.a;return e=e===void 0?1:e,t===0?"transparent":"rgba("+Math.round(n.r*255/t)+","+Math.round(n.g*255/t)+","+Math.round(n.b*255/t)+","+t*e+")"}return n}var fte=/\{[^{}}]*\}/g;function gC(n,e){return n.replace(fte,function(t){return e[t.slice(1,-1)]||""})}function dte(n,e,t,i,r,s,o,a){if(i===void 0&&(i=NE),r===void 0&&(r=void 0),s===void 0&&(s=void 0),o===void 0&&(o=void 0),a===void 0&&(a=void 0),typeof e=="string"&&(e=JSON.parse(e)),e.version!=8)throw new Error("glStyle version 8 required.");var l,u;if(s){if(typeof Image<"u"){var h=new Image;h.crossOrigin="anonymous",h.onload=function(){l=h,u=[h.width,h.height],n.changed(),h.onload=null},h.src=s}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){var p=self;p.postMessage({action:"loadImage",src:s}),p.addEventListener("message",function(se){se.data.action==="imageLoaded"&&se.data.src===s&&(l=se.data.image,u=[l.width,l.height])})}}for(var m=Jee(e.layers),y={},x=[],w={},R={},E={},T={},I,A=0,L=m.length;A<L;++A){var F=m[A],O=F.id;if(typeof t=="string"&&F.source==t||t.indexOf(O)!==-1){var N=F["source-layer"];if(I){if(F.source!==I)throw new Error('Layer "'+O+'" does not use source "'+I)}else{I=F.source;var B=e.sources[I];if(!B)throw new Error('Source "'+I+'" is not defined');var V=B.type;if(V!=="vector"&&V!=="geojson")throw new Error('Source "'+I+'" is not of type "vector" or "geojson", but "'+V+'"')}var J=y[N];J||(J=[],y[N]=J),J.push({layer:F,index:A}),x.push(O)}}var ge=new Ts,he=new Ws,de=[],oe=function(_e,se){var Z=_e.getProperties(),pe=y[Z.layer];if(pe){var ne=i.indexOf(se);ne==-1&&(ne=WG(se,i));for(var ee=ate[_e.getGeometry().getType()],j={properties:Z,type:ee},ie=n.get("mapbox-featurestate")[_e.getId()],q=-1,H=0,te=pe.length;H<te;++H){var ue=pe[H],K=ue.layer,Te=K.id,lt=K.layout||kR,It=K.paint||kR;if(!(lt.visibility==="none"||"minzoom"in K&&ne<K.minzoom||"maxzoom"in K&&ne>=K.maxzoom)){var rt=K.filter;if(!rt||hte(Te,rt,j,ne,T)){var ut=void 0,ct=void 0,rr=void 0,Mn=void 0,$i=void 0,Ie=void 0,U=ue.index;if(ee==3&&(K.type=="fill"||K.type=="fill-extrusion"))if(ct=Je(K,"paint",K.type+"-opacity",ne,j,E,ie),K.type+"-pattern"in It){var Wr=Je(K,"paint",K.type+"-pattern",ne,j,E,ie);if(Wr){var ks=typeof Wr=="string"?gC(Wr,Z):Wr.toString();if(l&&r&&r[ks]){++q,Ie=de[q],(!Ie||!Ie.getFill()||Ie.getStroke()||Ie.getText())&&(Ie=new ws({fill:new Ws}),de[q]=Ie),rr=Ie.getFill(),Ie.setZIndex(U);var ei=ks+"."+ct,Wt=R[ei];if(!Wt){var yn=r[ks],Wi=$G(yn.width,yn.height),cs=Wi.getContext("2d");cs.globalAlpha=ct,cs.drawImage(l,yn.x,yn.y,yn.width,yn.height,0,0,yn.width,yn.height),Wt=cs.createPattern(Wi,"repeat"),R[ei]=Wt}rr.setColor(Wt)}}}else ut=Xu(Je(K,"paint",K.type+"-color",ne,j,E,ie),ct),K.type+"-outline-color"in It&&($i=Xu(Je(K,"paint",K.type+"-outline-color",ne,j,E,ie),ct)),$i||($i=ut),(ut||$i)&&(++q,Ie=de[q],(!Ie||ut&&!Ie.getFill()||!ut&&Ie.getFill()||$i&&!Ie.getStroke()||!$i&&Ie.getStroke()||Ie.getText())&&(Ie=new ws({fill:ut?new Ws:void 0,stroke:$i?new Ts:void 0}),de[q]=Ie),ut&&(rr=Ie.getFill(),rr.setColor(ut)),$i&&(Mn=Ie.getStroke(),Mn.setColor($i),Mn.setWidth(.5)),Ie.setZIndex(U));if(ee!=1&&K.type=="line"){ut=!("line-pattern"in It)&&"line-color"in It?Xu(Je(K,"paint","line-color",ne,j,E,ie),Je(K,"paint","line-opacity",ne,j,E,ie)):void 0;var Hi=Je(K,"paint","line-width",ne,j,E,ie);ut&&Hi>0&&(++q,Ie=de[q],(!Ie||!Ie.getStroke()||Ie.getFill()||Ie.getText())&&(Ie=new ws({stroke:new Ts}),de[q]=Ie),Mn=Ie.getStroke(),Mn.setLineCap(Je(K,"layout","line-cap",ne,j,E,ie)),Mn.setLineJoin(Je(K,"layout","line-join",ne,j,E,ie)),Mn.setMiterLimit(Je(K,"layout","line-miter-limit",ne,j,E,ie)),Mn.setColor(ut),Mn.setWidth(Hi),Mn.setLineDash(It["line-dasharray"]?Je(K,"paint","line-dasharray",ne,j,E,ie).map(function(Xi){return Xi*Hi}):null),Ie.setZIndex(U))}var Rn=!1,Ft=null,sr=0,Xt=void 0,cn=void 0,ti=void 0;if((ee==1||ee==2)&&"icon-image"in lt){var or=Je(K,"layout","icon-image",ne,j,E,ie);if(or){Xt=typeof or=="string"?gC(or,Z):or.toString();var no=void 0,Dn=a?a(n,Xt):void 0;if(l&&r&&r[Xt]||Dn){var ar=Je(K,"layout","icon-rotation-alignment",ne,j,E,ie);if(ee==2){var bn=_e.getGeometry();if(bn.getFlatMidpoint||bn.getFlatMidpoints){var lr=bn.getExtent(),ni=Math.sqrt(Math.max(Math.pow((lr[2]-lr[0])/se,2),Math.pow((lr[3]-lr[1])/se,2)));if(ni>150){var ii=bn.getType()==="MultiLineString"?bn.getFlatMidpoints():bn.getFlatMidpoint();dC||(I1=[NaN,NaN],dC=new _R("Point",I1,[],{},null)),no=dC,I1[0]=ii[0],I1[1]=ii[1];var Ps=Je(K,"layout","symbol-placement",ne,j,E,ie);if(Ps==="line"&&ar==="map")for(var zo=bn.getStride(),io=bn.getFlatCoordinates(),_n=0,ro=io.length-zo;_n<ro;_n+=zo){var ri=io[_n],Ti=io[_n+1],Fn=io[_n+zo],On=io[_n+zo+1],Rt=Math.min(ri,Fn),bt=Math.min(Ti,On),sn=Math.max(ri,Fn),Pt=Math.max(Ti,On);if(ii[0]>=Rt&&ii[0]<=sn&&ii[1]>=bt&&ii[1]<=Pt){sr=Math.atan2(Ti-On,Fn-ri);break}}}}}if(ee!==2||no){var si=Je(K,"layout","icon-size",ne,j,E,ie),Si=It["icon-color"]!==void 0?Je(K,"paint","icon-color",ne,j,E,ie):null;if(!Si||Si.a!==0){var so=Xt+"."+si;if(Si!==null&&(so+="."+Si),cn=w[so],!cn){var vn=cte(K,ne,j,E),Hr=void 0;"icon-offset"in lt&&(Hr=Je(K,"layout","icon-offset",ne,j,E,ie),Hr[1]*=-1);var gu=Si?[Si.r*255,Si.g*255,Si.b*255,Si.a]:void 0;if(Dn)typeof Dn=="string"?cn=new xg({color:gu,src:Dn,rotateWithView:ar==="map",displacement:Hr,declutterMode:vn}):cn=new xg({color:gu,img:Dn,imgSize:[Dn.width,Dn.height],rotateWithView:ar==="map",displacement:Hr,declutterMode:vn});else{var hs=r[Xt];cn=new xg({color:gu,img:l,imgSize:u,size:[hs.width,hs.height],offset:[hs.x,hs.y],rotateWithView:ar==="map",scale:si/hs.pixelRatio,displacement:Hr,declutterMode:vn})}w[so]=cn}}cn&&(++q,Ie=de[q],(!Ie||!Ie.getImage()||Ie.getFill()||Ie.getStroke())&&(Ie=new ws,de[q]=Ie),Ie.setGeometry(no),cn.setRotation(sr+cC(Je(K,"layout","icon-rotate",ne,j,E,ie))),cn.setOpacity(Je(K,"paint","icon-opacity",ne,j,E,ie)),cn.setAnchor(lte[Je(K,"layout","icon-anchor",ne,j,E,ie)]),Ie.setImage(cn),Ft=Ie.getText(),Ie.setText(void 0),Ie.setZIndex(U),Rn=!0,ti=!1)}else ti=!0}}}if(ee==1&&K.type==="circle"){++q,Ie=de[q],(!Ie||!Ie.getImage()||Ie.getFill()||Ie.getStroke())&&(Ie=new ws,de[q]=Ie);var Ls="circle-radius"in It?Je(K,"paint","circle-radius",ne,j,E,ie):5,pu=Xu(Je(K,"paint","circle-stroke-color",ne,j,E,ie),Je(K,"paint","circle-stroke-opacity",ne,j,E,ie)),wa=Xu(Je(K,"paint","circle-color",ne,j,E,ie),Je(K,"paint","circle-opacity",ne,j,E,ie)),oo=Je(K,"paint","circle-stroke-width",ne,j,E,ie),mu=Ls+"."+pu+"."+wa+"."+oo;cn=w[mu],cn||(cn=new gp({radius:Ls,stroke:pu&&oo>0?new Ts({width:oo,color:pu}):void 0,fill:wa?new Ws({color:wa}):void 0,declutterMode:"none"}),w[mu]=cn),Ie.setImage(cn),Ft=Ie.getText(),Ie.setText(void 0),Ie.setGeometry(void 0),Ie.setZIndex(U),Rn=!0}var Ht=void 0,Xr=void 0,dl=void 0,Nn=void 0,Uo=void 0,yu=void 0;if("text-field"in lt){Nn=Math.round(Je(K,"layout","text-size",ne,j,E,ie));var ao=Je(K,"layout","text-font",ne,j,E,ie);dl=Je(K,"layout","text-line-height",ne,j,E,ie),Xr=RR(o?o(ao):ao,Nn,dl),Xr.includes("sans-serif")||(Xr+=",sans-serif"),Uo=Je(K,"layout","text-letter-spacing",ne,j,E,ie),yu=Je(K,"layout","text-max-width",ne,j,E,ie);var oi=Je(K,"layout","text-field",ne,j,E,ie);typeof oi=="object"&&oi.sections?oi.sections.length===1?Ht=oi.toString():Ht=oi.sections.reduce(function(Xi,Tr,Kr){var yl=Tr.fontStack?Tr.fontStack.split(","):ao,Sa=RR(o?o(yl):yl,Nn*(Tr.scale||1),dl),Yr=Tr.text;if(Yr===`
`)return Xi.push(`
`,""),Xi;if(ee==2){Xi.push(bR(Yr,Uo),Sa);return}Yr=AR(Yr,Sa,yu,Uo).split(`
`);for(var jo=0,wu=Yr.length;jo<wu;++jo)jo>0&&Xi.push(`
`,""),Xi.push(Yr[jo],Sa);return Xi},[]):Ht=gC(oi,Z).trim(),ct=Je(K,"paint","text-opacity",ne,j,E,ie)}if(Ht&&ct&&!ti){Rn||(++q,Ie=de[q],(!Ie||!Ie.getText()||Ie.getFill()||Ie.getStroke())&&(Ie=new ws,de[q]=Ie),Ie.setImage(void 0),Ie.setGeometry(void 0)),Ie.getText()||Ie.setText(Ft||new s0({padding:[2,2,2,2]})),Ft=Ie.getText();var Go=lt["text-transform"];Go=="uppercase"?Ht=Array.isArray(Ht)?Ht.map(function(Xi,Tr){return Tr%2?Xi:Xi.toUpperCase()}):Ht.toUpperCase():Go=="lowercase"&&(Ht=Array.isArray(Ht)?Ht.map(function(Xi,Tr){return Tr%2?Xi:Xi.toLowerCase()}):Ht.toLowerCase());var gl=Array.isArray(Ht)?Ht:ee==2?bR(Ht,Uo):AR(Ht,Xr,yu,Uo);Ft.setText(gl),Ft.setFont(Xr),Ft.setRotation(cC(Je(K,"layout","text-rotate",ne,j,E,ie)));var _u=Je(K,"layout","text-anchor",ne,j,E,ie),Ci=Rn||ee==1?"point":Je(K,"layout","symbol-placement",ne,j,E,ie);if(Ft.setPlacement(Ci),typeof Ft.setRepeat=="function"){var vu=Je(K,"layout","symbol-spacing",ne,j,E,ie);Ft.setRepeat(vu*2)}Ft.setOverflow(Ci==="point");var ur=Je(K,"paint","text-halo-width",ne,j,E,ie),lo=Je(K,"layout","text-offset",ne,j,E,ie),Ii=Je(K,"paint","text-translate",ne,j,E,ie),uo=0,Ea=0;if(Ci=="point"){var Ri="center";_u.indexOf("left")!==-1?(Ri="left",Ea=ur):_u.indexOf("right")!==-1&&(Ri="right",Ea=-ur),Ft.setTextAlign(Ri);var xu=Je(K,"layout","text-rotation-alignment",ne,j,E,ie);Ft.setRotateWithView(xu=="map")}else Ft.setMaxAngle(cC(Je(K,"layout","text-max-angle",ne,j,E,ie))*Ht.length/gl.length),Ft.setTextAlign(),Ft.setRotateWithView(!1);var Ta="middle";_u.indexOf("bottom")==0?(Ta="bottom",uo=-ur-.5*(dl-1)*Nn):_u.indexOf("top")==0&&(Ta="top",uo=ur+.5*(dl-1)*Nn),Ft.setTextBaseline(Ta);var bi=Je(K,"layout","text-justify",ne,j,E,ie);Ft.setJustify(bi==="auto"?void 0:bi),Ft.setOffsetX(lo[0]*Nn+Ea+Ii[0]),Ft.setOffsetY(lo[1]*Nn+uo+Ii[1]),he.setColor(Xu(Je(K,"paint","text-color",ne,j,E,ie),ct)),Ft.setFill(he);var pl=Xu(Je(K,"paint","text-halo-color",ne,j,E,ie),ct);if(pl){ge.setColor(pl),ur*=2;var co=.5*Nn;ge.setWidth(ur<=co?ur:co),Ft.setStroke(ge)}else Ft.setStroke(void 0);var ml=Je(K,"layout","text-padding",ne,j,E,ie),qr=Ft.getPadding();ml!==qr[0]&&(qr[0]=ml,qr[1]=ml,qr[2]=ml,qr[3]=ml),Ie.setZIndex(U)}}}}if(q>-1)return de.length=q+1,de}};return n.setStyle(oe),n.set("mapbox-source",I),n.set("mapbox-layers",x),n.set("mapbox-featurestate",{}),oe}function gte(n,e){return e===void 0&&(e=512),n.getExtent()?Df({extent:n.getExtent(),tileSize:e,maxZoom:22}).getResolutions():NE}function pte(n,e){if(!e.accessToken){e=Object.assign({},e);var t=new URL(n).searchParams;t.forEach(function(i,r){e.accessToken=i,e.accessTokenParam=r})}return e}function mte(n,e,t,i,r){t===void 0&&(t=""),i===void 0&&(i={}),r===void 0&&(r=void 0);var s,o,a,l;return typeof t!="string"&&!Array.isArray(t)?(a=t,l=a.source||a.layers,i=a):l=t,typeof i=="string"?(s=i,a={}):(s=i.styleUrl,a=i),r||(r=a.resolutions),!s&&typeof e=="string"&&!e.trim().startsWith("{")&&(s=e),s&&(s=s.startsWith("data:")?location.href:VG(s,a.accessToken),a=pte(s,a)),new Promise(function(u,h){HG(e,a).then(function(p){if(p.version!=8)return h(new Error("glStyle version 8 required."));if(!(n instanceof Lc||n instanceof vy))return h(new Error("Can only apply to VectorLayer or VectorTileLayer"));var m=n instanceof vy?"vector":"geojson";if(l?Array.isArray(l)?o=p.layers.find(function(F){return F.id===l[0]}).source:o=l:(o=Object.keys(p.sources).find(function(F){return p.sources[F].type===m}),l=o),!o)return h(new Error("No "+m+" source found in the glStyle."));function y(){if(n instanceof vy)return Ete(p.sources[o],s,a).then(function(B){var V=n.getSource();if(V?B!==V&&(V.setTileUrlFunction(B.getTileUrlFunction()),V.format_||(V.format_=B.format_),V.getAttributions()||V.setAttributions(B.getAttributions()),V.getTileLoadFunction()===iG&&V.setTileLoadFunction(B.getTileLoadFunction()),rs(V.getProjection(),B.getProjection())&&(V.tileGrid=B.getTileGrid())):n.setSource(B),!isFinite(n.getMaxResolution())&&!isFinite(n.getMinZoom())){var J=n.getSource().getTileGrid();n.setMaxResolution(J.getResolution(J.getMinZoom()))}});var F=p.sources[o],O=n.getSource();(!O||O.get("mapbox-source")!==F)&&(O=Ste(F,s,a));var N=n.getSource();return N?O!==N&&(N.getAttributions()||N.setAttributions(O.getAttributions()),N.format_||(N.format_=O.getFormat()),N.url_=O.getUrl()):n.setSource(O),Promise.resolve()}var x,w,R,E;function T(){if(!E&&(!p.sprite||w)){if(a.projection&&!r){var F=_t(a.projection),O=F.getUnits();O!=="m"&&(r=NE.map(function(N){return N/Kh[O]}))}E=dte(n,p,l,r,w,R,ote,a.getImage),n.getStyle()?y().then(u).catch(h):h(new Error("Nothing to show for source ["+o+"]"))}else E?(n.setStyle(E),y().then(u).catch(h)):h(new Error("Something went wrong trying to apply style."))}if(p.sprite){var I=new URL(ete(p.sprite,a.accessToken,s||location.href));x=window.devicePixelRatio>=1.5?.5:1;var A=x==.5?"@2x":"",L=I.origin+I.pathname+A+".json"+I.search;new Promise(function(F,O){pw("Sprite",L,a).then(F).catch(function(N){L=I.origin+I.pathname+".json"+I.search,pw("Sprite",L,a).then(F).catch(O)})}).then(function(F){if(F===void 0&&h(new Error("No sprites found.")),w=F,R=I.origin+I.pathname+A+".png"+I.search,a.transformRequest){var O=a.transformRequest(R,"SpriteImage");O instanceof Request&&(R=encodeURI(O.url))}T()}).catch(function(F){h(new Error("Sprites cannot be loaded: "+L+": "+F.message))})}else T()}).catch(h)})}var qD={};function yte(n,e,t){e.layers.some(function(i){if(i.type==="background"){if(n instanceof cu)return n.setBackground(function(r){return qG(i,r,t,{})}),!0;if(n instanceof hk||n instanceof pp)return n.getLayers().push(wte(i,t,{})),!0}})}function _te(n,e,t){return t===void 0&&(t={}),HG(e,t).then(function(i){yte(n,i,t)})}function vte(n,e){var t=n.bounds;if(t){var i=WM([t[0],t[1]],e),r=WM([t[2],t[3]],e);return[i[0],i[1],r[0],r[1]]}return _t(e).getExtent()}function xte(n,e,t){var i=new uG({tileJSON:e,tileSize:n.tileSize||e.tileSize||512}),r=i.getTileJSON(),s=i.getTileGrid(),o=_t(t.projection||"EPSG:3857"),a=vte(r,o),l=o.getExtent(),u=r.minzoom||0,h=r.maxzoom||22,p={attributions:i.getAttributions(),projection:o,tileGrid:new fu({origin:l?va(l):s.getOrigin(0),extent:a||s.getExtent(),minZoom:u,resolutions:gte(o,e.tileSize).slice(0,h+1),tileSize:s.getTileSize(0)})};return Array.isArray(r.tiles)?p.urls=r.tiles:p.url=r.tiles,p}function qG(n,e,t,i){var r={id:n.id,type:n.type},s=n.layout||{},o=n.paint||{};r.paint=o;var a=WG(e,t.resolutions||NE),l,u;return o["background-color"]!==void 0&&(l=Je(r,"paint","background-color",a,qD,i)),o["background-opacity"]!==void 0&&(u=Je(r,"paint","background-opacity",a,qD,i)),s.visibility=="none"?void 0:Xu(l,u)}function wte(n,e,t){var i=document.createElement("div");return i.className="ol-mapbox-style-background",i.style.position="absolute",i.style.width="100%",i.style.height="100%",new cu({source:new Pf({}),render:function(s){var o=qG(n,s.viewState.resolution,e,t);return i.style.backgroundColor=o,i}})}function Ete(n,e,t){return new Promise(function(i,r){tte(n,e,t).then(function(s){var o=xte(n,s,t);o.format=new QU,Array.isArray(s.tiles)?o.urls=s.tiles:o.url=s.tiles,i(new Rk(o))}).catch(r)})}function Tte(n){var e=n?n.getCode():"EPSG:3857";return"{bbox-"+e.toLowerCase().replace(/[^a-z0-9]/g,"-")+"}"}var R1=new sJ;function Ste(n,e,t){var i=n.data,r={};if(typeof i=="string"){var s=ox(i,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(t.transformRequest){var o=t.transformRequest(s,"GeoJSON");o instanceof Request&&(s=decodeURI(o.url))}if(/\{bbox-[0-9a-z-]+\}/.test(s)){var a=function(h,p,m){var y=Tte(m);return s.replace(y,h.join(",")+","+m.getCode())},l=new Ja({attributions:n.attribution,format:R1,url:a,strategy:$7});return l.set("mapbox-source",n),l}return new Ja({attributions:n.attribution,format:R1,url:s})}r.features=R1.readFeatures(i,{featureProjection:"EPSG:3857"});var u=new Ja(Object.assign({attributions:n.attribution,format:R1},r));return u.set("mapbox-source",n),u}class Cte extends Vi{constructor(e){super(Re.ERROR),this.error=e}}class Ite extends vy{constructor(e){const t="declutter"in e?e.declutter:!0,i=new Rk({state:"loading",format:new QU});super({source:i,background:e.background,declutter:t,className:e.className,opacity:e.opacity,visible:e.visible,zIndex:e.zIndex,minResolution:e.minResolution,maxResolution:e.maxResolution,minZoom:e.minZoom,maxZoom:e.maxZoom,renderOrder:e.renderOrder,renderBuffer:e.renderBuffer,renderMode:e.renderMode,map:e.map,updateWhileAnimating:e.updateWhileAnimating,updateWhileInteracting:e.updateWhileInteracting,preload:e.preload,useInterimTilesOnError:e.useInterimTilesOnError,properties:e.properties}),e.accessToken&&(this.accessToken=e.accessToken);const r=e.styleUrl;mte(this,r,e.layers||e.source,{accessToken:this.accessToken}).then(()=>{i.setState("ready")}).catch(s=>{this.dispatchEvent(new Cte(s)),this.getSource().setState("error")}),this.getBackground()===void 0&&_te(this,e.styleUrl,{accessToken:this.accessToken})}}const Rte=Ite;class bte extends HU{constructor(e){super(e),this.vectorRenderer_=new nU(e),this.layerImageRatio_=e.getImageRatio(),this.coordinateToVectorPixelTransform_=Hn(),this.renderedPixelToCoordinateTransform_=null}disposeInternal(){this.vectorRenderer_.dispose(),super.disposeInternal()}getFeatures(e){if(!this.vectorRenderer_)return Promise.resolve([]);const t=Tn(this.coordinateToVectorPixelTransform_,Tn(this.renderedPixelToCoordinateTransform_,e.slice()));return this.vectorRenderer_.getFeatures(t)}handleFontsChanged(){this.vectorRenderer_.handleFontsChanged()}prepareFrame(e){const t=e.pixelRatio,i=e.viewState,r=i.resolution,s=e.viewHints,o=this.vectorRenderer_;let a=e.extent;this.layerImageRatio_!==1&&(a=a.slice(0),pE(a,this.layerImageRatio_));const l=gt(a)/r,u=rn(a)/r;if(!s[ln.ANIMATING]&&!s[ln.INTERACTING]&&!bf(a)){o.useContainer(null,null);const h=o.context,p=e.layerStatesArray[e.layerIndex];h.globalAlpha=p.opacity;const m=Object.assign({},p,{opacity:1}),y=Object.assign({},e,{declutterTree:new QA(9),extent:a,size:[l,u],viewState:Object.assign({},e.viewState,{rotation:0}),layerStatesArray:[m],layerIndex:0});let x=!0;const w=new TE(a,r,t,h.canvas,function(R){o.prepareFrame(y)&&o.replayGroupChanged&&(o.clipping=!1,o.renderFrame(y,null)&&(o.renderDeclutter(y),x=!1),R())});w.addEventListener(Re.CHANGE,()=>{if(w.getState()!==st.LOADED)return;this.image_=x?null:w;const R=w.getResolution(),E=w.getPixelRatio(),T=R*t/E;this.renderedResolution=T,this.coordinateToVectorPixelTransform_=As(this.coordinateToVectorPixelTransform_,l/2,u/2,1/T,-1/T,0,-i.center[0],-i.center[1])}),w.load()}return this.image_&&(this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice()),!!this.image_}preRender(){}postRender(){}renderDeclutter(){}forEachFeatureAtCoordinate(e,t,i,r,s){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,i,r,s):super.forEachFeatureAtCoordinate(e,t,i,r,s)}}const Ate=bte;class kte extends Q0{constructor(e){e=e||{};const t=Object.assign({},e);delete t.imageRatio,super(t),this.imageRatio_=e.imageRatio!==void 0?e.imageRatio:1}getImageRatio(){return this.imageRatio_}createRenderer(){return new Ate(this)}}const Pte=kte;class Lte{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}}const Mte=Lte;function yw(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement?n:null}function PR(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Float32Array||n instanceof DataView?n:null}let jm=null;function Dte(n){jm||(jm=mn(n.width,n.height,void 0,{willReadFrequently:!0}));const e=jm.canvas,t=n.width;e.width!==t&&(e.width=t);const i=n.height;return e.height!==i&&(e.height=i),jm.drawImage(n,t,i),jm.getImageData(0,0,t,i).data}const Fte=[256,256];let Ote=class extends Mf{constructor(e){const t=ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null}getSize(){if(this.size_)return this.size_;const e=yw(this.data_);return e?[e.width,e.height]:Fte}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ce.IDLE&&this.state!==ce.ERROR)return;this.state=ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=ce.ERROR,e.changed()})}};const Bk=Ote;class Nte extends Bk{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8Array(4)),interpolate:e.interpolate,transition:e.transition}),this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const t=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),i=this.targetTileGrid_.getExtent();let r=this.sourceTileGrid_.getExtent();const s=i?tr(t,i):t;if(Bg(s)===0){this.state=ce.EMPTY;return}const o=e.sourceProj,a=o.getExtent();a&&(r?r=tr(r,a):r=a);const l=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),u=e.targetProj,h=JU(o,u,s,l);if(!isFinite(h)||h<=0){this.state=ce.EMPTY;return}const p=e.errorThreshold!==void 0?e.errorThreshold:xk;if(this.triangulation_=new wk(o,u,s,r,h*p,l),this.triangulation_.getTriangles().length===0){this.state=ce.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(h);let m=this.triangulation_.calculateSourceExtent();if(r&&(o.canWrapX()?(m[1]=ot(m[1],r[1],r[3]),m[3]=ot(m[3],r[1],r[3])):m=tr(m,r)),!Bg(m))this.state=ce.EMPTY;else{const y=this.sourceTileGrid_.getTileRangeForExtentAndZ(m,this.sourceZ_),x=e.getTileFunction;for(let w=y.minX;w<=y.maxX;w++)for(let R=y.minY;R<=y.maxY;R++){const E=x(this.sourceZ_,w,R,this.pixelRatio_);E&&this.sourceTiles_.push(E)}this.sourceTiles_.length===0&&(this.state=ce.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{if(!t||t.getState()!==ce.LOADED)return;const i=t.getSize(),r=this.gutter_;let s;const o=PR(t.getData());o?s=o:s=Dte(yw(t.getData()));const a=[i[0]+2*r,i[1]+2*r],l=s instanceof Float32Array,u=a[0]*a[1],h=l?Float32Array:Uint8Array,p=new h(s.buffer),m=h.BYTES_PER_ELEMENT,y=m*p.length/u,x=p.byteLength/a[1],w=Math.floor(x/m/a[0]),R=u*w;let E=p;if(p.length!==R){E=new h(R);let T=0,I=0;const A=a[0]*w;for(let L=0;L<a[1];++L){for(let F=0;F<A;++F)E[T++]=p[I+F];I+=x/m}}e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),data:new Uint8Array(E.buffer),dataType:h,bytesPerPixel:y,pixelSize:a})}),this.sourceTiles_.length=0,e.length===0)this.state=ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let u,h;const p=e[0].bytesPerPixel,m=Math.ceil(p/3);for(let y=m-1;y>=0;--y){const x=[];for(let A=0,L=e.length;A<L;++A){const F=e[A],O=F.data,N=F.pixelSize,B=N[0],V=N[1],J=mn(B,V,Xl),ge=J.createImageData(B,V),he=ge.data;let de=y*3;for(let oe=0,_e=he.length;oe<_e;oe+=4)he[oe]=O[de],he[oe+1]=O[de+1],he[oe+2]=O[de+2],he[oe+3]=255,de+=p;J.putImageData(ge,0,0),x.push({extent:F.extent,image:J.canvas})}const w=Ek(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,x,this.gutter_,!1,!1);for(let A=0,L=x.length;A<L;++A){const O=x[A].image.getContext("2d");Qh(O),Xl.push(O.canvas)}const R=w.getContext("2d"),E=R.getImageData(0,0,w.width,w.height);Qh(R),Xl.push(w),u||(h=new Uint8Array(p*E.width*E.height),u=new e[0].dataType(h.buffer));const T=E.data;let I=y*3;for(let A=0,L=T.length;A<L;A+=4)T[A+3]===255?(h[I]=T[A],h[I+1]=T[A+1],h[I+2]=T[A+2]):(h[I]=0,h[I+1]=0,h[I+2]=0),I+=p}this.reprojData_=u,this.reprojSize_=[Math.round(r*this.pixelRatio_),Math.round(s*this.pixelRatio_)],this.state=ce.LOADED}this.changed()}load(){if(this.state!==ce.IDLE&&this.state!==ce.ERROR)return;this.state=ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const i=t.getState();if(i!==ce.IDLE&&i!==ce.LOADING)return;e++;const r=Ve(t,Re.CHANGE,function(){const s=t.getState();(s==ce.LOADED||s==ce.ERROR||s==ce.EMPTY)&&(zt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t){t.getState()==ce.IDLE&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(zt),this.sourcesListenerKeys_=null}}const LR=Nte;function KG(n,e,t){const i=t?n.LINEAR:n.NEAREST;n.bindTexture(n.TEXTURE_2D,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,i)}function zte(n,e,t,i){KG(n,e,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)}function KD(n,e,t,i,r,s){const o=n.getGL();let a,l;t instanceof Float32Array?(a=o.FLOAT,n.getExtension("OES_texture_float"),l=n.getExtension("OES_texture_float_linear")!==null):(a=o.UNSIGNED_BYTE,l=!0),KG(o,e,s&&l);const u=t.byteLength/i[1];let h=1;u%8===0?h=8:u%4===0?h=4:u%2===0&&(h=2);let p;switch(r){case 1:{p=o.LUMINANCE;break}case 2:{p=o.LUMINANCE_ALPHA;break}case 3:{p=o.RGB;break}case 4:{p=o.RGBA;break}default:throw new Error(`Unsupported number of bands: ${r}`)}const m=o.getParameter(o.UNPACK_ALIGNMENT);o.pixelStorei(o.UNPACK_ALIGNMENT,h),o.texImage2D(o.TEXTURE_2D,0,p,i[0],i[1],0,p,a,t),o.pixelStorei(o.UNPACK_ALIGNMENT,m)}let Gd=null;function Ute(){Gd=mn(1,1,void 0,{willReadFrequently:!0})}class Gte extends fp{constructor(e){super(),this.tile,this.textures=[],this.handleTileChange_=this.handleTileChange_.bind(this),this.renderSize_=dn(e.grid.getTileSize(e.tile.tileCoord[0])),this.gutter_=e.gutter||0,this.bandCount=NaN,this.helper_=e.helper;const t=new _y(c0,gk);t.fromArray([0,1,1,1,1,0,0,0]),this.helper_.flushBufferData(t),this.coords=t,this.setTile(e.tile)}setTile(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(Re.CHANGE,this.handleTileChange_),this.tile=e,this.textures.length=0,this.loaded=e.getState()===ce.LOADED,this.loaded)this.uploadTile_();else{if(e instanceof Xg){const t=e.getImage();t instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous")}e.addEventListener(Re.CHANGE,this.handleTileChange_)}}uploadTile_(){const e=this.helper_,t=e.getGL(),i=this.tile;let r;i instanceof Xg||i instanceof Yg?r=i.getImage():r=i.getData();const s=yw(r);if(s){const T=t.createTexture();this.textures.push(T),this.bandCount=4,zte(t,T,s,i.interpolate);return}r=PR(r);const o=i.getSize(),a=[o[0]+2*this.gutter_,o[1]+2*this.gutter_],l=r instanceof Float32Array,u=a[0]*a[1],h=l?Float32Array:Uint8Array,p=h.BYTES_PER_ELEMENT,m=r.byteLength/a[1];this.bandCount=Math.floor(m/p/a[0]);const y=Math.ceil(this.bandCount/4);if(y===1){const T=t.createTexture();this.textures.push(T),KD(e,T,r,a,this.bandCount,i.interpolate);return}const x=new Array(y);for(let T=0;T<y;++T){const I=t.createTexture();this.textures.push(I);const A=T<y-1?4:(this.bandCount-1)%4+1;x[T]=new h(u*A)}let w=0,R=0;const E=a[0]*this.bandCount;for(let T=0;T<a[1];++T){for(let I=0;I<E;++I){const A=r[R+I],L=Math.floor(w/this.bandCount),F=I%this.bandCount,O=Math.floor(F/4),N=x[O],B=N.length/u,V=F%4;N[L*B+V]=A,++w}R+=m/p}for(let T=0;T<y;++T){const I=this.textures[T],A=x[T],L=A.length/u;KD(e,I,A,a,L,i.interpolate)}}handleTileChange_(){this.tile.getState()===ce.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(Re.CHANGE))}disposeInternal(){const e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(let t=0;t<this.textures.length;++t)e.deleteTexture(this.textures[t]);this.tile.removeEventListener(Re.CHANGE,this.handleTileChange_)}getImagePixelData_(e,t,i){const r=this.gutter_,s=this.renderSize_[0],o=this.renderSize_[1];Gd||Ute(),Gd.clearRect(0,0,1,1);const a=e.width,l=e.height,u=a-2*r,h=l-2*r,p=r+Math.floor(u*(t/s)),m=r+Math.floor(h*(i/o));let y;try{Gd.drawImage(e,p,m,1,1,0,0,1,1),y=Gd.getImageData(0,0,1,1).data}catch{return Gd=null,null}return y}getArrayPixelData_(e,t,i,r){const s=this.gutter_,o=this.renderSize_[0],a=this.renderSize_[1],l=t[0],u=t[1],h=l+2*s,p=u+2*s,m=s+Math.floor(l*(i/o)),y=s+Math.floor(u*(r/a));if(e instanceof DataView){const w=e.byteLength/(h*p),R=w*(y*h+m),E=e.buffer.slice(R,R+w);return new DataView(E)}const x=this.bandCount*(y*h+m);return e.slice(x,x+this.bandCount)}getPixelData(e,t){if(!this.loaded)return null;if(this.tile instanceof Bk){const i=this.tile.getData(),r=PR(i);if(r){const s=this.tile.getSize();return this.getArrayPixelData_(r,s,e,t)}return this.getImagePixelData_(yw(i),e,t)}return this.getImagePixelData_(this.tile.getImage(),e,t)}}const jte=Gte,mt={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},ax={TEXTURE_COORD:"a_textureCoord"},Bte=[{name:ax.TEXTURE_COORD,size:2,type:Eo.FLOAT}],Vte={};function $te(n){return 2*(1-1/(n+1))-1}function YD(n,e,t){t in n||(n[t]=[]),n[t].push(e)}function pC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=tr(e,bo(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=tr(e,r))}return e}function mC(n,e){return`${n.getKey()},${u0(e)}`}class Wte extends jU{constructor(e,t){super(e,{uniforms:t.uniforms}),this.renderComplete=!1,this.tileTransform_=Hn(),this.tempMat4_=UU(),this.tempTileRange_=new CE(0,0,0,0),this.tempTileCoord_=l0(0,0,0),this.tempSize_=[0,0],this.program_,this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.indices_=new _y(IE,gk),this.indices_.fromArray([0,1,3,1,2,3]);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileTextureCache_=new fk(i),this.paletteTextures_=t.paletteTextures||[],this.frameState_=null,this.projection_=void 0}reset(e){super.reset({uniforms:e.uniforms}),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}isDrawableTile_(e){const t=this.getLayer(),i=e.getState(),r=t.getUseInterimTilesOnError();return i==ce.LOADED||i==ce.EMPTY||i==ce.ERROR&&!r}prepareFrameInternal(e){this.projection_?e.viewState.projection!==this.projection_&&(this.clearCache(),this.projection_=e.viewState.projection):this.projection_=e.viewState.projection;const i=this.getLayer().getRenderSource();return!i||bf(pC(e,e.extent))?!1:i.getState()==="ready"}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getGutterForProjection(o.projection),p=be(l);p in e.wantedTiles||(e.wantedTiles[p]={});const m=e.wantedTiles[p],y=this.tileTextureCache_,x=a.getMapInternal(),w=Math.max(i-s,u.getMinZoom(),u.getZForResolution(Math.min(a.getMaxResolution(),x?x.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):u.getResolution(0)),l.zDirection));for(let R=i;R>=w;--R){const E=u.getTileRangeForExtentAndZ(t,R,this.tempTileRange_),T=u.getResolution(R);for(let I=E.minX;I<=E.maxX;++I)for(let A=E.minY;A<=E.maxY;++A){const L=l0(R,I,A,this.tempTileCoord_),F=mC(l,L);let O,N;if(y.containsKey(F)&&(O=y.get(F),N=O.tile),!O||O.tile.key!==l.getKey())if(N=l.getTile(R,I,A,e.pixelRatio,o.projection),!O)O=new jte({tile:N,grid:u,helper:this.helper,gutter:h}),y.set(F,O);else if(this.isDrawableTile_(N))O.setTile(N);else{const V=N.getInterimTile();O.setTile(V)}YD(r,O,R);const B=N.getKey();m[B]=!0,N.getState()===ce.IDLE&&(e.tileQueue.isKeyQueued(B)||e.tileQueue.enqueue([N,p,u.getTileCoordCenter(L),T]))}}}renderFrame(e){this.frameState_=e,this.renderComplete=!0;const t=this.helper.getGL();this.preRender(t,e);const i=e.viewState,r=this.getLayer(),s=r.getRenderSource(),o=s.getTileGridForProjection(i.projection),a=s.getGutterForProjection(i.projection),l=pC(e,e.extent),u=o.getZForResolution(i.resolution,s.zDirection),h={},p=r.getPreload();if(e.nextExtent){const O=o.getZForResolution(i.nextResolution,s.zDirection),N=pC(e,e.nextExtent);this.enqueueTiles(e,N,O,h,p)}this.enqueueTiles(e,l,u,h,0),p>0&&setTimeout(()=>{this.enqueueTiles(e,l,u-1,h,p-1)},0);const m={},y=be(this),x=e.time;let w=!1;const R=h[u];for(let O=0,N=R.length;O<N;++O){const B=R[O],V=B.tile;if((V instanceof Yg||V instanceof LR)&&V.getState()===ce.EMPTY)continue;const J=V.tileCoord;if(B.loaded){const de=V.getAlpha(y,x);if(de===1){V.endTransition(y);continue}w=!0;const oe=u0(J);m[oe]=de}if(this.renderComplete=!1,this.findAltTiles_(o,J,u+1,h))continue;const he=o.getMinZoom();for(let de=u-1;de>=he&&!this.findAltTiles_(o,J,de,h);--de);}this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e,!w);const E=Object.keys(h).map(Number).sort(Ac),T=i.center[0],I=i.center[1];for(let O=0,N=E.length;O<N;++O){const B=E[O],V=o.getResolution(B),J=dn(o.getTileSize(B),this.tempSize_),ge=o.getOrigin(B),he=J[0]+2*a,de=J[1]+2*a,oe=he/de,_e=(T-ge[0])/(J[0]*V),se=(ge[1]-I)/(J[1]*V),Z=i.resolution/V,pe=$te(B),ne=h[B];for(let ee=0,j=ne.length;ee<j;++ee){const ie=ne[ee];if(!ie.loaded)continue;const H=ie.tile.tileCoord,te=u0(H),ue=H[1],K=H[2];pg(this.tileTransform_),mg(this.tileTransform_,2/(e.size[0]*Z/he),-2/(e.size[1]*Z/he)),f3(this.tileTransform_,i.rotation),mg(this.tileTransform_,1,1/oe),jx(this.tileTransform_,(J[0]*(ue-_e)-a)/he,(J[1]*(K-se)-a)/de),this.helper.setUniformMatrixValue(mt.TILE_TRANSFORM,rx(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(ie.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(Bte);let Te=0;for(;Te<ie.textures.length;){const rt="TEXTURE"+Te,ut=`${mt.TILE_TEXTURE_ARRAY}[${Te}]`;t.activeTexture(t[rt]),t.bindTexture(t.TEXTURE_2D,ie.textures[Te]),t.uniform1i(this.helper.getUniformLocation(ut),Te),++Te}for(let rt=0;rt<this.paletteTextures_.length;++rt){const ut=this.paletteTextures_[rt];t.activeTexture(t["TEXTURE"+Te]);const ct=ut.getTexture(t);t.bindTexture(t.TEXTURE_2D,ct),t.uniform1i(this.helper.getUniformLocation(ut.name),Te),++Te}const lt=te in m?m[te]:1;lt<1&&(e.animate=!0),this.helper.setUniformFloatValue(mt.TRANSITION_ALPHA,lt),this.helper.setUniformFloatValue(mt.DEPTH,pe),this.helper.setUniformFloatValue(mt.TEXTURE_PIXEL_WIDTH,he),this.helper.setUniformFloatValue(mt.TEXTURE_PIXEL_HEIGHT,de),this.helper.setUniformFloatValue(mt.TEXTURE_RESOLUTION,V),this.helper.setUniformFloatValue(mt.TEXTURE_ORIGIN_X,ge[0]+ue*J[0]*V-a*V),this.helper.setUniformFloatValue(mt.TEXTURE_ORIGIN_Y,ge[1]-K*J[1]*V+a*V);let It=l;a>0&&(It=o.getTileCoordExtent(H),tr(It,l,It)),this.helper.setUniformFloatVec4(mt.RENDER_EXTENT,It),this.helper.setUniformFloatValue(mt.RESOLUTION,i.resolution),this.helper.setUniformFloatValue(mt.ZOOM,i.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const A=this.helper.getCanvas(),L=this.tileTextureCache_;for(;L.canExpireCache();)L.pop().dispose();const F=function(O,N){s.updateCacheSize(.1,N.viewState.projection),s.expireCache(N.viewState.projection,Vte)};return e.postRenderFunctions.push(F),this.postRender(t,e),A}getData(e){if(!this.helper.getGL())return null;const i=this.frameState_;if(!i)return null;const r=this.getLayer(),s=Tn(i.pixelToCoordinateTransform,e.slice()),o=i.viewState,a=r.getExtent();if(a&&!la(bo(a,o.projection),s))return null;const l=r.getSources(_i([s]),o.resolution);let u,h,p;for(u=l.length-1;u>=0;--u)if(h=l[u],h.getState()==="ready"){if(p=h.getTileGridForProjection(o.projection),h.getWrapX())break;const y=p.getExtent();if(!y||la(y,s))break}if(u<0)return null;const m=this.tileTextureCache_;for(let y=p.getZForResolution(o.resolution);y>=p.getMinZoom();--y){const x=p.getTileCoordForCoordAndZ(s,y),w=mC(h,x);if(!m.containsKey(w))continue;const R=m.get(w),E=R.tile;if((E instanceof Yg||E instanceof LR)&&E.getState()===ce.EMPTY)return null;if(!R.loaded)continue;const T=p.getOrigin(y),I=dn(p.getTileSize(y)),A=p.getResolution(y),L=(s[0]-T[0])/A-x[1]*I[0],F=(T[1]-s[1])/A-x[2]*I[1];return R.getPixelData(L,F)}return null}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileTextureCache_,l=this.getLayer().getRenderSource();for(let u=s.minX;u<=s.maxX;++u)for(let h=s.minY;h<=s.maxY;++h){const p=mC(l,[i,u,h]);let m=!1;if(a.containsKey(p)){const y=a.get(p);y.loaded&&(YD(r,y,i),m=!0)}m||(o=!1)}return o}clearCache(){const e=this.tileTextureCache_;e.forEach(t=>t.dispose()),e.clear()}removeHelper(){this.helper&&this.clearCache(),super.removeHelper()}disposeInternal(){const e=this.helper;e&&(e.getGL().deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)),super.disposeInternal(),delete this.indices_,delete this.tileTextureCache_,delete this.frameState_}}const Hte=Wte,Ce={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},Ct={};function ol(n){if(typeof n=="number")return Ce.NUMBER;if(typeof n=="boolean")return Ce.BOOLEAN;if(typeof n=="string")return bY(n)?Ce.COLOR|Ce.STRING:Ce.STRING;if(!Array.isArray(n))throw new Error(`Unhandled value type: ${JSON.stringify(n)}`);const e=n;if(e.every(function(r){return typeof r=="number"}))return e.length===3||e.length===4?Ce.COLOR|Ce.NUMBER_ARRAY:Ce.NUMBER_ARRAY;if(typeof e[0]!="string")throw new Error(`Expected an expression operator but received: ${JSON.stringify(e)}`);const i=Ct[e[0]];if(i===void 0)throw new Error(`Unrecognized expression operator: ${JSON.stringify(e)}`);return i.getReturnType(e.slice(1))}function Xte(n){return Math.log2(n)%1===0}function zE(n){const e=n.toString();return e.includes(".")?e:e+".0"}function YG(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(zE).join(", ")})`}function qte(n){const e=Qy(n).slice();return e.length<4&&e.push(1),YG(e.map(function(t,i){return i<3?t/255:t}))}function _w(n,e){return n.stringLiteralsMap[e]===void 0&&(n.stringLiteralsMap[e]=Object.keys(n.stringLiteralsMap).length),n.stringLiteralsMap[e]}function Kte(n,e){return zE(_w(n,e))}function De(n,e,t){if(Array.isArray(e)&&typeof e[0]=="string"){const r=Ct[e[0]];if(r===void 0)throw new Error(`Unrecognized expression operator: ${JSON.stringify(e)}`);return r.toGlsl(n,e.slice(1),t)}const i=ol(e);if((i&Ce.NUMBER)>0)return zE(e);if((i&Ce.BOOLEAN)>0)return e.toString();if((i&Ce.STRING)>0&&(t===void 0||t==Ce.STRING))return Kte(n,e.toString());if((i&Ce.COLOR)>0&&(t===void 0||t==Ce.COLOR))return qte(e);if((i&Ce.NUMBER_ARRAY)>0)return YG(e);throw new Error(`Unexpected expression ${e} (expected type ${t})`)}function ZG(n){if(!(ol(n)&Ce.NUMBER))throw new Error(`A numeric value was expected, got ${JSON.stringify(n)} instead`)}function di(n){for(let e=0;e<n.length;e++)ZG(n[e])}function QG(n){if(!(ol(n)&Ce.STRING))throw new Error(`A string value was expected, got ${JSON.stringify(n)} instead`)}function Vk(n){if(!(ol(n)&Ce.BOOLEAN))throw new Error(`A boolean value was expected, got ${JSON.stringify(n)} instead`)}function Ln(n,e){if(n.length!==e)throw new Error(`Exactly ${e} arguments were expected, got ${n.length} instead`)}function fl(n,e){if(n.length<e)throw new Error(`At least ${e} arguments were expected, got ${n.length} instead`)}function UE(n,e){if(n.length>e)throw new Error(`At most ${e} arguments were expected, got ${n.length} instead`)}function JG(n){if(n.length%2!==0)throw new Error(`An even amount of arguments was expected, got ${n} instead`)}function Yte(n){if(n.length%2===0)throw new Error(`An odd amount of arguments was expected, got ${n} instead`)}function $k(n,e){if(!Xte(e))throw new Error(`Could not infer only one type from the following expression: ${JSON.stringify(n)}`)}Ct.get={getReturnType:function(n){return Ce.ANY},toGlsl:function(n,e){Ln(e,1),QG(e[0]);const t=e[0].toString();return n.attributes.includes(t)||n.attributes.push(t),(n.inFragmentShader?"v_":"a_")+t}};function Wk(n){return"u_var_"+n}Ct.var={getReturnType:function(n){return Ce.ANY},toGlsl:function(n,e){Ln(e,1),QG(e[0]);const t=e[0].toString();return n.variables.includes(t)||n.variables.push(t),Wk(t)}};const ej="u_paletteTextures";Ct.palette={getReturnType:function(n){return Ce.COLOR},toGlsl:function(n,e){Ln(e,2),ZG(e[0]);const t=De(n,e[0]),i=e[1];if(!Array.isArray(i))throw new Error("The second argument of palette must be an array");const r=i.length,s=new Uint8Array(r*4);for(let l=0;l<r;l++){const u=i[l];let h;if(typeof u=="string")h=U3(u);else{if(!Array.isArray(u))throw new Error("The second argument of palette must be an array of strings or colors");const m=u.length;if(m===4)h=u;else{if(m!==3)throw new Error(`Expected palette color to have 3 or 4 values, got ${m}`);h=[u[0],u[1],u[2],1]}}const p=l*4;s[p]=h[0],s[p+1]=h[1],s[p+2]=h[2],s[p+3]=h[3]*255}n.paletteTextures||(n.paletteTextures=[]);const o=`${ej}[${n.paletteTextures.length}]`,a=new Mte(o,s);return n.paletteTextures.push(a),`texture2D(${o}, vec2((${t} + 0.5) / ${r}.0, 0.5))`}};const yC="getBandValue";Ct.band={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){fl(e,1),UE(e,3);const t=e[0];if(!(yC in n.functions)){let o="";const a=n.bandCount||1;for(let l=0;l<a;l++){const u=Math.floor(l/4);let h=l%4;l===a-1&&h===1&&(h=3);const p=`${mt.TILE_TEXTURE_ARRAY}[${u}]`;o+=`
          if (band == ${l+1}.0) {
            return texture2D(${p}, v_textureCoord + vec2(dx, dy))[${h}];
          }
        `}n.functions[yC]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / ${mt.TEXTURE_PIXEL_WIDTH};
          float dy = yOffset / ${mt.TEXTURE_PIXEL_HEIGHT};
          ${o}
        }
      `}const i=De(n,t),r=De(n,e[1]||0),s=De(n,e[2]||0);return`${yC}(${i}, ${r}, ${s})`}};Ct.time={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,0),"u_time"}};Ct.zoom={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,0),"u_zoom"}};Ct.resolution={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,0),"u_resolution"}};Ct["*"]={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return fl(e,2),di(e),`(${e.map(t=>De(n,t)).join(" * ")})`}};Ct["/"]={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,2),di(e),`(${De(n,e[0])} / ${De(n,e[1])})`}};Ct["+"]={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return fl(e,2),di(e),`(${e.map(t=>De(n,t)).join(" + ")})`}};Ct["-"]={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,2),di(e),`(${De(n,e[0])} - ${De(n,e[1])})`}};Ct.clamp={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){Ln(e,3),di(e);const t=De(n,e[1]),i=De(n,e[2]);return`clamp(${De(n,e[0])}, ${t}, ${i})`}};Ct["%"]={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,2),di(e),`mod(${De(n,e[0])}, ${De(n,e[1])})`}};Ct["^"]={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,2),di(e),`pow(${De(n,e[0])}, ${De(n,e[1])})`}};Ct.abs={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,1),di(e),`abs(${De(n,e[0])})`}};Ct.floor={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,1),di(e),`floor(${De(n,e[0])})`}};Ct.round={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,1),di(e),`floor(${De(n,e[0])} + 0.5)`}};Ct.ceil={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,1),di(e),`ceil(${De(n,e[0])})`}};Ct.sin={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,1),di(e),`sin(${De(n,e[0])})`}};Ct.cos={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return Ln(e,1),di(e),`cos(${De(n,e[0])})`}};Ct.atan={getReturnType:function(n){return Ce.NUMBER},toGlsl:function(n,e){return fl(e,1),UE(e,2),di(e),e.length===2?`atan(${De(n,e[0])}, ${De(n,e[1])})`:`atan(${De(n,e[0])})`}};Ct[">"]={getReturnType:function(n){return Ce.BOOLEAN},toGlsl:function(n,e){return Ln(e,2),di(e),`(${De(n,e[0])} > ${De(n,e[1])})`}};Ct[">="]={getReturnType:function(n){return Ce.BOOLEAN},toGlsl:function(n,e){return Ln(e,2),di(e),`(${De(n,e[0])} >= ${De(n,e[1])})`}};Ct["<"]={getReturnType:function(n){return Ce.BOOLEAN},toGlsl:function(n,e){return Ln(e,2),di(e),`(${De(n,e[0])} < ${De(n,e[1])})`}};Ct["<="]={getReturnType:function(n){return Ce.BOOLEAN},toGlsl:function(n,e){return Ln(e,2),di(e),`(${De(n,e[0])} <= ${De(n,e[1])})`}};function tj(n){return{getReturnType:function(e){return Ce.BOOLEAN},toGlsl:function(e,t){Ln(t,2);let i=Ce.ANY;for(let r=0;r<t.length;r++)i&=ol(t[r]);if(i===Ce.NONE)throw new Error(`All arguments should be of compatible type, got ${JSON.stringify(t)} instead`);return i&=~Ce.COLOR,`(${De(e,t[0],i)} ${n} ${De(e,t[1],i)})`}}}Ct["=="]=tj("==");Ct["!="]=tj("!=");Ct["!"]={getReturnType:function(n){return Ce.BOOLEAN},toGlsl:function(n,e){return Ln(e,1),Vk(e[0]),`(!${De(n,e[0])})`}};function nj(n){return{getReturnType:function(e){return Ce.BOOLEAN},toGlsl:function(e,t){fl(t,2);for(let r=0;r<t.length;r++)Vk(t[r]);let i="";return i=t.map(r=>De(e,r)).join(` ${n} `),i=`(${i})`,i}}}Ct.all=nj("&&");Ct.any=nj("||");Ct.between={getReturnType:function(n){return Ce.BOOLEAN},toGlsl:function(n,e){Ln(e,3),di(e);const t=De(n,e[1]),i=De(n,e[2]),r=De(n,e[0]);return`(${r} >= ${t} && ${r} <= ${i})`}};Ct.array={getReturnType:function(n){return Ce.NUMBER_ARRAY},toGlsl:function(n,e){fl(e,2),UE(e,4),di(e);const t=e.map(function(i){return De(n,i,Ce.NUMBER)});return`vec${e.length}(${t.join(", ")})`}};Ct.color={getReturnType:function(n){return Ce.COLOR},toGlsl:function(n,e){fl(e,3),UE(e,4),di(e);const t=e;e.length===3&&t.push(1);const i=e.map(function(r,s){return De(n,r,Ce.NUMBER)+(s<3?" / 255.0":"")});return`vec${e.length}(${i.join(", ")})`}};Ct.interpolate={getReturnType:function(n){let e=Ce.COLOR|Ce.NUMBER;for(let t=3;t<n.length;t+=2)e=e&ol(n[t]);return e},toGlsl:function(n,e,t){JG(e),fl(e,6);const i=e[0];let r;switch(i[0]){case"linear":r=1;break;case"exponential":r=i[1];break;default:r=null}if(!r)throw new Error(`Invalid interpolation type for "interpolate" operator, received: ${JSON.stringify(i)}`);t=t!==void 0?t:Ce.ANY;const s=Ct.interpolate.getReturnType(e)&t;$k(e,s);const o=De(n,e[1]),a=zE(r);let l="";for(let u=2;u<e.length-2;u+=2){const h=De(n,e[u]),p=l||De(n,e[u+1],s),m=De(n,e[u+2]),y=De(n,e[u+3],s);l=`mix(${p}, ${y}, pow(clamp((${o} - ${h}) / (${m} - ${h}), 0.0, 1.0), ${a}))`}return l}};Ct.match={getReturnType:function(n){let e=Ce.ANY;for(let t=2;t<n.length;t+=2)e=e&ol(n[t]);return e=e&ol(n[n.length-1]),e},toGlsl:function(n,e,t){JG(e),fl(e,4),t=t!==void 0?t:Ce.ANY;const i=Ct.match.getReturnType(e)&t;$k(e,i);const r=De(n,e[0]),s=De(n,e[e.length-1],i);let o=null;for(let a=e.length-3;a>=1;a-=2){const l=De(n,e[a]),u=De(n,e[a+1],i);o=`(${r} == ${l} ? ${u} : ${o||s})`}return o}};Ct.case={getReturnType:function(n){let e=Ce.ANY;for(let t=1;t<n.length;t+=2)e=e&ol(n[t]);return e=e&ol(n[n.length-1]),e},toGlsl:function(n,e,t){Yte(e),fl(e,3),t=t!==void 0?t:Ce.ANY;const i=Ct.case.getReturnType(e)&t;$k(e,i);for(let o=0;o<e.length-1;o+=2)Vk(e[o]);const r=De(n,e[e.length-1],i);let s=null;for(let o=e.length-3;o>=0;o-=2){const a=De(n,e[o]),l=De(n,e[o+1],i);s=`(${a} ? ${l} : ${s||r})`}return s}};class Zte{constructor(){this.uniforms=[],this.attributes=[],this.varyings=[],this.sizeExpression="vec2(1.0)",this.rotationExpression="0.0",this.offsetExpression="vec2(0.0)",this.colorExpression="vec4(1.0)",this.texCoordExpression="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression="false",this.rotateWithView=!1}addUniform(e){return this.uniforms.push(e),this}addAttribute(e){return this.attributes.push(e),this}addVarying(e,t,i){return this.varyings.push({name:e,type:t,expression:i}),this}setSizeExpression(e){return this.sizeExpression=e,this}setRotationExpression(e){return this.rotationExpression=e,this}setSymbolOffsetExpression(e){return this.offsetExpression=e,this}setColorExpression(e){return this.colorExpression=e,this}setTextureCoordinateExpression(e){return this.texCoordExpression=e,this}setFragmentDiscardExpression(e){return this.discardExpression=e,this}setSymbolRotateWithView(e){return this.rotateWithView=e,this}getSizeExpression(){return this.sizeExpression}getOffsetExpression(){return this.offsetExpression}getColorExpression(){return this.colorExpression}getTextureCoordinateExpression(){return this.texCoordExpression}getFragmentDiscardExpression(){return this.discardExpression}getSymbolVertexShader(e){const t=this.rotateWithView?"u_offsetScaleMatrix * u_offsetRotateMatrix":"u_offsetScaleMatrix";let i=this.attributes,r=this.varyings;return e&&(i=i.concat("vec4 a_hitColor"),r=r.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`precision mediump float;
uniform mat4 u_projectionMatrix;
uniform mat4 u_offsetScaleMatrix;
uniform mat4 u_offsetRotateMatrix;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
${this.uniforms.map(function(s){return"uniform "+s+";"}).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
${i.map(function(s){return"attribute "+s+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
${r.map(function(s){return"varying "+s.type+" "+s.name+";"}).join(`
`)}
void main(void) {
  mat4 offsetMatrix = ${t};
  vec2 halfSize = ${this.sizeExpression} * 0.5;
  vec2 offset = ${this.offsetExpression};
  float angle = ${this.rotationExpression};
  float offsetX;
  float offsetY;
  if (a_index == 0.0) {
    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);
    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);
  } else if (a_index == 1.0) {
    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);
    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);
  } else if (a_index == 2.0) {
    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);
    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);
  } else {
    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);
    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);
  }
  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
  vec4 texCoord = ${this.texCoordExpression};
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;
  v_quadCoord = vec2(u, v);
${r.map(function(s){return"  "+s.name+" = "+s.expression+";"}).join(`
`)}
}`}getSymbolFragmentShader(e){const t=e?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"";let i=this.varyings;return e&&(i=i.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`precision mediump float;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
${this.uniforms.map(function(r){return"uniform "+r+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
${i.map(function(r){return"varying "+r.type+" "+r.name+";"}).join(`
`)}
void main(void) {
  if (${this.discardExpression}) { discard; }
  gl_FragColor = ${this.colorExpression};
  gl_FragColor.rgb *= gl_FragColor.a;
${t}
}`}}function Qte(n){const e=n.symbol,t=e.size!==void 0?e.size:1,i=e.color||"white",r=e.textureCoord||[0,0,1,1],s=e.offset||[0,0],o=e.opacity!==void 0?e.opacity:1,a=e.rotation!==void 0?e.rotation:0,l={inFragmentShader:!1,variables:[],attributes:[],stringLiteralsMap:{},functions:{}},u=De(l,t,Ce.NUMBER_ARRAY|Ce.NUMBER),h=De(l,s,Ce.NUMBER_ARRAY),p=De(l,r,Ce.NUMBER_ARRAY),m=De(l,a,Ce.NUMBER),y={inFragmentShader:!0,variables:l.variables,attributes:[],stringLiteralsMap:l.stringLiteralsMap,functions:{}},x=De(y,i,Ce.COLOR),w=De(y,o,Ce.NUMBER);let R="1.0";const E=`vec2(${De(y,t,Ce.NUMBER_ARRAY|Ce.NUMBER)}).x`;switch(e.symbolType){case"square":break;case"image":break;case"circle":R=`(1.0-smoothstep(1.-4./${E},1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))`;break;case"triangle":const A="(v_quadCoord*2.-1.)",L=`(atan(${A}.x,${A}.y))`;R=`(1.0-smoothstep(.5-3./${E},.5,cos(floor(.5+${L}/2.094395102)*2.094395102-${L})*length(${A})))`;break;default:throw new Error("Unexpected symbol type: "+e.symbolType)}const T=new Zte().setSizeExpression(`vec2(${u})`).setRotationExpression(m).setSymbolOffsetExpression(h).setTextureCoordinateExpression(p).setSymbolRotateWithView(!!e.rotateWithView).setColorExpression(`vec4(${x}.rgb, ${x}.a * ${w} * ${R})`);if(n.filter){const A=De(y,n.filter,Ce.BOOLEAN);T.setFragmentDiscardExpression(`!${A}`)}const I={};if(y.variables.forEach(function(A){const L=Wk(A);T.addUniform(`float ${L}`),I[L]=function(){if(!n.variables||n.variables[A]===void 0)throw new Error(`The following variable is missing from the style: ${A}`);let F=n.variables[A];return typeof F=="string"&&(F=_w(l,F)),F!==void 0?F:-9999999}}),e.symbolType==="image"&&e.src){const A=new Image;A.crossOrigin=e.crossOrigin===void 0?"anonymous":e.crossOrigin,A.src=e.src,T.addUniform("sampler2D u_texture").setColorExpression(T.getColorExpression()+" * texture2D(u_texture, v_texCoord)"),I.u_texture=A}return y.attributes.forEach(function(A){l.attributes.includes(A)||l.attributes.push(A),T.addVarying(`v_${A}`,"float",`a_${A}`)}),l.attributes.forEach(function(A){T.addAttribute(`float a_${A}`)}),{builder:T,attributes:l.attributes.map(function(A){return{name:A,callback:function(L,F){let O=F[A];return typeof O=="string"&&(O=_w(l,O)),O!==void 0?O:-9999999}}}),uniforms:I}}class Jte extends cu{constructor(e){const t=Object.assign({},e);super(t),this.parseResult_=Qte(e.style),this.styleVariables_=e.style.variables||{},this.hitDetectionDisabled_=!!e.disableHitDetection}createRenderer(){return new WU(this,{vertexShader:this.parseResult_.builder.getSymbolVertexShader(),fragmentShader:this.parseResult_.builder.getSymbolFragmentShader(),hitVertexShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolVertexShader(!0),hitFragmentShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolFragmentShader(!0),uniforms:this.parseResult_.uniforms,attributes:this.parseResult_.attributes})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}const ene=Jte;function ZD(n,e){const t=`
    attribute vec2 ${ax.TEXTURE_COORD};
    uniform mat4 ${mt.TILE_TRANSFORM};
    uniform float ${mt.TEXTURE_PIXEL_WIDTH};
    uniform float ${mt.TEXTURE_PIXEL_HEIGHT};
    uniform float ${mt.TEXTURE_RESOLUTION};
    uniform float ${mt.TEXTURE_ORIGIN_X};
    uniform float ${mt.TEXTURE_ORIGIN_Y};
    uniform float ${mt.DEPTH};

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = ${ax.TEXTURE_COORD};
      v_mapCoord = vec2(
        ${mt.TEXTURE_ORIGIN_X} + ${mt.TEXTURE_RESOLUTION} * ${mt.TEXTURE_PIXEL_WIDTH} * v_textureCoord[0],
        ${mt.TEXTURE_ORIGIN_Y} - ${mt.TEXTURE_RESOLUTION} * ${mt.TEXTURE_PIXEL_HEIGHT} * v_textureCoord[1]
      );
      gl_Position = ${mt.TILE_TRANSFORM} * vec4(${ax.TEXTURE_COORD}, ${mt.DEPTH}, 1.0);
    }
  `,i={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:e},r=[];if(n.color!==void 0){const p=De(i,n.color,Ce.COLOR);r.push(`color = ${p};`)}if(n.contrast!==void 0){const p=De(i,n.contrast,Ce.NUMBER);r.push(`color.rgb = clamp((${p} + 1.0) * color.rgb - (${p} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(n.exposure!==void 0){const p=De(i,n.exposure,Ce.NUMBER);r.push(`color.rgb = clamp((${p} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(n.saturation!==void 0){const p=De(i,n.saturation,Ce.NUMBER);r.push(`
      float saturation = ${p} + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `)}if(n.gamma!==void 0){const p=De(i,n.gamma,Ce.NUMBER);r.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${p}));`)}if(n.brightness!==void 0){const p=De(i,n.brightness,Ce.NUMBER);r.push(`color.rgb = clamp(color.rgb + ${p}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}const s={},o=i.variables.length;if(o>1&&!n.variables)throw new Error(`Missing variables in style (expected ${i.variables})`);for(let p=0;p<o;++p){const m=i.variables[p];if(!(m in n.variables))throw new Error(`Missing '${m}' in style variables`);const y=Wk(m);s[y]=function(){let x=n.variables[m];return typeof x=="string"&&(x=_w(i,x)),x!==void 0?x:-9999999}}const a=Object.keys(s).map(function(p){return`uniform float ${p};`}),l=Math.ceil(e/4);a.push(`uniform sampler2D ${mt.TILE_TEXTURE_ARRAY}[${l}];`),i.paletteTextures&&a.push(`uniform sampler2D ${ej}[${i.paletteTextures.length}];`);const u=Object.keys(i.functions).map(function(p){return i.functions[p]}),h=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 ${mt.RENDER_EXTENT};
    uniform float ${mt.TRANSITION_ALPHA};
    uniform float ${mt.TEXTURE_PIXEL_WIDTH};
    uniform float ${mt.TEXTURE_PIXEL_HEIGHT};
    uniform float ${mt.RESOLUTION};
    uniform float ${mt.ZOOM};

    ${a.join(`
`)}

    ${u.join(`
`)}

    void main() {
      if (
        v_mapCoord[0] < ${mt.RENDER_EXTENT}[0] ||
        v_mapCoord[1] < ${mt.RENDER_EXTENT}[1] ||
        v_mapCoord[0] > ${mt.RENDER_EXTENT}[2] ||
        v_mapCoord[1] > ${mt.RENDER_EXTENT}[3]
      ) {
        discard;
      }

      vec4 color = texture2D(${mt.TILE_TEXTURE_ARRAY}[0],  v_textureCoord);

      ${r.join(`
`)}

      if (color.a == 0.0) {
        discard;
      }

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= ${mt.TRANSITION_ALPHA};
    }`;return{vertexShader:t,fragmentShader:h,uniforms:s,paletteTextures:i.paletteTextures}}class ij extends rG{constructor(e){e=e?Object.assign({},e):{};const t=e.style||{};delete e.style;const i=e.cacheSize;delete e.cacheSize,super(e),this.sources_=e.sources,this.renderedSource_=null,this.renderedResolution_=NaN,this.style_=t,this.cacheSize_=i,this.styleVariables_=this.style_.variables||{},this.addChangeListener(Zt.SOURCE,this.handleSourceUpdate_)}getSources(e,t){const i=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(e,t):this.sources_:i?[i]:[]}getRenderSource(){return this.renderedSource_||this.getSource()}getSourceState(){const e=this.getRenderSource();return e?e.getState():"undefined"}handleSourceUpdate_(){this.hasRenderer()&&this.getRenderer().clearCache(),this.getSource()&&this.setStyle(this.style_)}getSourceBandCount_(){const e=Number.MAX_SAFE_INTEGER,t=this.getSources([-e,-e,e,e],e);return t&&t.length&&"bandCount"in t[0]?t[0].bandCount:4}createRenderer(){const e=ZD(this.style_,this.getSourceBandCount_());return new Hte(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})}renderSources(e,t){const i=this.getRenderer();let r;for(let s=0,o=t.length;s<o;++s)this.renderedSource_=t[s],i.prepareFrame(e)&&(r=i.renderFrame(e));return r}render(e,t){this.rendered=!0;const i=e.viewState,r=this.getSources(e.extent,i.resolution);let s=!0;for(let a=0,l=r.length;a<l;++a){const u=r[a],h=u.getState();if(h=="loading"){const p=()=>{u.getState()=="ready"&&(u.removeEventListener("change",p),this.changed())};u.addEventListener("change",p)}s=s&&h=="ready"}const o=this.renderSources(e,r);if(this.getRenderer().renderComplete&&s)return this.renderedResolution_=i.resolution,o;if(this.renderedResolution_>.5*i.resolution){const a=this.getSources(e.extent,this.renderedResolution_).filter(l=>!r.includes(l));if(a.length>0)return this.renderSources(e,a)}return o}setStyle(e){this.styleVariables_=e.variables||{},this.style_=e;const t=ZD(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,paletteTextures:t.paletteTextures}),this.changed()}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}ij.prototype.dispose;const tne=ij,nne=Object.freeze(Object.defineProperty({__proto__:null,Graticule:sU,Group:pp,Heatmap:XZ,Image:XU,Layer:cu,MapboxVector:Rte,Tile:sG,Vector:Lc,VectorImage:Pte,VectorTile:vy,WebGLPoints:ene,WebGLTile:tne},Symbol.toStringTag,{value:"Module"})),QD=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],JD={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"};class ine extends hl{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target}),this.on,this.once,this.un,this.keys_=e.keys!==void 0?e.keys:!1,this.source_=e.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=e.className!==void 0?e.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=e.activeClassName!==void 0?e.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=e.inactiveClassName!==void 0?e.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const t=e.label!==void 0?e.label:"";this.labelNode_=typeof t=="string"?document.createTextNode(t):t;const i=e.labelActive!==void 0?e.labelActive:"";this.labelActiveNode_=typeof i=="string"?document.createTextNode(i):i;const r=e.tipLabel?e.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=r,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(Re.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${rl} ${kf}`,this.element.appendChild(this.button_)}handleClick_(e){e.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const e=this.getMap();if(!e)return;const t=e.getOwnerDocument();if(eF(t))if(tF(t))sne(t);else{let i;this.source_?i=typeof this.source_=="string"?t.getElementById(this.source_):this.source_:i=e.getTargetElement(),this.keys_?rne(i):rj(i)}}handleFullScreenChange_(){const e=this.getMap();if(!e)return;const t=this.isInFullscreen_;this.isInFullscreen_=tF(e.getOwnerDocument()),t!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(Wg(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(JD.ENTERFULLSCREEN)):(Wg(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(JD.LEAVEFULLSCREEN)),e.updateSize())}setClassName_(e,t){t?(e.classList.remove(...this.inactiveClassName_),e.classList.add(...this.activeClassName_)):(e.classList.remove(...this.activeClassName_),e.classList.add(...this.inactiveClassName_))}setMap(e){const t=this.getMap();t&&t.removeChangeListener(hi.TARGET,this.boundHandleMapTargetChange_),super.setMap(e),this.handleMapTargetChange_(),e&&e.addChangeListener(hi.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const e=this.documentListeners_;for(let i=0,r=e.length;i<r;++i)zt(e[i]);e.length=0;const t=this.getMap();if(t){const i=t.getOwnerDocument();eF(i)?this.element.classList.remove(QM):this.element.classList.add(QM);for(let r=0,s=QD.length;r<s;++r)e.push(Ve(i,QD[r],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}function eF(n){const e=n.body;return!!(e.webkitRequestFullscreen||e.requestFullscreen&&n.fullscreenEnabled)}function tF(n){return!!(n.webkitIsFullScreen||n.fullscreenElement)}function rj(n){n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}function rne(n){n.webkitRequestFullscreen?n.webkitRequestFullscreen():rj(n)}function sne(n){n.exitFullscreen?n.exitFullscreen():n.webkitExitFullscreen&&n.webkitExitFullscreen()}const one=ine,_C="projection",nF="coordinateFormat";class ane extends hl{constructor(e){e=e||{};const t=document.createElement("div");t.className=e.className!==void 0?e.className:"ol-mouse-position",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un,this.addChangeListener(_C,this.handleProjectionChanged_),e.coordinateFormat&&this.setCoordinateFormat(e.coordinateFormat),e.projection&&this.setProjection(e.projection),this.renderOnMouseOut_=e.placeholder!==void 0,this.placeholder_=this.renderOnMouseOut_?e.placeholder:"&#160;",this.renderedHTML_=t.innerHTML,this.mapProjection_=null,this.transform_=null,this.wrapX_=e.wrapX!==!1}handleProjectionChanged_(){this.transform_=null}getCoordinateFormat(){return this.get(nF)}getProjection(){return this.get(_C)}handleMouseMove(e){const t=this.getMap();this.updateHTML_(t.getEventPixel(e))}handleMouseOut(e){this.updateHTML_(null)}setMap(e){if(super.setMap(e),e){const t=e.getViewport();this.listenerKeys.push(Ve(t,Ha.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(Ve(t,Ha.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}}setCoordinateFormat(e){this.set(nF,e)}setProjection(e){this.set(_C,_t(e))}updateHTML_(e){let t=this.placeholder_;if(e&&this.mapProjection_){if(!this.transform_){const s=this.getProjection();s?this.transform_=Uc(this.mapProjection_,s):this.transform_=_E}const r=this.getMap().getCoordinateFromPixelInternal(e);if(r){if(this.transform_(r,r),this.wrapX_){const o=this.getProjection()||this.mapProjection_;yE(r,o)}const s=this.getCoordinateFormat();s?t=s(r):t=r.toString()}}(!this.renderedHTML_||t!==this.renderedHTML_)&&(this.element.innerHTML=t,this.renderedHTML_=t)}render(e){const t=e.frameState;t?this.mapProjection_!=t.viewState.projection&&(this.mapProjection_=t.viewState.projection,this.transform_=null):this.mapProjection_=null}}const lne=ane,vC=.75,b1=.1;class une extends hl{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",i=e.tipLabel!==void 0?e.tipLabel:"Overview map",r=e.collapseLabel!==void 0?e.collapseLabel:"";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r):this.collapseLabel_=r;const s=e.label!==void 0?e.label:"";typeof s=="string"?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;const o=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=i,a.appendChild(o),a.addEventListener(Re.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const l=new hk({view:e.view,controls:new Ei,interactions:new Ei});this.ovmap_=l,e.layers&&e.layers.forEach(function(T){l.addLayer(T)});const u=document.createElement("div");u.className="ol-overviewmap-box",u.style.boxSizing="border-box",this.boxOverlay_=new LU({position:[0,0],positioning:"center-center",element:u}),this.ovmap_.addOverlay(this.boxOverlay_);const h=t+" "+rl+" "+kf+(this.collapsed_&&this.collapsible_?" "+Kx:"")+(this.collapsible_?"":" ol-uncollapsible"),p=this.element;p.className=h,p.appendChild(this.ovmapDiv_),p.appendChild(a);const m=this,y=this.boxOverlay_,x=this.boxOverlay_.getElement(),w=function(T){return{clientX:T.clientX,clientY:T.clientY}},R=function(T){const I=w(T),A=l.getEventCoordinateInternal(I);y.setPosition(A)},E=function(T){const I=l.getEventCoordinateInternal(T);m.getMap().getView().setCenterInternal(I),window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",E)};x.addEventListener("mousedown",function(){window.addEventListener("mousemove",R),window.addEventListener("mouseup",E)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const i=t.getView();i&&this.unbindView_(i),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(Ve(e,Wh.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const i=e.getView();i&&(this.bindView_(i),i.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===hi.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const i=this.getMap().getView();this.bindView_(i)}else!this.ovmap_.isRendered()&&(e.key===hi.TARGET||e.key===hi.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new Fl({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(js.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(js.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),s=e.getView().calculateExtentInternal(i);if(this.viewExtent_&&Oo(s,this.viewExtent_))return;this.viewExtent_=s;const o=t.getSize(),l=t.getView().calculateExtentInternal(o),u=t.getPixelFromCoordinateInternal(va(s)),h=t.getPixelFromCoordinateInternal(q0(s)),p=Math.abs(u[0]-h[0]),m=Math.abs(u[1]-h[1]),y=o[0],x=o[1];p<y*b1||m<x*b1||p>y*vC||m>x*vC?this.resetExtent_():zr(l,s)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,i=e.getSize(),s=e.getView().calculateExtentInternal(i),o=t.getView(),a=Math.log(vC/b1)/Math.LN2,l=1/(Math.pow(2,a/2)*b1);pE(s,l),o.fitInternal($g(s))}recenter_(){const e=this.getMap(),t=this.ovmap_,i=e.getView();t.getView().setCenterInternal(i.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),r=e.getView(),s=t.getView(),o=this.rotateWithView_?0:-r.getRotation(),a=this.boxOverlay_,l=this.boxOverlay_.getElement(),u=r.getCenterInternal(),h=r.getResolution(),p=s.getResolution(),m=i[0]*h/p,y=i[1]*h/p;if(a.setPosition(u),l){l.style.width=m+"px",l.style.height=y+"px";const x="rotate("+o+"rad)";l.style.transform=x}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=jg(this.ovmap_,oa.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(Kx),this.collapsed_?Wg(this.collapseLabel_,this.label_):Wg(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}}const cne=une,xC="units",hne=[1,2,5],Bm=25.4/.28;class fne extends hl{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+rl,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(xC,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(xC)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(xC,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Vx(i,e.resolution,t,s);const a=this.minWidth_*(this.dpi_||Bm)/Bm,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Bm)/Bm:void 0;let u=a*o,h="";if(r=="degrees"){const I=Kh.degrees;u*=I,u<I/60?(h="",o*=3600):u<I?(h="",o*=60):h=""}else r=="imperial"?u<.9144?(h="in",o/=.0254):u<1609.344?(h="ft",o/=.3048):(h="mi",o/=1609.344):r=="nautical"?(o/=1852,h="NM"):r=="metric"?u<.001?(h="m",o*=1e6):u<1?(h="mm",o*=1e3):u<1e3?h="m":(h="km",o/=1e3):r=="us"?u<.9144?(h="in",o*=39.37):u<1609.344?(h="ft",o/=.30480061):(h="mi",o/=1609.3472):Ye(!1,33);let p=3*Math.floor(Math.log(a*o)/Math.log(10)),m,y,x,w,R,E;for(;;){x=Math.floor(p/3);const I=Math.pow(10,x);if(m=hne[(p%3+3)%3]*I,y=Math.round(m/o),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){m=w,y=R,x=E;break}else if(y>=a)break;w=m,R=y,E=x,++p}const T=this.scaleBar_?this.createScaleBar(y,m,h):m.toFixed(x<0?-x:0)+" "+h;this.renderedHTML_!=T&&(this.innerElement_.innerHTML=T,this.renderedHTML_=T),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,a=e/o,l=[this.createMarker("absolute")];for(let h=0;h<o;++h){const p=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(h%2===0||o===2?this.createStepText(h,e,!1,t,i):"")+"</div>")}return l.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const a=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,u=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${u}px;left: ${i?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=Vx(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Bm,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const dne=fne,Vm={VERTICAL:0,HORIZONTAL:1};class gne extends hl{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render}),this.dragListenerKeys_=[],this.currentResolution_=void 0,this.direction_=Vm.VERTICAL,this.dragging_,this.heightLimit_=0,this.widthLimit_=0,this.startX_,this.startY_,this.thumbSize_=null,this.sliderInitialized_=!1,this.duration_=e.duration!==void 0?e.duration:200;const t=e.className!==void 0?e.className:"ol-zoomslider",i=document.createElement("button");i.setAttribute("type","button"),i.className=t+"-thumb "+rl;const r=this.element;r.className=t+" "+rl+" "+kf,r.appendChild(i),r.addEventListener(Ha.POINTERDOWN,this.handleDraggerStart_.bind(this),!1),r.addEventListener(Ha.POINTERMOVE,this.handleDraggerDrag_.bind(this),!1),r.addEventListener(Ha.POINTERUP,this.handleDraggerEnd_.bind(this),!1),r.addEventListener(Re.CLICK,this.handleContainerClick_.bind(this),!1),i.addEventListener(Re.CLICK,nK,!1)}setMap(e){super.setMap(e),e&&e.render()}initSlider_(){const e=this.element;let t=e.offsetWidth,i=e.offsetHeight;if(t===0&&i===0)return this.sliderInitialized_=!1;const r=getComputedStyle(e);t-=parseFloat(r.paddingRight)+parseFloat(r.paddingLeft),i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom);const s=e.firstElementChild,o=getComputedStyle(s),a=s.offsetWidth+parseFloat(o.marginRight)+parseFloat(o.marginLeft),l=s.offsetHeight+parseFloat(o.marginTop)+parseFloat(o.marginBottom);return this.thumbSize_=[a,l],t>i?(this.direction_=Vm.HORIZONTAL,this.widthLimit_=t-a):(this.direction_=Vm.VERTICAL,this.heightLimit_=i-l),this.sliderInitialized_=!0}handleContainerClick_(e){const t=this.getMap().getView(),i=this.getRelativePosition_(e.offsetX-this.thumbSize_[0]/2,e.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(i),s=t.getConstrainedZoom(t.getZoomForResolution(r));t.animateInternal({zoom:s,duration:this.duration_,easing:Lf})}handleDraggerStart_(e){if(!this.dragging_&&e.target===this.element.firstElementChild){const t=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=e.clientX-parseFloat(t.style.left),this.startY_=e.clientY-parseFloat(t.style.top),this.dragging_=!0,this.dragListenerKeys_.length===0){const i=this.handleDraggerDrag_,r=this.handleDraggerEnd_,s=this.getMap().getOwnerDocument();this.dragListenerKeys_.push(Ve(s,Ha.POINTERMOVE,i,this),Ve(s,Ha.POINTERUP,r,this))}}}handleDraggerDrag_(e){if(this.dragging_){const t=e.clientX-this.startX_,i=e.clientY-this.startY_,r=this.getRelativePosition_(t,i);this.currentResolution_=this.getResolutionForPosition_(r),this.getMap().getView().setResolution(this.currentResolution_)}}handleDraggerEnd_(e){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(zt),this.dragListenerKeys_.length=0)}setThumbPosition_(e){const t=this.getPositionForResolution_(e),i=this.element.firstElementChild;this.direction_==Vm.HORIZONTAL?i.style.left=this.widthLimit_*t+"px":i.style.top=this.heightLimit_*t+"px"}getRelativePosition_(e,t){let i;return this.direction_===Vm.HORIZONTAL?i=e/this.widthLimit_:i=t/this.heightLimit_,ot(i,0,1)}getResolutionForPosition_(e){return this.getMap().getView().getResolutionForValueFunction()(1-e)}getPositionForResolution_(e){const t=this.getMap().getView().getValueForResolutionFunction();return ot(1-t(e),0,1)}render(e){if(!e.frameState||!this.sliderInitialized_&&!this.initSlider_())return;const t=e.frameState.viewState.resolution;this.currentResolution_=t,this.setThumbPosition_(t)}}const pne=gne;class mne extends hl{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target}),this.extent=e.extent?e.extent:null;const t=e.className!==void 0?e.className:"ol-zoom-extent",i=e.label!==void 0?e.label:"E",r=e.tipLabel!==void 0?e.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=r,s.appendChild(typeof i=="string"?document.createTextNode(i):i),s.addEventListener(Re.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+rl+" "+kf,a=this.element;a.className=o,a.appendChild(s)}handleClick_(e){e.preventDefault(),this.handleZoomToExtent()}handleZoomToExtent(){const t=this.getMap().getView(),i=this.extent?this.extent:t.getProjection().getExtent();t.fitInternal($g(i))}}const yne=mne,_ne=Object.freeze(Object.defineProperty({__proto__:null,Attribution:cU,Control:hl,FullScreen:one,MousePosition:lne,OverviewMap:cne,Rotate:hU,ScaleLine:dne,Zoom:fU,ZoomSlider:pne,ZoomToExtent:yne,defaults:dU},Symbol.toStringTag,{value:"Module"})),vne={ADD_FEATURES:"addfeatures"};class xne extends Vi{constructor(e,t,i,r){super(e),this.features=i,this.file=t,this.projection=r}}class wne extends hu{constructor(e){e=e||{},super({handleEvent:Fo}),this.on,this.once,this.un,this.readAsBuffer_=!1,this.formats_=[];const t=e.formatConstructors?e.formatConstructors:[];for(let i=0,r=t.length;i<r;++i){let s=t[i];typeof s=="function"&&(s=new s),this.formats_.push(s),this.readAsBuffer_=this.readAsBuffer_||s.getType()==="arraybuffer"}this.projection_=e.projection?_t(e.projection):null,this.dropListenKeys_=null,this.source_=e.source||null,this.target=e.target?e.target:null}handleResult_(e,t){const i=t.target.result,r=this.getMap();let s=this.projection_;s||(s=QK(),s||(s=r.getView().getProjection()));let o;const a=this.formats_;for(let l=0,u=a.length;l<u;++l){const h=a[l];let p=i;this.readAsBuffer_&&h.getType()!=="arraybuffer"&&(o===void 0&&(o=new TextDecoder().decode(i)),p=o);const m=this.tryReadFeatures_(h,p,{featureProjection:s});if(m&&m.length>0){this.source_&&(this.source_.clear(),this.source_.addFeatures(m)),this.dispatchEvent(new xne(vne.ADD_FEATURES,e,m,s));break}}}registerListeners_(){const e=this.getMap();if(e){const t=this.target?this.target:e.getViewport();this.dropListenKeys_=[Ve(t,Re.DROP,this.handleDrop,this),Ve(t,Re.DRAGENTER,this.handleStop,this),Ve(t,Re.DRAGOVER,this.handleStop,this),Ve(t,Re.DROP,this.handleStop,this)]}}setActive(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),super.setActive(e)}setMap(e){this.unregisterListeners_(),super.setMap(e),this.getActive()&&this.registerListeners_()}tryReadFeatures_(e,t,i){try{return e.readFeatures(t,i)}catch{return null}}unregisterListeners_(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(zt),this.dropListenKeys_=null)}handleDrop(e){const t=e.dataTransfer.files;for(let i=0,r=t.length;i<r;++i){const s=t.item(i),o=new FileReader;o.addEventListener(Re.LOAD,this.handleResult_.bind(this,s)),this.readAsBuffer_?o.readAsArrayBuffer(s):o.readAsText(s)}}handleStop(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}}const Ene=wne;class Tne extends No{constructor(e){e=e||{},super(e),this.condition_=e.condition?e.condition:SE,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=e.duration!==void 0?e.duration:400}handleDragEvent(e){if(!wg(e))return;const t=e.map,i=t.getSize(),r=e.pixel,s=r[0]-i[0]/2,o=i[1]/2-r[1],a=Math.atan2(o,s),l=Math.sqrt(s*s+o*o),u=t.getView();if(this.lastAngle_!==void 0){const h=this.lastAngle_-a;u.adjustRotationInternal(h)}this.lastAngle_=a,this.lastMagnitude_!==void 0&&u.adjustResolutionInternal(this.lastMagnitude_/l),this.lastMagnitude_!==void 0&&(this.lastScaleDelta_=this.lastMagnitude_/l),this.lastMagnitude_=l}handleUpEvent(e){if(!wg(e))return!0;const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),this.lastScaleDelta_=0,!1}handleDownEvent(e){return wg(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0):!1}}const Sne=Tne,A1={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class k1 extends Vi{constructor(e,t){super(e),this.feature=t}}function Cne(n,e){const t=[];for(let i=0;i<e.length;++i){const s=e[i].getGeometry();sj(n,s,t)}return t}function P1(n,e){return Wl(n[0],n[1],e[0],e[1])}function sg(n,e){const t=n.length;return e<0?n[e+t]:e>=t?n[e-t]:n[e]}function L1(n,e,t){let i,r;e<t?(i=e,r=t):(i=t,r=e);const s=Math.ceil(i),o=Math.floor(r);if(s>o){const l=og(n,i),u=og(n,r);return P1(l,u)}let a=0;if(i<s){const l=og(n,i),u=sg(n,s);a+=P1(l,u)}if(o<r){const l=sg(n,o),u=og(n,r);a+=P1(l,u)}for(let l=s;l<o-1;++l){const u=sg(n,l),h=sg(n,l+1);a+=P1(u,h)}return a}function sj(n,e,t){if(e instanceof da){M1(n,e.getCoordinates(),!1,t);return}if(e instanceof n_){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r)M1(n,i[r],!1,t);return}if(e instanceof Pc){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r)M1(n,i[r],!0,t);return}if(e instanceof r_){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length;a<l;++a)M1(n,o[a],!0,t)}return}if(e instanceof vk){const i=e.getGeometries();for(let r=0;r<i.length;++r)sj(n,i[r],t);return}}const wC={index:-1,endIndex:NaN};function Ine(n,e,t,i){const r=n[0],s=n[1];let o=1/0,a=-1,l=NaN;for(let p=0;p<e.targets.length;++p){const m=e.targets[p],y=m.coordinates;let x=1/0,w;for(let R=0;R<y.length-1;++R){const E=y[R],T=y[R+1],I=oj(r,s,E,T);I.squaredDistance<x&&(x=I.squaredDistance,w=R+I.along)}x<o&&(o=x,m.ring&&e.targetIndex===p&&(m.endIndex>m.startIndex?w<m.startIndex&&(w+=y.length):m.endIndex<m.startIndex&&w>m.startIndex&&(w-=y.length)),l=w,a=p)}const u=e.targets[a];let h=u.ring;if(e.targetIndex===a&&h){const p=og(u.coordinates,l),m=t.getPixelFromCoordinate(p);Yy(m,e.startPx)>i&&(h=!1)}if(h){const p=u.coordinates,m=p.length,y=u.startIndex,x=l;if(y<x){const w=L1(p,y,x);L1(p,y,x-m)<w&&(l-=m)}else{const w=L1(p,y,x);L1(p,y,x+m)<w&&(l+=m)}}return wC.index=a,wC.endIndex=l,wC}function M1(n,e,t,i){const r=n[0],s=n[1];for(let o=0,a=e.length-1;o<a;++o){const l=e[o],u=e[o+1],h=oj(r,s,l,u);if(h.squaredDistance===0){const p=o+h.along;i.push({coordinates:e,ring:t,startIndex:p,endIndex:p});return}}}const EC={along:0,squaredDistance:0};function oj(n,e,t,i){const r=t[0],s=t[1],o=i[0],a=i[1],l=o-r,u=a-s;let h=0,p=r,m=s;return(l!==0||u!==0)&&(h=ot(((n-r)*l+(e-s)*u)/(l*l+u*u),0,1),p+=l*h,m+=u*h),EC.along=h,EC.squaredDistance=Af(Wl(n,e,p,m),10),EC}function og(n,e){const t=n.length;let i=Math.floor(e);const r=e-i;i>=t?i-=t:i<0&&(i+=t);let s=i+1;s>=t&&(s-=t);const o=n[i],a=o[0],l=o[1],u=n[s],h=u[0]-a,p=u[1]-l;return[a+h*r,l+p*r]}class Rne extends No{constructor(e){const t=e;t.stopDown||(t.stopDown=Cf),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=Ane(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Fo,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let i=e.geometryFunction;if(!i){const r=this.mode_;if(r==="Circle")i=function(s,o,a){const l=o||new ZU([NaN,NaN]),u=Sn(s[0]),h=fa(u,Sn(s[s.length-1]));return l.setCenterAndRadius(u,Math.sqrt(h),this.geometryLayout_),l};else{let s;r==="Point"?s=bs:r==="LineString"?s=da:r==="Polygon"&&(s=Pc),i=function(o,a,l){return a?r==="Polygon"?o[0].length?a.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(o,this.geometryLayout_):a=new s(o,this.geometryLayout_),a}}}this.geometryFunction_=i,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Lc({source:new Ja({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:bne(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:ck,this.freehandCondition_,e.freehand?this.freehandCondition_=Kg:this.freehandCondition_=e.freehandCondition?e.freehandCondition:SE,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(sw.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=Kg:t=e:t=fR,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===Re.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===Dt.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&e.type===Dt.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===Dt.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),i=!1):this.freehand_&&e.type===Dt.POINTERDOWN?i=!1:t&&this.getPointerCount()<2?(i=e.type===Dt.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===Dt.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===Dt.DBLCLICK&&(i=!1),super.handleEvent(e)&&i}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Va(Dt.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),i=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),r=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),s=_i([i,r]),o=this.traceSource_.getFeaturesInExtent(s);if(o.length===0)return;const a=Cne(e.coordinate,o);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const i=e.startIndex<=e.endIndex,r=e.startIndex<=t;i===r?i&&t>e.endIndex||!i&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(i&&t<e.endIndex||!i&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let i=0;if(e<t){const r=Math.ceil(e);let s=Math.floor(t);s===t&&(s-=1),i=s-r+1}else{const r=Math.floor(e);let s=Math.ceil(t);s===t&&(s+=1),i=r-s+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(e,t,i){if(t===i)return;const r=[];if(t<i){const s=Math.ceil(t);let o=Math.floor(i);o===i&&(o-=1);for(let a=s;a<=o;++a)r.push(sg(e.coordinates,a))}else{const s=Math.floor(t);let o=Math.ceil(i);o===i&&(o+=1);for(let a=s;a>=o;--a)r.push(sg(e.coordinates,a))}r.length&&this.appendCoordinates(r)}updateTrace_(e){const t=this.traceState_;if(!t.active||t.targetIndex===-1&&Yy(t.startPx,e.pixel)<this.snapTolerance_)return;const i=Ine(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==i.index){if(t.targetIndex!==-1){const l=t.targets[t.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=t.targets[i.index];this.addTracedCoordinates_(a,a.startIndex,i.endIndex)}else{const a=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(a,i.endIndex)}t.targetIndex=i.index;const r=t.targets[t.targetIndex];r.endIndex=i.endIndex;const s=og(r.coordinates,r.endIndex),o=this.getMap().getPixelFromCoordinate(s);e.coordinate=s,e.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const i=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const r=!this.finishCoordinate_;r&&this.startDrawing_(e.coordinate),!r&&this.freehand_?this.finishDrawing():!this.freehand_&&(!r||this.mode_==="Point")&&(this.atFinish_(e.pixel,i)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,i=e.pixel,r=t[0]-i[0],s=t[1]-i[1],o=r*r+s*s;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let i=!1;if(this.sketchFeature_){let r=!1,s=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")i=!0;else if(o==="Circle")i=this.sketchCoords_.length===2;else if(o==="LineString")r=!t&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;r=a[0].length>this.minPoints_,s=[a[0][0],a[0][a[0].length-2]],t?s=[a[0][0]]:s=[a[0][0],a[0][a[0].length-2]]}if(r){const a=this.getMap();for(let l=0,u=s.length;l<u;l++){const h=s[l],p=a.getPixelFromCoordinate(h),m=e[0]-p[0],y=e[1]-p[1],x=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(m*m+y*y)<=x,i){this.finishCoordinate_=h;break}}}}return i}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new pr(new bs(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new pr);const t=e.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),i.changed()):(i=new da(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(e){const t=this.getMap().getView().getProjection(),i=$x(this.geometryLayout_);for(;e.length<i;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new pr(new da(this.sketchLineCoords_)));const r=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new pr,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new k1(A1.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),i=this.sketchFeature_.getGeometry(),r=t.getView().getProjection(),s=$x(this.geometryLayout_);let o,a;for(;e.length<s;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,i,r),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),i.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let r,s;const o=this.mode_;o==="LineString"||o==="Circle"?(this.finishCoordinate_=e.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(e.slice()),this.geometryFunction_(s,t,i)):o==="Polygon"&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(e.slice()),r&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,t,i)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),r&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),r=this.mode_;for(let s=0;s<e;++s){let o;if(r==="LineString"||r==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,t,i),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(r==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,t,i)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const i=e.getGeometry(),r=this.getMap().getView().getProjection();this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,i,r)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,i,r),t=i.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new i_([t])):this.type_==="MultiLineString"?e.setGeometry(new n_([t])):this.type_==="MultiPolygon"&&e.setGeometry(new r_([t])),this.dispatchEvent(new k1(A1.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new k1(A1.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,i=!this.sketchFeature_;i&&this.startDrawing_(e[0]);let r;if(t==="LineString"||t==="Circle")r=this.sketchCoords_;else if(t==="Polygon")r=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;i&&r.shift(),r.pop();for(let o=0;o<e.length;o++)this.addToDrawing_(e[o]);const s=e[e.length-1];this.addToDrawing_(s),this.modifyDrawing_(s)}extend(e){const i=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=i.getCoordinates();const r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new pr(new bs(r)),this.updateSketchFeatures_(),this.dispatchEvent(new k1(A1.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function bne(){const n=Y0();return function(e,t){return n[e.getGeometry().getType()]}}function Ane(n){switch(n){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+n)}}const kne=Rne,Pne={EXTENTCHANGED:"extentchanged"};class Lne extends Vi{constructor(e){super(Pne.EXTENTCHANGED),this.extent=e}}class Mne extends No{constructor(e){e=e||{},super(e),this.on,this.once,this.un,this.condition_=e.condition?e.condition:Kg,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new Lc({source:new Ja({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:Dne(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new Lc({source:new Ja({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:Fne(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}snapToVertex_(e,t){const i=t.getCoordinateFromPixelInternal(e),r=function(o,a){return nR(i,o)-nR(i,a)},s=this.getExtentInternal();if(s){const o=One(s);o.sort(r);const a=o[0];let l=mE(i,a);const u=t.getPixelFromCoordinateInternal(l);if(Yy(e,u)<=this.pixelTolerance_){const h=t.getPixelFromCoordinateInternal(a[0]),p=t.getPixelFromCoordinateInternal(a[1]),m=fa(u,h),y=fa(u,p),x=Math.sqrt(Math.min(m,y));return this.snappedToVertex_=x<=this.pixelTolerance_,this.snappedToVertex_&&(l=m>y?a[1]:a[0]),l}}return null}handlePointerMove_(e){const t=e.pixel,i=e.map;let r=this.snapToVertex_(t,i);r||(r=i.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(r)}createOrUpdateExtentFeature_(e){let t=this.extentFeature_;return t?e?t.setGeometry($g(e)):t.setGeometry(void 0):(e?t=new pr($g(e)):t=new pr({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}createOrUpdatePointerFeature_(e){let t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(e):(t=new pr(new bs(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t)),t}handleEvent(e){return!e.originalEvent||!this.condition_(e)?!0:(e.type==Dt.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),super.handleEvent(e),!1)}handleDownEvent(e){const t=e.pixel,i=e.map,r=this.getExtentInternal();let s=this.snapToVertex_(t,i);const o=function(a){let l=null,u=null;return a[0]==r[0]?l=r[2]:a[0]==r[2]&&(l=r[0]),a[1]==r[1]?u=r[3]:a[1]==r[3]&&(u=r[1]),l!==null&&u!==null?[l,u]:null};if(s&&r){const a=s[0]==r[0]||s[0]==r[2]?s[0]:null,l=s[1]==r[1]||s[1]==r[3]?s[1]:null;a!==null&&l!==null?this.pointerHandler_=iF(o(s)):a!==null?this.pointerHandler_=rF(o([a,r[1]]),o([a,r[3]])):l!==null&&(this.pointerHandler_=rF(o([r[0],l]),o([r[2],l])))}else s=i.getCoordinateFromPixelInternal(t),this.setExtent([s[0],s[1],s[0],s[1]]),this.pointerHandler_=iF(s);return!0}handleDragEvent(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}}handleUpEvent(e){this.pointerHandler_=null;const t=this.getExtentInternal();return(!t||Bg(t)===0)&&this.setExtent(null),!1}setMap(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),super.setMap(e)}getExtent(){return dp(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new Lne(this.extent_))}}function Dne(){const n=Y0();return function(e,t){return n.Polygon}}function Fne(){const n=Y0();return function(e,t){return n.Point}}function iF(n){return function(e){return _i([n,e])}}function rF(n,e){return n[0]==e[0]?function(t){return _i([n,[t[0],e[1]]])}:n[1]==e[1]?function(t){return _i([n,[e[0],t[1]]])}:null}function One(n){return[[[n[0],n[1]],[n[0],n[3]]],[[n[0],n[3]],[n[2],n[3]]],[[n[2],n[3]],[n[2],n[1]]],[[n[2],n[1]],[n[0],n[1]]]]}const Nne=Mne;function zne(n){return Af(n,5)}function ey(n){return parseFloat(n)}function ty(n){return zne(n).toString()}function vw(n,e){return isNaN(n)?!1:n!==ey(ty(e))}function Une(n,e){return vw(n[0],e[0])||vw(n[1],e[1])}class Gne extends hu{constructor(e){super(),e=Object.assign({animate:!0,params:["x","y","z","r","l"],replace:!1,prefix:""},e||{});let t;e.animate===!0?t={duration:250}:e.animate?t=e.animate:t=null,this.animationOptions_=t,this.params_=e.params.reduce((i,r)=>(i[r]=!0,i),{}),this.replace_=e.replace,this.prefix_=e.prefix,this.listenerKeys_=[],this.initial_=!0,this.updateState_=this.updateState_.bind(this)}getParamName_(e){return this.prefix_?this.prefix_+e:e}get_(e,t){return e.get(this.getParamName_(t))}set_(e,t,i){t in this.params_&&e.set(this.getParamName_(t),i)}delete_(e,t){t in this.params_&&e.delete(this.getParamName_(t))}setMap(e){const t=this.getMap();super.setMap(e),e!==t&&(t&&this.unregisterListeners_(t),e&&(this.initial_=!0,this.updateState_(),this.registerListeners_(e)))}registerListeners_(e){this.listenerKeys_.push(Ve(e,oa.MOVEEND,this.updateUrl_,this),Ve(e.getLayerGroup(),Re.CHANGE,this.updateUrl_,this),Ve(e,"change:layergroup",this.handleChangeLayerGroup_,this)),this.replace_||addEventListener("popstate",this.updateState_)}unregisterListeners_(e){for(let r=0,s=this.listenerKeys_.length;r<s;++r)zt(this.listenerKeys_[r]);this.listenerKeys_.length=0,this.replace_||removeEventListener("popstate",this.updateState_);const t=new URL(window.location.href),i=t.searchParams;this.delete_(i,"x"),this.delete_(i,"y"),this.delete_(i,"z"),this.delete_(i,"r"),this.delete_(i,"l"),window.history.replaceState(null,"",t)}handleChangeLayerGroup_(){const e=this.getMap();e&&(this.unregisterListeners_(e),this.registerListeners_(e),this.initial_=!0,this.updateUrl_())}updateState_(){const e=this.getMap();if(!e)return;const t=e.getView();if(!t)return;const r=new URL(window.location.href).searchParams;let s=!1;const o={},a=ey(this.get_(r,"z"));"z"in this.params_&&vw(a,t.getZoom())&&(s=!0,o.zoom=a);const l=ey(this.get_(r,"r"));"r"in this.params_&&vw(l,t.getRotation())&&(s=!0,o.rotation=l);const u=[ey(this.get_(r,"x")),ey(this.get_(r,"y"))];("x"in this.params_||"y"in this.params_)&&Une(u,t.getCenter())&&(s=!0,o.center=u),s&&(!this.initial_&&this.animationOptions_?t.animate(Object.assign(o,this.animationOptions_)):(o.center&&t.setCenter(o.center),"zoom"in o&&t.setZoom(o.zoom),"rotation"in o&&t.setRotation(o.rotation)));const h=e.getAllLayers(),p=this.get_(r,"l");if("l"in this.params_&&p&&p.length===h.length)for(let m=0,y=h.length;m<y;++m){const x=parseInt(p[m]);if(!isNaN(x)){const w=Boolean(x),R=h[m];R.getVisible()!==w&&R.setVisible(w)}}}updateUrl_(){const e=this.getMap();if(!e)return;const t=e.getView();if(!t)return;const i=this.initial_;this.initial_=!1;const r=t.getCenter(),s=t.getZoom(),o=t.getRotation(),a=e.getAllLayers(),l=new Array(a.length);for(let p=0,m=a.length;p<m;++p)l[p]=a[p].getVisible()?"1":"0";const u=new URL(window.location.href),h=u.searchParams;this.set_(h,"x",ty(r[0])),this.set_(h,"y",ty(r[1])),this.set_(h,"z",ty(s)),this.set_(h,"r",ty(o)),this.set_(h,"l",l.join("")),u.href!==window.location.href&&(i||this.replace_?window.history.replaceState(history.state,"",u):window.history.pushState(null,"",u))}}const jne=Gne,sF=0,Ey=1,oF=[0,0,0,0],Rg=[],TC={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class SC extends Vi{constructor(e,t,i){super(e),this.features=t,this.mapBrowserEvent=i}}class Bne extends No{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:vU,this.defaultDeleteCondition_=function(i){return O9(i)&&yU(i)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:Kg,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new iw,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Lc({source:new Ja({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:$ne(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new Ei(this.source_.getFeatures()),this.source_.addEventListener(Fi.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(Fi.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(Qn.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(Qn.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const t=e.getGeometry();if(t){const r=this.SEGMENT_WRITERS_[t.getType()];r&&r(e,t)}const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),e.addEventListener(Re.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Ei;const i=this.featuresBeingModified_.getArray();for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0,l=o.length;a<l;++a){const u=o[a].feature;u&&!i.includes(u)&&this.featuresBeingModified_.push(u)}}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new SC(TC.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(Re.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,i=[];t.forEach(function(r){e===r.feature&&i.push(r)});for(let r=i.length-1;r>=0;--r){const s=i[r];for(let o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===s&&this.dragSegments_.splice(o,1);t.remove(s)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const i=t.getCoordinates(),r={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),r)}writeMultiPointGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r],a={feature:e,geometry:t,depth:[r],index:r,segment:[o,o]};this.rBush_.insert(t.getExtent(),a)}}writeLineStringGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length-1;r<s;++r){const o=i.slice(r,r+2),a={feature:e,geometry:t,index:r,segment:o};this.rBush_.insert(_i(o),a)}}writeMultiLineStringGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length-1;a<l;++a){const u=o.slice(a,a+2),h={feature:e,geometry:t,depth:[r],index:a,segment:u};this.rBush_.insert(_i(u),h)}}}writePolygonGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length-1;a<l;++a){const u=o.slice(a,a+2),h={feature:e,geometry:t,depth:[r],index:a,segment:u};this.rBush_.insert(_i(u),h)}}}writeMultiPolygonGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length;a<l;++a){const u=o[a];for(let h=0,p=u.length-1;h<p;++h){const m=u.slice(h,h+2),y={feature:e,geometry:t,depth:[a,r],index:h,segment:m};this.rBush_.insert(_i(m),y)}}}}writeCircleGeometry_(e,t){const i=t.getCenter(),r={feature:e,geometry:t,index:sF,segment:[i,i]},s={feature:e,geometry:t,index:Ey,segment:[i,i]},o=[r,s];r.featureSegments=o,s.featureSegments=o,this.rBush_.insert(yg(i),r);let a=t;this.rBush_.insert(a.getExtent(),s)}writeGeometryCollectionGeometry_(e,t){const i=t.getGeometriesArray();for(let r=0;r<i.length;++r){const s=i[r],o=this.SEGMENT_WRITERS_[s.getType()];o(e,s)}}createOrUpdateVertexFeature_(e,t,i){let r=this.vertexFeature_;return r?r.getGeometry().setCoordinates(e):(r=new pr(new bs(e)),this.vertexFeature_=r,this.overlay_.getSource().addFeature(r)),r.set("features",t),r.set("geometries",i),r}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==Dt.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=Dt.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==Dt.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],i=[],r=[];for(let s=0,o=this.dragSegments_.length;s<o;++s){const a=this.dragSegments_[s],l=a[0],u=l.feature;i.includes(u)||i.push(u);const h=l.geometry;r.includes(h)||r.push(h);const p=l.depth;let m;const y=l.segment,x=a[1];for(;t.length<h.getStride();)t.push(y[x][t.length]);switch(h.getType()){case"Point":m=t,y[0]=t,y[1]=t;break;case"MultiPoint":m=h.getCoordinates(),m[l.index]=t,y[0]=t,y[1]=t;break;case"LineString":m=h.getCoordinates(),m[l.index+x]=t,y[x]=t;break;case"MultiLineString":m=h.getCoordinates(),m[p[0]][l.index+x]=t,y[x]=t;break;case"Polygon":m=h.getCoordinates(),m[p[0]][l.index+x]=t,y[x]=t;break;case"MultiPolygon":m=h.getCoordinates(),m[p[1]][p[0]][l.index+x]=t,y[x]=t;break;case"Circle":if(y[0]=t,y[1]=t,l.index===sF)this.changingFeature_=!0,h.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let w=Yy(Sn(h.getCenter()),Sn(t));h.setRadius(w),this.changingFeature_=!1}break}m&&this.setGeometryCoordinates_(h,m)}this.createOrUpdateVertexFeature_(t,i,r)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;const i=this.vertexFeature_;if(i){e.map.getView().getProjection();const r=[],s=i.getGeometry().getCoordinates(),o=_i([s]),a=this.rBush_.getInExtent(o),l={};a.sort(Vne);for(let u=0,h=a.length;u<h;++u){const p=a[u],m=p.segment;let y=be(p.geometry);const x=p.depth;if(x&&(y+="-"+x.join("-")),l[y]||(l[y]=new Array(2)),p.geometry.getType()==="Circle"&&p.index===Ey){const w=lF(t,p);sa(w,s)&&!l[y][0]&&(this.dragSegments_.push([p,0]),l[y][0]=p);continue}if(sa(m[0],s)&&!l[y][0]){this.dragSegments_.push([p,0]),l[y][0]=p;continue}if(sa(m[1],s)&&!l[y][1]){if(l[y][0]&&l[y][0].index===0){let w=p.geometry.getCoordinates();switch(p.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":w=w[x[1]];case"Polygon":if(p.index!==w[x[0]].length-2)continue;break}}this.dragSegments_.push([p,1]),l[y][1]=p;continue}be(m)in this.vertexSegments_&&!l[y][0]&&!l[y][1]&&this.insertVertexCondition_(e)&&r.push(p)}r.length&&this.willModifyFeatures_(e,[r]);for(let u=r.length-1;u>=0;--u)this.insertVertex_(r[u],s)}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const i=this.dragSegments_[t][0],r=i.geometry;if(r.getType()==="Circle"){const s=r.getCenter(),o=i.featureSegments[0],a=i.featureSegments[1];o.segment[0]=s,o.segment[1]=s,a.segment[0]=s,a.segment[1]=s,this.rBush_.update(yg(s),o);let l=r;this.rBush_.update(l.getExtent(),a)}else this.rBush_.update(_i(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new SC(TC.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}handlePointerAtPixel_(e,t,i){const r=i||t.getCoordinateFromPixel(e);t.getView().getProjection();const s=function(l,u){return aF(r,l)-aF(r,u)};let o,a;if(this.hitDetection_){const l=typeof this.hitDetection_=="object"?u=>u===this.hitDetection_:void 0;t.forEachFeatureAtPixel(e,(u,h,p)=>{const m=p||u.getGeometry();if(m.getType()==="Point"&&u instanceof pr&&this.features_.getArray().includes(u)){a=m;const y=a.getFlatCoordinates().slice(0,2);o=[{feature:u,geometry:a,segment:[y,y]}]}return!0},{layerFilter:l})}if(!o){const l=bo(yg(r,oF)),u=t.getView().getResolution()*this.pixelTolerance_,h=dp(Rs(l,u,oF));o=this.rBush_.getInExtent(h)}if(o&&o.length>0){const l=o.sort(s)[0],u=l.segment;let h=lF(r,l);const p=t.getPixelFromCoordinate(h);let m=Yy(e,p);if(a||m<=this.pixelTolerance_){const y={};if(y[be(u)]=!0,this.snapToPointer_||(this.delta_[0]=h[0]-r[0],this.delta_[1]=h[1]-r[1]),l.geometry.getType()==="Circle"&&l.index===Ey)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(h,[l.feature],[l.geometry]);else{const x=t.getPixelFromCoordinate(u[0]),w=t.getPixelFromCoordinate(u[1]),R=fa(p,x),E=fa(p,w);m=Math.sqrt(Math.min(R,E)),this.snappedToVertex_=m<=this.pixelTolerance_,this.snappedToVertex_&&(h=R>E?u[1]:u[0]),this.createOrUpdateVertexFeature_(h,[l.feature],[l.geometry]);const T={};T[be(l.geometry)]=!0;for(let I=1,A=o.length;I<A;++I){const L=o[I].segment;if(sa(u[0],L[0])&&sa(u[1],L[1])||sa(u[0],L[1])&&sa(u[1],L[0])){const F=be(o[I].geometry);F in T||(T[F]=!0,y[be(L)]=!0)}else break}}this.vertexSegments_=y;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const i=e.segment,r=e.feature,s=e.geometry,o=e.depth,a=e.index;let l;for(;t.length<s.getStride();)t.push(0);switch(s.getType()){case"MultiLineString":l=s.getCoordinates(),l[o[0]].splice(a+1,0,t);break;case"Polygon":l=s.getCoordinates(),l[o[0]].splice(a+1,0,t);break;case"MultiPolygon":l=s.getCoordinates(),l[o[1]][o[0]].splice(a+1,0,t);break;case"LineString":l=s.getCoordinates(),l.splice(a+1,0,t);break;default:return}this.setGeometryCoordinates_(s,l);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(s,a,o,1);const h={segment:[i[0],t],feature:r,geometry:s,depth:o,index:a};u.insert(_i(h.segment),h),this.dragSegments_.push([h,1]);const p={segment:[t,i[1]],feature:r,geometry:s,depth:o,index:a+1};u.insert(_i(p.segment),p),this.dragSegments_.push([p,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Dt.POINTERDRAG){const e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);const t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new SC(TC.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}removeVertex_(){const e=this.dragSegments_,t={};let i=!1,r,s,o,a,l,u,h,p,m,y,x;for(l=e.length-1;l>=0;--l)o=e[l],y=o[0],x=be(y.feature),y.depth&&(x+="-"+y.depth.join("-")),x in t||(t[x]={}),o[1]===0?(t[x].right=y,t[x].index=y.index):o[1]==1&&(t[x].left=y,t[x].index=y.index+1);for(x in t){switch(m=t[x].right,h=t[x].left,u=t[x].index,p=u-1,h!==void 0?y=h:y=m,p<0&&(p=0),a=y.geometry,s=a.getCoordinates(),r=s,i=!1,a.getType()){case"MultiLineString":s[y.depth[0]].length>2&&(s[y.depth[0]].splice(u,1),i=!0);break;case"LineString":s.length>2&&(s.splice(u,1),i=!0);break;case"MultiPolygon":r=r[y.depth[1]];case"Polygon":r=r[y.depth[0]],r.length>4&&(u==r.length-1&&(u=0),r.splice(u,1),i=!0,u===0&&(r.pop(),r.push(r[0]),p=r.length-1));break}if(i){this.setGeometryCoordinates_(a,s);const w=[];if(h!==void 0&&(this.rBush_.remove(h),w.push(h.segment[0])),m!==void 0&&(this.rBush_.remove(m),w.push(m.segment[1])),h!==void 0&&m!==void 0){const R={depth:y.depth,feature:y.feature,geometry:y.geometry,index:p,segment:w};this.rBush_.insert(_i(R.segment),R)}this.updateSegmentIndices_(a,u,y.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return i}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,i,r){this.rBush_.forEachInExtent(e.getExtent(),function(s){s.geometry===e&&(i===void 0||s.depth===void 0||cl(s.depth,i))&&s.index>t&&(s.index+=r)})}}function Vne(n,e){return n.index-e.index}function aF(n,e,t){const i=e.geometry;if(i.getType()==="Circle"){let s=i;if(e.index===Ey){const o=fa(s.getCenter(),Sn(n)),a=Math.sqrt(o)-s.getRadius();return a*a}}const r=Sn(n);return Rg[0]=Sn(e.segment[0]),Rg[1]=Sn(e.segment[1]),nR(r,Rg)}function lF(n,e,t){const i=e.geometry;if(i.getType()==="Circle"&&e.index===Ey)return Yh(i.getClosestPoint(Sn(n)));const r=Sn(n);return Rg[0]=Sn(e.segment[0]),Rg[1]=Sn(e.segment[1]),Yh(mE(r,Rg))}function $ne(){const n=Y0();return function(e,t){return n.Point}}const Wne=Bne,Hne={SELECT:"select"};class Xne extends Vi{constructor(e,t,i,r){super(e),this.selected=t,this.deselected=i,this.mapBrowserEvent=r}}const D1={};class Hk extends hu{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:yU,this.addCondition_=e.addCondition?e.addCondition:fR,this.removeCondition_=e.removeCondition?e.removeCondition:fR,this.toggleCondition_=e.toggleCondition?e.toggleCondition:SE,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:Fo,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:qne(),this.features_=e.features||new Ei;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const i=e.layers;t=function(r){return i.includes(r)}}else t=Fo;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[be(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[be(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(Qn.ADD,this.boundAddFeature_),this.features_.addEventListener(Qn.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Qn.ADD,this.boundAddFeature_),this.features_.removeEventListener(Qn.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const i=this.getMap().getAllLayers().find(function(r){if(r instanceof Lc&&r.getSource()&&r.getSource().hasFeature(t))return r});i&&this.addFeatureLayerAssociation_(t,i)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=be(e);t in D1||(D1[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let r=t.length-1;r>=0;--r){const s=t[r];if(s!==this&&s instanceof Hk&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(s.getStyle());return}}const i=be(e);e.setStyle(D1[i]),delete D1[i]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[be(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),i=this.removeCondition_(e),r=this.toggleCondition_(e),s=!t&&!i&&!r,o=e.map,a=this.getFeatures(),l=[],u=[];if(s){If(this.featureLayerAssociation_),o.forEachFeatureAtPixel(e.pixel,(h,p)=>{if(!(!(h instanceof pr)||!this.filter_(h,p)))return this.addFeatureLayerAssociation_(h,p),u.push(h),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=a.getLength()-1;h>=0;--h){const p=a.item(h),m=u.indexOf(p);m>-1?u.splice(m,1):(a.remove(p),l.push(p))}u.length!==0&&a.extend(u)}else{o.forEachFeatureAtPixel(e.pixel,(h,p)=>{if(!(!(h instanceof pr)||!this.filter_(h,p)))return(t||r)&&!a.getArray().includes(h)?(this.addFeatureLayerAssociation_(h,p),u.push(h)):(i||r)&&a.getArray().includes(h)&&(l.push(h),this.removeFeatureLayerAssociation_(h)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=l.length-1;h>=0;--h)a.remove(l[h]);a.extend(u)}return(u.length>0||l.length>0)&&this.dispatchEvent(new Xne(Hne.SELECT,u,l,e)),!0}}function qne(){const n=Y0();return qs(n.Polygon,n.LineString),qs(n.GeometryCollection,n.LineString),function(e){return e.getGeometry()?n[e.getGeometry().getType()]:null}}const Kne=Hk;function uF(n){if(n.feature)return n.feature;if(n.element)return n.element}const CC=[];class Yne extends No{constructor(e){e=e||{};const t=e;t.handleDownEvent||(t.handleDownEvent=Fo),t.stopDown||(t.stopDown=Cf),super(t),this.source_=e.source?e.source:null,this.vertex_=e.vertex!==void 0?e.vertex:!0,this.edge_=e.edge!==void 0?e.edge:!0,this.features_=e.features?e.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.rBush_=new iw,this.GEOMETRY_SEGMENTERS_={Point:this.segmentPointGeometry_.bind(this),LineString:this.segmentLineStringGeometry_.bind(this),LinearRing:this.segmentLineStringGeometry_.bind(this),Polygon:this.segmentPolygonGeometry_.bind(this),MultiPoint:this.segmentMultiPointGeometry_.bind(this),MultiLineString:this.segmentMultiLineStringGeometry_.bind(this),MultiPolygon:this.segmentMultiPolygonGeometry_.bind(this),GeometryCollection:this.segmentGeometryCollectionGeometry_.bind(this),Circle:this.segmentCircleGeometry_.bind(this)}}addFeature(e,t){t=t!==void 0?t:!0;const i=be(e),r=e.getGeometry();if(r){const s=this.GEOMETRY_SEGMENTERS_[r.getType()];if(s){this.indexedFeaturesExtents_[i]=r.getExtent(xr());const o=[];if(s(o,r),o.length===1)this.rBush_.insert(_i(o[0]),{feature:e,segment:o[0]});else if(o.length>1){const a=o.map(u=>_i(u)),l=o.map(u=>({feature:e,segment:u}));this.rBush_.load(a,l)}}}t&&(this.featureChangeListenerKeys_[i]=Ve(e,Re.CHANGE,this.handleFeatureChange_,this))}forEachFeatureAdd_(e){this.addFeature(e)}forEachFeatureRemove_(e){this.removeFeature(e)}getFeatures_(){let e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e}handleEvent(e){const t=this.snapTo(e.pixel,e.coordinate,e.map);return t&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),super.handleEvent(e)}handleFeatureAdd_(e){const t=uF(e);this.addFeature(t)}handleFeatureRemove_(e){const t=uF(e);this.removeFeature(t)}handleFeatureChange_(e){const t=e.target;if(this.handlingDownUpSequence){const i=be(t);i in this.pendingFeatures_||(this.pendingFeatures_[i]=t)}else this.updateFeature_(t)}handleUpEvent(e){const t=Object.values(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}removeFeature(e,t){const i=t!==void 0?t:!0,r=be(e),s=this.indexedFeaturesExtents_[r];if(s){const o=this.rBush_,a=[];o.forEachInExtent(s,function(l){e===l.feature&&a.push(l)});for(let l=a.length-1;l>=0;--l)o.remove(a[l])}i&&(zt(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])}setMap(e){const t=this.getMap(),i=this.featuresListenerKeys_,r=this.getFeatures_();t&&(i.forEach(zt),i.length=0,r.forEach(this.forEachFeatureRemove_.bind(this))),super.setMap(e),e&&(this.features_?i.push(Ve(this.features_,Qn.ADD,this.handleFeatureAdd_,this),Ve(this.features_,Qn.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push(Ve(this.source_,Fi.ADDFEATURE,this.handleFeatureAdd_,this),Ve(this.source_,Fi.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach(this.forEachFeatureAdd_.bind(this)))}snapTo(e,t,i){i.getView().getProjection();const r=Sn(t),s=dp(Rs(_i([r]),i.getView().getResolution()*this.pixelTolerance_)),o=this.rBush_.getInExtent(s),a=o.length;if(a===0)return null;let l,u=1/0;const h=this.pixelTolerance_*this.pixelTolerance_,p=()=>{if(l){const m=i.getPixelFromCoordinate(l);if(fa(e,m)<=h)return{vertex:l,vertexPixel:[Math.round(m[0]),Math.round(m[1])]}}return null};if(this.vertex_){for(let y=0;y<a;++y){const x=o[y];x.feature.getGeometry().getType()!=="Circle"&&x.segment.forEach(w=>{const R=Sn(w),E=fa(r,R);E<u&&(l=w,u=E)})}const m=p();if(m)return m}if(this.edge_){for(let y=0;y<a;++y){let x=null;const w=o[y];if(w.feature.getGeometry().getType()==="Circle"){let R=w.feature.getGeometry();x=$K(r,R)}else{const[R,E]=w.segment;E&&(CC[0]=Sn(R),CC[1]=Sn(E),x=mE(r,CC))}if(x){const R=fa(r,x);R<u&&(l=Yh(x),u=R)}}const m=p();if(m)return m}return null}updateFeature_(e){this.removeFeature(e,!1),this.addFeature(e,!1)}segmentCircleGeometry_(e,t){this.getMap().getView().getProjection();const s=xY(t).getCoordinates()[0];for(let o=0,a=s.length-1;o<a;++o)e.push(s.slice(o,o+2))}segmentGeometryCollectionGeometry_(e,t){const i=t.getGeometriesArray();for(let r=0;r<i.length;++r){const s=this.GEOMETRY_SEGMENTERS_[i[r].getType()];s&&s(e,i[r])}}segmentLineStringGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length-1;r<s;++r)e.push(i.slice(r,r+2))}segmentMultiLineStringGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length-1;a<l;++a)e.push(o.slice(a,a+2))}}segmentMultiPointGeometry_(e,t){t.getCoordinates().forEach(i=>{e.push([i])})}segmentMultiPolygonGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length;a<l;++a){const u=o[a];for(let h=0,p=u.length-1;h<p;++h)e.push(u.slice(h,h+2))}}}segmentPointGeometry_(e,t){e.push([t.getCoordinates()])}segmentPolygonGeometry_(e,t){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length-1;a<l;++a)e.push(o.slice(a,a+2))}}}const Zne=Yne,IC={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};class RC extends Vi{constructor(e,t,i,r,s){super(e),this.features=t,this.coordinate=i,this.startCoordinate=r,this.mapBrowserEvent=s}}class Qne extends No{constructor(e){e=e||{},super(e),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=e.features!==void 0?e.features:null;let t;if(e.layers&&!this.features_)if(typeof e.layers=="function")t=e.layers;else{const i=e.layers;t=function(r){return i.includes(r)}}else t=Fo;this.layerFilter_=t,this.filter_=e.filter&&!this.features_?e.filter:Fo,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.condition_=e.condition?e.condition:Kg,this.lastFeature_=null,this.addChangeListener(sw.ACTIVE,this.handleActiveChanged_)}handleDownEvent(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);const t=this.features_||new Ei([this.lastFeature_]);return this.dispatchEvent(new RC(IC.TRANSLATESTART,t,e.coordinate,this.startCoordinate_,e)),!0}return!1}handleUpEvent(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);const t=this.features_||new Ei([this.lastFeature_]);return this.dispatchEvent(new RC(IC.TRANSLATEEND,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1}handleDragEvent(e){if(this.lastCoordinate_){const t=e.coordinate,i=t[0]-this.lastCoordinate_[0],r=t[1]-this.lastCoordinate_[1],s=this.features_||new Ei([this.lastFeature_]);s.forEach(function(o){const a=o.getGeometry();a.translate(i,r),o.setGeometry(a)}),this.lastCoordinate_=t,this.dispatchEvent(new RC(IC.TRANSLATING,s,t,this.startCoordinate_,e))}}handleMoveEvent(e){const t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(e,t){return t.forEachFeatureAtPixel(e,(i,r)=>{if(!(!(i instanceof pr)||!this.filter_(i,r))&&!(this.features_&&!this.features_.getArray().includes(i)))return i},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(e){this.hitTolerance_=e}setMap(e){const t=this.getMap();super.setMap(e),this.updateState_(t)}handleActiveChanged_(){this.updateState_(null)}updateState_(e){let t=this.getMap();const i=this.getActive();(!t||!i)&&(t=t||e,t&&t.getViewport().classList.remove("ol-grab","ol-grabbing"))}}const Jne=Qne,eie=Object.freeze(Object.defineProperty({__proto__:null,DoubleClickZoom:gU,DragAndDrop:Ene,DragBox:EU,DragPan:xU,DragRotate:wU,DragRotateAndZoom:Sne,DragZoom:TU,Draw:kne,Extent:Nne,Interaction:hu,KeyboardPan:SU,KeyboardZoom:CU,Link:jne,Modify:Wne,MouseWheelZoom:IU,PinchRotate:RU,PinchZoom:bU,Pointer:No,Select:Kne,Snap:Zne,Translate:Jne,defaults:AU},Symbol.toStringTag,{value:"Module"}));function tie(n){const e=n[0],t=new Array(e);let i=1<<e-1,r,s;for(r=0;r<e;++r)s=48,n[1]&i&&(s+=1),n[2]&i&&(s+=2),t[r]=String.fromCharCode(s),i>>=1;return t.join("")}const nie='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>';class iie extends du{constructor(e){const t=e.hidpi!==void 0?e.hidpi:!1;super({cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,opaque:!0,projection:_t("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,tilePixelRatio:t?2:1,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.hidpi_=t,this.culture_=e.culture!==void 0?e.culture:"en-us",this.maxZoom_=e.maxZoom!==void 0?e.maxZoom:-1,this.apiKey_=e.key,this.imagerySet_=e.imagerySet;const i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;LE(i,this.handleImageryMetadataResponse.bind(this),void 0,"jsonp")}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(e){if(e.statusCode!=200||e.statusDescription!="OK"||e.authenticationResultCode!="ValidCredentials"||e.resourceSets.length!=1||e.resourceSets[0].resources.length!=1){this.setState("error");return}const t=e.resourceSets[0].resources[0],i=this.maxZoom_==-1?t.zoomMax:this.maxZoom_,r=this.getProjection(),s=Gc(r),o=this.hidpi_?2:1,a=t.imageWidth==t.imageHeight?t.imageWidth/o:[t.imageWidth/o,t.imageHeight/o],l=Df({extent:s,minZoom:t.zoomMin,maxZoom:i,tileSize:a});this.tileGrid=l;const u=this.culture_,h=this.hidpi_;if(this.tileUrlFunction=m0(t.imageUrlSubdomains.map(function(p){const m=[0,0,0],y=t.imageUrl.replace("{subdomain}",p).replace("{culture}",u);return function(x,w,R){if(!x)return;l0(x[0],x[1],x[2],m);let E=y;return h&&(E+="&dpi=d1&device=mobile"),E.replace("{quadkey}",tie(m))}})),t.imageryProviders){const p=Uc(_t("EPSG:4326"),this.getProjection());this.setAttributions(m=>{const y=[],x=m.viewState,w=this.getTileGrid(),R=w.getZForResolution(x.resolution,this.zDirection),T=w.getTileCoordForCoordAndZ(x.center,R)[0];return t.imageryProviders.map(function(I){let A=!1;const L=I.coverageAreas;for(let F=0,O=L.length;F<O;++F){const N=L[F];if(T>=N.zoomMin&&T<=N.zoomMax){const B=N.bbox,V=[B[1],B[0],B[3],B[2]],J=Vg(V,p);if(un(J,m.extent)){A=!0;break}}}A&&y.push(I.attribution)}),y.push(nie),y})}this.setState("ready")}}const rie=iie;class sie extends du{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:Df({extent:Gc(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:e.opaque,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const a_=sie;class oie extends a_{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,maxZoom:e.maxZoom!==void 0?e.maxZoom:18,minZoom:e.minZoom,projection:e.projection,transition:e.transition,wrapX:e.wrapX,zDirection:e.zDirection}),this.account_=e.account,this.mapId_=e.map||"",this.config_=e.config||{},this.templateCache_={},this.initializeMap_()}getConfig(){return this.config_}updateConfig(e){Object.assign(this.config_,e),this.initializeMap_()}setConfig(e){this.config_=e||{},this.initializeMap_()}initializeMap_(){const e=JSON.stringify(this.config_);if(this.templateCache_[e]){this.applyTemplate_(this.templateCache_[e]);return}let t="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(t+="/named/"+this.mapId_);const i=new XMLHttpRequest;i.addEventListener("load",this.handleInitResponse_.bind(this,e)),i.addEventListener("error",this.handleInitError_.bind(this)),i.open("POST",t),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(this.config_))}handleInitResponse_(e,t){const i=t.target;if(!i.status||i.status>=200&&i.status<300){let r;try{r=JSON.parse(i.responseText)}catch{this.setState("error");return}this.applyTemplate_(r),this.templateCache_[e]=r,this.setState("ready")}else this.setState("error")}handleInitError_(e){this.setState("error")}applyTemplate_(e){const t="https://"+e.cdn_url.https+"/"+this.account_+"/api/v1/map/"+e.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(t)}}const aie=oie;class lie extends Ja{constructor(e){super({attributions:e.attributions,wrapX:e.wrapX}),this.resolution=void 0,this.distance=e.distance!==void 0?e.distance:20,this.minDistance=e.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=e.geometryFunction||function(t){const i=t.getGeometry();return Ye(i.getType()=="Point",10),i},this.createCustomCluster_=e.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(e.source||null)}clear(e){this.features.length=0,super.clear(e)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(e,t,i){this.source.loadFeatures(e,t,i),t!==this.resolution&&(this.resolution=t,this.refresh())}setDistance(e){this.updateDistance(e,this.minDistance)}setMinDistance(e){this.updateDistance(this.distance,e)}getMinDistance(){return this.minDistance}setSource(e){this.source&&this.source.removeEventListener(Re.CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(Re.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(e,t){const i=e===0?0:Math.min(t,e)/e,r=e!==this.distance||this.interpolationRatio!==i;this.distance=e,this.minDistance=t,this.interpolationRatio=i,r&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const e=xr(),t=this.distance*this.resolution,i=this.source.getFeatures(),r={};for(let s=0,o=i.length;s<o;s++){const a=i[s];if(!(be(a)in r)){const l=this.geometryFunction(a);if(l){const u=l.getCoordinates();yg(u,e),Rs(e,t,e);const h=this.source.getFeaturesInExtent(e).filter(function(p){const m=be(p);return m in r?!1:(r[m]=!0,!0)});this.features.push(this.createCluster(h,e))}}}}createCluster(e,t){const i=[0,0];for(let a=e.length-1;a>=0;--a){const l=this.geometryFunction(e[a]);l?_3(i,l.getCoordinates()):e.splice(a,1)}v3(i,1/e.length);const r=er(t),s=this.interpolationRatio,o=new bs([i[0]*(1-s)+r[0]*s,i[1]*(1-s)+r[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(o,e):new pr({geometry:o,features:e})}}const uie=lie;class cie extends s_{constructor(e){const t=e.projection===void 0?"EPSG:3857":e.projection;let i=e.tileGrid;i===void 0&&t&&(i=Df({extent:Gc(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:t,tileGrid:i,opaque:e.opaque,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?dn(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.tileCacheForProjection_={}}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;const t=this.getTileGrid();return t?dn(t.getTileSize(e)):[256,256]}getGutterForProjection(e){const t=this.getProjection();return!t||rs(t,e)?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,t,i,r,s){const o=this.getTileCacheForProjection(r),a=sl(e,t,i);if(o.containsKey(a)){const R=o.get(a);if(R&&R.key==this.getKey())return R}const l=this.getTileGrid(),u=Math.max.apply(null,l.getResolutions().map((R,E)=>{const T=dn(l.getTileSize(E)),I=this.getTileSize(E);return Math.max(I[0]/T[0],I[1]/T[1])})),h=this.getTileGridForProjection(s),p=this.getTileGridForProjection(r),m=[e,t,i],y=this.getTileCoordForTileUrlFunction(m,r),x=Object.assign({sourceProj:s,sourceTileGrid:h,targetProj:r,targetTileGrid:p,tileCoord:m,wrappedTileCoord:y,pixelRatio:u,gutter:this.getGutterForProjection(s),getTileFunction:(R,E,T,I)=>this.getTile(R,E,T,I,s)},this.tileOptions),w=new LR(x);return w.key=this.getKey(),w}getTile(e,t,i,r,s){const o=this.getProjection();if(o&&s&&!rs(o,s))return this.getReprojTile_(e,t,i,s,o);const a=this.getTileSize(e),l=sl(e,t,i);if(this.tileCache.containsKey(l))return this.tileCache.get(l);const u=this.loader_;function h(){return lK(function(){return u(e,t,i)})}const p=Object.assign({tileCoord:[e,t,i],loader:h,size:a},this.tileOptions),m=new Bk(p);return m.key=this.getKey(),m.addEventListener(Re.CHANGE,this.handleTileChange_),this.tileCache.set(l,m),m}handleTileChange_(e){const t=e.target,i=be(t),r=t.getState();let s;r==ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=Eg.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==ce.ERROR?Eg.TILELOADERROR:r==ce.LOADED?Eg.TILELOADEND:void 0),s&&this.dispatchEvent(new nG(s,t))}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||rs(t,e)))return this.tileGrid;const i=be(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=Tk(e)),this.tileGridForProjection_[i]}setTileGridForProjection(e,t){const i=_t(e);if(i){const r=be(i);r in this.tileGridForProjection_||(this.tileGridForProjection_[r]=t)}}getTileCacheForProjection(e){const t=this.getProjection();if(!t||rs(t,e))return this.tileCache;const i=be(e);return i in this.tileCacheForProjection_||(this.tileCacheForProjection_[i]=new t_(.1)),this.tileCacheForProjection_[i]}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const r in this.tileCacheForProjection_){const s=this.tileCacheForProjection_[r];s.expireCache(s==i?t:{})}}clear(){super.clear();for(const e in this.tileCacheForProjection_)this.tileCacheForProjection_[e].clear()}}const aj=cie;function wr(n){return(e,...t)=>hie(n,e,t)}function wp(n,e){return wr(lj(n,e).get)}const{apply:hie,construct:Ime,defineProperty:Rme,get:bme,getOwnPropertyDescriptor:lj,getPrototypeOf:Xk,has:Ame,ownKeys:fie,set:kme,setPrototypeOf:Pme}=Reflect,{iterator:l_,species:Lme,toStringTag:die,for:Mme}=Symbol,gie=Object,{create:qk,defineProperty:pie,freeze:Dme,is:Fme}=gie,mie=Array,yie=mie.prototype,uj=yie[l_],_ie=wr(uj),cj=ArrayBuffer,vie=cj.prototype;wp(vie,"byteLength");const cF=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;cF&&wp(cF.prototype,"byteLength");const hj=Xk(Uint8Array);hj.from;const us=hj.prototype;us[l_];wr(us.keys);wr(us.values);wr(us.entries);wr(us.set);wr(us.reverse);wr(us.fill);wr(us.copyWithin);wr(us.sort);wr(us.slice);wr(us.subarray);wp(us,"buffer");wp(us,"byteOffset");wp(us,"length");wp(us,die);const Ep=Uint32Array,xie=Float32Array,T0=Xk([][l_]()),fj=wr(T0.next),wie=wr(function*(){}().next),Eie=Xk(T0),Tie=DataView.prototype,Sie=wr(Tie.getUint16),Kk=WeakMap,dj=Kk.prototype,gj=wr(dj.get),Cie=wr(dj.set),pj=new Kk,Iie=qk(null,{next:{value:function(){const e=gj(pj,this);return fj(e)}},[l_]:{value:function(){return this}}});function Rie(n){if(n[l_]===uj&&T0.next===fj)return n;const e=qk(Iie);return Cie(pj,e,_ie(n)),e}const bie=new Kk,Aie=qk(Eie,{next:{value:function(){const e=gj(bie,this);return wie(e)},writable:!0,configurable:!0}});for(const n of fie(T0))n!=="next"&&pie(Aie,n,lj(T0,n));const mj=new cj(4),kie=new xie(mj),Pie=new Ep(mj),za=new Ep(512),Ua=new Ep(512);for(let n=0;n<256;++n){const e=n-127;e<-27?(za[n]=0,za[n|256]=32768,Ua[n]=24,Ua[n|256]=24):e<-14?(za[n]=1024>>-e-14,za[n|256]=1024>>-e-14|32768,Ua[n]=-e-1,Ua[n|256]=-e-1):e<=15?(za[n]=e+15<<10,za[n|256]=e+15<<10|32768,Ua[n]=13,Ua[n|256]=13):e<128?(za[n]=31744,za[n|256]=64512,Ua[n]=24,Ua[n|256]=24):(za[n]=31744,za[n|256]=64512,Ua[n]=13,Ua[n|256]=13)}const Yk=new Ep(2048),Tp=new Ep(64),yj=new Ep(64);for(let n=1;n<1024;++n){let e=n<<13,t=0;for(;!(e&8388608);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,Yk[n]=e|t}for(let n=1024;n<2048;++n)Yk[n]=939524096+(n-1024<<13);for(let n=1;n<31;++n)Tp[n]=n<<23;Tp[31]=1199570944;Tp[32]=2147483648;for(let n=33;n<63;++n)Tp[n]=2147483648+(n-32<<23);Tp[63]=3347054592;for(let n=1;n<64;++n)n!==32&&(yj[n]=1024);function Lie(n){const e=n>>10;return Pie[0]=Yk[yj[e]+(n&1023)]+Tp[e],kie[0]}function _j(n,e,...t){return Lie(Sie(n,e,...Rie(t)))}var bg={},Mie={get exports(){return bg},set exports(n){bg=n}};function vj(n,e,t){const i=t&&t.debug||!1;i&&console.log("getting "+e+" in "+n);const r=typeof n=="object"?n.outer:n,s=`${e}\\="([^"]*)"`;i&&console.log("pattern:",s);const a=new RegExp(s).exec(r);if(i&&console.log("match:",a),a)return a[1]}Mie.exports=vj;bg.default=vj;var xw={},Die={get exports(){return xw},set exports(n){xw=n}},ww={},Fie={get exports(){return ww},set exports(n){ww=n}},Ew={},Oie={get exports(){return Ew},set exports(n){Ew=n}};function xj(n,e,t){const r=new RegExp(e).exec(n.slice(t));return r?t+r.index:-1}Oie.exports=xj;Ew.default=xj;var Tw={},Nie={get exports(){return Tw},set exports(n){Tw=n}};function wj(n,e,t){const r=new RegExp(e).exec(n.slice(t));return r?t+r.index+r[0].length-1:-1}Nie.exports=wj;Tw.default=wj;var Sw={},zie={get exports(){return Sw},set exports(n){Sw=n}};function Ej(n,e){const t=new RegExp(e,"g"),i=n.match(t);return i?i.length:0}zie.exports=Ej;Sw.default=Ej;const Uie=Ew,bC=Tw,hF=Sw;function Tj(n,e,t){const i=t&&t.debug||!1,r=!(t&&typeof t.nested===!1),s=t&&t.startIndex||0;i&&console.log("[xml-utils] starting findTagByName with",e," and ",t);const o=Uie(n,`<${e}[ >/]`,s);if(i&&console.log("[xml-utils] start:",o),o===-1)return;const a=n.slice(o+e.length);let l=bC(a,"^[^<]*[ /]>",0);const u=l!==-1&&a[l-1]==="/";if(i&&console.log("[xml-utils] selfClosing:",u),u===!1)if(r){let y=0,x=1,w=0;for(;(l=bC(a,"[ /]"+e+">",y))!==-1;){const R=a.substring(y,l+1);if(x+=hF(R,"<"+e),w+=hF(R,"/"+e+">"),w>=x)break;y=l}}else l=bC(a,"[ /]"+e+">",0);const h=o+e.length+l+1;if(i&&console.log("[xml-utils] end:",h),h===-1)return;const p=n.slice(o,h);let m;return u?m=null:m=p.slice(p.indexOf(">")+1,p.lastIndexOf("<")),{inner:m,outer:p,start:o,end:h}}Fie.exports=Tj;ww.default=Tj;const Gie=ww;function Sj(n,e,t){const i=[],r=t&&t.debug||!1,s=t&&typeof t.nested=="boolean"?t.nested:!0;let o=t&&t.startIndex||0,a;for(;a=Gie(n,e,{debug:r,startIndex:o});)s?o=a.start+1+e.length:o=a.end,i.push(a);return r&&console.log("findTagsByName found",i.length,"tags"),i}Die.exports=Sj;xw.default=Sj;const Ty={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},Ga={};for(const n in Ty)Ty.hasOwnProperty(n)&&(Ga[Ty[n]]=parseInt(n,10));const jie=[Ga.BitsPerSample,Ga.ExtraSamples,Ga.SampleFormat,Ga.StripByteCounts,Ga.StripOffsets,Ga.StripRowCounts,Ga.TileByteCounts,Ga.TileOffsets,Ga.SubIFDs],AC={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},St={};for(const n in AC)AC.hasOwnProperty(n)&&(St[AC[n]]=parseInt(n,10));const _s={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},Bie={Unspecified:0,Assocalpha:1,Unassalpha:2},Ome={Version:0,AddCompression:1},Nme={None:0,Deflate:1},Vie={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function $ie(n,e){const{width:t,height:i}=n,r=new Uint8Array(t*i*3);let s;for(let o=0,a=0;o<n.length;++o,a+=3)s=256-n[o]/e*256,r[a]=s,r[a+1]=s,r[a+2]=s;return r}function Wie(n,e){const{width:t,height:i}=n,r=new Uint8Array(t*i*3);let s;for(let o=0,a=0;o<n.length;++o,a+=3)s=n[o]/e*256,r[a]=s,r[a+1]=s,r[a+2]=s;return r}function Hie(n,e){const{width:t,height:i}=n,r=new Uint8Array(t*i*3),s=e.length/3,o=e.length/3*2;for(let a=0,l=0;a<n.length;++a,l+=3){const u=n[a];r[l]=e[u]/65536*256,r[l+1]=e[u+s]/65536*256,r[l+2]=e[u+o]/65536*256}return r}function Xie(n){const{width:e,height:t}=n,i=new Uint8Array(e*t*3);for(let r=0,s=0;r<n.length;r+=4,s+=3){const o=n[r],a=n[r+1],l=n[r+2],u=n[r+3];i[s]=255*((255-o)/256)*((255-u)/256),i[s+1]=255*((255-a)/256)*((255-u)/256),i[s+2]=255*((255-l)/256)*((255-u)/256)}return i}function qie(n){const{width:e,height:t}=n,i=new Uint8ClampedArray(e*t*3);for(let r=0,s=0;r<n.length;r+=3,s+=3){const o=n[r],a=n[r+1],l=n[r+2];i[s]=o+1.402*(l-128),i[s+1]=o-.34414*(a-128)-.71414*(l-128),i[s+2]=o+1.772*(a-128)}return i}const Kie=.95047,Yie=1,Zie=1.08883;function Qie(n){const{width:e,height:t}=n,i=new Uint8Array(e*t*3);for(let r=0,s=0;r<n.length;r+=3,s+=3){const o=n[r+0],a=n[r+1]<<24>>24,l=n[r+2]<<24>>24;let u=(o+16)/116,h=a/500+u,p=u-l/200,m,y,x;h=Kie*(h*h*h>.008856?h*h*h:(h-16/116)/7.787),u=Yie*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),p=Zie*(p*p*p>.008856?p*p*p:(p-16/116)/7.787),m=h*3.2406+u*-1.5372+p*-.4986,y=h*-.9689+u*1.8758+p*.0415,x=h*.0557+u*-.204+p*1.057,m=m>.0031308?1.055*m**(1/2.4)-.055:12.92*m,y=y>.0031308?1.055*y**(1/2.4)-.055:12.92*y,x=x>.0031308?1.055*x**(1/2.4)-.055:12.92*x,i[s]=Math.max(0,Math.min(1,m))*255,i[s+1]=Math.max(0,Math.min(1,y))*255,i[s+2]=Math.max(0,Math.min(1,x))*255}return i}const Jie="modulepreload",ere=function(n){return"/"+n},fF={},Vc=function(e,t,i){if(!t||t.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=ere(s),s in fF)return;fF[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let h=r.length-1;h>=0;h--){const p=r[h];if(p.href===s&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Jie,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((h,p)=>{u.addEventListener("load",h),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())},Cj=new Map;function $c(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>Cj.set(t,e))}async function Ij(n){const e=Cj.get(n.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${n.Compression}`);const t=await e();return new t(n)}$c([void 0,1],()=>Vc(()=>import("./raw-7a0fe838.js"),["assets/raw-7a0fe838.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));$c(5,()=>Vc(()=>import("./lzw-901d9363.js"),["assets/lzw-901d9363.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));$c(6,()=>{throw new Error("old style JPEG compression is not supported.")});$c(7,()=>Vc(()=>import("./jpeg-2f15dd85.js"),["assets/jpeg-2f15dd85.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));$c([8,32946],()=>Vc(()=>import("./deflate-29fb883b.js"),["assets/deflate-29fb883b.js","assets/pako.esm-bae9e474.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));$c(32773,()=>Vc(()=>import("./packbits-90020365.js"),["assets/packbits-90020365.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));$c(34887,()=>Vc(()=>import("./lerc-db322b45.js"),["assets/lerc-db322b45.js","assets/pako.esm-bae9e474.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));$c(50001,()=>Vc(()=>import("./webimage-aa764004.js"),["assets/webimage-aa764004.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));function GE(n,e,t,i=1){return new(Object.getPrototypeOf(n)).constructor(e*t*i)}function tre(n,e,t,i,r){const s=e/i,o=t/r;return n.map(a=>{const l=GE(a,i,r);for(let u=0;u<r;++u){const h=Math.min(Math.round(o*u),t-1);for(let p=0;p<i;++p){const m=Math.min(Math.round(s*p),e-1),y=a[h*e+m];l[u*i+p]=y}}return l})}function Ag(n,e,t){return(1-t)*n+t*e}function nre(n,e,t,i,r){const s=e/i,o=t/r;return n.map(a=>{const l=GE(a,i,r);for(let u=0;u<r;++u){const h=o*u,p=Math.floor(h),m=Math.min(Math.ceil(h),t-1);for(let y=0;y<i;++y){const x=s*y,w=x%1,R=Math.floor(x),E=Math.min(Math.ceil(x),e-1),T=a[p*e+R],I=a[p*e+E],A=a[m*e+R],L=a[m*e+E],F=Ag(Ag(T,I,w),Ag(A,L,w),h%1);l[u*i+y]=F}}return l})}function ire(n,e,t,i,r,s="nearest"){switch(s.toLowerCase()){case"nearest":return tre(n,e,t,i,r);case"bilinear":case"linear":return nre(n,e,t,i,r);default:throw new Error(`Unsupported resampling method: '${s}'`)}}function rre(n,e,t,i,r,s){const o=e/i,a=t/r,l=GE(n,i,r,s);for(let u=0;u<r;++u){const h=Math.min(Math.round(a*u),t-1);for(let p=0;p<i;++p){const m=Math.min(Math.round(o*p),e-1);for(let y=0;y<s;++y){const x=n[h*e*s+m*s+y];l[u*i*s+p*s+y]=x}}}return l}function sre(n,e,t,i,r,s){const o=e/i,a=t/r,l=GE(n,i,r,s);for(let u=0;u<r;++u){const h=a*u,p=Math.floor(h),m=Math.min(Math.ceil(h),t-1);for(let y=0;y<i;++y){const x=o*y,w=x%1,R=Math.floor(x),E=Math.min(Math.ceil(x),e-1);for(let T=0;T<s;++T){const I=n[p*e*s+R*s+T],A=n[p*e*s+E*s+T],L=n[m*e*s+R*s+T],F=n[m*e*s+E*s+T],O=Ag(Ag(I,A,w),Ag(L,F,w),h%1);l[u*i*s+y*s+T]=O}}}return l}function ore(n,e,t,i,r,s,o="nearest"){switch(o.toLowerCase()){case"nearest":return rre(n,e,t,i,r,s);case"bilinear":case"linear":return sre(n,e,t,i,r,s);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function are(n,e,t){let i=0;for(let r=e;r<t;++r)i+=n[r];return i}function MR(n,e,t){switch(n){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function lre(n,e){return(n===1||n===2)&&e<=32&&e%8===0?!1:!(n===3&&(e===16||e===32||e===64))}function ure(n,e,t,i,r,s,o){const a=new DataView(n),l=t===2?o*s:o*s*i,u=t===2?1:i,h=MR(e,r,l),p=parseInt("1".repeat(r),2);if(e===1){let m;t===1?m=i*r:m=r;let y=s*m;y&7&&(y=y+7&-8);for(let x=0;x<o;++x){const w=x*y;for(let R=0;R<s;++R){const E=w+R*u*r;for(let T=0;T<u;++T){const I=E+T*r,A=(x*s+R)*u+T,L=Math.floor(I/8),F=I%8;if(F+r<=8)h[A]=a.getUint8(L)>>8-r-F&p;else if(F+r<=16)h[A]=a.getUint16(L)>>16-r-F&p;else if(F+r<=24){const O=a.getUint16(L)<<8|a.getUint8(L+2);h[A]=O>>24-r-F&p}else h[A]=a.getUint32(L)>>32-r-F&p}}}}return h.buffer}class cre{constructor(e,t,i,r,s,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=i,this.littleEndian=r,this.tiles=s?{}:null,this.isTiled=!e.StripOffsets;const a=e.PlanarConfiguration;if(this.planarConfiguration=typeof a>"u"?1:a,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,i=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(r,s){return _j(this,r,s)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const i=this.getSampleFormat(e),r=this.getBitsPerSample(e);return MR(i,r,t)}async getTileOrStrip(e,t,i,r,s){const o=Math.ceil(this.getWidth()/this.getTileWidth()),a=Math.ceil(this.getHeight()/this.getTileHeight());let l;const{tiles:u}=this;this.planarConfiguration===1?l=t*o+e:this.planarConfiguration===2&&(l=i*o*a+t*o+e);let h,p;this.isTiled?(h=this.fileDirectory.TileOffsets[l],p=this.fileDirectory.TileByteCounts[l]):(h=this.fileDirectory.StripOffsets[l],p=this.fileDirectory.StripByteCounts[l]);const m=(await this.source.fetch([{offset:h,length:p}],s))[0];let y;return u===null||!u[l]?(y=(async()=>{let x=await r.decode(this.fileDirectory,m);const w=this.getSampleFormat(),R=this.getBitsPerSample();return lre(w,R)&&(x=ure(x,w,this.planarConfiguration,this.getSamplesPerPixel(),R,this.getTileWidth(),this.getBlockHeight(t))),x})(),u!==null&&(u[l]=y)):y=u[l],{x:e,y:t,sample:i,data:await y}}async _readRaster(e,t,i,r,s,o,a,l,u){const h=this.getTileWidth(),p=this.getTileHeight(),m=this.getWidth(),y=this.getHeight(),x=Math.max(Math.floor(e[0]/h),0),w=Math.min(Math.ceil(e[2]/h),Math.ceil(m/h)),R=Math.max(Math.floor(e[1]/p),0),E=Math.min(Math.ceil(e[3]/p),Math.ceil(y/p)),T=e[2]-e[0];let I=this.getBytesPerPixel();const A=[],L=[];for(let N=0;N<t.length;++N)this.planarConfiguration===1?A.push(are(this.fileDirectory.BitsPerSample,0,t[N])/8):A.push(0),L.push(this.getReaderForSample(t[N]));const F=[],{littleEndian:O}=this;for(let N=R;N<E;++N)for(let B=x;B<w;++B)for(let V=0;V<t.length;++V){const J=V,ge=t[V];this.planarConfiguration===2&&(I=this.getSampleByteSize(V));const he=this.getTileOrStrip(B,N,ge,s,u).then(de=>{const oe=de.data,_e=new DataView(oe),se=this.getBlockHeight(de.y),Z=de.y*p,pe=de.x*h,ne=Z+se,ee=(de.x+1)*h,j=L[J],ie=Math.min(se,se-(ne-e[3]),y-Z),q=Math.min(h,h-(ee-e[2]),m-pe);for(let H=Math.max(0,e[1]-Z);H<ie;++H)for(let te=Math.max(0,e[0]-pe);te<q;++te){const ue=(H*h+te)*I,K=j.call(_e,ue+A[J],O);let Te;r?(Te=(H+Z-e[1])*T*t.length+(te+pe-e[0])*t.length+J,i[Te]=K):(Te=(H+Z-e[1])*T+te+pe-e[0],i[J][Te]=K)}});F.push(he)}if(await Promise.all(F),o&&e[2]-e[0]!==o||a&&e[3]-e[1]!==a){let N;return r?N=ore(i,e[2]-e[0],e[3]-e[1],o,a,t.length,l):N=ire(i,e[2]-e[0],e[3]-e[1],o,a,l),N.width=o,N.height=a,N}return i.width=o||e[2]-e[0],i.height=a||e[3]-e[1],i}async readRasters({window:e,samples:t=[],interleave:i,pool:r=null,width:s,height:o,resampleMethod:a,fillValue:l,signal:u}={}){const h=e||[0,0,this.getWidth(),this.getHeight()];if(h[0]>h[2]||h[1]>h[3])throw new Error("Invalid subsets");const p=h[2]-h[0],m=h[3]-h[1],y=p*m,x=this.getSamplesPerPixel();if(!t||!t.length)for(let T=0;T<x;++T)t.push(T);else for(let T=0;T<t.length;++T)if(t[T]>=x)return Promise.reject(new RangeError(`Invalid sample index '${t[T]}'.`));let w;if(i){const T=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,I=Math.max.apply(null,this.fileDirectory.BitsPerSample);w=MR(T,I,y*t.length),l&&w.fill(l)}else{w=[];for(let T=0;T<t.length;++T){const I=this.getArrayForSample(t[T],y);Array.isArray(l)&&T<l.length?I.fill(l[T]):l&&!Array.isArray(l)&&I.fill(l),w.push(I)}}const R=r||await Ij(this.fileDirectory);return await this._readRaster(h,t,w,i,R,s,o,a,u)}async readRGB({window:e,interleave:t=!0,pool:i=null,width:r,height:s,resampleMethod:o,enableAlpha:a=!1,signal:l}={}){const u=e||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const h=this.fileDirectory.PhotometricInterpretation;if(h===_s.RGB){let E=[0,1,2];if(this.fileDirectory.ExtraSamples!==Bie.Unspecified&&a){E=[];for(let T=0;T<this.fileDirectory.BitsPerSample.length;T+=1)E.push(T)}return this.readRasters({window:e,interleave:t,samples:E,pool:i,width:r,height:s,resampleMethod:o,signal:l})}let p;switch(h){case _s.WhiteIsZero:case _s.BlackIsZero:case _s.Palette:p=[0];break;case _s.CMYK:p=[0,1,2,3];break;case _s.YCbCr:case _s.CIELab:p=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const m={window:u,interleave:!0,samples:p,pool:i,width:r,height:s,resampleMethod:o,signal:l},{fileDirectory:y}=this,x=await this.readRasters(m),w=2**this.fileDirectory.BitsPerSample[0];let R;switch(h){case _s.WhiteIsZero:R=$ie(x,w);break;case _s.BlackIsZero:R=Wie(x,w);break;case _s.Palette:R=Hie(x,y.ColorMap);break;case _s.CMYK:R=Xie(x);break;case _s.YCbCr:R=qie(x);break;case _s.CIELab:R=Qie(x);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const E=new Uint8Array(R.length/3),T=new Uint8Array(R.length/3),I=new Uint8Array(R.length/3);for(let A=0,L=0;A<R.length;A+=3,++L)E[L]=R[A],T[L]=R[A+1],I[L]=R[A+2];R=[E,T,I]}return R.width=x.width,R.height=x.height,R}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const i=this.fileDirectory.GDAL_METADATA;let r=xw(i,"Item");e===null?r=r.filter(s=>bg(s,"sample")===void 0):r=r.filter(s=>Number(bg(s,"sample"))===e);for(let s=0;s<r.length;++s){const o=r[s];t[bg(o,"name")]=o.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,i=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(i)return[i[0],i[5],i[10]];if(e){const[r,s,o]=e.getResolution();return[r*e.getWidth()/this.getWidth(),s*e.getHeight()/this.getHeight(),o*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),i=e[0],r=e[1],s=i+t[0]*this.getWidth(),o=r+t[1]*this.getHeight();return[Math.min(i,s),Math.min(r,o),Math.max(i,s),Math.max(r,o)]}}const Rj=cre;class hre{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const i=this.getUint32(e,t),r=this.getUint32(e+4,t);let s;if(t){if(s=i+2**32*r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}if(s=2**32*i+r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}getInt64(e,t){let i=0;const r=(this._dataView.getUint8(e+(t?7:0))&128)>0;let s=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(e+(t?o:7-o));r&&(s?a!==0&&(a=~(a-1)&255,s=!1):a=~a&255),i+=a*256**o}return r&&(i=-i),i}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return _j(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class fre{constructor(e,t,i,r){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=i,this._bigTiff=r}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),i=this.readUint32(e+4);let r;if(this._littleEndian){if(r=t+2**32*i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*t+i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}readInt64(e){let t=0;const i=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let r=!0;for(let s=0;s<8;s++){let o=this._dataView.getUint8(e+(this._littleEndian?s:7-s));i&&(r?o!==0&&(o=~(o-1)&255,r=!1):o=~o&255),t+=o*256**s}return i&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const dre=typeof navigator<"u"&&navigator.hardwareConcurrency||2;class gre{constructor(e=dre,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(i=>{Vc(()=>import("./decoder-bb67c6bf.js"),[]).then(r=>{i(r.create)})}),this._awaitingDecoder.then(i=>{this._awaitingDecoder=null,this.workers=[];for(let r=0;r<e;r++)this.workers.push({worker:i(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?Ij(e).then(i=>i.decode(e,t)):new Promise(i=>{const r=this.workers.find(a=>a.idle)||this.workers[Math.floor(Math.random()*this.size)];r.idle=!1;const s=this.messageId++,o=a=>{a.data.id===s&&(r.idle=!0,i(a.data.decoded),r.worker.removeEventListener("message",o))};r.worker.addEventListener("message",o),r.worker.postMessage({fileDirectory:e,buffer:t,id:s},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}const pre=gre,dF=`\r
\r
`;function bj(n){if(typeof Object.fromEntries<"u")return Object.fromEntries(n);const e={};for(const[t,i]of n)e[t.toLowerCase()]=i;return e}function mre(n){const e=n.split(`\r
`).map(t=>{const i=t.split(":").map(r=>r.trim());return i[0]=i[0].toLowerCase(),i});return bj(e)}function yre(n){const[e,...t]=n.split(";").map(r=>r.trim()),i=t.map(r=>r.split("="));return{type:e,params:bj(i)}}function DR(n){let e,t,i;return n&&([,e,t,i]=n.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),i=parseInt(i,10)),{start:e,end:t,total:i}}function _re(n,e){let t=null;const i=new TextDecoder("ascii"),r=[],s=`--${e}`,o=`${s}--`;for(let a=0;a<10;++a)i.decode(new Uint8Array(n,a,s.length))===s&&(t=a);if(t===null)throw new Error("Could not find initial boundary");for(;t<n.byteLength;){const a=i.decode(new Uint8Array(n,t,Math.min(s.length+1024,n.byteLength-t)));if(a.length===0||a.startsWith(o))break;if(!a.startsWith(s))throw new Error("Part does not start with boundary");const l=a.substr(s.length+2);if(l.length===0)break;const u=l.indexOf(dF),h=mre(l.substr(0,u)),{start:p,end:m,total:y}=DR(h["content-range"]),x=t+s.length+u+dF.length,w=parseInt(m,10)+1-parseInt(p,10);r.push({headers:h,data:n.slice(x,x+w),offset:p,length:w,fileSize:y}),t=x+w+4}return r}class Zk{async fetch(e,t=void 0){return Promise.all(e.map(i=>this.fetchSlice(i,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class vre extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[t,i]of e)this.onEviction(t,i.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const i=t.get(e);return this._getItemValue(e,i)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield e)}for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:i=this.maxAge}={}){const r=typeof i=="number"&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:r}):this._set(e,{value:t,expiry:r})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],i=t.length-e;i<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(i>0&&this._emitEvictions(t.slice(0,i)),this.oldCache=new Map(t.slice(i)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const i=e[t],[r,s]=i;this._deleteIfExpired(r,s)===!1&&(yield[r,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const i=e[t],[r,s]=i;this.cache.has(r)||this._deleteIfExpired(r,s)===!1&&(yield[r,s.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[i,r]of this.entriesAscending())e.call(t,r,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function xre(n){return new Promise(e=>setTimeout(e,n))}function wre(n,e){const t=Array.isArray(n)?n:Array.from(n),i=Array.isArray(e)?e:Array.from(e);return t.map((r,s)=>[r,i[s]])}class Zg extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,Zg),this.name="AbortError"}}class Ere extends Error{constructor(e,t){super(t),this.errors=e,this.message=t,this.name="AggregateError"}}const Tre=Ere;class Sre{constructor(e,t,i=null){this.offset=e,this.length=t,this.data=i}get top(){return this.offset+this.length}}class gF{constructor(e,t,i){this.offset=e,this.length=t,this.blockIds=i}}class Cre extends Zk{constructor(e,{blockSize:t=65536,cacheSize:i=100}={}){super(),this.source=e,this.blockSize=t,this.blockCache=new vre({maxSize:i,onEviction:(r,s)=>{this.evictedBlocks.set(r,s)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const i=[],r=[],s=[];this.evictedBlocks.clear();for(const{offset:m,length:y}of e){let x=m+y;const{fileSize:w}=this;w!==null&&(x=Math.min(x,w));const R=Math.floor(m/this.blockSize)*this.blockSize;for(let E=R;E<x;E+=this.blockSize){const T=Math.floor(E/this.blockSize);!this.blockCache.has(T)&&!this.blockRequests.has(T)&&(this.blockIdsToFetch.add(T),r.push(T)),this.blockRequests.has(T)&&i.push(this.blockRequests.get(T)),s.push(T)}}await xre(),this.fetchBlocks(t);const o=[];for(const m of r)this.blockRequests.has(m)&&o.push(this.blockRequests.get(m));await Promise.allSettled(i),await Promise.allSettled(o);const a=[],l=s.filter(m=>this.abortedBlockIds.has(m)||!this.blockCache.has(m));if(l.forEach(m=>this.blockIdsToFetch.add(m)),l.length>0&&t&&!t.aborted){this.fetchBlocks(null);for(const m of l){const y=this.blockRequests.get(m);if(!y)throw new Error(`Block ${m} is not in the block requests`);a.push(y)}await Promise.allSettled(a)}if(t&&t.aborted)throw new Zg("Request was aborted");const u=s.map(m=>this.blockCache.get(m)||this.evictedBlocks.get(m)),h=u.filter(m=>!m);if(h.length)throw new Tre(h,"Request failed");const p=new Map(wre(s,u));return this.readSliceData(e,p)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),i=this.source.fetch(t,e);for(let r=0;r<t.length;++r){const s=t[r];for(const o of s.blockIds)this.blockRequests.set(o,(async()=>{try{const a=(await i)[r],l=o*this.blockSize,u=l-a.offset,h=Math.min(u+this.blockSize,a.data.byteLength),p=a.data.slice(u,h),m=new Sre(l,p.byteLength,p,o);this.blockCache.set(o,m),this.abortedBlockIds.delete(o)}catch(a){if(a.name==="AbortError")a.signal=e,this.blockCache.delete(o),this.abortedBlockIds.add(o);else throw a}finally{this.blockRequests.delete(o)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((o,a)=>o-a);if(t.length===0)return[];let i=[],r=null;const s=[];for(const o of t)r===null||r+1===o?(i.push(o),r=o):(s.push(new gF(i[0]*this.blockSize,i.length*this.blockSize,i)),i=[o],r=o);return s.push(new gF(i[0]*this.blockSize,i.length*this.blockSize,i)),s}readSliceData(e,t){return e.map(i=>{let r=i.offset+i.length;this.fileSize!==null&&(r=Math.min(this.fileSize,r));const s=Math.floor(i.offset/this.blockSize),o=Math.floor(r/this.blockSize),a=new ArrayBuffer(i.length),l=new Uint8Array(a);for(let u=s;u<=o;++u){const h=t.get(u),p=h.offset-i.offset,m=h.top-r;let y=0,x=0,w;p<0?y=-p:p>0&&(x=p),m<0?w=h.length-y:w=r-h.offset-y;const R=new Uint8Array(h.data,y,w);l.set(R,x)}return a})}}class Qk{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Jk{constructor(e){this.url=e}async request({headers:e,credentials:t,signal:i}={}){throw new Error("request is not implemented")}}class Ire extends Qk{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class Rre extends Jk{constructor(e,t){super(e),this.credentials=t}async request({headers:e,credentials:t,signal:i}={}){const r=await fetch(this.url,{headers:e,credentials:t,signal:i});return new Ire(r)}}class bre extends Qk{constructor(e,t){super(),this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class Are extends Jk{constructRequest(e,t){return new Promise((i,r)=>{const s=new XMLHttpRequest;s.open("GET",this.url),s.responseType="arraybuffer";for(const[o,a]of Object.entries(e))s.setRequestHeader(o,a);s.onload=()=>{const o=s.response;i(new bre(s,o))},s.onerror=r,s.onabort=()=>r(new Zg("Request aborted")),s.send(),t&&(t.aborted&&s.abort(),t.addEventListener("abort",()=>s.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}const kC={};class kre extends Qk{constructor(e,t){super(),this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class Pre extends Jk{constructor(e){super(e),this.parsedUrl=kC.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",kC)}constructRequest(e,t){return new Promise((i,r)=>{const s=this.httpApi.get({...this.parsedUrl,headers:e},o=>{const a=new Promise(l=>{const u=[];o.on("data",h=>{u.push(h)}),o.on("end",()=>{const h=Buffer.concat(u).buffer;l(h)}),o.on("error",r)});i(new kre(o,a))});s.on("error",r),t&&(t.aborted&&s.destroy(new Zg("Request aborted")),t.addEventListener("abort",()=>s.destroy(new Zg("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class eP extends Zk{constructor(e,t,i,r){super(),this.client=e,this.headers=t,this.maxRanges=i,this.allowFullFile=r,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(i=>this.fetchSlice(i,t))))}async fetchSlices(e,t){const i=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map(({offset:r,length:s})=>`${r}-${r+s}`).join(",")}`},signal:t});if(i.ok)if(i.status===206){const{type:r,params:s}=yre(i.getHeader("content-type"));if(r==="multipart/byteranges"){const p=_re(await i.getData(),s.boundary);return this._fileSize=p[0].fileSize||null,p}const o=await i.getData(),{start:a,end:l,total:u}=DR(i.getHeader("content-range"));this._fileSize=u||null;const h=[{data:o,offset:a,length:l-a}];if(e.length>1){const p=await Promise.all(e.slice(1).map(m=>this.fetchSlice(m,t)));return h.concat(p)}return h}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const r=await i.getData();return this._fileSize=r.byteLength,[{data:r,offset:0,length:r.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:i,length:r}=e,s=await this.client.request({headers:{...this.headers,Range:`bytes=${i}-${i+r}`},signal:t});if(s.ok)if(s.status===206){const o=await s.getData(),{total:a}=DR(s.getHeader("content-range"));return this._fileSize=a||null,{data:o,offset:i,length:r}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const o=await s.getData();return this._fileSize=o.byteLength,{data:o,offset:0,length:o.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function tP(n,{blockSize:e,cacheSize:t}){return e===null?n:new Cre(n,{blockSize:e,cacheSize:t})}function Lre(n,{headers:e={},credentials:t,maxRanges:i=0,allowFullFile:r=!1,...s}={}){const o=new Rre(n,t),a=new eP(o,e,i,r);return tP(a,s)}function Mre(n,{headers:e={},maxRanges:t=0,allowFullFile:i=!1,...r}={}){const s=new Are(n),o=new eP(s,e,t,i);return tP(o,r)}function Dre(n,{headers:e={},maxRanges:t=0,allowFullFile:i=!1,...r}={}){const s=new Pre(n),o=new eP(s,e,t,i);return tP(o,r)}function FR(n,{forceXHR:e=!1,...t}={}){return typeof fetch=="function"&&!e?Lre(n,t):typeof XMLHttpRequest<"u"?Mre(n,t):Dre(n,t)}class Fre extends Zk{constructor(e){super(),this.file=e}async fetchSlice(e,t){return new Promise((i,r)=>{const s=this.file.slice(e.offset,e.offset+e.length),o=new FileReader;o.onload=a=>i(a.target.result),o.onerror=r,o.onabort=r,o.readAsArrayBuffer(s),t&&t.addEventListener("abort",()=>o.abort())})}}function Ore(n){return new Fre(n)}function OR(n){switch(n){case St.BYTE:case St.ASCII:case St.SBYTE:case St.UNDEFINED:return 1;case St.SHORT:case St.SSHORT:return 2;case St.LONG:case St.SLONG:case St.FLOAT:case St.IFD:return 4;case St.RATIONAL:case St.SRATIONAL:case St.DOUBLE:case St.LONG8:case St.SLONG8:case St.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${n}`)}}function Nre(n){const e=n.GeoKeyDirectory;if(!e)return null;const t={};for(let i=4;i<=e[3]*4;i+=4){const r=Vie[e[i]],s=e[i+1]?Ty[e[i+1]]:null,o=e[i+2],a=e[i+3];let l=null;if(!s)l=a;else{if(l=n[s],typeof l>"u"||l===null)throw new Error(`Could not get value of geoKey '${r}'.`);typeof l=="string"?l=l.substring(a,a+o-1):l.subarray&&(l=l.subarray(a,a+o),o===1&&(l=l[0]))}t[r]=l}return t}function Fd(n,e,t,i){let r=null,s=null;const o=OR(e);switch(e){case St.BYTE:case St.ASCII:case St.UNDEFINED:r=new Uint8Array(t),s=n.readUint8;break;case St.SBYTE:r=new Int8Array(t),s=n.readInt8;break;case St.SHORT:r=new Uint16Array(t),s=n.readUint16;break;case St.SSHORT:r=new Int16Array(t),s=n.readInt16;break;case St.LONG:case St.IFD:r=new Uint32Array(t),s=n.readUint32;break;case St.SLONG:r=new Int32Array(t),s=n.readInt32;break;case St.LONG8:case St.IFD8:r=new Array(t),s=n.readUint64;break;case St.SLONG8:r=new Array(t),s=n.readInt64;break;case St.RATIONAL:r=new Uint32Array(t*2),s=n.readUint32;break;case St.SRATIONAL:r=new Int32Array(t*2),s=n.readInt32;break;case St.FLOAT:r=new Float32Array(t),s=n.readFloat32;break;case St.DOUBLE:r=new Float64Array(t),s=n.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===St.RATIONAL||e===St.SRATIONAL)for(let a=0;a<t;a+=2)r[a]=s.call(n,i+a*o),r[a+1]=s.call(n,i+(a*o+4));else for(let a=0;a<t;++a)r[a]=s.call(n,i+a*o);return e===St.ASCII?new TextDecoder("utf-8").decode(r):r}class zre{constructor(e,t,i){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=i}}class F1 extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class Aj{async readRasters(e={}){const{window:t,width:i,height:r}=e;let{resX:s,resY:o,bbox:a}=e;const l=await this.getImage();let u=l;const h=await this.getImageCount(),p=l.getBoundingBox();if(t&&a)throw new Error('Both "bbox" and "window" passed.');if(i||r){if(t){const[x,w]=l.getOrigin(),[R,E]=l.getResolution();a=[x+t[0]*R,w+t[1]*E,x+t[2]*R,w+t[3]*E]}const y=a||p;if(i){if(s)throw new Error("Both width and resX passed");s=(y[2]-y[0])/i}if(r){if(o)throw new Error("Both width and resY passed");o=(y[3]-y[1])/r}}if(s||o){const y=[];for(let x=0;x<h;++x){const w=await this.getImage(x),{SubfileType:R,NewSubfileType:E}=w.fileDirectory;(x===0||R===2||E&1)&&y.push(w)}y.sort((x,w)=>x.getWidth()-w.getWidth());for(let x=0;x<y.length;++x){const w=y[x],R=(p[2]-p[0])/w.getWidth(),E=(p[3]-p[1])/w.getHeight();if(u=w,s&&s>R||o&&o>E)break}}let m=t;if(a){const[y,x]=l.getOrigin(),[w,R]=u.getResolution(l);m=[Math.round((a[0]-y)/w),Math.round((a[1]-x)/R),Math.round((a[2]-y)/w),Math.round((a[3]-x)/R)],m=[Math.min(m[0],m[2]),Math.min(m[1],m[3]),Math.max(m[0],m[2]),Math.max(m[1],m[3])]}return u.readRasters({...e,window:m})}}class Qg extends Aj{constructor(e,t,i,r,s={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=i,this.firstIFDOffset=r,this.cache=s.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const i=this.bigTiff?4048:1024;return new fre((await this.source.fetch([{offset:e,length:typeof t<"u"?t:i}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,i=this.bigTiff?8:2;let r=await this.getSlice(e);const s=this.bigTiff?r.readUint64(e):r.readUint16(e),o=s*t+(this.bigTiff?16:6);r.covers(e,o)||(r=await this.getSlice(e,o));const a={};let l=e+(this.bigTiff?8:2);for(let p=0;p<s;l+=t,++p){const m=r.readUint16(l),y=r.readUint16(l+2),x=this.bigTiff?r.readUint64(l+4):r.readUint32(l+4);let w,R;const E=OR(y),T=l+(this.bigTiff?12:8);if(E*x<=(this.bigTiff?8:4))w=Fd(r,y,x,T);else{const I=r.readOffset(T),A=OR(y)*x;if(r.covers(I,A))w=Fd(r,y,x,I);else{const L=await this.getSlice(I,A);w=Fd(L,y,x,I)}}x===1&&jie.indexOf(m)===-1&&!(y===St.RATIONAL||y===St.SRATIONAL)?R=w[0]:R=w,a[Ty[m]]=R}const u=Nre(a),h=r.readOffset(e+i+t*s);return new zre(a,u,h)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof F1?new F1(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new F1(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new Rj(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(i){if(i instanceof F1)t=!1;else throw i}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",i=t.length+100;let r=await this.getSlice(e,i);if(t===Fd(r,St.ASCII,t.length,e)){const o=Fd(r,St.ASCII,i,e).split(`
`)[0],a=Number(o.split("=")[1].split(" ")[0])+o.length;a>i&&(r=await this.getSlice(e,a));const l=Fd(r,St.ASCII,a,e);this.ghostValues={},l.split(`
`).filter(u=>u.length>0).map(u=>u.split("=")).forEach(([u,h])=>{this.ghostValues[u]=h})}return this.ghostValues}static async fromSource(e,t,i){const r=(await e.fetch([{offset:0,length:1024}],i))[0],s=new hre(r),o=s.getUint16(0,0);let a;if(o===18761)a=!0;else if(o===19789)a=!1;else throw new TypeError("Invalid byte order value.");const l=s.getUint16(2,a);let u;if(l===42)u=!1;else if(l===43){if(u=!0,s.getUint16(4,a)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const h=u?s.getUint64(8,a):s.getUint32(4,a);return new Qg(e,a,u,h,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class Ure extends Aj{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,i=0;for(let r=0;r<this.imageFiles.length;r++){const s=this.imageFiles[r];for(let o=0;o<this.imageCounts[r];o++){if(e===t){const a=await s.requestIFD(i);return new Rj(a.fileDirectory,a.geoKeyDirectory,s.dataView,s.littleEndian,s.cache,s.source)}t++,i++}i=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,i)=>t+i,0),this.imageCount}}async function Gre(n,e={},t){return Qg.fromSource(FR(n,e),t)}async function jre(n,e){return Qg.fromSource(Ore(n),e)}async function Bre(n,e=[],t={},i){const r=await Qg.fromSource(FR(n,t),i),s=await Promise.all(e.map(o=>Qg.fromSource(FR(o,t))));return new Ure(r,s)}function Vre(n){return((n.fileDirectory.NewSubfileType||0)&4)===4}function $re(n,e){if(!n)return!1;if(n===!0)return!0;if(e.getSamplesPerPixel()!==3)return!1;const t=e.fileDirectory.PhotometricInterpretation,i=_s;return t===i.CMYK||t===i.YCbCr||t===i.CIELab||t===i.ICCLab}const pF="STATISTICS_MAXIMUM",mF="STATISTICS_MINIMUM",PC=256;let LC;function Wre(){return LC||(LC=new pre),LC}function Hre(n){try{return n.getBoundingBox()}catch{const t=n.fileDirectory;return[0,0,t.ImageWidth,t.ImageLength]}}function Xre(n){try{return n.getOrigin().slice(0,2)}catch{return[0,n.fileDirectory.ImageLength]}}function qre(n,e){try{return n.getResolution(e)}catch{return[e.fileDirectory.ImageWidth/n.fileDirectory.ImageWidth,e.fileDirectory.ImageHeight/n.fileDirectory.ImageHeight]}}function Kre(n){const e=n.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey&&e.ProjectedCSTypeGeoKey!==32767){const t="EPSG:"+e.ProjectedCSTypeGeoKey;let i=_t(t);if(!i){const r=DM(e.ProjLinearUnitsGeoKey);r&&(i=new Ky({code:t,units:r}))}return i}if(e.GeographicTypeGeoKey&&e.GeographicTypeGeoKey!==32767){const t="EPSG:"+e.GeographicTypeGeoKey;let i=_t(t);if(!i){const r=DM(e.GeogAngularUnitsGeoKey);r&&(i=new Ky({code:t,units:r}))}return i}return null}function Yre(n){return n.getImageCount().then(function(e){const t=new Array(e);for(let i=0;i<e;++i)t[i]=n.getImage(i);return Promise.all(t)})}function Zre(n,e){let t;return n.blob?t=jre(n.blob):n.overviews?t=Bre(n.url,n.overviews,e):t=Gre(n.url,e),t.then(Yre)}function ny(n,e,t,i,r){if(Array.isArray(n)){const s=n.length;if(!Array.isArray(e)||s!=e.length){const o=new Error(i);throw r(o),o}for(let o=0;o<s;++o)ny(n[o],e[o],t,i,r);return}if(e=e,Math.abs(n-e)>t*n)throw new Error(i)}function Qre(n){return n instanceof Int8Array?-128:n instanceof Int16Array?-32768:n instanceof Int32Array?-2147483648:n instanceof Float32Array?12e-39:0}function Jre(n){return n instanceof Int8Array?127:n instanceof Uint8Array||n instanceof Uint8ClampedArray?255:n instanceof Int16Array?32767:n instanceof Uint16Array?65535:n instanceof Int32Array?2147483647:n instanceof Uint32Array?4294967295:n instanceof Float32Array?34e37:255}class kj extends aj{constructor(e){super({state:"loading",tileGrid:null,projection:null,opaque:e.opaque,transition:e.transition,interpolate:e.interpolate!==!1,wrapX:e.wrapX}),this.sourceInfo_=e.sources;const t=this.sourceInfo_.length;this.sourceOptions_=e.sourceOptions,this.sourceImagery_=new Array(t),this.sourceMasks_=new Array(t),this.resolutionFactors_=new Array(t),this.samplesPerPixel_,this.nodataValues_,this.metadata_,this.normalize_=e.normalize!==!1,this.addAlpha_=!1,this.error_=null,this.convertToRGB_=e.convertToRGB||!1,this.setKey(this.sourceInfo_.map(s=>s.url).join(","));const i=this,r=new Array(t);for(let s=0;s<t;++s)r[s]=Zre(this.sourceInfo_[s],this.sourceOptions_);Promise.all(r).then(function(s){i.configure_(s)}).catch(function(s){VM(s),i.error_=s,i.setState("error")})}getError(){return this.error_}determineProjection(e){const t=e[0];for(let i=t.length-1;i>=0;--i){const r=t[i],s=Kre(r);if(s){this.projection=s;break}}}configure_(e){let t,i,r,s,o;const a=new Array(e.length),l=new Array(e.length),u=new Array(e.length);let h=0;const p=e.length;for(let w=0;w<p;++w){const R=[],E=[];e[w].forEach(N=>{Vre(N)?E.push(N):R.push(N)});const T=R.length;if(E.length>0&&E.length!==T)throw new Error(`Expected one mask per image found ${E.length} masks and ${T} images`);let I,A;const L=new Array(T),F=new Array(T),O=new Array(T);l[w]=new Array(T),u[w]=new Array(T);for(let N=0;N<T;++N){const B=R[N],V=B.getGDALNoData();u[w][N]=B.getGDALMetadata(0),l[w][N]=V;const J=this.sourceInfo_[w].bands;a[w]=J?J.length:B.getSamplesPerPixel();const ge=T-(N+1);I||(I=Hre(B)),A||(A=Xre(B));const he=qre(B,R[0]);O[ge]=he[0];const de=[B.getTileWidth(),B.getTileHeight()];de[0]!==de[1]&&de[1]<PC&&(de[0]=PC,de[1]=PC),L[ge]=de;const oe=he[0]/Math.abs(he[1]);F[ge]=[de[0],de[1]/oe]}if(t?tr(t,I,t):t=I,!i)i=A;else{const N=`Origin mismatch for source ${w}, got [${A}] but expected [${i}]`;ny(i,A,0,N,this.viewRejector)}if(!o)o=O,this.resolutionFactors_[w]=1;else{o.length-h>O.length&&(h=o.length-O.length);const N=o[o.length-1]/O[O.length-1];this.resolutionFactors_[w]=N;const B=O.map(J=>J*=N),V=`Resolution mismatch for source ${w}, got [${B}] but expected [${o}]`;ny(o.slice(h,o.length),B,.02,V,this.viewRejector)}r?ny(r.slice(h,r.length),F,.01,`Tile size mismatch for source ${w}`,this.viewRejector):r=F,s?ny(s.slice(h,s.length),L,0,`Tile size mismatch for source ${w}`,this.viewRejector):s=L,this.sourceImagery_[w]=R.reverse(),this.sourceMasks_[w]=E.reverse()}for(let w=0,R=this.sourceImagery_.length;w<R;++w){const E=this.sourceImagery_[w];for(;E.length<o.length;)E.unshift(void 0)}this.getProjection()||this.determineProjection(e),this.samplesPerPixel_=a,this.nodataValues_=l,this.metadata_=u;e:for(let w=0;w<p;++w){if(this.sourceInfo_[w].nodata!==void 0){this.addAlpha_=!0;break}if(this.sourceMasks_[w].length){this.addAlpha_=!0;break}const R=l[w],E=this.sourceInfo_[w].bands;if(E){for(let T=0;T<E.length;++T)if(R[E[T]-1]!==null){this.addAlpha_=!0;break e}continue}for(let T=0;T<R.length;++T)if(R[T]!==null){this.addAlpha_=!0;break e}}let m=this.addAlpha_?1:0;for(let w=0;w<p;++w)m+=a[w];this.bandCount=m;const y=new fu({extent:t,minZoom:h,origin:i,resolutions:o,tileSizes:r});this.tileGrid=y,this.setTileSizes(s),this.setLoader(this.loadTile_.bind(this)),this.setState("ready");const x=1;o.length===2?o=[o[0],o[1],o[1]/2]:o.length===1&&(o=[o[0]*2,o[0],o[0]/2]),this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:o,center:Yh(er(t),this.projection),extent:dp(t,this.projection),zoom:x})}loadTile_(e,t,i){const r=this.getTileSize(e),s=this.sourceImagery_.length,o=new Array(s*2),a=this.nodataValues_,l=this.sourceInfo_,u=Wre();for(let h=0;h<s;++h){const p=l[h],m=this.resolutionFactors_[h],y=[Math.round(t*(r[0]*m)),Math.round(i*(r[1]*m)),Math.round((t+1)*(r[0]*m)),Math.round((i+1)*(r[1]*m))],x=this.sourceImagery_[h][e];let w;p.bands&&(w=p.bands.map(function(A){return A-1}));let R;"nodata"in p&&p.nodata!==null?R=p.nodata:w?R=w.map(function(A){return a[h][A]}):R=a[h];const E={window:y,width:r[0],height:r[1],samples:w,fillValue:R,pool:u,interleave:!1};$re(this.convertToRGB_,x)?o[h]=x.readRGB(E):o[h]=x.readRasters(E);const T=s+h,I=this.sourceMasks_[h][e];if(!I){o[T]=Promise.resolve(null);continue}o[T]=I.readRasters({window:y,width:r[0],height:r[1],samples:[0],pool:u,interleave:!1})}return Promise.all(o).then(this.composeTile_.bind(this,r)).catch(function(h){throw VM(h),h})}composeTile_(e,t){const i=this.metadata_,r=this.sourceInfo_,s=this.sourceImagery_.length,o=this.bandCount,a=this.samplesPerPixel_,l=this.nodataValues_,u=this.normalize_,h=this.addAlpha_,p=e[0]*e[1],m=p*o;let y;u?y=new Uint8Array(m):y=new Float32Array(m);let x=0;for(let w=0;w<p;++w){let R=h;for(let E=0;E<s;++E){const T=r[E];let I=T.min,A=T.max,L,F;if(u){const O=i[E][0];I===void 0&&(O&&mF in O?I=parseFloat(O[mF]):I=Qre(t[E][0])),A===void 0&&(O&&pF in O?A=parseFloat(O[pF]):A=Jre(t[E][0])),L=255/(A-I),F=-I*L}for(let O=0;O<a[E];++O){const N=t[E][O][w];let B;if(u?B=ot(L*N+F,0,255):B=N,!h)y[x]=B;else{let V=T.nodata;if(V===void 0){let ge;T.bands?ge=T.bands[O]-1:ge=O,V=l[E][ge]}const J=isNaN(V);(!J&&N!==V||J&&!isNaN(N))&&(R=!1,y[x]=B)}x++}if(!R){const O=s+E,N=t[O];N&&!N[0][w]&&(R=!0)}}h&&(R||(y[x]=255),x++)}return y}}kj.prototype.getView;const ese=kj;let Pj=class extends Xg{constructor(e,t,i,r,s,o,a){super(t,i,r,s,o,a),this.zoomifyImage_=null,this.tileSize_=e}getImage(){if(this.zoomifyImage_)return this.zoomifyImage_;const e=super.getImage();if(this.state==ce.LOADED){const t=this.tileSize_;if(e.width==t[0]&&e.height==t[1])return this.zoomifyImage_=e,e;const i=mn(t[0],t[1]);return i.drawImage(e,0,0),this.zoomifyImage_=i.canvas,i.canvas}return e}};class tse extends du{constructor(e){const t=e.size,i=e.tierSizeCalculation!==void 0?e.tierSizeCalculation:"default",r=e.tilePixelRatio||1,s=t[0],o=t[1],a=[],l=e.tileSize||qg;let u=l*r;switch(i){case"default":for(;s>u||o>u;)a.push([Math.ceil(s/u),Math.ceil(o/u)]),u+=u;break;case"truncated":let F=s,O=o;for(;F>u||O>u;)a.push([Math.ceil(F/u),Math.ceil(O/u)]),F>>=1,O>>=1;break;default:Ye(!1,53);break}a.push([1,1]),a.reverse();const h=[r],p=[0];for(let F=1,O=a.length;F<O;F++)h.push(r<<F),p.push(a[F-1][0]*a[F-1][1]+p[F-1]);h.reverse();const m=new fu({tileSize:l,extent:e.extent||[0,-o,s,0],resolutions:h});let y=e.url;y&&!y.includes("{TileGroup}")&&!y.includes("{tileIndex}")&&(y+="{TileGroup}/{z}-{x}-{y}.jpg");const x=kE(y);let w=l*r;function R(F){return function(O,N,B){if(!O)return;const V=O[0],J=O[1],ge=O[2],he=J+ge*a[V][0],de=(he+p[V])/w|0,oe={z:V,x:J,y:ge,tileIndex:he,TileGroup:"TileGroup"+de};return F.replace(/\{(\w+?)\}/g,function(_e,se){return oe[se]})}}const E=m0(x.map(R)),T=Pj.bind(null,dn(l*r));super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,tilePixelRatio:r,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:T,tileGrid:m,tileUrlFunction:E,transition:e.transition}),this.zDirection=e.zDirection;const I=m.getTileCoordForCoordAndResolution(er(m.getExtent()),h[h.length-1]),A=E(I,1,null),L=new Image;L.addEventListener("error",()=>{w=l,this.changed()}),L.src=A}}const nse=tse,$m={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"};function Wm(n){return n.toLocaleString("en",{maximumFractionDigits:10})}class ise extends du{constructor(e){const t=e||{};let i=t.url||"";i=i+(i.lastIndexOf("/")===i.length-1||i===""?"":"/");const r=t.version||$m.VERSION2,s=t.sizes||[],o=t.size;Ye(o!=null&&Array.isArray(o)&&o.length==2&&!isNaN(o[0])&&o[0]>0&&!isNaN(o[1])&&o[1]>0,60);const a=o[0],l=o[1],u=t.tileSize,h=t.tilePixelRatio||1,p=t.format||"jpg",m=t.quality||(t.version==$m.VERSION1?"native":"default");let y=t.resolutions||[];const x=t.supports||[],w=t.extent||[0,-l,a,0],R=s!=null&&Array.isArray(s)&&s.length>0,E=u!==void 0&&(typeof u=="number"&&Number.isInteger(u)&&u>0||Array.isArray(u)&&u.length>0),T=x!=null&&Array.isArray(x)&&(x.includes("regionByPx")||x.includes("regionByPct"))&&(x.includes("sizeByWh")||x.includes("sizeByH")||x.includes("sizeByW")||x.includes("sizeByPct"));let I,A,L;if(y.sort(function(B,V){return V-B}),E||T)if(u!=null&&(typeof u=="number"&&Number.isInteger(u)&&u>0?(I=u,A=u):Array.isArray(u)&&u.length>0&&((u.length==1||u[1]==null&&Number.isInteger(u[0]))&&(I=u[0],A=u[0]),u.length==2&&(Number.isInteger(u[0])&&Number.isInteger(u[1])?(I=u[0],A=u[1]):u[0]==null&&Number.isInteger(u[1])&&(I=u[1],A=u[1])))),(I===void 0||A===void 0)&&(I=qg,A=qg),y.length==0){L=Math.max(Math.ceil(Math.log(a/I)/Math.LN2),Math.ceil(Math.log(l/A)/Math.LN2));for(let B=L;B>=0;B--)y.push(Math.pow(2,B))}else{const B=Math.max(...y);L=Math.round(Math.log(B)/Math.LN2)}else if(I=a,A=l,y=[],R){s.sort(function(V,J){return V[0]-J[0]}),L=-1;const B=[];for(let V=0;V<s.length;V++){const J=a/s[V][0];if(y.length>0&&y[y.length-1]==J){B.push(V);continue}y.push(J),L++}if(B.length>0)for(let V=0;V<B.length;V++)s.splice(B[V]-V,1)}else y.push(1),s.push([a,l]),L=0;const F=new fu({tileSize:[I,A],extent:w,origin:va(w),resolutions:y}),O=function(B,V,J){let ge,he;const de=B[0];if(de>L)return;const oe=B[1],_e=B[2],se=y[de];if(!(oe===void 0||_e===void 0||se===void 0||oe<0||Math.ceil(a/se/I)<=oe||_e<0||Math.ceil(l/se/A)<=_e)){if(T||E){const Z=oe*I*se,pe=_e*A*se;let ne=I*se,ee=A*se,j=I,ie=A;if(Z+ne>a&&(ne=a-Z),pe+ee>l&&(ee=l-pe),Z+I*se>a&&(j=Math.floor((a-Z+se-1)/se)),pe+A*se>l&&(ie=Math.floor((l-pe+se-1)/se)),Z==0&&ne==a&&pe==0&&ee==l)ge="full";else if(!T||x.includes("regionByPx"))ge=Z+","+pe+","+ne+","+ee;else if(x.includes("regionByPct")){const q=Wm(Z/a*100),H=Wm(pe/l*100),te=Wm(ne/a*100),ue=Wm(ee/l*100);ge="pct:"+q+","+H+","+te+","+ue}r==$m.VERSION3&&(!T||x.includes("sizeByWh"))?he=j+","+ie:!T||x.includes("sizeByW")?he=j+",":x.includes("sizeByH")?he=","+ie:x.includes("sizeByWh")?he=j+","+ie:x.includes("sizeByPct")&&(he="pct:"+Wm(100/se))}else if(ge="full",R){const Z=s[de][0],pe=s[de][1];r==$m.VERSION3?Z==a&&pe==l?he="max":he=Z+","+pe:Z==a?he="full":he=Z+","}else he=r==$m.VERSION3?"max":"full";return i+ge+"/"+he+"/0/"+m+"."+p}},N=Pj.bind(null,dn(u||256).map(function(B){return B*h}));super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:t.state,tileClass:N,tileGrid:F,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:O,transition:t.transition}),this.zDirection=t.zDirection}}const rse=ise;function nu(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}class sse extends jc{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:PE,this.params_=e.params||{},this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5}getParams(){return this.params_}getImageInternal(e,t,i,r){if(this.url_===void 0)return null;t=this.findNearestResolution(t),i=this.hidpi_?i:1;const s=this.image_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==t&&s.getPixelRatio()==i&&zr(s.getExtent(),e))return s;const o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(o,this.params_),e=e.slice();const a=(e[0]+e[2])/2,l=(e[1]+e[3])/2;if(this.ratio_!=1){const y=this.ratio_*gt(e)/2,x=this.ratio_*rn(e)/2;e[0]=a-y,e[1]=l-x,e[2]=a+y,e[3]=l+x}const u=t/i,h=Math.ceil(gt(e)/u),p=Math.ceil(rn(e)/u);e[0]=a-u*h/2,e[2]=a+u*h/2,e[1]=l-u*p/2,e[3]=l+u*p/2,this.imageSize_[0]=h,this.imageSize_[1]=p;const m=this.getRequestUrl_(e,this.imageSize_,i,r,o);return this.image_=new Z0(e,t,i,m,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(Re.CHANGE,this.handleImageChange.bind(this)),this.image_}getImageLoadFunction(){return this.imageLoadFunction_}getRequestUrl_(e,t,i,r,s){const o=r.getCode().split(/:(?=\d+$)/).pop();s.SIZE=t[0]+","+t[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(90*i);const a=this.url_,l=a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return l==a&&Ye(!1,50),nu(l,s)}getUrl(){return this.url_}setImageLoadFunction(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.image_=null,this.changed()}}const ose=sse;class ase extends jc{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions,state:e.state}),this.canvasFunction_=e.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5}getImageInternal(e,t,i,r){t=this.findNearestResolution(t);let s=this.canvas_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==t&&s.getPixelRatio()==i&&zr(s.getExtent(),e))return s;e=e.slice(),pE(e,this.ratio_);const o=gt(e)/t,a=rn(e)/t,l=[o*i,a*i],u=this.canvasFunction_.call(this,e,t,i,l,r);return u&&(s=new TE(e,t,i,u)),this.canvas_=s,this.renderedRevision_=this.getRevision(),s}}const lse=ase;class use extends jc{constructor(e){super({interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.displayDpi_=e.displayDpi!==void 0?e.displayDpi:96,this.params_=e.params||{},this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:PE,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.metersPerUnit_=e.metersPerUnit!==void 0?e.metersPerUnit:1,this.ratio_=e.ratio!==void 0?e.ratio:1,this.useOverlay_=e.useOverlay!==void 0?e.useOverlay:!1,this.image_=null,this.renderedRevision_=0}getParams(){return this.params_}getImageInternal(e,t,i,r){t=this.findNearestResolution(t),i=this.hidpi_?i:1;let s=this.image_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==t&&s.getPixelRatio()==i&&zr(s.getExtent(),e))return s;this.ratio_!=1&&(e=e.slice(),pE(e,this.ratio_));const o=gt(e)/t,a=rn(e)/t,l=[o*i,a*i];if(this.url_!==void 0){const u=this.getUrl(this.url_,this.params_,e,l,r);s=new Z0(e,t,i,u,this.crossOrigin_,this.imageLoadFunction_),s.addEventListener(Re.CHANGE,this.handleImageChange.bind(this))}else s=null;return this.image_=s,this.renderedRevision_=this.getRevision(),s}getImageLoadFunction(){return this.imageLoadFunction_}updateParams(e){Object.assign(this.params_,e),this.changed()}getUrl(e,t,i,r,s){const o=cse(i,r,this.metersPerUnit_,this.displayDpi_),a=er(i),l={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(r[0]),SETDISPLAYHEIGHT:Math.round(r[1]),SETVIEWSCALE:o,SETVIEWCENTERX:a[0],SETVIEWCENTERY:a[1]};return Object.assign(l,t),nu(e,l)}setImageLoadFunction(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}}function cse(n,e,t,i){const r=gt(n),s=rn(n),o=e[0],a=e[1],l=.0254/i;return a*r>o*s?r*t/(o*l):s*t/(a*l)}const hse=use;class fse extends jc{constructor(e){const t=e.crossOrigin!==void 0?e.crossOrigin:null,i=e.imageLoadFunction!==void 0?e.imageLoadFunction:PE;super({attributions:e.attributions,interpolate:e.interpolate,projection:_t(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image_=new Z0(this.imageExtent_,void 0,1,this.url_,t,i),this.imageSize_=e.imageSize?e.imageSize:null,this.image_.addEventListener(Re.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(e,t,i,r){return un(e,this.image_.getExtent())?this.image_:null}getUrl(){return this.url_}handleImageChange(e){if(this.image_.getState()==st.LOADED){const t=this.image_.getExtent(),i=this.image_.getImage();let r,s;this.imageSize_?(r=this.imageSize_[0],s=this.imageSize_[1]):(r=i.width,s=i.height);const o=gt(t),a=rn(t),l=o/r,u=a/s;let h=r,p=s;if(l>u?h=Math.round(o/u):p=Math.round(a/l),h!==r||p!==s){const m=mn(h,p);this.getInterpolate()||(m.imageSmoothingEnabled=!1);const y=m.canvas;m.drawImage(i,0,0,r,s,0,0,y.width,y.height),this.image_.setImage(y)}}super.handleImageChange(e)}}const dse=fse,uc="1.3.0",$u=4,yF=[101,101];class gse extends jc{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:PE,this.params_=Object.assign({},e.params),this.v13_=!0,this.updateV13_(),this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5}getFeatureInfoUrl(e,t,i,r){if(this.url_===void 0)return;const s=_t(i),o=this.getProjection();o&&o!==s&&(t=p0(o,s,e,t),e=vE(e,s,o));const a=_g(e,t,0,yF),l={SERVICE:"WMS",VERSION:uc,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object.assign(l,this.params_,r);const u=ng((e[0]-a[0])/t,$u),h=ng((a[3]-e[1])/t,$u);return l[this.v13_?"I":"X"]=u,l[this.v13_?"J":"Y"]=h,this.getRequestUrl_(a,yF,1,o||s,l)}getLegendUrl(e,t){if(this.url_===void 0)return;const i={SERVICE:"WMS",VERSION:uc,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),nu(this.url_,i)}getParams(){return this.params_}getImageInternal(e,t,i,r){if(this.url_===void 0)return null;t=this.findNearestResolution(t),i!=1&&(!this.hidpi_||this.serverType_===void 0)&&(i=1);const s=t/i,o=er(e),a=rc(gt(e)/s,$u),l=rc(rn(e)/s,$u),u=_g(o,s,0,[a,l]),h=rc(this.ratio_*gt(e)/s,$u),p=rc(this.ratio_*rn(e)/s,$u),m=_g(o,s,0,[h,p]),y=this.image_;if(y&&this.renderedRevision_==this.getRevision()&&y.getResolution()==t&&y.getPixelRatio()==i&&zr(y.getExtent(),u))return y;const x={SERVICE:"WMS",VERSION:uc,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};Object.assign(x,this.params_),this.imageSize_[0]=UM(gt(m)/s,$u),this.imageSize_[1]=UM(rn(m)/s,$u);const w=this.getRequestUrl_(m,this.imageSize_,i,r,x);return this.image_=new Z0(m,t,i,w,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(Re.CHANGE,this.handleImageChange.bind(this)),this.image_}getImageLoadFunction(){return this.imageLoadFunction_}getRequestUrl_(e,t,i,r,s){if(Ye(this.url_!==void 0,9),s[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(s.STYLES=""),i!=1)switch(this.serverType_){case"geoserver":const l=90*i+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+l:s.FORMAT_OPTIONS="dpi:"+l;break;case"mapserver":s.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":s.DPI=90*i;break;default:Ye(!1,8);break}s.WIDTH=t[0],s.HEIGHT=t[1];const o=r.getAxisOrientation();let a;return this.v13_&&o.substr(0,2)=="ne"?a=[e[1],e[0],e[3],e[2]]:a=e,s.BBOX=a.join(","),nu(this.url_,s)}getUrl(){return this.url_}setImageLoadFunction(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.updateV13_(),this.image_=null,this.changed()}updateV13_(){const e=this.params_.VERSION||uc;this.v13_=y3(e,"1.3")>=0}}const pse=gse,Lj='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class mse extends a_{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[Lj];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,opaque:e.opaque!==void 0?e.opaque:!0,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const yse=mse,_se=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',Lj],vse={terrain:{extension:"png",opaque:!0},"terrain-background":{extension:"png",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},xse={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}};class wse extends a_{constructor(e){const t=e.layer.indexOf("-"),i=t==-1?e.layer:e.layer.slice(0,t),r=xse[i],s=vse[e.layer],o=e.url!==void 0?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+s.extension;super({attributions:_se,cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,maxZoom:e.maxZoom!=null?e.maxZoom:r.maxZoom,minZoom:e.minZoom!=null?e.minZoom:r.minZoom,opaque:s.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:o,wrapX:e.wrapX,zDirection:e.zDirection})}}const Ese=wse;class Tse extends du{constructor(e){e=e||{},super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.params_=e.params||{},this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=xr(),this.setKey(this.getKeyForParams_())}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s,o){const a=this.urls;if(!a)return;const l=s.getCode().split(/:(?=\d+$)/).pop();o.SIZE=t[0]+","+t[1],o.BBOX=i.join(","),o.BBOXSR=l,o.IMAGESR=l,o.DPI=Math.round(o.DPI?o.DPI*r:90*r);let u;if(a.length==1)u=a[0];else{const p=Qa(dk(e),a.length);u=a[p]}const h=u.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return nu(h,o)}getTilePixelRatio(e){return this.hidpi_?e:1}updateParams(e){Object.assign(this.params_,e),this.setKey(this.getKeyForParams_())}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&!this.hidpi_&&(t=1);const s=r.getTileCoordExtent(e,this.tmpExtent_);let o=dn(r.getTileSize(e[0]),this.tmpSize);t!=1&&(o=$A(o,t,this.tmpSize));const a={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(a,this.params_),this.getRequestUrl_(e,o,s,t,i,a)}}const Sse=Tse;class Cse extends a_{constructor(e){e=e||{},super({opaque:!1,projection:e.projection,tileGrid:e.tileGrid,wrapX:e.wrapX!==void 0?e.wrapX:!0,zDirection:e.zDirection,url:e.template||"z:{z} x:{x} y:{y}",tileLoadFunction:(t,i)=>{const r=t.getTileCoord()[0],s=dn(this.tileGrid.getTileSize(r)),o=mn(s[0],s[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,s[0]+.5,s[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(i,s[0]/2,s[1]/2,s[0]),o.fillText(i,s[0]/2,s[1]/2,s[0]),t.setImage(o.canvas)}})}}const Ise=Cse;class Rse extends du{constructor(e){e=e||{};const t=Object.assign({},e.params),i="TRANSPARENT"in t?t.TRANSPARENT:!0;super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:!i,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=xr(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=_t(i),o=this.getProjection();let a=this.getTileGrid();a||(a=this.getTileGridForProjection(s));const l=a.getZForResolution(t,this.zDirection),u=a.getTileCoordForCoordAndZ(e,l);if(a.getResolutions().length<=u[0])return;let h=a.getResolution(u[0]),p=a.getTileCoordExtent(u,this.tmpExtent_),m=dn(a.getTileSize(u[0]),this.tmpSize);const y=this.gutter_;y!==0&&(m=KM(m,y,this.tmpSize),p=Rs(p,h*y,p)),o&&o!==s&&(h=p0(o,s,e,h),p=YK(p,s,o),e=vE(e,s,o));const x={SERVICE:"WMS",VERSION:uc,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,this.params_,r);const w=Math.floor((e[0]-p[0])/h),R=Math.floor((p[3]-e[1])/h);return x[this.v13_?"I":"X"]=w,x[this.v13_?"J":"Y"]=R,this.getRequestUrl_(u,m,p,1,o||s,x)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:uc,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),nu(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s,o){const a=this.urls;if(!a)return;if(o.WIDTH=t[0],o.HEIGHT=t[1],o[this.v13_?"CRS":"SRS"]=s.getCode(),"STYLES"in this.params_||(o.STYLES=""),r!=1)switch(this.serverType_){case"geoserver":const p=90*r+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+p:o.FORMAT_OPTIONS="dpi:"+p;break;case"mapserver":o.MAP_RESOLUTION=90*r;break;case"carmentaserver":case"qgis":o.DPI=90*r;break;default:Ye(!1,52);break}const l=s.getAxisOrientation(),u=i;if(this.v13_&&l.substr(0,2)=="ne"){let p;p=i[0],u[0]=i[1],u[1]=p,p=i[2],u[2]=i[3],u[3]=p}o.BBOX=u.join(",");let h;if(a.length==1)h=a[0];else{const p=Qa(dk(e),a.length);h=a[p]}return nu(h,o)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}updateParams(e){Object.assign(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const e=this.params_.VERSION||uc;this.v13_=y3(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_),a=dn(r.getTileSize(e[0]),this.tmpSize);const l=this.gutter_;l!==0&&(a=KM(a,l,this.tmpSize),o=Rs(o,s*l,o)),t!=1&&(a=$A(a,t,this.tmpSize));const u={SERVICE:"WMS",VERSION:uc,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return Object.assign(u,this.params_),this.getRequestUrl_(e,a,o,t,i,u)}}const bse=Rse;class Ase extends Mf{constructor(e,t,i,r,s,o){super(e,t),this.src_=i,this.extent_=r,this.preemptive_=s,this.grid_=null,this.keys_=null,this.data_=null,this.jsonp_=o}getImage(){return null}getData(e){if(!this.grid_||!this.keys_)return null;const t=(e[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),i=(e[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),r=this.grid_[Math.floor((1-i)*this.grid_.length)];if(typeof r!="string")return null;let s=r.charCodeAt(Math.floor(t*r.length));s>=93&&s--,s>=35&&s--,s-=32;let o=null;if(s in this.keys_){const a=this.keys_[s];this.data_&&a in this.data_?o=this.data_[a]:o=a}return o}forDataAtCoordinate(e,t,i){this.state==ce.EMPTY&&i===!0?(this.state=ce.IDLE,jg(this,Re.CHANGE,function(r){t(this.getData(e))},this),this.loadInternal_()):i===!0?setTimeout(()=>{t(this.getData(e))},0):t(this.getData(e))}getKey(){return this.src_}handleError_(){this.state=ce.ERROR,this.changed()}handleLoad_(e){this.grid_=e.grid,this.keys_=e.keys,this.data_=e.data,this.state=ce.LOADED,this.changed()}loadInternal_(){if(this.state==ce.IDLE)if(this.state=ce.LOADING,this.jsonp_)LE(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",this.src_),e.send()}}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let i;try{i=JSON.parse(t.responseText)}catch{this.handleError_();return}this.handleLoad_(i)}else this.handleError_()}onXHRError_(e){this.handleError_()}load(){this.preemptive_?this.loadInternal_():this.setState(ce.EMPTY)}}class kse extends s_{constructor(e){if(super({projection:_t("EPSG:3857"),state:"loading",zDirection:e.zDirection}),this.preemptive_=e.preemptive!==void 0?e.preemptive:!0,this.tileUrlFunction_=GQ,this.template_=void 0,this.jsonp_=e.jsonp||!1,e.url)if(this.jsonp_)LE(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):Ye(!1,51)}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let i;try{i=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTemplate(){return this.template_}forDataAtCoordinateAndResolution(e,t,i,r){if(this.tileGrid){const s=this.tileGrid.getZForResolution(t,this.zDirection),o=this.tileGrid.getTileCoordForCoordAndZ(e,s);this.getTile(o[0],o[1],o[2],1,this.getProjection()).forDataAtCoordinate(e,i,r)}else r===!0?setTimeout(function(){i(null)},0):i(null)}handleTileJSONError(){this.setState("error")}handleTileJSONResponse(e){const t=_t("EPSG:4326"),i=this.getProjection();let r;if(e.bounds!==void 0){const h=Uc(t,i);r=Vg(e.bounds,h)}const s=Gc(i),o=e.minzoom||0,a=e.maxzoom||22,l=Df({extent:s,maxZoom:a,minZoom:o});this.tileGrid=l,this.template_=e.template;const u=e.grids;if(!u){this.setState("error");return}if(this.tileUrlFunction_=Sk(u,l),e.attribution!==void 0){const h=r!==void 0?r:s;this.setAttributions(function(p){return un(h,p.extent)?[e.attribution]:null})}this.setState("ready")}getTile(e,t,i,r,s){const o=sl(e,t,i);if(this.tileCache.containsKey(o))return this.tileCache.get(o);const a=[e,t,i],l=this.getTileCoordForTileUrlFunction(a,s),u=this.tileUrlFunction_(l,r,s),h=new Ase(a,u!==void 0?ce.IDLE:ce.EMPTY,u!==void 0?u:"",this.tileGrid.getTileCoordExtent(a),this.preemptive_,this.jsonp_);return this.tileCache.set(o,h),h}useTile(e,t,i){const r=sl(e,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}const Pse=kse;class Lse extends du{constructor(e){const t=e.requestEncoding!==void 0?e.requestEncoding:"KVP",i=e.tileGrid;let r=e.urls;r===void 0&&e.url!==void 0&&(r=kE(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:r,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection}),this.version_=e.version!==void 0?e.version:"1.0.0",this.format_=e.format!==void 0?e.format:"image/jpeg",this.dimensions_=e.dimensions!==void 0?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),r&&r.length>0&&(this.tileUrlFunction=m0(r.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;const t=e.join(`
`);this.setTileUrlFunction(m0(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const e=this.urls?this.urls.slice(0):[];for(const t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){const t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};t=="KVP"&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=t=="KVP"?nu(e,i):e.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in i?i[a.toLowerCase()]:o});const r=this.tileGrid,s=this.dimensions_;return function(o,a,l){if(!o)return;const u={TileMatrix:r.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(u,s);let h=e;return t=="KVP"?h=nu(h,u):h=h.replace(/\{(\w+?)\}/g,function(p,m){return u[m]}),h}}}const Mse=Lse;function Dse(n,e){const t=new fk(32),i=n.getExtent();return function(r,s){t.expireCache(),i&&(r=tr(i,r));const o=n.getZForResolution(s),a=[];return n.forEachTileCoord(r,o,l=>{const u=l.toString();if(!t.containsKey(u)){const h=e(l);t.set(u,h)}a.push(t.get(u))}),a}}const Fse=Object.freeze(Object.defineProperty({__proto__:null,BingMaps:rie,CartoDB:aie,Cluster:uie,DataTile:aj,GeoTIFF:ese,IIIF:rse,Image:jc,ImageArcGISRest:ose,ImageCanvas:lse,ImageMapGuide:hse,ImageStatic:dse,ImageWMS:pse,OSM:yse,Raster:xJ,Source:Pf,Stamen:Ese,Tile:s_,TileArcGISRest:Sse,TileDebug:Ise,TileImage:du,TileJSON:uG,TileWMS:bse,UTFGrid:Pse,UrlTile:Ik,Vector:Ja,VectorTile:Rk,WMTS:Mse,XYZ:a_,Zoomify:nse,sourcesFromTileGrid:Dse},Symbol.toStringTag,{value:"Module"}));function Ose(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Nse(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){Ose(n,r,t[r])})}return n}const zse=["defaults","AssertionError","Disposable","Graticule","Image","ImageBase","ImageCanvas","ImageTile","Kinetic","MapBrowserEvent","MapBrowserEventHandler","MapEvent","Tile","TileQueue","TileRange","VectorRenderTile","VectorTile","getUid","VERSION"],Use=[],Gse=["defaults"],jse=["defaults"],Bse=["Image","Source","Tile","sourcesFromTileGrid"],Vse=["Geometry","SimpleGeometry"],$se=["Image","IconImage"],Wse=Ae.omit(zse,aZ),Hse=Ae.omit(Use,nne),Xse=Ae.omit(Gse,_ne),qse=Ae.omit(jse,eie),Kse=Ae.omit(Bse,Fse),Yse=Ae.omit(Vse,yQ),Zse=Ae.omit($se,R7),Qse=Object.fromEntries(Object.entries(Wse).map(([n,e])=>[`ol${Ae.upperFirst(n)}`,{kind:n,type:`ol${Ae.upperFirst(n)}`,object:e}])),Jse=Object.fromEntries(Object.entries(Hse).map(([n,e])=>[`olLayer${Ae.upperFirst(n)}`,{kind:"Layer",type:`olLayer${Ae.upperFirst(n)}`,object:e}])),eoe=Object.fromEntries(Object.entries(Xse).map(([n,e])=>[`olControl${Ae.upperFirst(n)}`,{kind:"Control",type:`olControl${Ae.upperFirst(n)}`,object:e}])),toe=Object.fromEntries(Object.entries(qse).map(([n,e])=>[`olInteraction${Ae.upperFirst(n)}`,{kind:"Interaction",type:`olInteraction${Ae.upperFirst(n)}`,object:e}])),noe=Object.fromEntries(Object.entries(Kse).map(([n,e])=>[`olSource${Ae.upperFirst(n)}`,{kind:"Source",type:`olSource${Ae.upperFirst(n)}`,object:e}])),ioe=Object.fromEntries(Object.entries(Yse).map(([n,e])=>[`olGeom${Ae.upperFirst(n)}`,{kind:"Geom",type:`olGeom${Ae.upperFirst(n)}`,object:e}])),roe=Object.fromEntries(Object.entries(Zse).map(([n,e])=>[`olStyle${Ae.upperFirst(n)}`,{kind:"Style",type:`olStyle${Ae.upperFirst(n)}`,object:e}]));let soe=Nse({},Qse,Jse,eoe,toe,noe,ioe,roe);const Mj=Vt.createContext(null);Mj.Consumer;const ooe=Mj.Provider;var NR={},aoe={get exports(){return NR},set exports(n){NR=n}},zR={},loe={get exports(){return zR},set exports(n){zR=n}};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var MC,_F;function uoe(){if(_F)return MC;_F=1;var n=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function i(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}function r(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var o={},a=0;a<10;a++)o["_"+String.fromCharCode(a)]=a;var l=Object.getOwnPropertyNames(o).map(function(h){return o[h]});if(l.join("")!=="0123456789")return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function(h){u[h]=h}),Object.keys(Object.assign({},u)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return MC=r()?Object.assign:function(s,o){for(var a,l=i(s),u,h=1;h<arguments.length;h++){a=Object(arguments[h]);for(var p in a)e.call(a,p)&&(l[p]=a[p]);if(n){u=n(a);for(var m=0;m<u.length;m++)t.call(a,u[m])&&(l[u[m]]=a[u[m]])}}return l},MC}var Cw={},coe={get exports(){return Cw},set exports(n){Cw=n}},DC={};/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vF;function hoe(){return vF||(vF=1,function(n){var e,t,i,r,s;if(typeof window>"u"||typeof MessageChannel!="function"){var o=null,a=null,l=function(){if(o!==null)try{var q=n.unstable_now();o(!0,q),o=null}catch(H){throw setTimeout(l,0),H}},u=Date.now();n.unstable_now=function(){return Date.now()-u},e=function(q){o!==null?setTimeout(e,0,q):(o=q,setTimeout(l,0))},t=function(q,H){a=setTimeout(q,H)},i=function(){clearTimeout(a)},r=function(){return!1},s=n.unstable_forceFrameRate=function(){}}else{var h=window.performance,p=window.Date,m=window.setTimeout,y=window.clearTimeout;if(typeof console<"u"){var x=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),typeof x!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if(typeof h=="object"&&typeof h.now=="function")n.unstable_now=function(){return h.now()};else{var w=p.now();n.unstable_now=function(){return p.now()-w}}var R=!1,E=null,T=-1,I=5,A=0;r=function(){return n.unstable_now()>=A},s=function(){},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):I=0<q?Math.floor(1e3/q):5};var L=new MessageChannel,F=L.port2;L.port1.onmessage=function(){if(E!==null){var q=n.unstable_now();A=q+I;try{E(!0,q)?F.postMessage(null):(R=!1,E=null)}catch(H){throw F.postMessage(null),H}}else R=!1},e=function(q){E=q,R||(R=!0,F.postMessage(null))},t=function(q,H){T=m(function(){q(n.unstable_now())},H)},i=function(){y(T),T=-1}}function O(q,H){var te=q.length;q.push(H);e:for(;;){var ue=te-1>>>1,K=q[ue];if(K!==void 0&&0<V(K,H))q[ue]=H,q[te]=K,te=ue;else break e}}function N(q){return q=q[0],q===void 0?null:q}function B(q){var H=q[0];if(H!==void 0){var te=q.pop();if(te!==H){q[0]=te;e:for(var ue=0,K=q.length;ue<K;){var Te=2*(ue+1)-1,lt=q[Te],It=Te+1,rt=q[It];if(lt!==void 0&&0>V(lt,te))rt!==void 0&&0>V(rt,lt)?(q[ue]=rt,q[It]=te,ue=It):(q[ue]=lt,q[Te]=te,ue=Te);else if(rt!==void 0&&0>V(rt,te))q[ue]=rt,q[It]=te,ue=It;else break e}}return H}return null}function V(q,H){var te=q.sortIndex-H.sortIndex;return te!==0?te:q.id-H.id}var J=[],ge=[],he=1,de=null,oe=3,_e=!1,se=!1,Z=!1;function pe(q){for(var H=N(ge);H!==null;){if(H.callback===null)B(ge);else if(H.startTime<=q)B(ge),H.sortIndex=H.expirationTime,O(J,H);else break;H=N(ge)}}function ne(q){if(Z=!1,pe(q),!se)if(N(J)!==null)se=!0,e(ee);else{var H=N(ge);H!==null&&t(ne,H.startTime-q)}}function ee(q,H){se=!1,Z&&(Z=!1,i()),_e=!0;var te=oe;try{for(pe(H),de=N(J);de!==null&&(!(de.expirationTime>H)||q&&!r());){var ue=de.callback;if(ue!==null){de.callback=null,oe=de.priorityLevel;var K=ue(de.expirationTime<=H);H=n.unstable_now(),typeof K=="function"?de.callback=K:de===N(J)&&B(J),pe(H)}else B(J);de=N(J)}if(de!==null)var Te=!0;else{var lt=N(ge);lt!==null&&t(ne,lt.startTime-H),Te=!1}return Te}finally{de=null,oe=te,_e=!1}}function j(q){switch(q){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var ie=s;n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){se||_e||(se=!0,e(ee))},n.unstable_getCurrentPriorityLevel=function(){return oe},n.unstable_getFirstCallbackNode=function(){return N(J)},n.unstable_next=function(q){switch(oe){case 1:case 2:case 3:var H=3;break;default:H=oe}var te=oe;oe=H;try{return q()}finally{oe=te}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=ie,n.unstable_runWithPriority=function(q,H){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var te=oe;oe=q;try{return H()}finally{oe=te}},n.unstable_scheduleCallback=function(q,H,te){var ue=n.unstable_now();if(typeof te=="object"&&te!==null){var K=te.delay;K=typeof K=="number"&&0<K?ue+K:ue,te=typeof te.timeout=="number"?te.timeout:j(q)}else te=j(q),K=ue;return te=K+te,q={id:he++,callback:H,priorityLevel:q,startTime:K,expirationTime:te,sortIndex:-1},K>ue?(q.sortIndex=K,O(ge,q),N(J)===null&&q===N(ge)&&(Z?i():Z=!0,t(ne,K-ue))):(q.sortIndex=te,O(J,q),se||_e||(se=!0,e(ee))),q},n.unstable_shouldYield=function(){var q=n.unstable_now();pe(q);var H=N(J);return H!==de&&de!==null&&H!==null&&H.callback!==null&&H.startTime<=q&&H.expirationTime<de.expirationTime||r()},n.unstable_wrapCallback=function(q){var H=oe;return function(){var te=oe;oe=H;try{return q.apply(this,arguments)}finally{oe=te}}}}(DC)),DC}var xF;function foe(){return xF||(xF=1,function(n){n.exports=hoe()}(coe)),Cw}/** @license React v0.25.1
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){n.exports=function e(t){var i=uoe(),r=Vt,s=foe();function o(d){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+d,v=1;v<arguments.length;v++)g+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;a.hasOwnProperty("ReactCurrentDispatcher")||(a.ReactCurrentDispatcher={current:null}),a.hasOwnProperty("ReactCurrentBatchConfig")||(a.ReactCurrentBatchConfig={suspense:null});var l=typeof Symbol=="function"&&Symbol.for,u=l?Symbol.for("react.element"):60103,h=l?Symbol.for("react.portal"):60106,p=l?Symbol.for("react.fragment"):60107,m=l?Symbol.for("react.strict_mode"):60108,y=l?Symbol.for("react.profiler"):60114,x=l?Symbol.for("react.provider"):60109,w=l?Symbol.for("react.context"):60110,R=l?Symbol.for("react.concurrent_mode"):60111,E=l?Symbol.for("react.forward_ref"):60112,T=l?Symbol.for("react.suspense"):60113,I=l?Symbol.for("react.suspense_list"):60120,A=l?Symbol.for("react.memo"):60115,L=l?Symbol.for("react.lazy"):60116,F=l?Symbol.for("react.block"):60121,O=typeof Symbol=="function"&&Symbol.iterator;function N(d){return d===null||typeof d!="object"?null:(d=O&&d[O]||d["@@iterator"],typeof d=="function"?d:null)}function B(d){if(d._status===-1){d._status=0;var g=d._ctor;g=g(),d._result=g,g.then(function(v){d._status===0&&(v=v.default,d._status=1,d._result=v)},function(v){d._status===0&&(d._status=2,d._result=v)})}}function V(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case p:return"Fragment";case h:return"Portal";case y:return"Profiler";case m:return"StrictMode";case T:return"Suspense";case I:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case w:return"Context.Consumer";case x:return"Context.Provider";case E:var g=d.render;return g=g.displayName||g.name||"",d.displayName||(g!==""?"ForwardRef("+g+")":"ForwardRef");case A:return V(d.type);case F:return V(d.render);case L:if(d=d._status===1?d._result:null)return V(d)}return null}function J(d){var g=d,v=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,g.effectTag&1026&&(v=g.return),d=g.return;while(d)}return g.tag===3?v:null}function ge(d){if(J(d)!==d)throw Error(o(188))}function he(d){var g=d.alternate;if(!g){if(g=J(d),g===null)throw Error(o(188));return g!==d?null:d}for(var v=d,S=g;;){var b=v.return;if(b===null)break;var D=b.alternate;if(D===null){if(S=b.return,S!==null){v=S;continue}break}if(b.child===D.child){for(D=b.child;D;){if(D===v)return ge(b),d;if(D===S)return ge(b),g;D=D.sibling}throw Error(o(188))}if(v.return!==S.return)v=b,S=D;else{for(var z=!1,re=b.child;re;){if(re===v){z=!0,v=b,S=D;break}if(re===S){z=!0,S=b,v=D;break}re=re.sibling}if(!z){for(re=D.child;re;){if(re===v){z=!0,v=D,S=b;break}if(re===S){z=!0,S=D,v=b;break}re=re.sibling}if(!z)throw Error(o(189))}}if(v.alternate!==S)throw Error(o(190))}if(v.tag!==3)throw Error(o(188));return v.stateNode.current===v?d:g}function de(d){if(d=he(d),!d)return null;for(var g=d;;){if(g.tag===5||g.tag===6)return g;if(g.child)g.child.return=g,g=g.child;else{if(g===d)break;for(;!g.sibling;){if(!g.return||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}}return null}function oe(d){if(d=he(d),!d)return null;for(var g=d;;){if(g.tag===5||g.tag===6)return g;if(g.child&&g.tag!==4)g.child.return=g,g=g.child;else{if(g===d)break;for(;!g.sibling;){if(!g.return||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}}return null}var _e=t.getPublicInstance,se=t.getRootHostContext,Z=t.getChildHostContext,pe=t.prepareForCommit,ne=t.resetAfterCommit,ee=t.createInstance,j=t.appendInitialChild,ie=t.finalizeInitialChildren,q=t.prepareUpdate,H=t.shouldSetTextContent,te=t.shouldDeprioritizeSubtree,ue=t.createTextInstance,K=t.setTimeout,Te=t.clearTimeout,lt=t.noTimeout,It=t.isPrimaryRenderer,rt=t.supportsMutation,ut=t.supportsPersistence,ct=t.supportsHydration,rr=t.appendChild,Mn=t.appendChildToContainer,$i=t.commitTextUpdate,Ie=t.commitMount,U=t.commitUpdate,Wr=t.insertBefore,ks=t.insertInContainerBefore,ei=t.removeChild,Wt=t.removeChildFromContainer,yn=t.resetTextContent,Wi=t.hideInstance,cs=t.hideTextInstance,Hi=t.unhideInstance,Rn=t.unhideTextInstance,Ft=t.cloneInstance,sr=t.createContainerChildSet,Xt=t.appendChildToContainerChildSet,cn=t.finalizeContainerChildren,ti=t.replaceContainerChildren,or=t.cloneHiddenInstance,no=t.cloneHiddenTextInstance,Dn=t.canHydrateInstance,ar=t.canHydrateTextInstance,bn=t.isSuspenseInstancePending,lr=t.isSuspenseInstanceFallback,ni=t.getNextHydratableSibling,ii=t.getFirstHydratableChild,Ps=t.hydrateInstance,zo=t.hydrateTextInstance,io=t.getNextHydratableInstanceAfterSuspenseInstance,_n=t.commitHydratedContainer,ro=t.commitHydratedSuspenseInstance,ri=/^(.*)[\\\/]/;function Ti(d){var g="";do{e:switch(d.tag){case 3:case 4:case 6:case 7:case 10:case 9:var v="";break e;default:var S=d._debugOwner,b=d._debugSource,D=V(d.type);v=null,S&&(v=V(S.type)),S=D,D="",b?D=" (at "+b.fileName.replace(ri,"")+":"+b.lineNumber+")":v&&(D=" (created by "+v+")"),v=`
    in `+(S||"Unknown")+D}g+=v,d=d.return}while(d);return g}var Fn=[],On=-1;function Rt(d){0>On||(d.current=Fn[On],Fn[On]=null,On--)}function bt(d,g){On++,Fn[On]=d.current,d.current=g}var sn={},Pt={current:sn},si={current:!1},Si=sn;function so(d,g){var v=d.type.contextTypes;if(!v)return sn;var S=d.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===g)return S.__reactInternalMemoizedMaskedChildContext;var b={},D;for(D in v)b[D]=g[D];return S&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=g,d.__reactInternalMemoizedMaskedChildContext=b),b}function vn(d){return d=d.childContextTypes,d!=null}function Hr(){Rt(si),Rt(Pt)}function gu(d,g,v){if(Pt.current!==sn)throw Error(o(168));bt(Pt,g),bt(si,v)}function hs(d,g,v){var S=d.stateNode;if(d=g.childContextTypes,typeof S.getChildContext!="function")return v;S=S.getChildContext();for(var b in S)if(!(b in d))throw Error(o(108,V(g)||"Unknown",b));return i({},v,{},S)}function Ls(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||sn,Si=Pt.current,bt(Pt,d),bt(si,si.current),!0}function pu(d,g,v){var S=d.stateNode;if(!S)throw Error(o(169));v?(d=hs(d,g,Si),S.__reactInternalMemoizedMergedChildContext=d,Rt(si),Rt(Pt),bt(Pt,d)):Rt(si),bt(si,v)}var wa=s.unstable_runWithPriority,oo=s.unstable_scheduleCallback,mu=s.unstable_cancelCallback,Ht=s.unstable_requestPaint,Xr=s.unstable_now,dl=s.unstable_getCurrentPriorityLevel,Nn=s.unstable_ImmediatePriority,Uo=s.unstable_UserBlockingPriority,yu=s.unstable_NormalPriority,ao=s.unstable_LowPriority,oi=s.unstable_IdlePriority,Go={},gl=s.unstable_shouldYield,_u=Ht!==void 0?Ht:function(){},Ci=null,vu=null,ur=!1,lo=Xr(),Ii=1e4>lo?Xr:function(){return Xr()-lo};function uo(){switch(dl()){case Nn:return 99;case Uo:return 98;case yu:return 97;case ao:return 96;case oi:return 95;default:throw Error(o(332))}}function Ea(d){switch(d){case 99:return Nn;case 98:return Uo;case 97:return yu;case 96:return ao;case 95:return oi;default:throw Error(o(332))}}function Ri(d,g){return d=Ea(d),wa(d,g)}function xu(d,g,v){return d=Ea(d),oo(d,g,v)}function Ta(d){return Ci===null?(Ci=[d],vu=oo(Nn,pl)):Ci.push(d),Go}function bi(){if(vu!==null){var d=vu;vu=null,mu(d)}pl()}function pl(){if(!ur&&Ci!==null){ur=!0;var d=0;try{var g=Ci;Ri(99,function(){for(;d<g.length;d++){var v=g[d];do v=v(!0);while(v!==null)}}),Ci=null}catch(v){throw Ci!==null&&(Ci=Ci.slice(d+1)),oo(Nn,bi),v}finally{ur=!1}}}function co(d,g,v){return v/=10,1073741821-(((1073741821-d+g/10)/v|0)+1)*v}function ml(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var qr=typeof Object.is=="function"?Object.is:ml,Xi=Object.prototype.hasOwnProperty;function Tr(d,g){if(qr(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var v=Object.keys(d),S=Object.keys(g);if(v.length!==S.length)return!1;for(S=0;S<v.length;S++)if(!Xi.call(g,v[S])||!qr(d[v[S]],g[v[S]]))return!1;return!0}function Kr(d,g){if(d&&d.defaultProps){g=i({},g),d=d.defaultProps;for(var v in d)g[v]===void 0&&(g[v]=d[v])}return g}var yl={current:null},Sa=null,Yr=null,jo=null;function wu(){jo=Yr=Sa=null}function P_(d,g){d=d.type._context,It?(bt(yl,d._currentValue),d._currentValue=g):(bt(yl,d._currentValue2),d._currentValue2=g)}function Pp(d){var g=yl.current;Rt(yl),d=d.type._context,It?d._currentValue=g:d._currentValue2=g}function L_(d,g){for(;d!==null;){var v=d.alternate;if(d.childExpirationTime<g)d.childExpirationTime=g,v!==null&&v.childExpirationTime<g&&(v.childExpirationTime=g);else if(v!==null&&v.childExpirationTime<g)v.childExpirationTime=g;else break;d=d.return}}function Ca(d,g){Sa=d,jo=Yr=null,d=d.dependencies,d!==null&&d.firstContext!==null&&(d.expirationTime>=g&&(qi=!0),d.firstContext=null)}function fs(d,g){if(jo!==d&&g!==!1&&g!==0)if((typeof g!="number"||g===1073741823)&&(jo=d,g=1073741823),g={context:d,observedBits:g,next:null},Yr===null){if(Sa===null)throw Error(o(308));Yr=g,Sa.dependencies={expirationTime:0,firstContext:g,responders:null}}else Yr=Yr.next=g;return It?d._currentValue:d._currentValue2}var ho=!1;function Lp(d){d.updateQueue={baseState:d.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function Mp(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,baseQueue:d.baseQueue,shared:d.shared,effects:d.effects})}function Ia(d,g){return d={expirationTime:d,suspenseConfig:g,tag:0,payload:null,callback:null,next:null},d.next=d}function Ra(d,g){if(d=d.updateQueue,d!==null){d=d.shared;var v=d.pending;v===null?g.next=g:(g.next=v.next,v.next=g),d.pending=g}}function M_(d,g){var v=d.alternate;v!==null&&Mp(v,d),d=d.updateQueue,v=d.baseQueue,v===null?(d.baseQueue=g.next=g,g.next=g):(g.next=v.next,v.next=g)}function Xc(d,g,v,S){var b=d.updateQueue;ho=!1;var D=b.baseQueue,z=b.shared.pending;if(z!==null){if(D!==null){var re=D.next;D.next=z.next,z.next=re}D=z,b.shared.pending=null,re=d.alternate,re!==null&&(re=re.updateQueue,re!==null&&(re.baseQueue=z))}if(D!==null){re=D.next;var Se=b.baseState,Pe=0,qt=null,nt=null,At=null;if(re!==null){var Kt=re;do{if(z=Kt.expirationTime,z<S){var Rr={expirationTime:Kt.expirationTime,suspenseConfig:Kt.suspenseConfig,tag:Kt.tag,payload:Kt.payload,callback:Kt.callback,next:null};At===null?(nt=At=Rr,qt=Se):At=At.next=Rr,z>Pe&&(Pe=z)}else{At!==null&&(At=At.next={expirationTime:1073741823,suspenseConfig:Kt.suspenseConfig,tag:Kt.tag,payload:Kt.payload,callback:Kt.callback,next:null}),fv(z,Kt.suspenseConfig);e:{var Gn=d,Q=Kt;switch(z=g,Rr=v,Q.tag){case 1:if(Gn=Q.payload,typeof Gn=="function"){Se=Gn.call(Rr,Se,z);break e}Se=Gn;break e;case 3:Gn.effectTag=Gn.effectTag&-4097|64;case 0:if(Gn=Q.payload,z=typeof Gn=="function"?Gn.call(Rr,Se,z):Gn,z==null)break e;Se=i({},Se,z);break e;case 2:ho=!0}}Kt.callback!==null&&(d.effectTag|=32,z=b.effects,z===null?b.effects=[Kt]:z.push(Kt))}if(Kt=Kt.next,Kt===null||Kt===re){if(z=b.shared.pending,z===null)break;Kt=D.next=z.next,z.next=re,b.baseQueue=D=z,b.shared.pending=null}}while(1)}At===null?qt=Se:At.next=nt,b.baseState=qt,b.baseQueue=At,Mu(Pe),d.expirationTime=Pe,d.memoizedState=Se}}function D_(d,g,v){if(d=g.effects,g.effects=null,d!==null)for(g=0;g<d.length;g++){var S=d[g],b=S.callback;if(b!==null){if(S.callback=null,S=b,b=v,typeof S!="function")throw Error(o(191,S));S.call(b)}}}var qc=a.ReactCurrentBatchConfig,Dp=new r.Component().refs;function Gf(d,g,v,S){g=d.memoizedState,v=v(S,g),v=v==null?g:i({},g,v),d.memoizedState=v,d.expirationTime===0&&(d.updateQueue.baseState=v)}var jf={isMounted:function(d){return(d=d._reactInternalFiber)?J(d)===d:!1},enqueueSetState:function(d,g,v){d=d._reactInternalFiber;var S=Ns(),b=qc.suspense;S=zs(S,d,b),b=Ia(S,b),b.payload=g,v!=null&&(b.callback=v),Ra(d,b),po(d,S)},enqueueReplaceState:function(d,g,v){d=d._reactInternalFiber;var S=Ns(),b=qc.suspense;S=zs(S,d,b),b=Ia(S,b),b.tag=1,b.payload=g,v!=null&&(b.callback=v),Ra(d,b),po(d,S)},enqueueForceUpdate:function(d,g){d=d._reactInternalFiber;var v=Ns(),S=qc.suspense;v=zs(v,d,S),S=Ia(v,S),S.tag=2,g!=null&&(S.callback=g),Ra(d,S),po(d,v)}};function F_(d,g,v,S,b,D,z){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(S,D,z):g.prototype&&g.prototype.isPureReactComponent?!Tr(v,S)||!Tr(b,D):!0}function O_(d,g,v){var S=!1,b=sn,D=g.contextType;return typeof D=="object"&&D!==null?D=fs(D):(b=vn(g)?Si:Pt.current,S=g.contextTypes,D=(S=S!=null)?so(d,b):sn),g=new g(v,D),d.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=jf,d.stateNode=g,g._reactInternalFiber=d,S&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=b,d.__reactInternalMemoizedMaskedChildContext=D),g}function N_(d,g,v,S){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(v,S),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(v,S),g.state!==d&&jf.enqueueReplaceState(g,g.state,null)}function Fp(d,g,v,S){var b=d.stateNode;b.props=v,b.state=d.memoizedState,b.refs=Dp,Lp(d);var D=g.contextType;typeof D=="object"&&D!==null?b.context=fs(D):(D=vn(g)?Si:Pt.current,b.context=so(d,D)),Xc(d,v,b,S),b.state=d.memoizedState,D=g.getDerivedStateFromProps,typeof D=="function"&&(Gf(d,g,D,v),b.state=d.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(g=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),g!==b.state&&jf.enqueueReplaceState(b,b.state,null),Xc(d,v,b,S),b.state=d.memoizedState),typeof b.componentDidMount=="function"&&(d.effectTag|=4)}var _l=Array.isArray;function Kc(d,g,v){if(d=v.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(o(309));var S=v.stateNode}if(!S)throw Error(o(147,d));var b=""+d;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===b?g.ref:(g=function(D){var z=S.refs;z===Dp&&(z=S.refs={}),D===null?delete z[b]:z[b]=D},g._stringRef=b,g)}if(typeof d!="string")throw Error(o(284));if(!v._owner)throw Error(o(290,d))}return d}function vl(d,g){if(d.type!=="textarea")throw Error(o(31,Object.prototype.toString.call(g)==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":g,""))}function z_(d){function g(Q,X){if(d){var le=Q.lastEffect;le!==null?(le.nextEffect=X,Q.lastEffect=X):Q.firstEffect=Q.lastEffect=X,X.nextEffect=null,X.effectTag=8}}function v(Q,X){if(!d)return null;for(;X!==null;)g(Q,X),X=X.sibling;return null}function S(Q,X){for(Q=new Map;X!==null;)X.key!==null?Q.set(X.key,X):Q.set(X.index,X),X=X.sibling;return Q}function b(Q,X){return Q=Ko(Q,X),Q.index=0,Q.sibling=null,Q}function D(Q,X,le){return Q.index=le,d?(le=Q.alternate,le!==null?(le=le.index,le<X?(Q.effectTag=2,X):le):(Q.effectTag=2,X)):X}function z(Q){return d&&Q.alternate===null&&(Q.effectTag=2),Q}function re(Q,X,le,Oe){return X===null||X.tag!==6?(X=fr(le,Q.mode,Oe),X.return=Q,X):(X=b(X,le),X.return=Q,X)}function Se(Q,X,le,Oe){return X!==null&&X.elementType===le.type?(Oe=b(X,le.props),Oe.ref=Kc(Q,X,le),Oe.return=Q,Oe):(Oe=oh(le.type,le.key,le.props,null,Q.mode,Oe),Oe.ref=Kc(Q,X,le),Oe.return=Q,Oe)}function Pe(Q,X,le,Oe){return X===null||X.tag!==4||X.stateNode.containerInfo!==le.containerInfo||X.stateNode.implementation!==le.implementation?(X=mo(le,Q.mode,Oe),X.return=Q,X):(X=b(X,le.children||[]),X.return=Q,X)}function qt(Q,X,le,Oe,$e){return X===null||X.tag!==7?(X=Yo(le,Q.mode,Oe,$e),X.return=Q,X):(X=b(X,le),X.return=Q,X)}function nt(Q,X,le){if(typeof X=="string"||typeof X=="number")return X=fr(""+X,Q.mode,le),X.return=Q,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case u:return le=oh(X.type,X.key,X.props,null,Q.mode,le),le.ref=Kc(Q,null,X),le.return=Q,le;case h:return X=mo(X,Q.mode,le),X.return=Q,X}if(_l(X)||N(X))return X=Yo(X,Q.mode,le,null),X.return=Q,X;vl(Q,X)}return null}function At(Q,X,le,Oe){var $e=X!==null?X.key:null;if(typeof le=="string"||typeof le=="number")return $e!==null?null:re(Q,X,""+le,Oe);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case u:return le.key===$e?le.type===p?qt(Q,X,le.props.children,Oe,$e):Se(Q,X,le,Oe):null;case h:return le.key===$e?Pe(Q,X,le,Oe):null}if(_l(le)||N(le))return $e!==null?null:qt(Q,X,le,Oe,null);vl(Q,le)}return null}function Kt(Q,X,le,Oe,$e){if(typeof Oe=="string"||typeof Oe=="number")return Q=Q.get(le)||null,re(X,Q,""+Oe,$e);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case u:return Q=Q.get(Oe.key===null?le:Oe.key)||null,Oe.type===p?qt(X,Q,Oe.props.children,$e,Oe.key):Se(X,Q,Oe,$e);case h:return Q=Q.get(Oe.key===null?le:Oe.key)||null,Pe(X,Q,Oe,$e)}if(_l(Oe)||N(Oe))return Q=Q.get(le)||null,qt(X,Q,Oe,$e,null);vl(X,Oe)}return null}function Rr(Q,X,le,Oe){for(var $e=null,an=null,Qe=X,Bt=X=0,jn=null;Qe!==null&&Bt<le.length;Bt++){Qe.index>Bt?(jn=Qe,Qe=null):jn=Qe.sibling;var Ot=At(Q,Qe,le[Bt],Oe);if(Ot===null){Qe===null&&(Qe=jn);break}d&&Qe&&Ot.alternate===null&&g(Q,Qe),X=D(Ot,X,Bt),an===null?$e=Ot:an.sibling=Ot,an=Ot,Qe=jn}if(Bt===le.length)return v(Q,Qe),$e;if(Qe===null){for(;Bt<le.length;Bt++)Qe=nt(Q,le[Bt],Oe),Qe!==null&&(X=D(Qe,X,Bt),an===null?$e=Qe:an.sibling=Qe,an=Qe);return $e}for(Qe=S(Q,Qe);Bt<le.length;Bt++)jn=Kt(Qe,Q,Bt,le[Bt],Oe),jn!==null&&(d&&jn.alternate!==null&&Qe.delete(jn.key===null?Bt:jn.key),X=D(jn,X,Bt),an===null?$e=jn:an.sibling=jn,an=jn);return d&&Qe.forEach(function(Qo){return g(Q,Qo)}),$e}function Gn(Q,X,le,Oe){var $e=N(le);if(typeof $e!="function")throw Error(o(150));if(le=$e.call(le),le==null)throw Error(o(151));for(var an=$e=null,Qe=X,Bt=X=0,jn=null,Ot=le.next();Qe!==null&&!Ot.done;Bt++,Ot=le.next()){Qe.index>Bt?(jn=Qe,Qe=null):jn=Qe.sibling;var Qo=At(Q,Qe,Ot.value,Oe);if(Qo===null){Qe===null&&(Qe=jn);break}d&&Qe&&Qo.alternate===null&&g(Q,Qe),X=D(Qo,X,Bt),an===null?$e=Qo:an.sibling=Qo,an=Qo,Qe=jn}if(Ot.done)return v(Q,Qe),$e;if(Qe===null){for(;!Ot.done;Bt++,Ot=le.next())Ot=nt(Q,Ot.value,Oe),Ot!==null&&(X=D(Ot,X,Bt),an===null?$e=Ot:an.sibling=Ot,an=Ot);return $e}for(Qe=S(Q,Qe);!Ot.done;Bt++,Ot=le.next())Ot=Kt(Qe,Q,Bt,Ot.value,Oe),Ot!==null&&(d&&Ot.alternate!==null&&Qe.delete(Ot.key===null?Bt:Ot.key),X=D(Ot,X,Bt),an===null?$e=Ot:an.sibling=Ot,an=Ot);return d&&Qe.forEach(function(Jo){return g(Q,Jo)}),$e}return function(Q,X,le,Oe){var $e=typeof le=="object"&&le!==null&&le.type===p&&le.key===null;$e&&(le=le.props.children);var an=typeof le=="object"&&le!==null;if(an)switch(le.$$typeof){case u:e:{for(an=le.key,$e=X;$e!==null;){if($e.key===an){switch($e.tag){case 7:if(le.type===p){v(Q,$e.sibling),X=b($e,le.props.children),X.return=Q,Q=X;break e}break;default:if($e.elementType===le.type){v(Q,$e.sibling),X=b($e,le.props),X.ref=Kc(Q,$e,le),X.return=Q,Q=X;break e}}v(Q,$e);break}else g(Q,$e);$e=$e.sibling}le.type===p?(X=Yo(le.props.children,Q.mode,Oe,le.key),X.return=Q,Q=X):(Oe=oh(le.type,le.key,le.props,null,Q.mode,Oe),Oe.ref=Kc(Q,X,le),Oe.return=Q,Q=Oe)}return z(Q);case h:e:{for($e=le.key;X!==null;){if(X.key===$e)if(X.tag===4&&X.stateNode.containerInfo===le.containerInfo&&X.stateNode.implementation===le.implementation){v(Q,X.sibling),X=b(X,le.children||[]),X.return=Q,Q=X;break e}else{v(Q,X);break}else g(Q,X);X=X.sibling}X=mo(le,Q.mode,Oe),X.return=Q,Q=X}return z(Q)}if(typeof le=="string"||typeof le=="number")return le=""+le,X!==null&&X.tag===6?(v(Q,X.sibling),X=b(X,le),X.return=Q,Q=X):(v(Q,X),X=fr(le,Q.mode,Oe),X.return=Q,Q=X),z(Q);if(_l(le))return Rr(Q,X,le,Oe);if(N(le))return Gn(Q,X,le,Oe);if(an&&vl(Q,le),typeof le>"u"&&!$e)switch(Q.tag){case 1:case 0:throw Q=Q.type,Error(o(152,Q.displayName||Q.name||"Component"))}return v(Q,X)}}var Eu=z_(!0),Op=z_(!1),Tu={},Zr={current:Tu},Su={current:Tu},Cu={current:Tu};function fo(d){if(d===Tu)throw Error(o(174));return d}function Np(d,g){bt(Cu,g),bt(Su,d),bt(Zr,Tu),d=se(g),Rt(Zr),bt(Zr,d)}function Iu(){Rt(Zr),Rt(Su),Rt(Cu)}function zp(d){var g=fo(Cu.current),v=fo(Zr.current);g=Z(v,d.type,g),v!==g&&(bt(Su,d),bt(Zr,g))}function Bf(d){Su.current===d&&(Rt(Zr),Rt(Su))}var xn={current:0};function Ru(d){for(var g=d;g!==null;){if(g.tag===13){var v=g.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||bn(v)||lr(v)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.effectTag&64)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function Up(d,g){return{responder:d,props:g}}var Yc=a.ReactCurrentDispatcher,cr=a.ReactCurrentBatchConfig,Bo=0,ai=null,Ai=null,ki=null,bu=!1;function Qr(){throw Error(o(321))}function Vf(d,g){if(g===null)return!1;for(var v=0;v<g.length&&v<d.length;v++)if(!qr(d[v],g[v]))return!1;return!0}function Zc(d,g,v,S,b,D){if(Bo=D,ai=g,g.memoizedState=null,g.updateQueue=null,g.expirationTime=0,Yc.current=d===null||d.memoizedState===null?ST:hn,d=v(S,b),g.expirationTime===Bo){D=0;do{if(g.expirationTime=0,!(25>D))throw Error(o(301));D+=1,ki=Ai=null,g.updateQueue=null,Yc.current=on,d=v(S,b)}while(g.expirationTime===Bo)}if(Yc.current=Kf,g=Ai!==null&&Ai.next!==null,Bo=0,ki=Ai=ai=null,bu=!1,g)throw Error(o(300));return d}function ba(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?ai.memoizedState=ki=d:ki=ki.next=d,ki}function Ms(){if(Ai===null){var d=ai.alternate;d=d!==null?d.memoizedState:null}else d=Ai.next;var g=ki===null?ai.memoizedState:ki.next;if(g!==null)ki=g,Ai=d;else{if(d===null)throw Error(o(310));Ai=d,d={memoizedState:Ai.memoizedState,baseState:Ai.baseState,baseQueue:Ai.baseQueue,queue:Ai.queue,next:null},ki===null?ai.memoizedState=ki=d:ki=ki.next=d}return ki}function Aa(d,g){return typeof g=="function"?g(d):g}function Qc(d){var g=Ms(),v=g.queue;if(v===null)throw Error(o(311));v.lastRenderedReducer=d;var S=Ai,b=S.baseQueue,D=v.pending;if(D!==null){if(b!==null){var z=b.next;b.next=D.next,D.next=z}S.baseQueue=b=D,v.pending=null}if(b!==null){b=b.next,S=S.baseState;var re=z=D=null,Se=b;do{var Pe=Se.expirationTime;if(Pe<Bo){var qt={expirationTime:Se.expirationTime,suspenseConfig:Se.suspenseConfig,action:Se.action,eagerReducer:Se.eagerReducer,eagerState:Se.eagerState,next:null};re===null?(z=re=qt,D=S):re=re.next=qt,Pe>ai.expirationTime&&(ai.expirationTime=Pe,Mu(Pe))}else re!==null&&(re=re.next={expirationTime:1073741823,suspenseConfig:Se.suspenseConfig,action:Se.action,eagerReducer:Se.eagerReducer,eagerState:Se.eagerState,next:null}),fv(Pe,Se.suspenseConfig),S=Se.eagerReducer===d?Se.eagerState:d(S,Se.action);Se=Se.next}while(Se!==null&&Se!==b);re===null?D=S:re.next=z,qr(S,g.memoizedState)||(qi=!0),g.memoizedState=S,g.baseState=D,g.baseQueue=re,v.lastRenderedState=S}return[g.memoizedState,v.dispatch]}function $f(d){var g=Ms(),v=g.queue;if(v===null)throw Error(o(311));v.lastRenderedReducer=d;var S=v.dispatch,b=v.pending,D=g.memoizedState;if(b!==null){v.pending=null;var z=b=b.next;do D=d(D,z.action),z=z.next;while(z!==b);qr(D,g.memoizedState)||(qi=!0),g.memoizedState=D,g.baseQueue===null&&(g.baseState=D),v.lastRenderedState=D}return[D,S]}function Wf(d){var g=ba();return typeof d=="function"&&(d=d()),g.memoizedState=g.baseState=d,d=g.queue={pending:null,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:d},d=d.dispatch=$_.bind(null,ai,d),[g.memoizedState,d]}function Hf(d,g,v,S){return d={tag:d,create:g,destroy:v,deps:S,next:null},g=ai.updateQueue,g===null?(g={lastEffect:null},ai.updateQueue=g,g.lastEffect=d.next=d):(v=g.lastEffect,v===null?g.lastEffect=d.next=d:(S=v.next,v.next=d,d.next=S,g.lastEffect=d)),d}function Gp(){return Ms().memoizedState}function Xf(d,g,v,S){var b=ba();ai.effectTag|=d,b.memoizedState=Hf(1|g,v,void 0,S===void 0?null:S)}function jp(d,g,v,S){var b=Ms();S=S===void 0?null:S;var D=void 0;if(Ai!==null){var z=Ai.memoizedState;if(D=z.destroy,S!==null&&Vf(S,z.deps)){Hf(g,v,D,S);return}}ai.effectTag|=d,b.memoizedState=Hf(1|g,v,D,S)}function U_(d,g){return Xf(516,4,d,g)}function qf(d,g){return jp(516,4,d,g)}function Bp(d,g){return jp(4,2,d,g)}function G_(d,g){if(typeof g=="function")return d=d(),g(d),function(){g(null)};if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function j_(d,g,v){return v=v!=null?v.concat([d]):null,jp(4,2,G_.bind(null,g,d),v)}function Vp(){}function B_(d,g){return ba().memoizedState=[d,g===void 0?null:g],d}function Au(d,g){var v=Ms();g=g===void 0?null:g;var S=v.memoizedState;return S!==null&&g!==null&&Vf(g,S[1])?S[0]:(v.memoizedState=[d,g],d)}function V_(d,g){var v=Ms();g=g===void 0?null:g;var S=v.memoizedState;return S!==null&&g!==null&&Vf(g,S[1])?S[0]:(d=d(),v.memoizedState=[d,g],d)}function $p(d,g,v){var S=uo();Ri(98>S?98:S,function(){d(!0)}),Ri(97<S?97:S,function(){var b=cr.suspense;cr.suspense=g===void 0?null:g;try{d(!1),v()}finally{cr.suspense=b}})}function $_(d,g,v){var S=Ns(),b=qc.suspense;S=zs(S,d,b),b={expirationTime:S,suspenseConfig:b,action:v,eagerReducer:null,eagerState:null,next:null};var D=g.pending;if(D===null?b.next=b:(b.next=D.next,D.next=b),g.pending=b,D=d.alternate,d===ai||D!==null&&D===ai)bu=!0,b.expirationTime=Bo,ai.expirationTime=Bo;else{if(d.expirationTime===0&&(D===null||D.expirationTime===0)&&(D=g.lastRenderedReducer,D!==null))try{var z=g.lastRenderedState,re=D(z,v);if(b.eagerReducer=D,b.eagerState=re,qr(re,z))return}catch{}finally{}po(d,S)}}var Kf={readContext:fs,useCallback:Qr,useContext:Qr,useEffect:Qr,useImperativeHandle:Qr,useLayoutEffect:Qr,useMemo:Qr,useReducer:Qr,useRef:Qr,useState:Qr,useDebugValue:Qr,useResponder:Qr,useDeferredValue:Qr,useTransition:Qr},ST={readContext:fs,useCallback:B_,useContext:fs,useEffect:U_,useImperativeHandle:function(d,g,v){return v=v!=null?v.concat([d]):null,Xf(4,2,G_.bind(null,g,d),v)},useLayoutEffect:function(d,g){return Xf(4,2,d,g)},useMemo:function(d,g){var v=ba();return g=g===void 0?null:g,d=d(),v.memoizedState=[d,g],d},useReducer:function(d,g,v){var S=ba();return g=v!==void 0?v(g):g,S.memoizedState=S.baseState=g,d=S.queue={pending:null,dispatch:null,lastRenderedReducer:d,lastRenderedState:g},d=d.dispatch=$_.bind(null,ai,d),[S.memoizedState,d]},useRef:function(d){var g=ba();return d={current:d},g.memoizedState=d},useState:Wf,useDebugValue:Vp,useResponder:Up,useDeferredValue:function(d,g){var v=Wf(d),S=v[0],b=v[1];return U_(function(){var D=cr.suspense;cr.suspense=g===void 0?null:g;try{b(d)}finally{cr.suspense=D}},[d,g]),S},useTransition:function(d){var g=Wf(!1),v=g[0];return g=g[1],[B_($p.bind(null,g,d),[g,d]),v]}},hn={readContext:fs,useCallback:Au,useContext:fs,useEffect:qf,useImperativeHandle:j_,useLayoutEffect:Bp,useMemo:V_,useReducer:Qc,useRef:Gp,useState:function(){return Qc(Aa)},useDebugValue:Vp,useResponder:Up,useDeferredValue:function(d,g){var v=Qc(Aa),S=v[0],b=v[1];return qf(function(){var D=cr.suspense;cr.suspense=g===void 0?null:g;try{b(d)}finally{cr.suspense=D}},[d,g]),S},useTransition:function(d){var g=Qc(Aa),v=g[0];return g=g[1],[Au($p.bind(null,g,d),[g,d]),v]}},on={readContext:fs,useCallback:Au,useContext:fs,useEffect:qf,useImperativeHandle:j_,useLayoutEffect:Bp,useMemo:V_,useReducer:$f,useRef:Gp,useState:function(){return $f(Aa)},useDebugValue:Vp,useResponder:Up,useDeferredValue:function(d,g){var v=$f(Aa),S=v[0],b=v[1];return qf(function(){var D=cr.suspense;cr.suspense=g===void 0?null:g;try{b(d)}finally{cr.suspense=D}},[d,g]),S},useTransition:function(d){var g=$f(Aa),v=g[0];return g=g[1],[Au($p.bind(null,g,d),[g,d]),v]}},Vo=null,xl=null,wl=!1;function W_(d,g){var v=Un(5,null,null,0);v.elementType="DELETED",v.type="DELETED",v.stateNode=g,v.return=d,v.effectTag=8,d.lastEffect!==null?(d.lastEffect.nextEffect=v,d.lastEffect=v):d.firstEffect=d.lastEffect=v}function H_(d,g){switch(d.tag){case 5:return g=Dn(g,d.type,d.pendingProps),g!==null?(d.stateNode=g,!0):!1;case 6:return g=ar(g,d.pendingProps),g!==null?(d.stateNode=g,!0):!1;case 13:return!1;default:return!1}}function Wp(d){if(wl){var g=xl;if(g){var v=g;if(!H_(d,g)){if(g=ni(v),!g||!H_(d,g)){d.effectTag=d.effectTag&-1025|2,wl=!1,Vo=d;return}W_(Vo,v)}Vo=d,xl=ii(g)}else d.effectTag=d.effectTag&-1025|2,wl=!1,Vo=d}}function Hp(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Vo=d}function Yf(d){if(!ct||d!==Vo)return!1;if(!wl)return Hp(d),wl=!0,!1;var g=d.type;if(d.tag!==5||g!=="head"&&g!=="body"&&!H(g,d.memoizedProps))for(g=xl;g;)W_(d,g),g=ni(g);if(Hp(d),d.tag===13){if(!ct)throw Error(o(316));if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(o(317));xl=io(d)}else xl=Vo?ni(d.stateNode):null;return!0}function li(){ct&&(xl=Vo=null,wl=!1)}var Xp=a.ReactCurrentOwner,qi=!1;function Sr(d,g,v,S){g.child=d===null?Op(g,null,v,S):Eu(g,d.child,v,S)}function Zf(d,g,v,S,b){v=v.render;var D=g.ref;return Ca(g,b),S=Zc(d,g,v,S,D,b),d!==null&&!qi?(g.updateQueue=d.updateQueue,g.effectTag&=-517,d.expirationTime<=b&&(d.expirationTime=0),Cr(d,g,b)):(g.effectTag|=1,Sr(d,g,S,b),g.child)}function Jr(d,g,v,S,b,D){if(d===null){var z=v.type;return typeof z=="function"&&!gm(z)&&z.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(g.tag=15,g.type=z,qp(d,g,z,S,b,D)):(d=oh(v.type,null,S,null,g.mode,D),d.ref=g.ref,d.return=g,g.child=d)}return z=d.child,b<D&&(b=z.memoizedProps,v=v.compare,v=v!==null?v:Tr,v(b,S)&&d.ref===g.ref)?Cr(d,g,D):(g.effectTag|=1,d=Ko(z,S),d.ref=g.ref,d.return=g,g.child=d)}function qp(d,g,v,S,b,D){return d!==null&&Tr(d.memoizedProps,S)&&d.ref===g.ref&&(qi=!1,b<D)?(g.expirationTime=d.expirationTime,Cr(d,g,D)):Qf(d,g,v,S,D)}function Kp(d,g){var v=g.ref;(d===null&&v!==null||d!==null&&d.ref!==v)&&(g.effectTag|=128)}function Qf(d,g,v,S,b){var D=vn(v)?Si:Pt.current;return D=so(g,D),Ca(g,b),v=Zc(d,g,v,S,D,b),d!==null&&!qi?(g.updateQueue=d.updateQueue,g.effectTag&=-517,d.expirationTime<=b&&(d.expirationTime=0),Cr(d,g,b)):(g.effectTag|=1,Sr(d,g,v,b),g.child)}function Yp(d,g,v,S,b){if(vn(v)){var D=!0;Ls(g)}else D=!1;if(Ca(g,b),g.stateNode===null)d!==null&&(d.alternate=null,g.alternate=null,g.effectTag|=2),O_(g,v,S),Fp(g,v,S,b),S=!0;else if(d===null){var z=g.stateNode,re=g.memoizedProps;z.props=re;var Se=z.context,Pe=v.contextType;typeof Pe=="object"&&Pe!==null?Pe=fs(Pe):(Pe=vn(v)?Si:Pt.current,Pe=so(g,Pe));var qt=v.getDerivedStateFromProps,nt=typeof qt=="function"||typeof z.getSnapshotBeforeUpdate=="function";nt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(re!==S||Se!==Pe)&&N_(g,z,S,Pe),ho=!1;var At=g.memoizedState;z.state=At,Xc(g,S,z,b),Se=g.memoizedState,re!==S||At!==Se||si.current||ho?(typeof qt=="function"&&(Gf(g,v,qt,S),Se=g.memoizedState),(re=ho||F_(g,v,re,S,At,Se,Pe))?(nt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(g.effectTag|=4)):(typeof z.componentDidMount=="function"&&(g.effectTag|=4),g.memoizedProps=S,g.memoizedState=Se),z.props=S,z.state=Se,z.context=Pe,S=re):(typeof z.componentDidMount=="function"&&(g.effectTag|=4),S=!1)}else z=g.stateNode,Mp(d,g),re=g.memoizedProps,z.props=g.type===g.elementType?re:Kr(g.type,re),Se=z.context,Pe=v.contextType,typeof Pe=="object"&&Pe!==null?Pe=fs(Pe):(Pe=vn(v)?Si:Pt.current,Pe=so(g,Pe)),qt=v.getDerivedStateFromProps,(nt=typeof qt=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(re!==S||Se!==Pe)&&N_(g,z,S,Pe),ho=!1,Se=g.memoizedState,z.state=Se,Xc(g,S,z,b),At=g.memoizedState,re!==S||Se!==At||si.current||ho?(typeof qt=="function"&&(Gf(g,v,qt,S),At=g.memoizedState),(qt=ho||F_(g,v,re,S,Se,At,Pe))?(nt||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(S,At,Pe),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(S,At,Pe)),typeof z.componentDidUpdate=="function"&&(g.effectTag|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(g.effectTag|=256)):(typeof z.componentDidUpdate!="function"||re===d.memoizedProps&&Se===d.memoizedState||(g.effectTag|=4),typeof z.getSnapshotBeforeUpdate!="function"||re===d.memoizedProps&&Se===d.memoizedState||(g.effectTag|=256),g.memoizedProps=S,g.memoizedState=At),z.props=S,z.state=At,z.context=Pe,S=qt):(typeof z.componentDidUpdate!="function"||re===d.memoizedProps&&Se===d.memoizedState||(g.effectTag|=4),typeof z.getSnapshotBeforeUpdate!="function"||re===d.memoizedProps&&Se===d.memoizedState||(g.effectTag|=256),S=!1);return Jf(d,g,v,S,D,b)}function Jf(d,g,v,S,b,D){Kp(d,g);var z=(g.effectTag&64)!==0;if(!S&&!z)return b&&pu(g,v,!1),Cr(d,g,D);S=g.stateNode,Xp.current=g;var re=z&&typeof v.getDerivedStateFromError!="function"?null:S.render();return g.effectTag|=1,d!==null&&z?(g.child=Eu(g,d.child,null,D),g.child=Eu(g,null,re,D)):Sr(d,g,re,D),g.memoizedState=S.state,b&&pu(g,v,!0),g.child}function Zp(d){var g=d.stateNode;g.pendingContext?gu(d,g.pendingContext,g.pendingContext!==g.context):g.context&&gu(d,g.context,!1),Np(d,g.containerInfo)}var Qp={dehydrated:null,retryTime:0};function X_(d,g,v){var S=g.mode,b=g.pendingProps,D=xn.current,z=!1,re;if((re=(g.effectTag&64)!==0)||(re=(D&2)!==0&&(d===null||d.memoizedState!==null)),re?(z=!0,g.effectTag&=-65):d!==null&&d.memoizedState===null||b.fallback===void 0||b.unstable_avoidThisFallback===!0||(D|=1),bt(xn,D&1),d===null){if(b.fallback!==void 0&&Wp(g),z){if(z=b.fallback,b=Yo(null,S,0,null),b.return=g,!(g.mode&2))for(d=g.memoizedState!==null?g.child.child:g.child,b.child=d;d!==null;)d.return=b,d=d.sibling;return v=Yo(z,S,v,null),v.return=g,b.sibling=v,g.memoizedState=Qp,g.child=b,v}return S=b.children,g.memoizedState=null,g.child=Op(g,null,S,v)}if(d.memoizedState!==null){if(d=d.child,S=d.sibling,z){if(b=b.fallback,v=Ko(d,d.pendingProps),v.return=g,!(g.mode&2)&&(z=g.memoizedState!==null?g.child.child:g.child,z!==d.child))for(v.child=z;z!==null;)z.return=v,z=z.sibling;return S=Ko(S,b),S.return=g,v.sibling=S,v.childExpirationTime=0,g.memoizedState=Qp,g.child=v,S}return v=Eu(g,d.child,b.children,v),g.memoizedState=null,g.child=v}if(d=d.child,z){if(z=b.fallback,b=Yo(null,S,0,null),b.return=g,b.child=d,d!==null&&(d.return=b),!(g.mode&2))for(d=g.memoizedState!==null?g.child.child:g.child,b.child=d;d!==null;)d.return=b,d=d.sibling;return v=Yo(z,S,v,null),v.return=g,b.sibling=v,v.effectTag|=2,b.childExpirationTime=0,g.memoizedState=Qp,g.child=b,v}return g.memoizedState=null,g.child=Eu(g,d,b.children,v)}function q_(d,g){d.expirationTime<g&&(d.expirationTime=g);var v=d.alternate;v!==null&&v.expirationTime<g&&(v.expirationTime=g),L_(d.return,g)}function Jp(d,g,v,S,b,D){var z=d.memoizedState;z===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:S,tail:v,tailExpiration:0,tailMode:b,lastEffect:D}:(z.isBackwards=g,z.rendering=null,z.renderingStartTime=0,z.last=S,z.tail=v,z.tailExpiration=0,z.tailMode=b,z.lastEffect=D)}function K_(d,g,v){var S=g.pendingProps,b=S.revealOrder,D=S.tail;if(Sr(d,g,S.children,v),S=xn.current,S&2)S=S&1|2,g.effectTag|=64;else{if(d!==null&&d.effectTag&64)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&q_(d,v);else if(d.tag===19)q_(d,v);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}S&=1}if(bt(xn,S),!(g.mode&2))g.memoizedState=null;else switch(b){case"forwards":for(v=g.child,b=null;v!==null;)d=v.alternate,d!==null&&Ru(d)===null&&(b=v),v=v.sibling;v=b,v===null?(b=g.child,g.child=null):(b=v.sibling,v.sibling=null),Jp(g,!1,b,v,D,g.lastEffect);break;case"backwards":for(v=null,b=g.child,g.child=null;b!==null;){if(d=b.alternate,d!==null&&Ru(d)===null){g.child=b;break}d=b.sibling,b.sibling=v,v=b,b=d}Jp(g,!0,v,null,D,g.lastEffect);break;case"together":Jp(g,!1,null,null,void 0,g.lastEffect);break;default:g.memoizedState=null}return g.child}function Cr(d,g,v){d!==null&&(g.dependencies=d.dependencies);var S=g.expirationTime;if(S!==0&&Mu(S),g.childExpirationTime<v)return null;if(d!==null&&g.child!==d.child)throw Error(o(153));if(g.child!==null){for(d=g.child,v=Ko(d,d.pendingProps),g.child=v,v.return=g;d.sibling!==null;)d=d.sibling,v=v.sibling=Ko(d,d.pendingProps),v.return=g;v.sibling=null}return g.child}function W(d){d.effectTag|=4}var ae,k,ke,Be;if(rt)ae=function(d,g){for(var v=g.child;v!==null;){if(v.tag===5||v.tag===6)j(d,v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===g)break;for(;v.sibling===null;){if(v.return===null||v.return===g)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},k=function(){},ke=function(d,g,v,S,b){if(d=d.memoizedProps,d!==S){var D=g.stateNode,z=fo(Zr.current);v=q(D,v,d,S,b,z),(g.updateQueue=v)&&W(g)}},Be=function(d,g,v,S){v!==S&&W(g)};else if(ut){ae=function(d,g,v,S){for(var b=g.child;b!==null;){if(b.tag===5){var D=b.stateNode;v&&S&&(D=or(D,b.type,b.memoizedProps,b)),j(d,D)}else if(b.tag===6)D=b.stateNode,v&&S&&(D=no(D,b.memoizedProps,b)),j(d,D);else if(b.tag!==4){if(b.tag===13&&b.effectTag&4&&(D=b.memoizedState!==null)){var z=b.child;if(z!==null&&(z.child!==null&&(z.child.return=z,ae(d,z,!0,D)),D=z.sibling,D!==null)){D.return=b,b=D;continue}}if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};var Fe=function(d,g,v,S){for(var b=g.child;b!==null;){if(b.tag===5){var D=b.stateNode;v&&S&&(D=or(D,b.type,b.memoizedProps,b)),Xt(d,D)}else if(b.tag===6)D=b.stateNode,v&&S&&(D=no(D,b.memoizedProps,b)),Xt(d,D);else if(b.tag!==4){if(b.tag===13&&b.effectTag&4&&(D=b.memoizedState!==null)){var z=b.child;if(z!==null&&(z.child!==null&&(z.child.return=z,Fe(d,z,!0,D)),D=z.sibling,D!==null)){D.return=b,b=D;continue}}if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};k=function(d){var g=d.stateNode;if(d.firstEffect!==null){var v=g.containerInfo,S=sr(v);Fe(S,d,!1,!1),g.pendingChildren=S,W(d),cn(v,S)}},ke=function(d,g,v,S,b){var D=d.stateNode,z=d.memoizedProps;if((d=g.firstEffect===null)&&z===S)g.stateNode=D;else{var re=g.stateNode,Se=fo(Zr.current),Pe=null;z!==S&&(Pe=q(re,v,z,S,b,Se)),d&&Pe===null?g.stateNode=D:(D=Ft(D,Pe,v,z,S,g,d,re),ie(D,v,S,b,Se)&&W(g),g.stateNode=D,d?W(g):ae(D,g,!1,!1))}},Be=function(d,g,v,S){v!==S?(d=fo(Cu.current),v=fo(Zr.current),g.stateNode=ue(S,d,v,g),W(g)):g.stateNode=d.stateNode}}else k=function(){},ke=function(){},Be=function(){};function Pi(d,g){switch(d.tailMode){case"hidden":g=d.tail;for(var v=null;g!==null;)g.alternate!==null&&(v=g),g=g.sibling;v===null?d.tail=null:v.sibling=null;break;case"collapsed":v=d.tail;for(var S=null;v!==null;)v.alternate!==null&&(S=v),v=v.sibling;S===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:S.sibling=null}}function em(d,g,v){var S=g.pendingProps;switch(g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return vn(g.type)&&Hr(),null;case 3:return Iu(),Rt(si),Rt(Pt),S=g.stateNode,S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(d===null||d.child===null)&&Yf(g)&&W(g),k(g),null;case 5:Bf(g);var b=fo(Cu.current);if(v=g.type,d!==null&&g.stateNode!=null)ke(d,g,v,S,b),d.ref!==g.ref&&(g.effectTag|=128);else{if(!S){if(g.stateNode===null)throw Error(o(166));return null}if(d=fo(Zr.current),Yf(g)){if(!ct)throw Error(o(175));d=Ps(g.stateNode,g.type,g.memoizedProps,b,d,g),g.updateQueue=d,d!==null&&W(g)}else{var D=ee(v,S,b,d,g);ae(D,g,!1,!1),g.stateNode=D,ie(D,v,S,b,d)&&W(g)}g.ref!==null&&(g.effectTag|=128)}return null;case 6:if(d&&g.stateNode!=null)Be(d,g,d.memoizedProps,S);else{if(typeof S!="string"&&g.stateNode===null)throw Error(o(166));if(d=fo(Cu.current),b=fo(Zr.current),Yf(g)){if(!ct)throw Error(o(176));zo(g.stateNode,g.memoizedProps,g)&&W(g)}else g.stateNode=ue(S,d,b,g)}return null;case 13:return Rt(xn),S=g.memoizedState,g.effectTag&64?(g.expirationTime=v,g):(S=S!==null,b=!1,d===null?g.memoizedProps.fallback!==void 0&&Yf(g):(v=d.memoizedState,b=v!==null,S||v===null||(v=d.child.sibling,v!==null&&(D=g.firstEffect,D!==null?(g.firstEffect=v,v.nextEffect=D):(g.firstEffect=g.lastEffect=v,v.nextEffect=null),v.effectTag=8))),S&&!b&&g.mode&2&&(d===null&&g.memoizedProps.unstable_avoidThisFallback!==!0||xn.current&1?gi===Xo&&(gi=id):((gi===Xo||gi===id)&&(gi=eh),Pa!==0&&hr!==null&&(yo(hr,fn),ym(hr,Pa)))),ut&&S&&(g.effectTag|=4),rt&&(S||b)&&(g.effectTag|=4),null);case 4:return Iu(),k(g),null;case 10:return Pp(g),null;case 17:return vn(g.type)&&Hr(),null;case 19:if(Rt(xn),S=g.memoizedState,S===null)return null;if(b=(g.effectTag&64)!==0,D=S.rendering,D===null){if(b)Pi(S,!1);else if(gi!==Xo||d!==null&&d.effectTag&64)for(d=g.child;d!==null;){if(D=Ru(d),D!==null){for(g.effectTag|=64,Pi(S,!1),d=D.updateQueue,d!==null&&(g.updateQueue=d,g.effectTag|=4),S.lastEffect===null&&(g.firstEffect=null),g.lastEffect=S.lastEffect,d=v,S=g.child;S!==null;)b=S,v=d,b.effectTag&=2,b.nextEffect=null,b.firstEffect=null,b.lastEffect=null,D=b.alternate,D===null?(b.childExpirationTime=0,b.expirationTime=v,b.child=null,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null):(b.childExpirationTime=D.childExpirationTime,b.expirationTime=D.expirationTime,b.child=D.child,b.memoizedProps=D.memoizedProps,b.memoizedState=D.memoizedState,b.updateQueue=D.updateQueue,v=D.dependencies,b.dependencies=v===null?null:{expirationTime:v.expirationTime,firstContext:v.firstContext,responders:v.responders}),S=S.sibling;return bt(xn,xn.current&1|2),g.child}d=d.sibling}}else{if(!b)if(d=Ru(D),d!==null){if(g.effectTag|=64,b=!0,d=d.updateQueue,d!==null&&(g.updateQueue=d,g.effectTag|=4),Pi(S,!0),S.tail===null&&S.tailMode==="hidden"&&!D.alternate)return g=g.lastEffect=S.lastEffect,g!==null&&(g.nextEffect=null),null}else 2*Ii()-S.renderingStartTime>S.tailExpiration&&1<v&&(g.effectTag|=64,b=!0,Pi(S,!1),g.expirationTime=g.childExpirationTime=v-1);S.isBackwards?(D.sibling=g.child,g.child=D):(d=S.last,d!==null?d.sibling=D:g.child=D,S.last=D)}return S.tail!==null?(S.tailExpiration===0&&(S.tailExpiration=Ii()+500),d=S.tail,S.rendering=d,S.tail=d.sibling,S.lastEffect=g.lastEffect,S.renderingStartTime=Ii(),d.sibling=null,g=xn.current,bt(xn,b?g&1|2:g&1),d):null}throw Error(o(156,g.tag))}function CT(d){switch(d.tag){case 1:vn(d.type)&&Hr();var g=d.effectTag;return g&4096?(d.effectTag=g&-4097|64,d):null;case 3:if(Iu(),Rt(si),Rt(Pt),g=d.effectTag,g&64)throw Error(o(285));return d.effectTag=g&-4097|64,d;case 5:return Bf(d),null;case 13:return Rt(xn),g=d.effectTag,g&4096?(d.effectTag=g&-4097|64,d):null;case 19:return Rt(xn),null;case 4:return Iu(),null;case 10:return Pp(d),null;default:return null}}function $o(d,g){return{value:d,source:g,stack:Ti(g)}}var IT=typeof WeakSet=="function"?WeakSet:Set;function tm(d,g){var v=g.source,S=g.stack;S===null&&v!==null&&(S=Ti(v)),v!==null&&V(v.type),g=g.value,d!==null&&d.tag===1&&V(d.type);try{console.error(g)}catch(b){setTimeout(function(){throw b})}}function RT(d,g){try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(v){Da(d,v)}}function Y_(d){var g=d.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(v){Da(d,v)}else g.current=null}function bT(d,g){switch(g.tag){case 0:case 11:case 15:case 22:return;case 1:if(g.effectTag&256&&d!==null){var v=d.memoizedProps,S=d.memoizedState;d=g.stateNode,g=d.getSnapshotBeforeUpdate(g.elementType===g.type?v:Kr(g.type,v),S),d.__reactInternalSnapshotBeforeUpdate=g}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(o(163))}function Ds(d,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&d)===d){var S=v.destroy;v.destroy=void 0,S!==void 0&&S()}v=v.next}while(v!==g)}}function Z_(d,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&d)===d){var S=v.create;v.destroy=S()}v=v.next}while(v!==g)}}function AT(d,g,v){switch(v.tag){case 0:case 11:case 15:case 22:Z_(3,v);return;case 1:if(d=v.stateNode,v.effectTag&4)if(g===null)d.componentDidMount();else{var S=v.elementType===v.type?g.memoizedProps:Kr(v.type,g.memoizedProps);d.componentDidUpdate(S,g.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}g=v.updateQueue,g!==null&&D_(v,g,d);return;case 3:if(g=v.updateQueue,g!==null){if(d=null,v.child!==null)switch(v.child.tag){case 5:d=_e(v.child.stateNode);break;case 1:d=v.child.stateNode}D_(v,g,d)}return;case 5:d=v.stateNode,g===null&&v.effectTag&4&&Ie(d,v.type,v.memoizedProps,v);return;case 6:return;case 4:return;case 12:return;case 13:ct&&v.memoizedState===null&&(v=v.alternate,v!==null&&(v=v.memoizedState,v!==null&&(v=v.dehydrated,v!==null&&ro(v))));return;case 19:case 17:case 20:case 21:return}throw Error(o(163))}function Q_(d,g,v){switch(typeof dm=="function"&&dm(g),g.tag){case 0:case 11:case 14:case 15:case 22:if(d=g.updateQueue,d!==null&&(d=d.lastEffect,d!==null)){var S=d.next;Ri(97<v?97:v,function(){var b=S;do{var D=b.destroy;if(D!==void 0){var z=g;try{D()}catch(re){Da(z,re)}}b=b.next}while(b!==S)})}break;case 1:Y_(g),v=g.stateNode,typeof v.componentWillUnmount=="function"&&RT(g,v);break;case 5:Y_(g);break;case 4:rt?iv(d,g,v):ut&&Wo(g)}}function J_(d,g,v){for(var S=g;;)if(Q_(d,S,v),S.child===null||rt&&S.tag===4){if(S===g)break;for(;S.sibling===null;){if(S.return===null||S.return===g)return;S=S.return}S.sibling.return=S.return,S=S.sibling}else S.child.return=S,S=S.child}function ev(d){var g=d.alternate;d.return=null,d.child=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.alternate=null,d.firstEffect=null,d.lastEffect=null,d.pendingProps=null,d.memoizedProps=null,d.stateNode=null,g!==null&&ev(g)}function Wo(d){if(ut){d=d.stateNode.containerInfo;var g=sr(d);ti(d,g)}}function tv(d){return d.tag===5||d.tag===3||d.tag===4}function nv(d){if(rt){e:{for(var g=d.return;g!==null;){if(tv(g)){var v=g;break e}g=g.return}throw Error(o(160))}switch(g=v.stateNode,v.tag){case 5:var S=!1;break;case 3:g=g.containerInfo,S=!0;break;case 4:g=g.containerInfo,S=!0;break;default:throw Error(o(161))}v.effectTag&16&&(yn(g),v.effectTag&=-17);e:t:for(v=d;;){for(;v.sibling===null;){if(v.return===null||tv(v.return)){v=null;break e}v=v.return}for(v.sibling.return=v.return,v=v.sibling;v.tag!==5&&v.tag!==6&&v.tag!==18;){if(v.effectTag&2||v.child===null||v.tag===4)continue t;v.child.return=v,v=v.child}if(!(v.effectTag&2)){v=v.stateNode;break e}}S?nm(d,v,g):im(d,v,g)}}function nm(d,g,v){var S=d.tag,b=S===5||S===6;if(b)d=b?d.stateNode:d.stateNode.instance,g?ks(v,d,g):Mn(v,d);else if(S!==4&&(d=d.child,d!==null))for(nm(d,g,v),d=d.sibling;d!==null;)nm(d,g,v),d=d.sibling}function im(d,g,v){var S=d.tag,b=S===5||S===6;if(b)d=b?d.stateNode:d.stateNode.instance,g?Wr(v,d,g):rr(v,d);else if(S!==4&&(d=d.child,d!==null))for(im(d,g,v),d=d.sibling;d!==null;)im(d,g,v),d=d.sibling}function iv(d,g,v){for(var S=g,b=!1,D,z;;){if(!b){b=S.return;e:for(;;){if(b===null)throw Error(o(160));switch(D=b.stateNode,b.tag){case 5:z=!1;break e;case 3:D=D.containerInfo,z=!0;break e;case 4:D=D.containerInfo,z=!0;break e}b=b.return}b=!0}if(S.tag===5||S.tag===6)J_(d,S,v),z?Wt(D,S.stateNode):ei(D,S.stateNode);else if(S.tag===4){if(S.child!==null){D=S.stateNode.containerInfo,z=!0,S.child.return=S,S=S.child;continue}}else if(Q_(d,S,v),S.child!==null){S.child.return=S,S=S.child;continue}if(S===g)break;for(;S.sibling===null;){if(S.return===null||S.return===g)return;S=S.return,S.tag===4&&(b=!1)}S.sibling.return=S.return,S=S.sibling}}function Ho(d,g){if(rt){switch(g.tag){case 0:case 11:case 14:case 15:case 22:Ds(3,g);return;case 1:return;case 5:var v=g.stateNode;if(v!=null){var S=g.memoizedProps;d=d!==null?d.memoizedProps:S;var b=g.type,D=g.updateQueue;g.updateQueue=null,D!==null&&U(v,D,b,d,S,g)}return;case 6:if(g.stateNode===null)throw Error(o(162));v=g.memoizedProps,$i(g.stateNode,d!==null?d.memoizedProps:v,v);return;case 3:ct&&(g=g.stateNode,g.hydrate&&(g.hydrate=!1,_n(g.containerInfo)));return;case 12:return;case 13:rv(g),ed(g);return;case 19:ed(g);return;case 17:return}throw Error(o(163))}switch(g.tag){case 0:case 11:case 14:case 15:case 22:Ds(3,g);return;case 12:return;case 13:rv(g),ed(g);return;case 19:ed(g);return;case 3:ct&&(v=g.stateNode,v.hydrate&&(v.hydrate=!1,_n(v.containerInfo)))}e:if(ut){switch(g.tag){case 1:case 5:case 6:case 20:break e;case 3:case 4:g=g.stateNode,ti(g.containerInfo,g.pendingChildren);break e}throw Error(o(163))}}function rv(d){var g=d;if(d.memoizedState===null)var v=!1;else v=!0,g=d.child,od=Ii();if(rt&&g!==null){e:if(d=g,rt)for(g=d;;){if(g.tag===5){var S=g.stateNode;v?Wi(S):Hi(g.stateNode,g.memoizedProps)}else if(g.tag===6)S=g.stateNode,v?cs(S):Rn(S,g.memoizedProps);else if(g.tag===13&&g.memoizedState!==null&&g.memoizedState.dehydrated===null){S=g.child.sibling,S.return=g,g=S;continue}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break e;for(;g.sibling===null;){if(g.return===null||g.return===d)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}}}function ed(d){var g=d.updateQueue;if(g!==null){d.updateQueue=null;var v=d.stateNode;v===null&&(v=d.stateNode=new IT),g.forEach(function(S){var b=MT.bind(null,d,S);v.has(S)||(v.add(S),S.then(b,b))})}}var Fs=typeof WeakMap=="function"?WeakMap:Map;function sv(d,g,v){v=Ia(v,null),v.tag=3,v.payload={element:null};var S=g.value;return v.callback=function(){ku||(ku=!0,Pu=S),tm(d,g)},v}function ov(d,g,v){v=Ia(v,null),v.tag=3;var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var b=g.value;v.payload=function(){return tm(d,g),S(b)}}var D=d.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(v.callback=function(){typeof S!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this),tm(d,g));var z=g.stack;this.componentDidCatch(g.value,{componentStack:z!==null?z:""})}),v}var kT=Math.ceil,td=a.ReactCurrentDispatcher,av=a.ReactCurrentOwner,zn=0,nd=8,ds=16,Os=32,Xo=0,ka=1,Jc=2,id=3,eh=4,rm=5,Ge=zn,hr=null,tt=null,fn=0,gi=Xo,th=null,go=1073741823,qo=1073741823,rd=null,Pa=0,sd=!1,od=0,pi=500,Me=null,ku=!1,Pu=null,Ir=null,nh=!1,ui=null,El=90,Tl=null,ih=0,sm=null,Lu=0;function Ns(){return(Ge&(ds|Os))!==zn?1073741821-(Ii()/10|0):Lu!==0?Lu:Lu=1073741821-(Ii()/10|0)}function zs(d,g,v){if(g=g.mode,!(g&2))return 1073741823;var S=uo();if(!(g&4))return S===99?1073741823:1073741822;if((Ge&ds)!==zn)return fn;if(v!==null)d=co(d,v.timeoutMs|0||5e3,250);else switch(S){case 99:d=1073741823;break;case 98:d=co(d,150,100);break;case 97:case 96:d=co(d,5e3,250);break;case 95:d=2;break;default:throw Error(o(326))}return hr!==null&&d===fn&&--d,d}function po(d,g){if(50<ih)throw ih=0,sm=null,Error(o(185));if(d=ad(d,g),d!==null){var v=uo();g===1073741823?(Ge&nd)!==zn&&(Ge&(ds|Os))===zn?om(d):(mi(d),Ge===zn&&bi()):mi(d),(Ge&4)===zn||v!==98&&v!==99||(Tl===null?Tl=new Map([[d,g]]):(v=Tl.get(d),(v===void 0||v>g)&&Tl.set(d,g)))}}function ad(d,g){d.expirationTime<g&&(d.expirationTime=g);var v=d.alternate;v!==null&&v.expirationTime<g&&(v.expirationTime=g);var S=d.return,b=null;if(S===null&&d.tag===3)b=d.stateNode;else for(;S!==null;){if(v=S.alternate,S.childExpirationTime<g&&(S.childExpirationTime=g),v!==null&&v.childExpirationTime<g&&(v.childExpirationTime=g),S.return===null&&S.tag===3){b=S.stateNode;break}S=S.return}return b!==null&&(hr===b&&(Mu(g),gi===eh&&yo(b,fn)),ym(b,g)),b}function ld(d){var g=d.lastExpiredTime;if(g!==0||(g=d.firstPendingTime,!mm(d,g)))return g;var v=d.lastPingedTime;return d=d.nextKnownPendingLevel,d=v>d?v:d,2>=d&&g!==d?0:d}function mi(d){if(d.lastExpiredTime!==0)d.callbackExpirationTime=1073741823,d.callbackPriority=99,d.callbackNode=Ta(om.bind(null,d));else{var g=ld(d),v=d.callbackNode;if(g===0)v!==null&&(d.callbackNode=null,d.callbackExpirationTime=0,d.callbackPriority=90);else{var S=Ns();if(g===1073741823?S=99:g===1||g===2?S=95:(S=10*(1073741821-g)-10*(1073741821-S),S=0>=S?99:250>=S?98:5250>=S?97:95),v!==null){var b=d.callbackPriority;if(d.callbackExpirationTime===g&&b>=S)return;v!==Go&&mu(v)}d.callbackExpirationTime=g,d.callbackPriority=S,g=g===1073741823?Ta(om.bind(null,d)):xu(S,lv.bind(null,d),{timeout:10*(1073741821-g)-Ii()}),d.callbackNode=g}}}function lv(d,g){if(Lu=0,g)return g=Ns(),Du(d,g),mi(d),null;var v=ld(d);if(v!==0){if(g=d.callbackNode,(Ge&(ds|Os))!==zn)throw Error(o(327));if(Ma(),d===hr&&v===fn||Sl(d,v),tt!==null){var S=Ge;Ge|=ds;var b=ud();do try{gv();break}catch(re){lm(d,re)}while(1);if(wu(),Ge=S,td.current=b,gi===ka)throw g=th,Sl(d,v),yo(d,v),mi(d),g;if(tt===null)switch(b=d.finishedWork=d.current.alternate,d.finishedExpirationTime=v,S=gi,hr=null,S){case Xo:case ka:throw Error(o(345));case Jc:Du(d,2<v?2:v);break;case id:if(yo(d,v),S=d.lastSuspendedTime,v===S&&(d.nextKnownPendingLevel=cm(b)),go===1073741823&&(b=od+pi-Ii(),10<b)){if(sd){var D=d.lastPingedTime;if(D===0||D>=v){d.lastPingedTime=v,Sl(d,v);break}}if(D=ld(d),D!==0&&D!==v)break;if(S!==0&&S!==v){d.lastPingedTime=S;break}d.timeoutHandle=K(La.bind(null,d),b);break}La(d);break;case eh:if(yo(d,v),S=d.lastSuspendedTime,v===S&&(d.nextKnownPendingLevel=cm(b)),sd&&(b=d.lastPingedTime,b===0||b>=v)){d.lastPingedTime=v,Sl(d,v);break}if(b=ld(d),b!==0&&b!==v)break;if(S!==0&&S!==v){d.lastPingedTime=S;break}if(qo!==1073741823?S=10*(1073741821-qo)-Ii():go===1073741823?S=0:(S=10*(1073741821-go)-5e3,b=Ii(),v=10*(1073741821-v)-b,S=b-S,0>S&&(S=0),S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*kT(S/1960))-S,v<S&&(S=v)),10<S){d.timeoutHandle=K(La.bind(null,d),S);break}La(d);break;case rm:if(go!==1073741823&&rd!==null){D=go;var z=rd;if(S=z.busyMinDurationMs|0,0>=S?S=0:(b=z.busyDelayMs|0,D=Ii()-(10*(1073741821-D)-(z.timeoutMs|0||5e3)),S=D<=b?0:b+S-D),10<S){yo(d,v),d.timeoutHandle=K(La.bind(null,d),S);break}}La(d);break;default:throw Error(o(329))}if(mi(d),d.callbackNode===g)return lv.bind(null,d)}}return null}function om(d){var g=d.lastExpiredTime;if(g=g!==0?g:1073741823,(Ge&(ds|Os))!==zn)throw Error(o(327));if(Ma(),d===hr&&g===fn||Sl(d,g),tt!==null){var v=Ge;Ge|=ds;var S=ud();do try{dv();break}catch(b){lm(d,b)}while(1);if(wu(),Ge=v,td.current=S,gi===ka)throw v=th,Sl(d,g),yo(d,g),mi(d),v;if(tt!==null)throw Error(o(261));d.finishedWork=d.current.alternate,d.finishedExpirationTime=g,hr=null,La(d),mi(d)}return null}function am(d,g){Du(d,g),mi(d),(Ge&(ds|Os))===zn&&bi()}function uv(){if(Tl!==null){var d=Tl;Tl=null,d.forEach(function(g,v){Du(v,g),mi(v)}),bi()}}function cv(d,g){var v=Ge;Ge|=1;try{return d(g)}finally{Ge=v,Ge===zn&&bi()}}function hv(d,g){if((Ge&(ds|Os))!==zn)throw Error(o(187));var v=Ge;Ge|=1;try{return Ri(99,d.bind(null,g))}finally{Ge=v,bi()}}function Sl(d,g){d.finishedWork=null,d.finishedExpirationTime=0;var v=d.timeoutHandle;if(v!==lt&&(d.timeoutHandle=lt,Te(v)),tt!==null)for(v=tt.return;v!==null;){var S=v;switch(S.tag){case 1:S=S.type.childContextTypes,S!=null&&Hr();break;case 3:Iu(),Rt(si),Rt(Pt);break;case 5:Bf(S);break;case 4:Iu();break;case 13:Rt(xn);break;case 19:Rt(xn);break;case 10:Pp(S)}v=v.return}hr=d,tt=Ko(d.current,null),fn=g,gi=Xo,th=null,qo=go=1073741823,rd=null,Pa=0,sd=!1}function lm(d,g){do{try{if(wu(),Yc.current=Kf,bu)for(var v=ai.memoizedState;v!==null;){var S=v.queue;S!==null&&(S.pending=null),v=v.next}if(Bo=0,ki=Ai=ai=null,bu=!1,tt===null||tt.return===null)return gi=ka,th=g,tt=null;e:{var b=d,D=tt.return,z=tt,re=g;if(g=fn,z.effectTag|=2048,z.firstEffect=z.lastEffect=null,re!==null&&typeof re=="object"&&typeof re.then=="function"){var Se=re;if(!(z.mode&2)){var Pe=z.alternate;Pe?(z.updateQueue=Pe.updateQueue,z.memoizedState=Pe.memoizedState,z.expirationTime=Pe.expirationTime):(z.updateQueue=null,z.memoizedState=null)}var qt=(xn.current&1)!==0,nt=D;do{var At;if(At=nt.tag===13){var Kt=nt.memoizedState;if(Kt!==null)At=Kt.dehydrated!==null;else{var Rr=nt.memoizedProps;At=Rr.fallback===void 0?!1:Rr.unstable_avoidThisFallback!==!0?!0:!qt}}if(At){var Gn=nt.updateQueue;if(Gn===null){var Q=new Set;Q.add(Se),nt.updateQueue=Q}else Gn.add(Se);if(!(nt.mode&2)){if(nt.effectTag|=64,z.effectTag&=-2981,z.tag===1)if(z.alternate===null)z.tag=17;else{var X=Ia(1073741823,null);X.tag=2,Ra(z,X)}z.expirationTime=1073741823;break e}re=void 0,z=g;var le=b.pingCache;if(le===null?(le=b.pingCache=new Fs,re=new Set,le.set(Se,re)):(re=le.get(Se),re===void 0&&(re=new Set,le.set(Se,re))),!re.has(z)){re.add(z);var Oe=hm.bind(null,b,Se,z);Se.then(Oe,Oe)}nt.effectTag|=4096,nt.expirationTime=g;break e}nt=nt.return}while(nt!==null);re=Error((V(z.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`+Ti(z))}gi!==rm&&(gi=Jc),re=$o(re,z),nt=D;do{switch(nt.tag){case 3:Se=re,nt.effectTag|=4096,nt.expirationTime=g;var $e=sv(nt,Se,g);M_(nt,$e);break e;case 1:Se=re;var an=nt.type,Qe=nt.stateNode;if(!(nt.effectTag&64)&&(typeof an.getDerivedStateFromError=="function"||Qe!==null&&typeof Qe.componentDidCatch=="function"&&(Ir===null||!Ir.has(Qe)))){nt.effectTag|=4096,nt.expirationTime=g;var Bt=ov(nt,Se,g);M_(nt,Bt);break e}}nt=nt.return}while(nt!==null)}tt=rh(tt)}catch(jn){g=jn;continue}break}while(1)}function ud(){var d=td.current;return td.current=Kf,d===null?Kf:d}function fv(d,g){d<go&&2<d&&(go=d),g!==null&&d<qo&&2<d&&(qo=d,rd=g)}function Mu(d){d>Pa&&(Pa=d)}function dv(){for(;tt!==null;)tt=um(tt)}function gv(){for(;tt!==null&&!gl();)tt=um(tt)}function um(d){var g=hd(d.alternate,d,fn);return d.memoizedProps=d.pendingProps,g===null&&(g=rh(d)),av.current=null,g}function rh(d){tt=d;do{var g=tt.alternate;if(d=tt.return,tt.effectTag&2048){if(g=CT(tt),g!==null)return g.effectTag&=2047,g;d!==null&&(d.firstEffect=d.lastEffect=null,d.effectTag|=2048)}else{if(g=em(g,tt,fn),fn===1||tt.childExpirationTime!==1){for(var v=0,S=tt.child;S!==null;){var b=S.expirationTime,D=S.childExpirationTime;b>v&&(v=b),D>v&&(v=D),S=S.sibling}tt.childExpirationTime=v}if(g!==null)return g;d!==null&&!(d.effectTag&2048)&&(d.firstEffect===null&&(d.firstEffect=tt.firstEffect),tt.lastEffect!==null&&(d.lastEffect!==null&&(d.lastEffect.nextEffect=tt.firstEffect),d.lastEffect=tt.lastEffect),1<tt.effectTag&&(d.lastEffect!==null?d.lastEffect.nextEffect=tt:d.firstEffect=tt,d.lastEffect=tt))}if(g=tt.sibling,g!==null)return g;tt=d}while(tt!==null);return gi===Xo&&(gi=rm),null}function cm(d){var g=d.expirationTime;return d=d.childExpirationTime,g>d?g:d}function La(d){var g=uo();return Ri(99,pv.bind(null,d,g)),null}function pv(d,g){do Ma();while(ui!==null);if((Ge&(ds|Os))!==zn)throw Error(o(327));var v=d.finishedWork,S=d.finishedExpirationTime;if(v===null)return null;if(d.finishedWork=null,d.finishedExpirationTime=0,v===d.current)throw Error(o(177));d.callbackNode=null,d.callbackExpirationTime=0,d.callbackPriority=90,d.nextKnownPendingLevel=0;var b=cm(v);if(d.firstPendingTime=b,S<=d.lastSuspendedTime?d.firstSuspendedTime=d.lastSuspendedTime=d.nextKnownPendingLevel=0:S<=d.firstSuspendedTime&&(d.firstSuspendedTime=S-1),S<=d.lastPingedTime&&(d.lastPingedTime=0),S<=d.lastExpiredTime&&(d.lastExpiredTime=0),d===hr&&(tt=hr=null,fn=0),1<v.effectTag?v.lastEffect!==null?(v.lastEffect.nextEffect=v,b=v.firstEffect):b=v:b=v.firstEffect,b!==null){var D=Ge;Ge|=Os,av.current=null,pe(d.containerInfo),Me=b;do try{PT()}catch(X){if(Me===null)throw Error(o(330));Da(Me,X),Me=Me.nextEffect}while(Me!==null);Me=b;do try{for(var z=d,re=g;Me!==null;){var Se=Me.effectTag;if(Se&16&&rt&&yn(Me.stateNode),Se&128){var Pe=Me.alternate;if(Pe!==null){var qt=Pe.ref;qt!==null&&(typeof qt=="function"?qt(null):qt.current=null)}}switch(Se&1038){case 2:nv(Me),Me.effectTag&=-3;break;case 6:nv(Me),Me.effectTag&=-3,Ho(Me.alternate,Me);break;case 1024:Me.effectTag&=-1025;break;case 1028:Me.effectTag&=-1025,Ho(Me.alternate,Me);break;case 4:Ho(Me.alternate,Me);break;case 8:var nt=z,At=Me,Kt=re;rt?iv(nt,At,Kt):J_(nt,At,Kt),ev(At)}Me=Me.nextEffect}}catch(X){if(Me===null)throw Error(o(330));Da(Me,X),Me=Me.nextEffect}while(Me!==null);ne(d.containerInfo),d.current=v,Me=b;do try{for(Se=d;Me!==null;){var Rr=Me.effectTag;if(Rr&36&&AT(Se,Me.alternate,Me),Rr&128){Pe=void 0;var Gn=Me.ref;if(Gn!==null){var Q=Me.stateNode;switch(Me.tag){case 5:Pe=_e(Q);break;default:Pe=Q}typeof Gn=="function"?Gn(Pe):Gn.current=Pe}}Me=Me.nextEffect}}catch(X){if(Me===null)throw Error(o(330));Da(Me,X),Me=Me.nextEffect}while(Me!==null);Me=null,_u(),Ge=D}else d.current=v;if(nh)nh=!1,ui=d,El=g;else for(Me=b;Me!==null;)g=Me.nextEffect,Me.nextEffect=null,Me=g;if(g=d.firstPendingTime,g===0&&(Ir=null),g===1073741823?d===sm?ih++:(ih=0,sm=d):ih=0,typeof fm=="function"&&fm(v.stateNode,S),mi(d),ku)throw ku=!1,d=Pu,Pu=null,d;return(Ge&nd)!==zn||bi(),null}function PT(){for(;Me!==null;){var d=Me.effectTag;d&256&&bT(Me.alternate,Me),!(d&512)||nh||(nh=!0,xu(97,function(){return Ma(),null})),Me=Me.nextEffect}}function Ma(){if(El!==90){var d=97<El?97:El;return El=90,Ri(d,LT)}}function LT(){if(ui===null)return!1;var d=ui;if(ui=null,(Ge&(ds|Os))!==zn)throw Error(o(331));var g=Ge;for(Ge|=Os,d=d.current.firstEffect;d!==null;){try{var v=d;if(v.effectTag&512)switch(v.tag){case 0:case 11:case 15:case 22:Ds(5,v),Z_(5,v)}}catch(S){if(d===null)throw Error(o(330));Da(d,S)}v=d.nextEffect,d.nextEffect=null,d=v}return Ge=g,bi(),!0}function cd(d,g,v){g=$o(v,g),g=sv(d,g,1073741823),Ra(d,g),d=ad(d,1073741823),d!==null&&mi(d)}function Da(d,g){if(d.tag===3)cd(d,d,g);else for(var v=d.return;v!==null;){if(v.tag===3){cd(v,d,g);break}else if(v.tag===1){var S=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Ir===null||!Ir.has(S))){d=$o(g,d),d=ov(v,d,1073741823),Ra(v,d),v=ad(v,1073741823),v!==null&&mi(v);break}}v=v.return}}function hm(d,g,v){var S=d.pingCache;S!==null&&S.delete(g),hr===d&&fn===v?gi===eh||gi===id&&go===1073741823&&Ii()-od<pi?Sl(d,fn):sd=!0:mm(d,v)&&(g=d.lastPingedTime,g!==0&&g<v||(d.lastPingedTime=v,mi(d)))}function MT(d,g){var v=d.stateNode;v!==null&&v.delete(g),g=0,g===0&&(g=Ns(),g=zs(g,d,null)),d=ad(d,g),d!==null&&mi(d)}var hd;hd=function(d,g,v){var S=g.expirationTime;if(d!==null){var b=g.pendingProps;if(d.memoizedProps!==b||si.current)qi=!0;else{if(S<v){switch(qi=!1,g.tag){case 3:Zp(g),li();break;case 5:if(zp(g),g.mode&4&&v!==1&&te(g.type,b))return g.expirationTime=g.childExpirationTime=1,null;break;case 1:vn(g.type)&&Ls(g);break;case 4:Np(g,g.stateNode.containerInfo);break;case 10:P_(g,g.memoizedProps.value);break;case 13:if(g.memoizedState!==null)return S=g.child.childExpirationTime,S!==0&&S>=v?X_(d,g,v):(bt(xn,xn.current&1),g=Cr(d,g,v),g!==null?g.sibling:null);bt(xn,xn.current&1);break;case 19:if(S=g.childExpirationTime>=v,d.effectTag&64){if(S)return K_(d,g,v);g.effectTag|=64}if(b=g.memoizedState,b!==null&&(b.rendering=null,b.tail=null),bt(xn,xn.current),!S)return null}return Cr(d,g,v)}qi=!1}}else qi=!1;switch(g.expirationTime=0,g.tag){case 2:if(S=g.type,d!==null&&(d.alternate=null,g.alternate=null,g.effectTag|=2),d=g.pendingProps,b=so(g,Pt.current),Ca(g,v),b=Zc(null,g,S,d,b,v),g.effectTag|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0){if(g.tag=1,g.memoizedState=null,g.updateQueue=null,vn(S)){var D=!0;Ls(g)}else D=!1;g.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,Lp(g);var z=S.getDerivedStateFromProps;typeof z=="function"&&Gf(g,S,z,d),b.updater=jf,g.stateNode=b,b._reactInternalFiber=g,Fp(g,S,d,v),g=Jf(null,g,S,!0,D,v)}else g.tag=0,Sr(null,g,b,v),g=g.child;return g;case 16:e:{if(b=g.elementType,d!==null&&(d.alternate=null,g.alternate=null,g.effectTag|=2),d=g.pendingProps,B(b),b._status!==1)throw b._result;switch(b=b._result,g.type=b,D=g.tag=fd(b),d=Kr(b,d),D){case 0:g=Qf(null,g,b,d,v);break e;case 1:g=Yp(null,g,b,d,v);break e;case 11:g=Zf(null,g,b,d,v);break e;case 14:g=Jr(null,g,b,Kr(b.type,d),S,v);break e}throw Error(o(306,b,""))}return g;case 0:return S=g.type,b=g.pendingProps,b=g.elementType===S?b:Kr(S,b),Qf(d,g,S,b,v);case 1:return S=g.type,b=g.pendingProps,b=g.elementType===S?b:Kr(S,b),Yp(d,g,S,b,v);case 3:if(Zp(g),S=g.updateQueue,d===null||S===null)throw Error(o(282));if(S=g.pendingProps,b=g.memoizedState,b=b!==null?b.element:null,Mp(d,g),Xc(g,S,null,v),S=g.memoizedState.element,S===b)li(),g=Cr(d,g,v);else{if((b=g.stateNode.hydrate)&&(ct?(xl=ii(g.stateNode.containerInfo),Vo=g,b=wl=!0):b=!1),b)for(v=Op(g,null,S,v),g.child=v;v;)v.effectTag=v.effectTag&-3|1024,v=v.sibling;else Sr(d,g,S,v),li();g=g.child}return g;case 5:return zp(g),d===null&&Wp(g),S=g.type,b=g.pendingProps,D=d!==null?d.memoizedProps:null,z=b.children,H(S,b)?z=null:D!==null&&H(S,D)&&(g.effectTag|=16),Kp(d,g),g.mode&4&&v!==1&&te(S,b)?(g.expirationTime=g.childExpirationTime=1,g=null):(Sr(d,g,z,v),g=g.child),g;case 6:return d===null&&Wp(g),null;case 13:return X_(d,g,v);case 4:return Np(g,g.stateNode.containerInfo),S=g.pendingProps,d===null?g.child=Eu(g,null,S,v):Sr(d,g,S,v),g.child;case 11:return S=g.type,b=g.pendingProps,b=g.elementType===S?b:Kr(S,b),Zf(d,g,S,b,v);case 7:return Sr(d,g,g.pendingProps,v),g.child;case 8:return Sr(d,g,g.pendingProps.children,v),g.child;case 12:return Sr(d,g,g.pendingProps.children,v),g.child;case 10:e:{if(S=g.type._context,b=g.pendingProps,z=g.memoizedProps,D=b.value,P_(g,D),z!==null){var re=z.value;if(D=qr(re,D)?0:(typeof S._calculateChangedBits=="function"?S._calculateChangedBits(re,D):1073741823)|0,D===0){if(z.children===b.children&&!si.current){g=Cr(d,g,v);break e}}else for(re=g.child,re!==null&&(re.return=g);re!==null;){var Se=re.dependencies;if(Se!==null){z=re.child;for(var Pe=Se.firstContext;Pe!==null;){if(Pe.context===S&&Pe.observedBits&D){re.tag===1&&(Pe=Ia(v,null),Pe.tag=2,Ra(re,Pe)),re.expirationTime<v&&(re.expirationTime=v),Pe=re.alternate,Pe!==null&&Pe.expirationTime<v&&(Pe.expirationTime=v),L_(re.return,v),Se.expirationTime<v&&(Se.expirationTime=v);break}Pe=Pe.next}}else z=re.tag===10&&re.type===g.type?null:re.child;if(z!==null)z.return=re;else for(z=re;z!==null;){if(z===g){z=null;break}if(re=z.sibling,re!==null){re.return=z.return,z=re;break}z=z.return}re=z}}Sr(d,g,b.children,v),g=g.child}return g;case 9:return b=g.type,D=g.pendingProps,S=D.children,Ca(g,v),b=fs(b,D.unstable_observedBits),S=S(b),g.effectTag|=1,Sr(d,g,S,v),g.child;case 14:return b=g.type,D=Kr(b,g.pendingProps),D=Kr(b.type,D),Jr(d,g,b,D,S,v);case 15:return qp(d,g,g.type,g.pendingProps,S,v);case 17:return S=g.type,b=g.pendingProps,b=g.elementType===S?b:Kr(S,b),d!==null&&(d.alternate=null,g.alternate=null,g.effectTag|=2),g.tag=1,vn(S)?(d=!0,Ls(g)):d=!1,Ca(g,v),O_(g,S,b),Fp(g,S,b,v),Jf(null,g,S,!0,d,v);case 19:return K_(d,g,v)}throw Error(o(156,g.tag))};var dt={current:!1},fm=null,dm=null;function sh(d){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")return!1;var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)return!0;try{var v=g.inject(d);fm=function(S){try{g.onCommitFiberRoot(v,S,void 0,(S.current.effectTag&64)===64)}catch{}},dm=function(S){try{g.onCommitFiberUnmount(v,S)}catch{}}}catch{}return!0}function DT(d,g,v,S){this.tag=d,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Un(d,g,v,S){return new DT(d,g,v,S)}function gm(d){return d=d.prototype,!(!d||!d.isReactComponent)}function fd(d){if(typeof d=="function")return gm(d)?1:0;if(d!=null){if(d=d.$$typeof,d===E)return 11;if(d===A)return 14}return 2}function Ko(d,g){var v=d.alternate;return v===null?(v=Un(d.tag,g,d.key,d.mode),v.elementType=d.elementType,v.type=d.type,v.stateNode=d.stateNode,v.alternate=d,d.alternate=v):(v.pendingProps=g,v.effectTag=0,v.nextEffect=null,v.firstEffect=null,v.lastEffect=null),v.childExpirationTime=d.childExpirationTime,v.expirationTime=d.expirationTime,v.child=d.child,v.memoizedProps=d.memoizedProps,v.memoizedState=d.memoizedState,v.updateQueue=d.updateQueue,g=d.dependencies,v.dependencies=g===null?null:{expirationTime:g.expirationTime,firstContext:g.firstContext,responders:g.responders},v.sibling=d.sibling,v.index=d.index,v.ref=d.ref,v}function oh(d,g,v,S,b,D){var z=2;if(S=d,typeof d=="function")gm(d)&&(z=1);else if(typeof d=="string")z=5;else e:switch(d){case p:return Yo(v.children,b,D,g);case R:z=8,b|=7;break;case m:z=8,b|=1;break;case y:return d=Un(12,v,g,b|8),d.elementType=y,d.type=y,d.expirationTime=D,d;case T:return d=Un(13,v,g,b),d.type=T,d.elementType=T,d.expirationTime=D,d;case I:return d=Un(19,v,g,b),d.elementType=I,d.expirationTime=D,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case x:z=10;break e;case w:z=9;break e;case E:z=11;break e;case A:z=14;break e;case L:z=16,S=null;break e;case F:z=22;break e}throw Error(o(130,d==null?d:typeof d,""))}return g=Un(z,v,g,b),g.elementType=d,g.type=S,g.expirationTime=D,g}function Yo(d,g,v,S){return d=Un(7,d,S,g),d.expirationTime=v,d}function fr(d,g,v){return d=Un(6,d,null,g),d.expirationTime=v,d}function mo(d,g,v){return g=Un(4,d.children!==null?d.children:[],d.key,g),g.expirationTime=v,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}function pm(d,g,v){this.tag=g,this.current=null,this.containerInfo=d,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=lt,this.pendingContext=this.context=null,this.hydrate=v,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function mm(d,g){var v=d.firstSuspendedTime;return d=d.lastSuspendedTime,v!==0&&v>=g&&d<=g}function yo(d,g){var v=d.firstSuspendedTime,S=d.lastSuspendedTime;v<g&&(d.firstSuspendedTime=g),(S>g||v===0)&&(d.lastSuspendedTime=g),g<=d.lastPingedTime&&(d.lastPingedTime=0),g<=d.lastExpiredTime&&(d.lastExpiredTime=0)}function ym(d,g){g>d.firstPendingTime&&(d.firstPendingTime=g);var v=d.firstSuspendedTime;v!==0&&(g>=v?d.firstSuspendedTime=d.lastSuspendedTime=d.nextKnownPendingLevel=0:g>=d.lastSuspendedTime&&(d.lastSuspendedTime=g+1),g>d.nextKnownPendingLevel&&(d.nextKnownPendingLevel=g))}function Du(d,g){var v=d.lastExpiredTime;(v===0||v>g)&&(d.lastExpiredTime=g)}var ah=null;function _m(d){if(ah===null)try{var g=("require"+Math.random()).slice(0,7);ah=(n&&n[g])("timers").setImmediate}catch{ah=function(S){var b=new MessageChannel;b.port1.onmessage=S,b.port2.postMessage(void 0)}}return ah(d)}function dd(d){var g=d._reactInternalFiber;if(g===void 0)throw typeof d.render=="function"?Error(o(188)):Error(o(268,Object.keys(d)));return d=de(g),d===null?null:d.stateNode}function Zo(d,g){d=d.memoizedState,d!==null&&d.dehydrated!==null&&d.retryTime<g&&(d.retryTime=g)}function Us(d,g){Zo(d,g),(d=d.alternate)&&Zo(d,g)}var gd=a.IsSomeRendererActing,pd=typeof s.unstable_flushAllWithoutAsserting=="function",vm=s.unstable_flushAllWithoutAsserting||function(){for(var d=!1;Ma();)d=!0;return d};function mv(d){try{vm(),_m(function(){vm()?mv(d):d()})}catch(g){d(g)}}var md=0,xm=!1,yd={__proto__:null,createContainer:function(d,g,v){return d=new pm(d,g,v),g=Un(3,null,null,g===2?7:g===1?3:0),d.current=g,g.stateNode=d,Lp(g),d},updateContainer:function(d,g,v,S){var b=g.current,D=Ns(),z=qc.suspense;D=zs(D,b,z);e:if(v){v=v._reactInternalFiber;t:{if(J(v)!==v||v.tag!==1)throw Error(o(170));var re=v;do{switch(re.tag){case 3:re=re.stateNode.context;break t;case 1:if(vn(re.type)){re=re.stateNode.__reactInternalMemoizedMergedChildContext;break t}}re=re.return}while(re!==null);throw Error(o(171))}if(v.tag===1){var Se=v.type;if(vn(Se)){v=hs(v,Se,re);break e}}v=re}else v=sn;return g.context===null?g.context=v:g.pendingContext=v,g=Ia(D,z),g.payload={element:d},S=S===void 0?null:S,S!==null&&(g.callback=S),Ra(b,g),po(b,D),D},batchedEventUpdates:function(d,g){var v=Ge;Ge|=2;try{return d(g)}finally{Ge=v,Ge===zn&&bi()}},batchedUpdates:cv,unbatchedUpdates:function(d,g){var v=Ge;Ge&=-2,Ge|=nd;try{return d(g)}finally{Ge=v,Ge===zn&&bi()}},deferredUpdates:function(d){return Ri(97,d)},syncUpdates:function(d,g,v,S){return Ri(99,d.bind(null,g,v,S))},discreteUpdates:function(d,g,v,S,b){var D=Ge;Ge|=4;try{return Ri(98,d.bind(null,g,v,S,b))}finally{Ge=D,Ge===zn&&bi()}},flushDiscreteUpdates:function(){(Ge&(1|ds|Os))===zn&&(uv(),Ma())},flushControlled:function(d){var g=Ge;Ge|=1;try{Ri(99,d)}finally{Ge=g,Ge===zn&&bi()}},flushSync:hv,flushPassiveEffects:Ma,IsThisRendererActing:dt,getPublicRootInstance:function(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return _e(d.child.stateNode);default:return d.child.stateNode}},attemptSynchronousHydration:function(d){switch(d.tag){case 3:var g=d.stateNode;g.hydrate&&am(g,g.firstPendingTime);break;case 13:hv(function(){return po(d,1073741823)}),g=co(Ns(),150,100),Us(d,g)}},attemptUserBlockingHydration:function(d){if(d.tag===13){var g=co(Ns(),150,100);po(d,g),Us(d,g)}},attemptContinuousHydration:function(d){d.tag===13&&(po(d,3),Us(d,3))},attemptHydrationAtCurrentPriority:function(d){if(d.tag===13){var g=Ns();g=zs(g,d,null),po(d,g),Us(d,g)}},findHostInstance:dd,findHostInstanceWithWarning:function(d){return dd(d)},findHostInstanceWithNoPortals:function(d){return d=oe(d),d===null?null:d.tag===20?d.stateNode.instance:d.stateNode},shouldSuspend:function(){return!1},injectIntoDevTools:function(d){var g=d.findFiberByHostInstance;return sh(i({},d,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:function(v){return v=de(v),v===null?null:v.stateNode},findFiberByHostInstance:function(v){return g?g(v):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))},act:function(d){function g(){md--,gd.current=v,dt.current=S}xm===!1&&(xm=!0,console.error("act(...) is not supported in production builds of React, and might not behave as expected.")),md++;var v=gd.current,S=dt.current;gd.current=!0,dt.current=!0;try{var b=cv(d)}catch(D){throw g(),D}if(b!==null&&typeof b=="object"&&typeof b.then=="function")return{then:function(D,z){b.then(function(){1<md||pd===!0&&v===!0?(g(),D()):mv(function(re){g(),re?z(re):D()})},function(re){g(),z(re)})}};try{md!==1||pd!==!1&&v!==!1||vm(),g()}catch(D){throw g(),D}return{then:function(D){D()}}}},yv=yd&&yd.default||yd;n.exports=yv.default||yv;var _v=n.exports;return n.exports=e,_v}})(loe);(function(n){n.exports=zR})(aoe);const doe=eN(NR);var UR={},goe={get exports(){return UR},set exports(n){UR=n}},Dj={};/** @license React v0.20.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){var e,t,i,r;if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}if(typeof window>"u"||typeof MessageChannel!="function"){var l=null,u=null,h=function(){if(l!==null)try{var ee=n.unstable_now();l(!0,ee),l=null}catch(j){throw setTimeout(h,0),j}};e=function(ee){l!==null?setTimeout(e,0,ee):(l=ee,setTimeout(h,0))},t=function(ee,j){u=setTimeout(ee,j)},i=function(){clearTimeout(u)},n.unstable_shouldYield=function(){return!1},r=n.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,m=window.clearTimeout;if(typeof console<"u"){var y=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof y!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var x=!1,w=null,R=-1,E=5,T=0;n.unstable_shouldYield=function(){return n.unstable_now()>=T},r=function(){},n.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<ee?Math.floor(1e3/ee):5};var I=new MessageChannel,A=I.port2;I.port1.onmessage=function(){if(w!==null){var ee=n.unstable_now();T=ee+E;try{w(!0,ee)?A.postMessage(null):(x=!1,w=null)}catch(j){throw A.postMessage(null),j}}else x=!1},e=function(ee){w=ee,x||(x=!0,A.postMessage(null))},t=function(ee,j){R=p(function(){ee(n.unstable_now())},j)},i=function(){m(R),R=-1}}function L(ee,j){var ie=ee.length;ee.push(j);e:for(;;){var q=ie-1>>>1,H=ee[q];if(H!==void 0&&0<N(H,j))ee[q]=j,ee[ie]=H,ie=q;else break e}}function F(ee){return ee=ee[0],ee===void 0?null:ee}function O(ee){var j=ee[0];if(j!==void 0){var ie=ee.pop();if(ie!==j){ee[0]=ie;e:for(var q=0,H=ee.length;q<H;){var te=2*(q+1)-1,ue=ee[te],K=te+1,Te=ee[K];if(ue!==void 0&&0>N(ue,ie))Te!==void 0&&0>N(Te,ue)?(ee[q]=Te,ee[K]=ie,q=K):(ee[q]=ue,ee[te]=ie,q=te);else if(Te!==void 0&&0>N(Te,ie))ee[q]=Te,ee[K]=ie,q=K;else break e}}return j}return null}function N(ee,j){var ie=ee.sortIndex-j.sortIndex;return ie!==0?ie:ee.id-j.id}var B=[],V=[],J=1,ge=null,he=3,de=!1,oe=!1,_e=!1;function se(ee){for(var j=F(V);j!==null;){if(j.callback===null)O(V);else if(j.startTime<=ee)O(V),j.sortIndex=j.expirationTime,L(B,j);else break;j=F(V)}}function Z(ee){if(_e=!1,se(ee),!oe)if(F(B)!==null)oe=!0,e(pe);else{var j=F(V);j!==null&&t(Z,j.startTime-ee)}}function pe(ee,j){oe=!1,_e&&(_e=!1,i()),de=!0;var ie=he;try{for(se(j),ge=F(B);ge!==null&&(!(ge.expirationTime>j)||ee&&!n.unstable_shouldYield());){var q=ge.callback;if(typeof q=="function"){ge.callback=null,he=ge.priorityLevel;var H=q(ge.expirationTime<=j);j=n.unstable_now(),typeof H=="function"?ge.callback=H:ge===F(B)&&O(B),se(j)}else O(B);ge=F(B)}if(ge!==null)var te=!0;else{var ue=F(V);ue!==null&&t(Z,ue.startTime-j),te=!1}return te}finally{ge=null,he=ie,de=!1}}var ne=r;n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ee){ee.callback=null},n.unstable_continueExecution=function(){oe||de||(oe=!0,e(pe))},n.unstable_getCurrentPriorityLevel=function(){return he},n.unstable_getFirstCallbackNode=function(){return F(B)},n.unstable_next=function(ee){switch(he){case 1:case 2:case 3:var j=3;break;default:j=he}var ie=he;he=j;try{return ee()}finally{he=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=ne,n.unstable_runWithPriority=function(ee,j){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ie=he;he=ee;try{return j()}finally{he=ie}},n.unstable_scheduleCallback=function(ee,j,ie){var q=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?q+ie:q):ie=q,ee){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=ie+H,ee={id:J++,callback:j,priorityLevel:ee,startTime:ie,expirationTime:H,sortIndex:-1},ie>q?(ee.sortIndex=ie,L(V,ee),F(B)===null&&ee===F(V)&&(_e?i():_e=!0,t(Z,ie-q))):(ee.sortIndex=H,L(B,ee),oe||de||(oe=!0,e(pe))),ee},n.unstable_wrapCallback=function(ee){var j=he;return function(){var ie=he;he=j;try{return ee.apply(this,arguments)}finally{he=ie}}}})(Dj);(function(n){n.exports=Dj})(goe);function poe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wF(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){poe(n,r,t[r])})}return n}function GR(n,e){if(n==null)return{};var t=moe(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function moe(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}const ns=Symbol("MetaOlFiber"),FC=new Map,yoe={},_oe=()=>{},Hm=(n="",e="")=>new Error(`React-Openlayers-Fiber Error: Couldn't add this child to this container. You can specify how to attach this type of child ("${e}") to this type of container ("${n}") using the "attach" props. If you think this should be done automatically, open an issue here https://github.com/labelflow/react-openlayers-fiber/issues/new?title=Support+${e}+in+${n}&body=Support+${e}+in+${n}`),u_=()=>new Error("React-Openlayers-Fiber Error: Instance is null, is it a TextInstance ?"),EF=(n,e,t)=>{const i=n.set,r=`set${Ae.upperFirst(e)}`,s=n[r];Ae.isFunction(s)?s.bind(n)(t):Ae.isFunction(i)?i.bind(n)(e,t):Ae.has(e,n)?(console.warn(`React-Openlayers-Fiber Warning: Setting the property "${e}" brutally because there is no setter on the object`),console.warn(n),n[e]=t):(console.error(`React-Openlayers-Fiber Error: Setting the property "${e}" very brutally because there is no setter on the object nor the object has this key... This is probably an error`),console.error(n),n[e]=t)},Fj=(n,e,t={},i=!1)=>{Ae.forEach(r=>{if(i&&r.substr(0,7)==="initial"){const s=Ae.lowerFirst(r.substr(7)),o=Ae.startsWith("_",s)?s.substring(1):s;EF(n,o,e[r])}else if(t[r]!==e[r]&&r.substr(0,7)!=="initial")if(r.substr(0,2)==="on"){const s=Ae.lowerFirst(r.substr(2).replace("_",":"));Ae.isFunction(t[r])&&n.un(s,t[r]),Ae.isFunction(e[r])&&n.on(s,e[r])}else{const s=Ae.startsWith("_",r)?r.substring(1):r;EF(n,s,e[r])}},Ae.keys(e))},jt=(n,e)=>e,voe=(n,e)=>{if(!e)throw u_();const{kind:t}=n[ns],{kind:i}=e[ns];switch(t){case"Map":switch(i){case"View":return jt("olMap",n).setView(jt("olView",e)),r=>jt("olMap",r).unset("view");case"Layer":return jt("olMap",n).addLayer(jt("olLayerLayer",e)),(r,s)=>jt("olMap",r).removeLayer(jt("olLayerLayer",s));case"Control":return jt("olMap",n).addControl(jt("olControlControl",e)),(r,s)=>jt("olMap",r).removeControl(jt("olControlControl",s));case"Interaction":return jt("olMap",n).addInteraction(jt("olInteractionInteraction",e)),(r,s)=>jt("olMap",r).removeInteraction(jt("olInteractionInteraction",s));case"Overlay":return jt("olMap",n).addOverlay(jt("olOverlay",e)),(r,s)=>jt("olMap",r).removeOverlay(jt("olOverlay",s));default:throw Hm(t,i)}case"Layer":switch(i){case"Source":return jt("olLayerLayer",n).setSource(jt("olSourceVector",e)),(r,s)=>jt("olLayerLayer",r).unset("source");default:throw Hm(t,i)}case"Source":switch(i){case"Feature":return jt("olSourceVector",n).addFeature(jt("olFeature",e)),(r,s)=>jt("olSourceVector",r).removeFeature(jt("olFeature",s));case"Source":return jt("olSourceCluster",n).setSource(jt("olSourceVector",e)),(r,s)=>jt("olSourceCluster",r).unset("source");default:throw Hm(t,i)}case"Feature":switch(i){case"Geom":return jt("olFeature",n).setGeometry(jt("olGeomGeometryCollection",e)),(r,s)=>jt("olFeature",r).unset("geometry");default:throw Hm(t,i)}default:throw Hm(t,i)}},xoe=n=>{if(!n)throw u_();return n},woe=n=>yoe,Eoe=(n,e,t)=>typeof n=="string"?`${n}.${e}`:e,Toe=n=>null,Soe=n=>{},Oj=(n,e,t,i,r)=>{let s,o;if(n==="primitive"){const{object:a}=e;s=a,o=null}else if(n==="new"){const{object:a,args:l}=e;s=new a(...l),o=null}else{const{args:a,constructFrom:l,attach:u,onUpdate:h,children:p}=e,m=GR(e,["args","constructFrom","attach","onUpdate","children"]),y=soe[n];if(Ae.isNil(y))throw new Error(`React-Openlayers-Fiber Error: ${n} is not exported by ol. Use extend to add it if needed.`);if(Ae.isNil(l)){const x=Ae.flow(Ae.pickBy((R,E)=>E.substr(0,7)==="initial"),Ae.mapKeys(R=>Ae.lowerFirst(R.substr(7))))(m),w=wF({},x,Ae.mapKeys(R=>Ae.startsWith("_",R)?R.substring(1):R,Ae.pickBy((R,E)=>E.substr(0,7)!=="initial",m)));Ae.isNil(a)?(s=new y.object(w),o=y.kind):Ae.isArray(a)?(s=new y.object(...a),o=y.kind):(s=new y.object(wF({},w,a)),o=y.kind)}else if(Ae.isFunction(y.object[l]))s=y.object[l](...a),o=y.kind;else throw new Error(`React-Openlayers-Fiber Error: ${l} is not a constructor for ${y}`);s[ns]={kind:o,type:n,attach:u},Fj(s,m,{},!0)}return s},Coe=(n,e,t,i,r)=>!1,Ioe=(n,e,t,i,r,s)=>{const o=Ae.keys(t),a=Ae.keys(i);return Ae.size(o)!==Ae.size(a)||o.some((l,u)=>a[u]!==l)?!0:o.filter(l=>l!=="children").some(l=>t[l]!==i[l])},Roe=(n,e)=>!1,boe=(n,e,t,i)=>null,Aoe=setTimeout,koe=clearTimeout,Poe=-1,Loe=(n,e,t)=>{},Moe=(n,e,t,i)=>{},Nj=(n,e)=>{if(!e)throw u_();const{attach:t,detach:i}=e[ns];if(Ae.isFunction(i))i(n,e);else if(Ae.isString(t))n[t]=void 0,delete n[t];else throw new Error(`React-Openlayers-Fiber Error: Couldn't remove this child from this container. You can specify how to detach this type of child ("${e.constructor.name}") from this type of container ("${n.constructor.name}") using the "attach" props.`)},Doe=(n,e)=>{e.setTarget(void 0),e.unset("target")},jE=(n,e)=>{if(!e)throw u_();const{attach:t}=e[ns];if(e[ns].parent=n,Ae.isNil(t))e[ns].detach=voe(n,e);else if(Ae.isString(t)){var i,r;const s=(i=n)===null||i===void 0?void 0:i.set,o=(r=n)===null||r===void 0?void 0:r[`set${Ae.upperFirst(t)}`];Ae.isFunction(o)?(o.bind(n)(e),e[ns].detach=(a,l)=>{var u;const h=(u=a)===null||u===void 0?void 0:u[`unset${Ae.upperFirst(t)}`];Ae.isFunction(h)?h.bind(a)(l):o.bind(a)(void 0)}):Ae.isFunction(s)?(s.bind(n)(t,e),e[ns].detach=(a,l)=>{var u;const h=(u=a)===null||u===void 0?void 0:u.unset;Ae.isFunction(h)?h.bind(a)(t,l):s.bind(a)(t,void 0)}):(console.warn(`React-Openlayers-Fiber Warning: Attaching the child ${t} brutally because there is no setter on the object`),n[t]=e,e[ns].detach=(a,l)=>{a[t]=void 0,delete a[t]})}else if(Ae.isFunction(t))e[ns].detach=t(n,e,n,e);else throw new Error('React-Openlayers-Fiber Error: Unsupported "attach" type.')};function Foe(n,e,t,i){const{parent:r}=n[ns],s=Oj(e,t);if(Ae.isNil(r))if(e==="olMap")console.warn("React-Openlayers-Fiber Warning: Trying to switch olMap! This is poorly supported for now, it will only cause problems if you change the args of the olMap between renders.");else throw new Error("React-Openlayers-Fiber Error: Trying to switch instance which has no parent!");else Nj(r,n),jE(r,s);[i,i.alternate].forEach(o=>{o!==null&&(o.stateNode=s,o.ref&&(typeof o.ref=="function"?o.ref(s):o.ref.current=s))})}const Ooe=(n,e,t,i,r,s)=>{const o=n,{args:a=[],onUpdate:l,children:u}=r,h=GR(r,["args","onUpdate","children"]),{args:p=[]}=i,m=GR(i,["args"]);let y=!1;if(Ae.isArray(a))Ae.isArray(p)?y=a.some((x,w)=>Ae.isPlainObject(x)?Object.entries(x).some(([R,E])=>E!==p[w][R]):x!==p[w]):y=!0;else if(Ae.isPlainObject(a))Array.isArray(p)?y=!0:y=Object.entries(a).some(([x,w])=>w!==p[x]);else throw Error("Args should be an Array or an object");y?Foe(n,t,r,s):Fj(o,h,m,!1),typeof l=="function"&&l(o)},Noe=(n,e,t)=>{if(!e)throw u_();e[ns].parent=n},zoe=n=>{},Uoe=(n,e,t)=>{jE(n,e)},Goe=(n,e)=>jE(n,e),joe=(n,e)=>{},Boe=n=>{const{kind:e}=n[ns];switch(e){case"Layer":{jt("olLayerLayer",n).setVisible(!1);break}default:throw new Error("React-Openlayers-Fiber Error: Can't hide things that are not layers")}},Voe=(n,e)=>{const{kind:t}=n[ns];switch(t){case"Layer":{jt("olLayerLayer",n).setVisible(!0);break}default:throw new Error("React-Openlayers-Fiber Error: Can't unhide things that are not layers")}},$oe=()=>{throw new Error("React-Openlayers-Fiber Error: Text is not allowed in the react-openlayers-fiber tree. You may have extraneous whitespace between components.")},Woe=()=>{throw new Error("React-Openlayers-Fiber Error: Text is not allowed in the react-openlayers-fiber tree. You may have extraneous whitespace between components.")},OC=doe({getPublicInstance:xoe,getRootHostContext:woe,getChildHostContext:Eoe,prepareForCommit:Toe,resetAfterCommit:Soe,createInstance:Oj,appendInitialChild:Goe,finalizeInitialChildren:Coe,prepareUpdate:Ioe,shouldSetTextContent:Roe,createTextInstance:boe,scheduleTimeout:Aoe,cancelTimeout:koe,noTimeout:Poe,now:UR.unstable_now,isPrimaryRenderer:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,appendChild:jE,appendChildToContainer:joe,commitTextUpdate:Loe,commitMount:Moe,commitUpdate:Ooe,insertBefore:Uoe,insertInContainerBefore:Noe,removeChild:Nj,removeChildFromContainer:Doe,resetTextContent:zoe,hideInstance:Boe,hideTextInstance:$oe,unhideInstance:Voe,unhideTextInstance:Woe,preparePortalMount:_oe,queueMicrotask});function Hoe(n,e){let t;return FC.has(e)?t=FC.get(e):(t=OC.createContainer(e,0,!1,null),FC.set(e,t)),OC.updateContainer(n,t,null,()=>null),OC.getPublicRootInstance(t)}function jR(){return jR=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},jR.apply(this,arguments)}function Xoe(n,e){if(n==null)return{};var t=qoe(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function qoe(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}const Koe=[{}],Yoe={width:"100%",height:"400px"};var Zoe=Vt.forwardRef((n,e)=>{var{children:t,args:i=Koe,style:r=Yoe,className:s,containerRef:o}=n,a=Xoe(n,["children","args","style","className","containerRef"]);const l=Vt.useRef(null),[u,h]=Vt.useState(null);Vt.useEffect(()=>{if(l.current){const m=H1.createElement("olMap",jR({},a,{args:i,target:l.current,ref:e}),Ae.isNull(u)?null:H1.createElement(ooe,{value:u},t)),y=Hoe(m,l.current);Ae.isNull(u)&&!Ae.isNull(y)&&h(x=>Ae.isNull(x)?y:x)}},[t,l.current,u]);const p=m=>{Ae.isNil(m)||(Ae.isFunction(o)?o(m):Ae.isNil(o)||(o.current=m),Ae.isFunction(l)?l(m):Ae.isNil(l)||(l.current=m))};return H1.createElement("div",{style:r,className:s,ref:p})});const TF=(n={})=>{let{strokeWidth:e,strokeColor:t,fillColor:i,circleRadius:r}={strokeWidth:1.25,strokeColor:"#3399CC",fillColor:"rgba(255,255,255,0.4)",circleRadius:5,...n};const s=new Ws({color:i}),o=new Ts({color:t,width:e});return new ws({image:new gp({fill:s,stroke:o,radius:r}),fill:s,stroke:o})},Qoe=Ke("olLayerTile",{preload:10,children:Ke("olSourceXYZ",{tileUrlFunction:([n,e,t])=>n>7?null:`http://www.gitzmansgallery.com/tiles/${n}_${e}_${t}.jpg`})}),Joe=Ke("olLayerTile",{preload:3,minZoom:7,children:Ke("olSourceTileImage",{tileGrid:new fu({extent:[-3.3200179088326604e6,4701281932972828e-9,-3175634720787182e-9,4803354426231889e-9],origin:[-3.3200179088326604e6,4701281932972828e-9],resolutions:[658.5322145745888,329.2661072872944,164.6330536436472,82.3165268218236,41.1582634109118,20.5791317054559,10.28956585272795,5.144782926363975],tileSize:[256,256]}),tileUrlFunction:n=>"./marienburg/{z}/{x}/{y}.png".replace("{z}",String(n[0])).replace("{x}",String(n[1])).replace("{y}",String(-1-n[2]))})}),eae=Ke("olLayerTile",{preload:3,minZoom:7,children:Ke("olSourceTileImage",{tileGrid:new fu({extent:[-1.8795726783471084e6,3734469056198348e-9,-1.7547822783471085e6,3.8241138561983476e6],origin:[-1.8795726783471084e6,3734469056198348e-9],resolutions:[537.6,268.8,134.4,67.2,33.6,16.8,8.4,4.2],tileSize:[256,256]}),tileUrlFunction:n=>"./altdorf/{z}/{x}/{y}.png".replace("{z}",String(n[0])).replace("{x}",String(n[1])).replace("{y}",String(-1-n[2]))})}),tae=({setPopup:n,previewPoint:e})=>{var t;return Ni("div",{ref:n,className:"preview-popup",children:[Ke("img",{className:"preview-image",src:e.length>0&&e[0].src||"./locations/resturant.png",alt:""}),e.length>0?Ke("div",{children:((t=e[0])==null?void 0:t.name)||"lmao"}):null]})},nae=({setContextMenu:n,contextMenuLocation:e,newLocationHook:t})=>Ke("div",{ref:n,className:"contextmenu-popup",children:Ke("button",{onClick:()=>t({coordinates:e}),children:"Add Location"})}),SF=({points:n})=>Ke("olSourceVector",{children:n.map(e=>Ke("olFeature",{children:Ke("olGeomPoint",{coordinates:e.coordinates})},e.coordinates.join()))}),iae=({points:n,setSelectedPoints:e,newLocationHook:t,addPointDialogOpen:i,user:r})=>{const[s,o]=Vt.useState(null),[a,l]=Vt.useState([]),[u,h]=Vt.useState(null),[p,m]=Vt.useState(null),[y,x]=Vt.useState(null);Vt.useEffect(()=>{i||x(null)},[i]),Vt.useEffect(()=>{r||x(null)},[y]),Vt.useEffect(()=>{s&&(s.on("contextmenu",function(T){T.preventDefault(),x(T.coordinate)}),s.on("click",function(T){x(null)}))},[s]);const w=Vt.useCallback(({coordinate:T})=>console.log({coordinate:T}),[]),R=Vt.useCallback(T=>{var I=T.target.getFeatures().getArray().map(A=>n.find(({coordinates:L})=>L.join()==A.getGeometry().getCoordinates().join()));l(I)},[n]),E=Vt.useCallback(T=>{var I=T.target.getFeatures().getArray().map(A=>n.find(({coordinates:L})=>L.join()==A.getGeometry().getCoordinates().join()));e(I)},[n]);return Ke(jH,{children:Ni("div",{className:"mapview",children:[Ni("div",{className:"hidden-popup-container",children:[Ke(tae,{setPopup:h,previewPoint:a}),Ke(nae,{setContextMenu:m,contextMenuLocation:y,newLocationHook:t})]}),Ni(Zoe,{ref:o,style:{width:"100%",height:"96vh"},onSingleclick:w,children:[a.length>0?Ke("olOverlay",{element:u,position:a[0].coordinates,positioning:"bottom-center",offset:[0,-12]}):null,y?Ke("olOverlay",{element:p,position:y,positioning:"bottom-center",offset:[0,-12]}):null,Ke("olControlRotate",{}),Ke("olControlFullScreen",{}),Ke("olView",{initialCenter:[0,0],initialZoom:3}),Qoe,Joe,eae,Ke("olLayerVector",{style:TF({strokeColor:"orange"}),children:Ke(SF,{points:n.filter(T=>!T.public)})}),Ke("olLayerVector",{style:TF({strokeColor:"blue",strokeWidth:2}),children:Ke(SF,{points:n.filter(T=>T.public)})}),Ke("olInteractionSelect",{args:{condition:U9},onSelect:E}),Ke("olInteractionSelect",{args:{condition:G9},onSelect:R})]})]})})};var BR={},rae={get exports(){return BR},set exports(n){BR=n}};(function(n,e){(function(t,i){i()})($a,function(){function t(u,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function i(u,h,p){var m=new XMLHttpRequest;m.open("GET",u),m.responseType="blob",m.onload=function(){l(m.response,h,p)},m.onerror=function(){console.error("could not download file")},m.send()}function r(u){var h=new XMLHttpRequest;h.open("HEAD",u,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function s(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $a=="object"&&$a.global===$a?$a:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(u,h,p){var m=o.URL||o.webkitURL,y=document.createElement("a");h=h||u.name||"download",y.download=h,y.rel="noopener",typeof u=="string"?(y.href=u,y.origin===location.origin?s(y):r(y.href)?i(u,h,p):s(y,y.target="_blank")):(y.href=m.createObjectURL(u),setTimeout(function(){m.revokeObjectURL(y.href)},4e4),setTimeout(function(){s(y)},0))}:"msSaveOrOpenBlob"in navigator?function(u,h,p){if(h=h||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(t(u,p),h);else if(r(u))i(u,h,p);else{var m=document.createElement("a");m.href=u,m.target="_blank",setTimeout(function(){s(m)})}}:function(u,h,p,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof u=="string")return i(u,h,p);var y=u.type==="application/octet-stream",x=/constructor/i.test(o.HTMLElement)||o.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||y&&x||a)&&typeof FileReader<"u"){var R=new FileReader;R.onloadend=function(){var I=R.result;I=w?I:I.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=I:location=I,m=null},R.readAsDataURL(u)}else{var E=o.URL||o.webkitURL,T=E.createObjectURL(u);m?m.location=T:location.href=T,m=null,setTimeout(function(){E.revokeObjectURL(T)},4e4)}});o.saveAs=l.saveAs=l,n.exports=l})})(rae);const sae=({point:{name:n,coordinates:e,src:t,owned_by_user:i,id:r,...s},removePointHook:o})=>{const a=()=>BR.saveAs(t,n+".png"),l=()=>navigator.clipboard.writeText(location.href+n+e);return console.log(r),Ni("div",{className:"card",children:[Ke("img",{src:t}),Ni("div",{className:"name",children:[" ",n]}),s.public?Ke("div",{children:"Public"}):Ke("div",{children:"Private"}),Ni("div",{children:[Ke("button",{title:"Download",onClick:a,children:""}),s.public?Ke("button",{title:"Share",onClick:l,children:""}):null,i?Ke("button",{title:"Delete",onClick:()=>o(r),children:""}):null]})]})},oae=({selectedPoints:n,removePointHook:e})=>Ni("div",{children:[Ni("h3",{children:["Selected point",n.length>1?"s":""]}),Ke("div",{className:"point-container",children:n.map(t=>Ke(sae,{removePointHook:e,point:t},t.coordinates.join()))})]}),aae=({addNewPointHook:n,closePointDialog:e})=>Ke("div",{className:"point-container",children:Ke("div",{className:" card",children:Ni("form",{onSubmit:i=>{i.preventDefault();const r=i.target,s=new FormData(r),o=Object.fromEntries(s.entries());o.public==="true"?o.public=!0:o.public=!1,n(o),e()},children:[Ni("label",{children:["Name:",Ke("input",{name:"name",defaultValue:Math.random()*10,type:"text"})]}),Ni("label",{children:["SRC:",Ke("input",{name:"src",type:"text"})]}),Ni("label",{children:["Share publically:",Ke("input",{name:"public","data-val":"true",value:"true",defaultChecked:!0,type:"checkbox"})]}),Ni("div",{children:[Ke("input",{type:"submit",value:""}),Ke("button",{onClick:e,title:"Cancel",children:""})]})]})})}),lae=({selectedPoints:n,addNewPointHook:e,addPointDialogOpen:t,closePointDialog:i,user:r,removePointHook:s})=>Ni("div",{className:"controlview",children:[r&&t?Ke(aae,{addNewPointHook:e,closePointDialog:i}):null,n.length>0?Ke(oae,{selectedPoints:n,removePointHook:s}):null]});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},uae=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Uj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,h=s>>2,p=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,y=u&63;l||(y=64,o||(m=64)),i.push(t[h],t[p],t[m],t[y])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(zj(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):uae(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const u=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||u==null||p==null)throw Error();const m=s<<2|a>>4;if(i.push(m),u!==64){const y=a<<4&240|u>>2;if(i.push(y),p!==64){const x=u<<6&192|p;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},cae=function(n){const e=zj(n);return Uj.encodeByteArray(e,!0)},Iw=function(n){return cae(n).replace(/\./g,"")},Gj=function(n){try{return Uj.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hae(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fae=()=>hae().__FIREBASE_DEFAULTS__,dae=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},gae=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Gj(n[1]);return e&&JSON.parse(e)},nP=()=>{try{return fae()||dae()||gae()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},jj=n=>{var e,t;return(t=(e=nP())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},pae=n=>{const e=jj(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},mae=()=>{var n;return(n=nP())===null||n===void 0?void 0:n.config},Bj=n=>{var e;return(e=nP())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yae{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _ae(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[Iw(JSON.stringify(t)),Iw(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vae(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Br())}function Vj(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function xae(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wae(){const n=Br();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $j(){try{return typeof indexedDB=="object"}catch{return!1}}function Wj(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}function Eae(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tae="FirebaseError";class xa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Tae,Object.setPrototypeOf(this,xa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ff.prototype.create)}}class Ff{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Sae(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new xa(r,a,i)}}function Sae(n,e){return n.replace(Cae,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const Cae=/\{\$([^}]+)}/g;function Iae(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function S0(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(CF(s)&&CF(o)){if(!S0(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function CF(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Rae(n,e){const t=new bae(n,e);return t.subscribe.bind(t)}class bae{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Aae(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=NC),r.error===void 0&&(r.error=NC),r.complete===void 0&&(r.complete=NC);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Aae(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function NC(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kae=1e3,Pae=2,Lae=4*60*60*1e3,Mae=.5;function IF(n,e=kae,t=Pae){const i=e*Math.pow(t,n),r=Math.round(Mae*i*(Math.random()-.5)*2);return Math.min(Lae,i+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(n){return n&&n._delegate?n._delegate:n}class ya{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dae{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new yae;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Oae(e))try{this.getOrInitializeService({instanceIdentifier:xh})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=xh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xh){return this.instances.has(e)}getOptions(e=xh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Fae(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=xh){return this.component?this.component.multipleInstances?e:xh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Fae(n){return n===xh?void 0:n}function Oae(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nae{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Dae(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Qt||(Qt={}));const zae={debug:Qt.DEBUG,verbose:Qt.VERBOSE,info:Qt.INFO,warn:Qt.WARN,error:Qt.ERROR,silent:Qt.SILENT},Uae=Qt.INFO,Gae={[Qt.DEBUG]:"log",[Qt.VERBOSE]:"log",[Qt.INFO]:"info",[Qt.WARN]:"warn",[Qt.ERROR]:"error"},jae=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=Gae[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class BE{constructor(e){this.name=e,this._logLevel=Uae,this._logHandler=jae,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zae[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qt.DEBUG,...e),this._logHandler(this,Qt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qt.VERBOSE,...e),this._logHandler(this,Qt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qt.INFO,...e),this._logHandler(this,Qt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qt.WARN,...e),this._logHandler(this,Qt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qt.ERROR,...e),this._logHandler(this,Qt.ERROR,...e)}}const Bae=(n,e)=>e.some(t=>n instanceof t);let RF,bF;function Vae(){return RF||(RF=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $ae(){return bF||(bF=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hj=new WeakMap,VR=new WeakMap,Xj=new WeakMap,zC=new WeakMap,iP=new WeakMap;function Wae(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Tc(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Hj.set(t,n)}).catch(()=>{}),iP.set(e,n),e}function Hae(n){if(VR.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});VR.set(n,e)}let $R={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return VR.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Xj.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Tc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Xae(n){$R=n($R)}function qae(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(UC(this),e,...t);return Xj.set(i,e.sort?e.sort():[e]),Tc(i)}:$ae().includes(n)?function(...e){return n.apply(UC(this),e),Tc(Hj.get(this))}:function(...e){return Tc(n.apply(UC(this),e))}}function Kae(n){return typeof n=="function"?qae(n):(n instanceof IDBTransaction&&Hae(n),Bae(n,Vae())?new Proxy(n,$R):n)}function Tc(n){if(n instanceof IDBRequest)return Wae(n);if(zC.has(n))return zC.get(n);const e=Kae(n);return e!==n&&(zC.set(n,e),iP.set(e,n)),e}const UC=n=>iP.get(n);function qj(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Tc(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Tc(o.result),l.oldVersion,l.newVersion,Tc(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}const Yae=["get","getKey","getAll","getAllKeys","count"],Zae=["put","add","delete","clear"],GC=new Map;function AF(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(GC.get(e))return GC.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Zae.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Yae.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let u=l.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),r&&l.done]))[0]};return GC.set(e,s),s}Xae(n=>({...n,get:(e,t,i)=>AF(e,t)||n.get(e,t,i),has:(e,t)=>!!AF(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Jae(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Jae(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const WR="@firebase/app",kF="0.9.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf=new BE("@firebase/app"),ele="@firebase/app-compat",tle="@firebase/analytics-compat",nle="@firebase/analytics",ile="@firebase/app-check-compat",rle="@firebase/app-check",sle="@firebase/auth",ole="@firebase/auth-compat",ale="@firebase/database",lle="@firebase/database-compat",ule="@firebase/functions",cle="@firebase/functions-compat",hle="@firebase/installations",fle="@firebase/installations-compat",dle="@firebase/messaging",gle="@firebase/messaging-compat",ple="@firebase/performance",mle="@firebase/performance-compat",yle="@firebase/remote-config",_le="@firebase/remote-config-compat",vle="@firebase/storage",xle="@firebase/storage-compat",wle="@firebase/firestore",Ele="@firebase/firestore-compat",Tle="firebase",Sle="9.17.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR="[DEFAULT]",Cle={[WR]:"fire-core",[ele]:"fire-core-compat",[nle]:"fire-analytics",[tle]:"fire-analytics-compat",[rle]:"fire-app-check",[ile]:"fire-app-check-compat",[sle]:"fire-auth",[ole]:"fire-auth-compat",[ale]:"fire-rtdb",[lle]:"fire-rtdb-compat",[ule]:"fire-fn",[cle]:"fire-fn-compat",[hle]:"fire-iid",[fle]:"fire-iid-compat",[dle]:"fire-fcm",[gle]:"fire-fcm-compat",[ple]:"fire-perf",[mle]:"fire-perf-compat",[yle]:"fire-rc",[_le]:"fire-rc-compat",[vle]:"fire-gcs",[xle]:"fire-gcs-compat",[wle]:"fire-fst",[Ele]:"fire-fst-compat","fire-js":"fire-js",[Tle]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=new Map,XR=new Map;function Ile(n,e){try{n.container.addComponent(e)}catch(t){yf.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function al(n){const e=n.name;if(XR.has(e))return yf.debug(`There were multiple attempts to register component ${e}.`),!1;XR.set(e,n);for(const t of Rw.values())Ile(t,n);return!0}function Of(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rle={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Sc=new Ff("app","Firebase",Rle);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ble{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ya("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Sc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_=Sle;function Kj(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:HR,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Sc.create("bad-app-name",{appName:String(r)});if(t||(t=mae()),!t)throw Sc.create("no-options");const s=Rw.get(r);if(s){if(S0(t,s.options)&&S0(i,s.config))return s;throw Sc.create("duplicate-app",{appName:r})}const o=new Nae(r);for(const l of XR.values())o.addComponent(l);const a=new ble(t,i,o);return Rw.set(r,a),a}function rP(n=HR){const e=Rw.get(n);if(!e&&n===HR)return Kj();if(!e)throw Sc.create("no-app",{appName:n});return e}function ko(n,e,t){var i;let r=(i=Cle[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yf.warn(a.join(" "));return}al(new ya(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ale="firebase-heartbeat-database",kle=1,C0="firebase-heartbeat-store";let jC=null;function Yj(){return jC||(jC=qj(Ale,kle,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(C0)}}}).catch(n=>{throw Sc.create("idb-open",{originalErrorMessage:n.message})})),jC}async function Ple(n){try{return(await Yj()).transaction(C0).objectStore(C0).get(Zj(n))}catch(e){if(e instanceof xa)yf.warn(e.message);else{const t=Sc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yf.warn(t.message)}}}async function PF(n,e){try{const i=(await Yj()).transaction(C0,"readwrite");return await i.objectStore(C0).put(e,Zj(n)),i.done}catch(t){if(t instanceof xa)yf.warn(t.message);else{const i=Sc.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});yf.warn(i.message)}}}function Zj(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lle=1024,Mle=30*24*60*60*1e3;class Dle{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ole(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=LF();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const s=new Date(r.date).valueOf();return Date.now()-s<=Mle}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=LF(),{heartbeatsToSend:t,unsentEntries:i}=Fle(this._heartbeatsCache.heartbeats),r=Iw(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function LF(){return new Date().toISOString().substring(0,10)}function Fle(n,e=Lle){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),MF(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),MF(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Ole{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $j()?Wj().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Ple(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return PF(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return PF(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function MF(n){return Iw(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nle(n){al(new ya("platform-logger",e=>new Qae(e),"PRIVATE")),al(new ya("heartbeat",e=>new Dle(e),"PRIVATE")),ko(WR,kF,n),ko(WR,kF,"esm2017"),ko("fire-js","")}Nle("");var zle="firebase",Ule="9.17.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ko(zle,Ule,"app");const Qj="@firebase/installations",sP="0.6.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=1e4,eB=`w:${sP}`,tB="FIS_v2",Gle="https://firebaseinstallations.googleapis.com/v1",jle=60*60*1e3,Ble="installations",Vle="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $le={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},_f=new Ff(Ble,Vle,$le);function nB(n){return n instanceof xa&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iB({projectId:n}){return`${Gle}/projects/${n}/installations`}function rB(n){return{token:n.token,requestStatus:2,expiresIn:Hle(n.expiresIn),creationTime:Date.now()}}async function sB(n,e){const i=(await e.json()).error;return _f.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function oB({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Wle(n,{refreshToken:e}){const t=oB(n);return t.append("Authorization",Xle(e)),t}async function aB(n){const e=await n();return e.status>=500&&e.status<600?n():e}function Hle(n){return Number(n.replace("s","000"))}function Xle(n){return`${tB} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qle({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=iB(n),r=oB(n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&r.append("x-firebase-client",u)}const o={fid:t,authVersion:tB,appId:n.appId,sdkVersion:eB},a={method:"POST",headers:r,body:JSON.stringify(o)},l=await aB(()=>fetch(i,a));if(l.ok){const u=await l.json();return{fid:u.fid||t,registrationStatus:2,refreshToken:u.refreshToken,authToken:rB(u.authToken)}}else throw await sB("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lB(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kle(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yle=/^[cdef][\w-]{21}$/,qR="";function Zle(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Qle(n);return Yle.test(t)?t:qR}catch{return qR}}function Qle(n){return Kle(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uB=new Map;function cB(n,e){const t=VE(n);hB(t,e),Jle(t,e)}function hB(n,e){const t=uB.get(n);if(t)for(const i of t)i(e)}function Jle(n,e){const t=eue();t&&t.postMessage({key:n,fid:e}),tue()}let bh=null;function eue(){return!bh&&"BroadcastChannel"in self&&(bh=new BroadcastChannel("[Firebase] FID Change"),bh.onmessage=n=>{hB(n.data.key,n.data.fid)}),bh}function tue(){uB.size===0&&bh&&(bh.close(),bh=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nue="firebase-installations-database",iue=1,vf="firebase-installations-store";let BC=null;function oP(){return BC||(BC=qj(nue,iue,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(vf)}}})),BC}async function bw(n,e){const t=VE(n),r=(await oP()).transaction(vf,"readwrite"),s=r.objectStore(vf),o=await s.get(t);return await s.put(e,t),await r.done,(!o||o.fid!==e.fid)&&cB(n,e.fid),e}async function fB(n){const e=VE(n),i=(await oP()).transaction(vf,"readwrite");await i.objectStore(vf).delete(e),await i.done}async function $E(n,e){const t=VE(n),r=(await oP()).transaction(vf,"readwrite"),s=r.objectStore(vf),o=await s.get(t),a=e(o);return a===void 0?await s.delete(t):await s.put(a,t),await r.done,a&&(!o||o.fid!==a.fid)&&cB(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aP(n){let e;const t=await $E(n.appConfig,i=>{const r=rue(i),s=sue(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===qR?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function rue(n){const e=n||{fid:Zle(),registrationStatus:0};return dB(e)}function sue(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(_f.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=oue(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:aue(n)}:{installationEntry:e}}async function oue(n,e){try{const t=await qle(n,e);return bw(n.appConfig,t)}catch(t){throw nB(t)&&t.customData.serverCode===409?await fB(n.appConfig):await bw(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function aue(n){let e=await DF(n.appConfig);for(;e.registrationStatus===1;)await lB(100),e=await DF(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await aP(n);return i||t}return e}function DF(n){return $E(n,e=>{if(!e)throw _f.create("installation-not-found");return dB(e)})}function dB(n){return lue(n)?{fid:n.fid,registrationStatus:0}:n}function lue(n){return n.registrationStatus===1&&n.registrationTime+Jj<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uue({appConfig:n,heartbeatServiceProvider:e},t){const i=cue(n,t),r=Wle(n,t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&r.append("x-firebase-client",u)}const o={installation:{sdkVersion:eB,appId:n.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},l=await aB(()=>fetch(i,a));if(l.ok){const u=await l.json();return rB(u)}else throw await sB("Generate Auth Token",l)}function cue(n,{fid:e}){return`${iB(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lP(n,e=!1){let t;const i=await $E(n.appConfig,s=>{if(!gB(s))throw _f.create("not-registered");const o=s.authToken;if(!e&&due(o))return s;if(o.requestStatus===1)return t=hue(n,e),s;{if(!navigator.onLine)throw _f.create("app-offline");const a=pue(s);return t=fue(n,a),a}});return t?await t:i.authToken}async function hue(n,e){let t=await FF(n.appConfig);for(;t.authToken.requestStatus===1;)await lB(100),t=await FF(n.appConfig);const i=t.authToken;return i.requestStatus===0?lP(n,e):i}function FF(n){return $E(n,e=>{if(!gB(e))throw _f.create("not-registered");const t=e.authToken;return mue(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function fue(n,e){try{const t=await uue(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await bw(n.appConfig,i),t}catch(t){if(nB(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await fB(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await bw(n.appConfig,i)}throw t}}function gB(n){return n!==void 0&&n.registrationStatus===2}function due(n){return n.requestStatus===2&&!gue(n)}function gue(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+jle}function pue(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function mue(n){return n.requestStatus===1&&n.requestTime+Jj<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yue(n){const e=n,{installationEntry:t,registrationPromise:i}=await aP(e);return i?i.catch(console.error):lP(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _ue(n,e=!1){const t=n;return await vue(t),(await lP(t,e)).token}async function vue(n){const{registrationPromise:e}=await aP(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xue(n){if(!n||!n.options)throw VC("App Configuration");if(!n.name)throw VC("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw VC(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function VC(n){return _f.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pB="installations",wue="installations-internal",Eue=n=>{const e=n.getProvider("app").getImmediate(),t=xue(e),i=Of(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},Tue=n=>{const e=n.getProvider("app").getImmediate(),t=Of(e,pB).getImmediate();return{getId:()=>yue(t),getToken:r=>_ue(t,r)}};function Sue(){al(new ya(pB,Eue,"PUBLIC")),al(new ya(wue,Tue,"PRIVATE"))}Sue();ko(Qj,sP);ko(Qj,sP,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="analytics",Cue="firebase_id",Iue="origin",Rue=60*1e3,bue="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",mB="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks=new BE("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function Aue(n,e){const t=document.createElement("script");t.src=`${mB}?l=${n}&id=${e}`,t.async=!0,document.head.appendChild(t)}function kue(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function Pue(n,e,t,i,r,s){const o=i[r];try{if(o)await e[o];else{const l=(await yB(t)).find(u=>u.measurementId===r);l&&await e[l.appId]}}catch(a){Ks.error(a)}n("config",r,s)}async function Lue(n,e,t,i,r){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await yB(t);for(const l of o){const u=a.find(p=>p.measurementId===l),h=u&&e[u.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),n("event",i,r||{})}catch(s){Ks.error(s)}}function Mue(n,e,t,i){async function r(s,o,a){try{s==="event"?await Lue(n,e,t,o,a):s==="config"?await Pue(n,e,t,i,o,a):s==="consent"?n("consent","update",a):n("set",o)}catch(l){Ks.error(l)}}return r}function Due(n,e,t,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=Mue(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}function Fue(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(mB)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oue={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Po=new Ff("analytics","Analytics",Oue);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nue=30,zue=1e3;class Uue{constructor(e={},t=zue){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const _B=new Uue;function Gue(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function jue(n){var e;const{appId:t,apiKey:i}=n,r={method:"GET",headers:Gue(i)},s=bue.replace("{app-id}",t),o=await fetch(s,r);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Po.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Bue(n,e=_B,t){const{appId:i,apiKey:r,measurementId:s}=n.options;if(!i)throw Po.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Po.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Wue;return setTimeout(async()=>{a.abort()},t!==void 0?t:Rue),vB({appId:i,apiKey:r,measurementId:s},o,a,e)}async function vB(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=_B){var s;const{appId:o,measurementId:a}=n;try{await Vue(i,e)}catch(l){if(a)return Ks.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await jue(n);return r.deleteThrottleMetadata(o),l}catch(l){const u=l;if(!$ue(u)){if(r.deleteThrottleMetadata(o),a)return Ks.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:a};throw l}const h=Number((s=u==null?void 0:u.customData)===null||s===void 0?void 0:s.httpStatus)===503?IF(t,r.intervalMillis,Nue):IF(t,r.intervalMillis),p={throttleEndTimeMillis:Date.now()+h,backoffCount:t+1};return r.setThrottleMetadata(o,p),Ks.debug(`Calling attemptFetch again in ${h} millis`),vB(n,p,i,r)}}function Vue(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(Po.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function $ue(n){if(!(n instanceof xa)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Wue{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Hue(n,e,t,i,r){if(r&&r.global){n("event",t,i);return}else{const s=await e,o=Object.assign(Object.assign({},i),{send_to:s});n("event",t,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xue(){if($j())try{await Wj()}catch(n){return Ks.warn(Po.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return Ks.warn(Po.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function que(n,e,t,i,r,s,o){var a;const l=Bue(n);l.then(y=>{t[y.measurementId]=y.appId,n.options.measurementId&&y.measurementId!==n.options.measurementId&&Ks.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${y.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(y=>Ks.error(y)),e.push(l);const u=Xue().then(y=>{if(y)return i.getId()}),[h,p]=await Promise.all([l,u]);Fue(s)||Aue(s,h.measurementId),r("js",new Date);const m=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return m[Iue]="firebase",m.update=!0,p!=null&&(m[Cue]=p),r("config",h.measurementId,m),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kue{constructor(e){this.app=e}_delete(){return delete Sy[this.app.options.appId],Promise.resolve()}}let Sy={},OF=[];const NF={};let $C="dataLayer",Yue="gtag",zF,xB,UF=!1;function Zue(){const n=[];if(Vj()&&n.push("This is a browser extension environment."),Eae()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=Po.create("invalid-analytics-context",{errorInfo:e});Ks.warn(t.message)}}function Que(n,e,t){Zue();const i=n.options.appId;if(!i)throw Po.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Ks.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Po.create("no-api-key");if(Sy[i]!=null)throw Po.create("already-exists",{id:i});if(!UF){kue($C);const{wrappedGtag:s,gtagCore:o}=Due(Sy,OF,NF,$C,Yue);xB=s,zF=o,UF=!0}return Sy[i]=que(n,OF,NF,e,zF,$C,t),new Kue(n)}function Jue(n=rP()){n=Vr(n);const e=Of(n,Aw);return e.isInitialized()?e.getImmediate():ece(n)}function ece(n,e={}){const t=Of(n,Aw);if(t.isInitialized()){const r=t.getImmediate();if(S0(e,t.getOptions()))return r;throw Po.create("already-initialized")}return t.initialize({options:e})}function tce(n,e,t,i){n=Vr(n),Hue(xB,Sy[n.app.options.appId],e,t,i).catch(r=>Ks.error(r))}const GF="@firebase/analytics",jF="0.9.3";function nce(){al(new ya(Aw,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return Que(i,r,t)},"PUBLIC")),al(new ya("analytics-internal",n,"PRIVATE")),ko(GF,jF),ko(GF,jF,"esm2017");function n(e){try{const t=e.getProvider(Aw).getImmediate();return{logEvent:(i,r,s)=>tce(t,i,r,s)}}catch(t){throw Po.create("interop-component-reg-failed",{reason:t})}}}nce();function uP(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function wB(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ice=wB,EB=new Ff("auth","Firebase",wB());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BF=new BE("@firebase/auth");function lx(n,...e){BF.logLevel<=Qt.ERROR&&BF.error(`Auth (${h_}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(n,...e){throw cP(n,...e)}function el(n,...e){return cP(n,...e)}function TB(n,e,t){const i=Object.assign(Object.assign({},ice()),{[e]:t});return new Ff("auth","Firebase",i).create(e,{appName:n.name})}function rce(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ll(n,"argument-error"),TB(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function cP(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return EB.create(n,...e)}function ht(n,e,...t){if(!n)throw cP(e,...t)}function jl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw lx(e),new Error(e)}function iu(n,e){n||jl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF=new Map;function Bl(n){iu(n instanceof Function,"Expected a class definition");let e=VF.get(n);return e?(iu(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,VF.set(n,e),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sce(n,e){const t=Of(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(S0(s,e??{}))return r;ll(r,"already-initialized")}return t.initialize({options:e})}function oce(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Bl);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KR(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function ace(){return $F()==="http:"||$F()==="https:"}function $F(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lce(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ace()||Vj()||"connection"in navigator)?navigator.onLine:!0}function uce(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,t){this.shortDelay=e,this.longDelay=t,iu(t>e,"Short delay should be less than long delay!"),this.isMobile=vae()||xae()}get(){return lce()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(n,e){iu(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;jl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;jl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;jl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cce={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hce=new f_(3e4,6e4);function fce(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function WE(n,e,t,i,r={}){return CB(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=c_(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode),SB.fetch()(IB(n,n.config.apiHost,t,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function CB(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},cce),e);try{const r=new gce(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw O1(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw O1(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw O1(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw O1(n,"user-disabled",o);const h=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw TB(n,h,u);ll(n,h)}}catch(r){if(r instanceof xa)throw r;ll(n,"network-request-failed")}}async function dce(n,e,t,i,r={}){const s=await WE(n,e,t,i,r);return"mfaPendingCredential"in s&&ll(n,"multi-factor-auth-required",{_serverResponse:s}),s}function IB(n,e,t,i){const r=`${e}${t}?${i}`;return n.config.emulator?hP(n.config,r):`${n.config.apiScheme}://${r}`}class gce{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(el(this.auth,"network-request-failed")),hce.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function O1(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=el(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pce(n,e){return WE(n,"POST","/v1/accounts:delete",e)}async function mce(n,e){return WE(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yce(n,e=!1){const t=Vr(n),i=await t.getIdToken(e),r=fP(i);ht(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Cy(WC(r.auth_time)),issuedAtTime:Cy(WC(r.iat)),expirationTime:Cy(WC(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function WC(n){return Number(n)*1e3}function fP(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return lx("JWT malformed, contained fewer than 3 sections"),null;try{const r=Gj(t);return r?JSON.parse(r):(lx("Failed to decode base64 JWT payload"),null)}catch(r){return lx("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function _ce(n){const e=fP(n);return ht(e,"internal-error"),ht(typeof e.exp<"u","internal-error"),ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I0(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof xa&&vce(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function vce({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xce{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RB{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cy(this.lastLoginAt),this.creationTime=Cy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kw(n){var e;const t=n.auth,i=await n.getIdToken(),r=await I0(n,mce(t,{idToken:i}));ht(r==null?void 0:r.users.length,t,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Tce(s.providerUserInfo):[],a=Ece(n.providerData,o),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),h=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new RB(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,p)}async function wce(n){const e=Vr(n);await kw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ece(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Tce(n){return n.map(e=>{var{providerId:t}=e,i=uP(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sce(n,e){const t=await CB(n,{},async()=>{const i=c_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=IB(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",SB.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ht(e.idToken,"internal-error"),ht(typeof e.idToken<"u","internal-error"),ht(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_ce(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return ht(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await Sce(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new R0;return i&&(ht(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(ht(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(ht(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new R0,this.toJSON())}_performRefresh(){return jl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(n,e){ht(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Nh{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=uP(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new xce(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new RB(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await I0(this,this.stsTokenManager.getToken(this.auth,e));return ht(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return yce(this,e)}reload(){return wce(this)}_assign(e){this!==e&&(ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Nh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await kw(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await I0(this,pce(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,a,l,u,h;const p=(i=t.displayName)!==null&&i!==void 0?i:void 0,m=(r=t.email)!==null&&r!==void 0?r:void 0,y=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,x=(o=t.photoURL)!==null&&o!==void 0?o:void 0,w=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,E=(u=t.createdAt)!==null&&u!==void 0?u:void 0,T=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:I,emailVerified:A,isAnonymous:L,providerData:F,stsTokenManager:O}=t;ht(I&&O,e,"internal-error");const N=R0.fromJSON(this.name,O);ht(typeof I=="string",e,"internal-error"),Wu(p,e.name),Wu(m,e.name),ht(typeof A=="boolean",e,"internal-error"),ht(typeof L=="boolean",e,"internal-error"),Wu(y,e.name),Wu(x,e.name),Wu(w,e.name),Wu(R,e.name),Wu(E,e.name),Wu(T,e.name);const B=new Nh({uid:I,auth:e,email:m,emailVerified:A,displayName:p,isAnonymous:L,photoURL:x,phoneNumber:y,tenantId:w,stsTokenManager:N,createdAt:E,lastLoginAt:T});return F&&Array.isArray(F)&&(B.providerData=F.map(V=>Object.assign({},V))),R&&(B._redirectEventId=R),B}static async _fromIdTokenResponse(e,t,i=!1){const r=new R0;r.updateFromServerResponse(t);const s=new Nh({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await kw(s),s}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bB{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bB.type="NONE";const WF=bB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(n,e,t){return`firebase:${n}:${e}:${t}`}class kg{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=ux(this.userKey,r.apiKey,s),this.fullPersistenceKey=ux("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Nh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new kg(Bl(WF),e,i);const r=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=r[0]||Bl(WF);const o=ux(i,e.config.apiKey,e.name);let a=null;for(const u of t)try{const h=await u._get(o);if(h){const p=Nh._fromJSON(e,h);u!==s&&(a=p),s=u;break}}catch{}const l=r.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new kg(s,e,i):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new kg(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(PB(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(AB(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(MB(e))return"Blackberry";if(DB(e))return"Webos";if(dP(e))return"Safari";if((e.includes("chrome/")||kB(e))&&!e.includes("edge/"))return"Chrome";if(LB(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function AB(n=Br()){return/firefox\//i.test(n)}function dP(n=Br()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kB(n=Br()){return/crios\//i.test(n)}function PB(n=Br()){return/iemobile/i.test(n)}function LB(n=Br()){return/android/i.test(n)}function MB(n=Br()){return/blackberry/i.test(n)}function DB(n=Br()){return/webos/i.test(n)}function HE(n=Br()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Cce(n=Br()){var e;return HE(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Ice(){return wae()&&document.documentMode===10}function FB(n=Br()){return HE(n)||LB(n)||DB(n)||MB(n)||/windows phone/i.test(n)||PB(n)}function Rce(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OB(n,e=[]){let t;switch(n){case"Browser":t=HF(Br());break;case"Worker":t=`${HF(Br())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${h_}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bce{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ace{constructor(e,t,i){this.app=e,this.heartbeatServiceProvider=t,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new XF(this),this.idTokenSubscription=new XF(this),this.beforeStateQueue=new bce(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EB,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Bl(t)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await kg.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await kw(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uce()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Vr(e):null;return t&&ht(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Bl(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ff("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Bl(e)||this._popupRedirectResolver;ht(t,this,"argument-error"),this.redirectPersistenceManager=await kg.create(this,[Bl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return ht(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof t=="function"?e.addObserver(t,i,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OB(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return i&&(t["X-Firebase-Client"]=i),t}}function XE(n){return Vr(n)}class XF{constructor(e){this.auth=e,this.observer=null,this.addObserver=Rae(t=>this.observer=t)}get next(){return ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function kce(n,e,t){const i=XE(n);ht(i._canInitEmulator,i,"emulator-config-failed"),ht(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(t!=null&&t.disableWarnings),s=NB(e),{host:o,port:a}=Pce(e),l=a===null?"":`:${a}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||Lce()}function NB(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Pce(n){const e=NB(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:qF(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:qF(o)}}}function qF(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Lce(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return jl("not implemented")}_getIdTokenResponse(e){return jl("not implemented")}_linkToIdToken(e,t){return jl("not implemented")}_getReauthenticationResolver(e){return jl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pg(n,e){return dce(n,"POST","/v1/accounts:signInWithIdp",fce(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mce="http://localhost";class xf extends zB{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new xf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ll("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=uP(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new xf(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Pg(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Pg(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Pg(e,t)}buildRequest(){const e={requestUri:Mce,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=c_(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_ extends gP{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends d_{constructor(){super("facebook.com")}static credential(e){return xf._fromParams({providerId:Ju.PROVIDER_ID,signInMethod:Ju.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ju.credentialFromTaggedObject(e)}static credentialFromError(e){return Ju.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ju.credential(e.oauthAccessToken)}catch{return null}}}Ju.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ju.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl extends d_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return xf._fromParams({providerId:Nl.PROVIDER_ID,signInMethod:Nl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Nl.credentialFromTaggedObject(e)}static credentialFromError(e){return Nl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Nl.credential(t,i)}catch{return null}}}Nl.GOOGLE_SIGN_IN_METHOD="google.com";Nl.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec extends d_{constructor(){super("github.com")}static credential(e){return xf._fromParams({providerId:ec.PROVIDER_ID,signInMethod:ec.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ec.credentialFromTaggedObject(e)}static credentialFromError(e){return ec.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ec.credential(e.oauthAccessToken)}catch{return null}}}ec.GITHUB_SIGN_IN_METHOD="github.com";ec.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc extends d_{constructor(){super("twitter.com")}static credential(e,t){return xf._fromParams({providerId:tc.PROVIDER_ID,signInMethod:tc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return tc.credentialFromTaggedObject(e)}static credentialFromError(e){return tc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return tc.credential(t,i)}catch{return null}}}tc.TWITTER_SIGN_IN_METHOD="twitter.com";tc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Nh._fromIdTokenResponse(e,i,r),o=KF(i);return new Jg({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=KF(i);return new Jg({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function KF(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw extends xa{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Pw.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Pw(e,t,i,r)}}function UB(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Pw._fromErrorAndOperation(n,s,e,i):s})}async function Dce(n,e,t=!1){const i=await I0(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Jg._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fce(n,e,t=!1){const{auth:i}=n,r="reauthenticate";try{const s=await I0(n,UB(i,r,e,n),t);ht(s.idToken,i,"internal-error");const o=fP(s.idToken);ht(o,i,"internal-error");const{sub:a}=o;return ht(n.uid===a,i,"user-mismatch"),Jg._forOperation(n,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ll(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oce(n,e,t=!1){const i="signIn",r=await UB(n,i,e),s=await Jg._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function Nce(n,e,t,i){return Vr(n).onIdTokenChanged(e,t,i)}function zce(n,e,t){return Vr(n).beforeAuthStateChanged(e,t)}function Uce(n,e,t,i){return Vr(n).onAuthStateChanged(e,t,i)}function Gce(n){return Vr(n).signOut()}const Lw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GB{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Lw,"1"),this.storage.removeItem(Lw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jce(){const n=Br();return dP(n)||HE(n)}const Bce=1e3,Vce=10;class jB extends GB{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=jce()&&Rce(),this.fallbackToPolling=FB(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(i);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(i,e.newValue):this.storage.removeItem(i);else if(this.localCache[i]===e.newValue&&!t)return}const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);Ice()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Vce):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Bce)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}jB.type="LOCAL";const $ce=jB;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB extends GB{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}BB.type="SESSION";const VB=BB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wce(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new qE(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async u=>u(t.origin,s)),l=await Wce(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qE.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hce{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=pP("",20);r.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const m=p;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(){return window}function Xce(n){tl().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $B(){return typeof tl().WorkerGlobalScope<"u"&&typeof tl().importScripts=="function"}async function qce(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Kce(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Yce(){return $B()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB="firebaseLocalStorageDb",Zce=1,Mw="firebaseLocalStorage",HB="fbase_key";class g_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function KE(n,e){return n.transaction([Mw],e?"readwrite":"readonly").objectStore(Mw)}function Qce(){const n=indexedDB.deleteDatabase(WB);return new g_(n).toPromise()}function YR(){const n=indexedDB.open(WB,Zce);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Mw,{keyPath:HB})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Mw)?e(i):(i.close(),await Qce(),e(await YR()))})})}async function YF(n,e,t){const i=KE(n,!0).put({[HB]:e,value:t});return new g_(i).toPromise()}async function Jce(n,e){const t=KE(n,!1).get(e),i=await new g_(t).toPromise();return i===void 0?null:i.value}function ZF(n,e){const t=KE(n,!0).delete(e);return new g_(t).toPromise()}const ehe=800,the=3;class XB{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await YR(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>the)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $B()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qE._getInstance(Yce()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await qce(),!this.activeServiceWorker)return;this.sender=new Hce(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Kce()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await YR();return await YF(e,Lw,"1"),await ZF(e,Lw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>YF(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Jce(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ZF(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=KE(r,!1).getAll();return new g_(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ehe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XB.type="LOCAL";const nhe=XB;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ihe(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function rhe(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=el("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",ihe().appendChild(i)})}function she(n){return`__${n}${Math.floor(Math.random()*1e6)}`}new f_(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(n,e){return e?Bl(e):(ht(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP extends zB{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Pg(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Pg(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Pg(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ohe(n){return Oce(n.auth,new mP(n),n.bypassAuthState)}function ahe(n){const{auth:e,user:t}=n;return ht(t,e,"internal-error"),Fce(t,new mP(n),n.bypassAuthState)}async function lhe(n){const{auth:e,user:t}=n;return ht(t,e,"internal-error"),Dce(t,new mP(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ohe;case"linkViaPopup":case"linkViaRedirect":return lhe;case"reauthViaPopup":case"reauthViaRedirect":return ahe;default:ll(this.auth,"internal-error")}}resolve(e){iu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){iu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uhe=new f_(2e3,1e4);async function che(n,e,t){const i=XE(n);rce(n,e,gP);const r=qB(i,t);return new Ah(i,"signInViaPopup",e,r).executeNotNull()}class Ah extends KB{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Ah.currentPopupAction&&Ah.currentPopupAction.cancel(),Ah.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ht(e,this.auth,"internal-error"),e}async onExecution(){iu(this.filter.length===1,"Popup operations only handle one event");const e=pP();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(el(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(el(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ah.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(el(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,uhe.get())};e()}}Ah.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hhe="pendingRedirect",cx=new Map;class fhe extends KB{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=cx.get(this.auth._key());if(!e){try{const i=await dhe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}cx.set(this.auth._key(),e)}return this.bypassAuthState||cx.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dhe(n,e){const t=mhe(e),i=phe(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function ghe(n,e){cx.set(n._key(),e)}function phe(n){return Bl(n._redirectPersistence)}function mhe(n){return ux(hhe,n.config.apiKey,n.name)}async function yhe(n,e,t=!1){const i=XE(n),r=qB(i,e),o=await new fhe(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _he=10*60*1e3;class vhe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xhe(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!YB(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(el(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_he&&this.cachedEventUids.clear(),this.cachedEventUids.has(QF(e))}saveEventToCache(e){this.cachedEventUids.add(QF(e)),this.lastProcessedEventTime=Date.now()}}function QF(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function YB({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function xhe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return YB(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function whe(n,e={}){return WE(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ehe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,The=/^https?/;async function She(n){if(n.config.emulator)return;const{authorizedDomains:e}=await whe(n);for(const t of e)try{if(Che(t))return}catch{}ll(n,"unauthorized-domain")}function Che(n){const e=KR(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!The.test(t))return!1;if(Ehe.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ihe=new f_(3e4,6e4);function JF(){const n=tl().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Rhe(n){return new Promise((e,t)=>{var i,r,s;function o(){JF(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{JF(),t(el(n,"network-request-failed"))},timeout:Ihe.get()})}if(!((r=(i=tl().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=tl().gapi)===null||s===void 0)&&s.load)o();else{const a=she("iframefcb");return tl()[a]=()=>{gapi.load?o():t(el(n,"network-request-failed"))},rhe(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw hx=null,e})}let hx=null;function bhe(n){return hx=hx||Rhe(n),hx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ahe=new f_(5e3,15e3),khe="__/auth/iframe",Phe="emulator/auth/iframe",Lhe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Mhe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dhe(n){const e=n.config;ht(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hP(e,Phe):`https://${n.config.authDomain}/${khe}`,i={apiKey:e.apiKey,appName:n.name,v:h_},r=Mhe.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${c_(i).slice(1)}`}async function Fhe(n){const e=await bhe(n),t=tl().gapi;return ht(t,n,"internal-error"),e.open({where:document.body,url:Dhe(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Lhe,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=el(n,"network-request-failed"),a=tl().setTimeout(()=>{s(o)},Ahe.get());function l(){tl().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ohe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Nhe=500,zhe=600,Uhe="_blank",Ghe="http://localhost";class eO{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jhe(n,e,t,i=Nhe,r=zhe){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Ohe),{width:i.toString(),height:r.toString(),top:s,left:o}),u=Br().toLowerCase();t&&(a=kB(u)?Uhe:t),AB(u)&&(e=e||Ghe,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[y,x])=>`${m}${y}=${x},`,"");if(Cce(u)&&a!=="_self")return Bhe(e||"",a),new eO(null);const p=window.open(e||"",a,h);ht(p,n,"popup-blocked");try{p.focus()}catch{}return new eO(p)}function Bhe(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vhe="__/auth/handler",$he="emulator/auth/handler";function tO(n,e,t,i,r,s){ht(n.config.authDomain,n,"auth-domain-config-required"),ht(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:h_,eventId:r};if(e instanceof gP){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Iae(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[l,u]of Object.entries(s||{}))o[l]=u}if(e instanceof d_){const l=e.getScopes().filter(u=>u!=="");l.length>0&&(o.scopes=l.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const l of Object.keys(a))a[l]===void 0&&delete a[l];return`${Whe(n)}?${c_(a).slice(1)}`}function Whe({config:n}){return n.emulator?hP(n,$he):`https://${n.authDomain}/${Vhe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC="webStorageSupport";class Hhe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=VB,this._completeRedirectFn=yhe,this._overrideRedirectResult=ghe}async _openPopup(e,t,i,r){var s;iu((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=tO(e,t,i,KR(),r);return jhe(e,o,pP())}async _openRedirect(e,t,i,r){return await this._originValidation(e),Xce(tO(e,t,i,KR(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(iu(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Fhe(e),i=new vhe(e);return t.register("authEvent",r=>(ht(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(HC,{type:HC},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[HC];o!==void 0&&t(!!o),ll(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=She(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return FB()||dP()||HE()}}const Xhe=Hhe;var nO="@firebase/auth",iO="0.21.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qhe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Khe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Yhe(n){al(new ya("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:s,authDomain:o}=i.options;return((a,l)=>{ht(s&&!s.includes(":"),"invalid-api-key",{appName:a.name}),ht(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const u={apiKey:s,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OB(n)},h=new Ace(a,l,u);return oce(h,t),h})(i,r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),al(new ya("auth-internal",e=>{const t=XE(e.getProvider("auth").getImmediate());return(i=>new qhe(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ko(nO,iO,Khe(n)),ko(nO,iO,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zhe=5*60,Qhe=Bj("authIdTokenMaxAge")||Zhe;let rO=null;const Jhe=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Qhe)return;const r=t==null?void 0:t.token;rO!==r&&(rO=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function efe(n=rP()){const e=Of(n,"auth");if(e.isInitialized())return e.getImmediate();const t=sce(n,{popupRedirectResolver:Xhe,persistence:[nhe,$ce,VB]}),i=Bj("authTokenSyncURL");if(i){const s=Jhe(i);zce(t,s,()=>s(t.currentUser)),Nce(t,o=>s(o))}const r=jj("auth");return r&&kce(t,`http://${r}`),t}Yhe("Browser");var tfe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},je,yP=yP||{},ft=tfe||self;function Dw(){}function YE(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function p_(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function nfe(n){return Object.prototype.hasOwnProperty.call(n,XC)&&n[XC]||(n[XC]=++ife)}var XC="closure_uid_"+(1e9*Math.random()>>>0),ife=0;function rfe(n,e,t){return n.call.apply(n.bind,arguments)}function sfe(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function Ur(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ur=rfe:Ur=sfe,Ur.apply(null,arguments)}function N1(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Er(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(i,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(i,o)}}function Wc(){this.s=this.s,this.o=this.o}var ofe=0;Wc.prototype.s=!1;Wc.prototype.na=function(){!this.s&&(this.s=!0,this.M(),ofe!=0)&&nfe(this)};Wc.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ZB=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function _P(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function sO(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(YE(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let o=0;o<s;o++)n[r+o]=i[o]}else n.push(i)}}function Gr(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Gr.prototype.h=function(){this.defaultPrevented=!0};var afe=function(){if(!ft.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{ft.addEventListener("test",Dw,e),ft.removeEventListener("test",Dw,e)}catch{}return n}();function Fw(n){return/^[\s\xa0]*$/.test(n)}var oO=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function qC(n,e){return n<e?-1:n>e?1:0}function ZE(){var n=ft.navigator;return n&&(n=n.userAgent)?n:""}function qa(n){return ZE().indexOf(n)!=-1}function vP(n){return vP[" "](n),n}vP[" "]=Dw;function lfe(n){var e=hfe;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}var ufe=qa("Opera"),ep=qa("Trident")||qa("MSIE"),QB=qa("Edge"),ZR=QB||ep,JB=qa("Gecko")&&!(ZE().toLowerCase().indexOf("webkit")!=-1&&!qa("Edge"))&&!(qa("Trident")||qa("MSIE"))&&!qa("Edge"),cfe=ZE().toLowerCase().indexOf("webkit")!=-1&&!qa("Edge");function eV(){var n=ft.document;return n?n.documentMode:void 0}var Ow;e:{var KC="",YC=function(){var n=ZE();if(JB)return/rv:([^\);]+)(\)|;)/.exec(n);if(QB)return/Edge\/([\d\.]+)/.exec(n);if(ep)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(cfe)return/WebKit\/(\S+)/.exec(n);if(ufe)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(YC&&(KC=YC?YC[1]:""),ep){var ZC=eV();if(ZC!=null&&ZC>parseFloat(KC)){Ow=String(ZC);break e}}Ow=KC}var hfe={};function ffe(){return lfe(function(){let n=0;const e=oO(String(Ow)).split("."),t=oO("9").split("."),i=Math.max(e.length,t.length);for(let o=0;n==0&&o<i;o++){var r=e[o]||"",s=t[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r[0].length==0&&s[0].length==0)break;n=qC(r[1].length==0?0:parseInt(r[1],10),s[1].length==0?0:parseInt(s[1],10))||qC(r[2].length==0,s[2].length==0)||qC(r[2],s[2]),r=r[3],s=s[3]}while(n==0)}return 0<=n})}var QR;if(ft.document&&ep){var aO=eV();QR=aO||parseInt(Ow,10)||void 0}else QR=void 0;var dfe=QR;function b0(n,e){if(Gr.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(JB){e:{try{vP(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:gfe[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&b0.X.h.call(this)}}Er(b0,Gr);var gfe={2:"touch",3:"pen",4:"mouse"};b0.prototype.h=function(){b0.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var m_="closure_listenable_"+(1e6*Math.random()|0),pfe=0;function mfe(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.ha=r,this.key=++pfe,this.ba=this.ea=!1}function QE(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function xP(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function tV(n){const e={};for(const t in n)e[t]=n[t];return e}const lO="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nV(n,e){let t,i;for(let r=1;r<arguments.length;r++){i=arguments[r];for(t in i)n[t]=i[t];for(let s=0;s<lO.length;s++)t=lO[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function JE(n){this.src=n,this.g={},this.h=0}JE.prototype.add=function(n,e,t,i,r){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var o=eb(n,e,i,r);return-1<o?(e=n[o],t||(e.ea=!1)):(e=new mfe(e,this.src,s,!!i,r),e.ea=t,n.push(e)),e};function JR(n,e){var t=e.type;if(t in n.g){var i=n.g[t],r=ZB(i,e),s;(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(QE(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function eb(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.ba&&s.listener==e&&s.capture==!!t&&s.ha==i)return r}return-1}var wP="closure_lm_"+(1e6*Math.random()|0),QC={};function iV(n,e,t,i,r){if(i&&i.once)return sV(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)iV(n,e[s],t,i,r);return null}return t=SP(t),n&&n[m_]?n.N(e,t,p_(i)?!!i.capture:!!i,r):rV(n,e,t,!1,i,r)}function rV(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var o=p_(r)?!!r.capture:!!r,a=TP(n);if(a||(n[wP]=a=new JE(n)),t=a.add(e,t,i,o,s),t.proxy)return t;if(i=yfe(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)afe||(r=o),r===void 0&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(aV(e.toString()),i);else if(n.addListener&&n.removeListener)n.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return t}function yfe(){function n(t){return e.call(n.src,n.listener,t)}const e=_fe;return n}function sV(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)sV(n,e[s],t,i,r);return null}return t=SP(t),n&&n[m_]?n.O(e,t,p_(i)?!!i.capture:!!i,r):rV(n,e,t,!0,i,r)}function oV(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)oV(n,e[s],t,i,r);else i=p_(i)?!!i.capture:!!i,t=SP(t),n&&n[m_]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=eb(s,t,i,r),-1<t&&(QE(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=TP(n))&&(e=n.g[e.toString()],n=-1,e&&(n=eb(e,t,i,r)),(t=-1<n?e[n]:null)&&EP(t))}function EP(n){if(typeof n!="number"&&n&&!n.ba){var e=n.src;if(e&&e[m_])JR(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(aV(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=TP(e))?(JR(t,n),t.h==0&&(t.src=null,e[wP]=null)):QE(n)}}}function aV(n){return n in QC?QC[n]:QC[n]="on"+n}function _fe(n,e){if(n.ba)n=!0;else{e=new b0(e,this);var t=n.listener,i=n.ha||n.src;n.ea&&EP(n),n=t.call(i,e)}return n}function TP(n){return n=n[wP],n instanceof JE?n:null}var JC="__closure_events_fn_"+(1e9*Math.random()>>>0);function SP(n){return typeof n=="function"?n:(n[JC]||(n[JC]=function(e){return n.handleEvent(e)}),n[JC])}function ir(){Wc.call(this),this.i=new JE(this),this.P=this,this.I=null}Er(ir,Wc);ir.prototype[m_]=!0;ir.prototype.removeEventListener=function(n,e,t,i){oV(this,n,e,t,i)};function _r(n,e){var t,i=n.I;if(i)for(t=[];i;i=i.I)t.push(i);if(n=n.P,i=e.type||e,typeof e=="string")e=new Gr(e,n);else if(e instanceof Gr)e.target=e.target||n;else{var r=e;e=new Gr(i,n),nV(e,r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=z1(o,i,!0,e)&&r}if(o=e.g=n,r=z1(o,i,!0,e)&&r,r=z1(o,i,!1,e)&&r,t)for(s=0;s<t.length;s++)o=e.g=t[s],r=z1(o,i,!1,e)&&r}ir.prototype.M=function(){if(ir.X.M.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)QE(t[i]);delete n.g[e],n.h--}}this.I=null};ir.prototype.N=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)};ir.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};function z1(n,e,t,i){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ba&&o.capture==t){var a=o.listener,l=o.ha||o.src;o.ea&&JR(n.i,o),r=a.call(l,i)!==!1&&r}}return r&&!i.defaultPrevented}var CP=ft.JSON.stringify;function vfe(){var n=cV;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class xfe{constructor(){this.h=this.g=null}add(e,t){const i=lV.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}}var lV=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new wfe,n=>n.reset());class wfe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Efe(n){ft.setTimeout(()=>{throw n},0)}function uV(n,e){tb||Tfe(),nb||(tb(),nb=!0),cV.add(n,e)}var tb;function Tfe(){var n=ft.Promise.resolve(void 0);tb=function(){n.then(Sfe)}}var nb=!1,cV=new xfe;function Sfe(){for(var n;n=vfe();){try{n.h.call(n.g)}catch(t){Efe(t)}var e=lV;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}nb=!1}function eT(n,e){ir.call(this),this.h=n||1,this.g=e||ft,this.j=Ur(this.lb,this),this.l=Date.now()}Er(eT,ir);je=eT.prototype;je.ca=!1;je.R=null;je.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),_r(this,"tick"),this.ca&&(IP(this),this.start()))}};je.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function IP(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}je.M=function(){eT.X.M.call(this),IP(this),delete this.g};function RP(n,e,t){if(typeof n=="function")t&&(n=Ur(n,t));else if(n&&typeof n.handleEvent=="function")n=Ur(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ft.setTimeout(n,e||0)}function hV(n){n.g=RP(()=>{n.g=null,n.i&&(n.i=!1,hV(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class Cfe extends Wc{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:hV(this)}M(){super.M(),this.g&&(ft.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function A0(n){Wc.call(this),this.h=n,this.g={}}Er(A0,Wc);var uO=[];function fV(n,e,t,i){Array.isArray(t)||(t&&(uO[0]=t.toString()),t=uO);for(var r=0;r<t.length;r++){var s=iV(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function dV(n){xP(n.g,function(e,t){this.g.hasOwnProperty(t)&&EP(e)},n),n.g={}}A0.prototype.M=function(){A0.X.M.call(this),dV(this)};A0.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function tT(){this.g=!0}tT.prototype.Aa=function(){this.g=!1};function Ife(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var h=u[0];u=u[1];var p=h.split("_");o=2<=p.length&&p[1]=="type"?o+(h+"="+u+"&"):o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+`
`+t+`
`+o})}function Rfe(n,e,t,i,r,s,o){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+`
`+t+`
`+s+" "+o})}function ag(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+Afe(n,t)+(i?" "+i:"")})}function bfe(n,e){n.info(function(){return"TIMEOUT: "+e})}tT.prototype.info=function(){};function Afe(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return CP(t)}catch{return e}}var Nf={},cO=null;function nT(){return cO=cO||new ir}Nf.Pa="serverreachability";function gV(n){Gr.call(this,Nf.Pa,n)}Er(gV,Gr);function k0(n){const e=nT();_r(e,new gV(e))}Nf.STAT_EVENT="statevent";function pV(n,e){Gr.call(this,Nf.STAT_EVENT,n),this.stat=e}Er(pV,Gr);function ss(n){const e=nT();_r(e,new pV(e,n))}Nf.Qa="timingevent";function mV(n,e){Gr.call(this,Nf.Qa,n),this.size=e}Er(mV,Gr);function y_(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return ft.setTimeout(function(){n()},e)}var iT={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},yV={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function bP(){}bP.prototype.h=null;function hO(n){return n.h||(n.h=n.i())}function _V(){}var __={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function AP(){Gr.call(this,"d")}Er(AP,Gr);function kP(){Gr.call(this,"c")}Er(kP,Gr);var ib;function rT(){}Er(rT,bP);rT.prototype.g=function(){return new XMLHttpRequest};rT.prototype.i=function(){return{}};ib=new rT;function v_(n,e,t,i){this.l=n,this.j=e,this.m=t,this.U=i||1,this.S=new A0(this),this.O=kfe,n=ZR?125:void 0,this.T=new eT(n),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new vV}function vV(){this.i=null,this.g="",this.h=!1}var kfe=45e3,rb={},Nw={};je=v_.prototype;je.setTimeout=function(n){this.O=n};function sb(n,e,t){n.K=1,n.v=oT(ru(e)),n.s=t,n.P=!0,xV(n,null)}function xV(n,e){n.F=Date.now(),x_(n),n.A=ru(n.v);var t=n.A,i=n.U;Array.isArray(i)||(i=[String(i)]),bV(t.i,"t",i),n.C=0,t=n.l.H,n.h=new vV,n.g=KV(n.l,t?e:null,!n.s),0<n.N&&(n.L=new Cfe(Ur(n.La,n,n.g),n.N)),fV(n.S,n.g,"readystatechange",n.ib),e=n.H?tV(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),k0(),Ife(n.j,n.u,n.A,n.m,n.U,n.s)}je.ib=function(n){n=n.target;const e=this.L;e&&Vl(n)==3?e.l():this.La(n)};je.La=function(n){try{if(n==this.g)e:{const h=Vl(this.g);var e=this.g.Ea();const p=this.g.aa();if(!(3>h)&&(h!=3||ZR||this.g&&(this.h.h||this.g.fa()||pO(this.g)))){this.I||h!=4||e==7||(e==8||0>=p?k0(3):k0(2)),sT(this);var t=this.g.aa();this.Y=t;t:if(wV(this)){var i=pO(this.g);n="";var r=i.length,s=Vl(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){kh(this),Iy(this);var o="";break t}this.h.i=new ft.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=t==200,Rfe(this.j,this.u,this.A,this.m,this.U,h,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Fw(a)){var u=a;break t}}u=null}if(t=u)ag(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ob(this,t);else{this.i=!1,this.o=3,ss(12),kh(this),Iy(this);break e}}this.P?(EV(this,h,o),ZR&&this.i&&h==3&&(fV(this.S,this.T,"tick",this.hb),this.T.start())):(ag(this.j,this.m,o,null),ob(this,o)),h==4&&kh(this),this.i&&!this.I&&(h==4?WV(this.l,this):(this.i=!1,x_(this)))}else t==400&&0<o.indexOf("Unknown SID")?(this.o=3,ss(12)):(this.o=0,ss(13)),kh(this),Iy(this)}}}catch{}finally{}};function wV(n){return n.g?n.u=="GET"&&n.K!=2&&n.l.Da:!1}function EV(n,e,t){let i=!0,r;for(;!n.I&&n.C<t.length;)if(r=Pfe(n,t),r==Nw){e==4&&(n.o=4,ss(14),i=!1),ag(n.j,n.m,null,"[Incomplete Response]");break}else if(r==rb){n.o=4,ss(15),ag(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}else ag(n.j,n.m,r,null),ob(n,r);wV(n)&&r!=Nw&&r!=rb&&(n.h.g="",n.C=0),e!=4||t.length!=0||n.h.h||(n.o=1,ss(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.$&&(n.$=!0,e=n.l,e.g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),NP(e),e.K=!0,ss(11))):(ag(n.j,n.m,t,"[Invalid Chunked Response]"),kh(n),Iy(n))}je.hb=function(){if(this.g){var n=Vl(this.g),e=this.g.fa();this.C<e.length&&(sT(this),EV(this,n,e),this.i&&n!=4&&x_(this))}};function Pfe(n,e){var t=n.C,i=e.indexOf(`
`,t);return i==-1?Nw:(t=Number(e.substring(t,i)),isNaN(t)?rb:(i+=1,i+t>e.length?Nw:(e=e.substr(i,t),n.C=i+t,e)))}je.cancel=function(){this.I=!0,kh(this)};function x_(n){n.V=Date.now()+n.O,TV(n,n.O)}function TV(n,e){if(n.B!=null)throw Error("WatchDog timer not null");n.B=y_(Ur(n.gb,n),e)}function sT(n){n.B&&(ft.clearTimeout(n.B),n.B=null)}je.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(bfe(this.j,this.A),this.K!=2&&(k0(),ss(17)),kh(this),this.o=2,Iy(this)):TV(this,this.V-n)};function Iy(n){n.l.G==0||n.I||WV(n.l,n)}function kh(n){sT(n);var e=n.L;e&&typeof e.na=="function"&&e.na(),n.L=null,IP(n.T),dV(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function ob(n,e){try{var t=n.l;if(t.G!=0&&(t.g==n||ab(t.h,n))){if(!n.J&&ab(t.h,n)&&t.G==3){try{var i=t.Fa.g.parse(e)}catch{i=null}if(Array.isArray(i)&&i.length==3){var r=i;if(r[0]==0){e:if(!t.u){if(t.g)if(t.g.F+3e3<n.F)Gw(t),uT(t);else break e;OP(t),ss(18)}}else t.Ba=r[1],0<t.Ba-t.T&&37500>r[2]&&t.L&&t.A==0&&!t.v&&(t.v=y_(Ur(t.cb,t),6e3));if(1>=PV(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else Ph(t,11)}else if((n.J||t.g==n)&&Gw(t),!Fw(e))for(r=t.Fa.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(t.T=u[0],u=u[1],t.G==2)if(u[0]=="c"){t.I=u[1],t.ka=u[2];const h=u[3];h!=null&&(t.ma=h,t.j.info("VER="+t.ma));const p=u[4];p!=null&&(t.Ca=p,t.j.info("SVER="+t.Ca));const m=u[5];m!=null&&typeof m=="number"&&0<m&&(i=1.5*m,t.J=i,t.j.info("backChannelRequestTimeoutMs_="+i)),i=t;const y=n.g;if(y){const x=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(x){var s=i.h;s.g||x.indexOf("spdy")==-1&&x.indexOf("quic")==-1&&x.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(PP(s,s.h),s.h=null))}if(i.D){const w=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;w&&(i.za=w,kn(i.F,i.D,w))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms")),i=t;var o=n;if(i.sa=qV(i,i.H?i.ka:null,i.V),o.J){LV(i.h,o);var a=o,l=i.J;l&&a.setTimeout(l),a.B&&(sT(a),x_(a)),i.g=o}else VV(i);0<t.i.length&&cT(t)}else u[0]!="stop"&&u[0]!="close"||Ph(t,7);else t.G==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Ph(t,7):FP(t):u[0]!="noop"&&t.l&&t.l.wa(u),t.A=0)}}k0(4)}catch{}}function Lfe(n){if(n.W&&typeof n.W=="function")return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(YE(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}e=[],t=0;for(i in n)e[t++]=n[i];return e}function Mfe(n){if(n.oa&&typeof n.oa=="function")return n.oa();if(!n.W||typeof n.W!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(YE(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}function SV(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(YE(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=Mfe(n),i=Lfe(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}var CV=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Dfe(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function zh(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof zh){this.h=e!==void 0?e:n.h,zw(this,n.j),this.s=n.s,this.g=n.g,Uw(this,n.m),this.l=n.l,e=n.i;var t=new P0;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),fO(this,t),this.o=n.o}else n&&(t=String(n).match(CV))?(this.h=!!e,zw(this,t[1]||"",!0),this.s=iy(t[2]||""),this.g=iy(t[3]||"",!0),Uw(this,t[4]),this.l=iy(t[5]||"",!0),fO(this,t[6]||"",!0),this.o=iy(t[7]||"")):(this.h=!!e,this.i=new P0(null,this.h))}zh.prototype.toString=function(){var n=[],e=this.j;e&&n.push(ry(e,dO,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(ry(e,dO,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(ry(t,t.charAt(0)=="/"?Nfe:Ofe,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",ry(t,Ufe)),n.join("")};function ru(n){return new zh(n)}function zw(n,e,t){n.j=t?iy(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Uw(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function fO(n,e,t){e instanceof P0?(n.i=e,Gfe(n.i,n.h)):(t||(e=ry(e,zfe)),n.i=new P0(e,n.h))}function kn(n,e,t){n.i.set(e,t)}function oT(n){return kn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function iy(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function ry(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,Ffe),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Ffe(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var dO=/[#\/\?@]/g,Ofe=/[#\?:]/g,Nfe=/[#\?]/g,zfe=/[#\?@]/g,Ufe=/#/g;function P0(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Hc(n){n.g||(n.g=new Map,n.h=0,n.i&&Dfe(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}je=P0.prototype;je.add=function(n,e){Hc(this),this.i=null,n=Sp(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function IV(n,e){Hc(n),e=Sp(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function RV(n,e){return Hc(n),e=Sp(n,e),n.g.has(e)}je.forEach=function(n,e){Hc(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)};je.oa=function(){Hc(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t};je.W=function(n){Hc(this);let e=[];if(typeof n=="string")RV(this,n)&&(e=e.concat(this.g.get(Sp(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};je.set=function(n,e){return Hc(this),this.i=null,n=Sp(this,n),RV(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};je.get=function(n,e){return n?(n=this.W(n),0<n.length?String(n[0]):e):e};function bV(n,e,t){IV(n,e),0<t.length&&(n.i=null,n.g.set(Sp(n,e),_P(t)),n.h+=t.length)}je.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),o=this.W(i);for(i=0;i<o.length;i++){var r=s;o[i]!==""&&(r+="="+encodeURIComponent(String(o[i]))),n.push(r)}}return this.i=n.join("&")};function Sp(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Gfe(n,e){e&&!n.j&&(Hc(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(IV(this,i),bV(this,r,t))},n)),n.j=e}var jfe=class{constructor(e,t){this.h=e,this.g=t}};function AV(n){this.l=n||Bfe,ft.PerformanceNavigationTiming?(n=ft.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(ft.g&&ft.g.Ga&&ft.g.Ga()&&ft.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Bfe=10;function kV(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function PV(n){return n.h?1:n.g?n.g.size:0}function ab(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function PP(n,e){n.g?n.g.add(e):n.h=e}function LV(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}AV.prototype.cancel=function(){if(this.i=MV(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function MV(n){if(n.h!=null)return n.i.concat(n.h.D);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return _P(n.i)}function LP(){}LP.prototype.stringify=function(n){return ft.JSON.stringify(n,void 0)};LP.prototype.parse=function(n){return ft.JSON.parse(n,void 0)};function Vfe(){this.g=new LP}function $fe(n,e,t){const i=t||"";try{SV(n,function(r,s){let o=r;p_(r)&&(o=CP(r)),e.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function Wfe(n,e){const t=new tT;if(ft.Image){const i=new Image;i.onload=N1(U1,t,i,"TestLoadImage: loaded",!0,e),i.onerror=N1(U1,t,i,"TestLoadImage: error",!1,e),i.onabort=N1(U1,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=N1(U1,t,i,"TestLoadImage: timeout",!1,e),ft.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}function U1(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function w_(n){this.l=n.ac||null,this.j=n.jb||!1}Er(w_,bP);w_.prototype.g=function(){return new aT(this.l,this.j)};w_.prototype.i=function(n){return function(){return n}}({});function aT(n,e){ir.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=MP,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Er(aT,ir);var MP=0;je=aT.prototype;je.open=function(n,e){if(this.readyState!=MP)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,L0(this)};je.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||ft).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))};je.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,E_(this)),this.readyState=MP};je.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,L0(this)),this.g&&(this.readyState=3,L0(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof ft.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;DV(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))};function DV(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}je.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?E_(this):L0(this),this.readyState==3&&DV(this)}};je.Va=function(n){this.g&&(this.response=this.responseText=n,E_(this))};je.Ua=function(n){this.g&&(this.response=n,E_(this))};je.ga=function(){this.g&&E_(this)};function E_(n){n.readyState=4,n.l=null,n.j=null,n.A=null,L0(n)}je.setRequestHeader=function(n,e){this.v.append(n,e)};je.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};je.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function L0(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(aT.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var Hfe=ft.JSON.parse;function Jn(n){ir.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=FV,this.K=this.L=!1}Er(Jn,ir);var FV="",Xfe=/^https?$/i,qfe=["POST","PUT"];je=Jn.prototype;je.Ka=function(n){this.L=n};je.da=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ib.g(),this.C=this.u?hO(this.u):hO(ib),this.g.onreadystatechange=Ur(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(s){gO(this,s);return}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else if(typeof i.keys=="function"&&typeof i.get=="function")for(const s of i.keys())t.set(s,i.get(s));else throw Error("Unknown input type for opt_headers: "+String(i));i=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),r=ft.FormData&&n instanceof ft.FormData,!(0<=ZB(qfe,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{zV(this),0<this.B&&((this.K=Kfe(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ur(this.qa,this)):this.A=RP(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){gO(this,s)}};function Kfe(n){return ep&&ffe()&&typeof n.timeout=="number"&&n.ontimeout!==void 0}je.qa=function(){typeof yP<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_r(this,"timeout"),this.abort(8))};function gO(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,OV(n),lT(n)}function OV(n){n.D||(n.D=!0,_r(n,"complete"),_r(n,"error"))}je.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,_r(this,"complete"),_r(this,"abort"),lT(this))};je.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),lT(this,!0)),Jn.X.M.call(this)};je.Ha=function(){this.s||(this.F||this.v||this.l?NV(this):this.fb())};je.fb=function(){NV(this)};function NV(n){if(n.h&&typeof yP<"u"&&(!n.C[1]||Vl(n)!=4||n.aa()!=2)){if(n.v&&Vl(n)==4)RP(n.Ha,0,n);else if(_r(n,"readystatechange"),Vl(n)==4){n.h=!1;try{const a=n.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=a===0){var r=String(n.H).match(CV)[1]||null;if(!r&&ft.self&&ft.self.location){var s=ft.self.location.protocol;r=s.substr(0,s.length-1)}i=!Xfe.test(r?r.toLowerCase():"")}t=i}if(t)_r(n,"complete"),_r(n,"success");else{n.m=6;try{var o=2<Vl(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",OV(n)}}finally{lT(n)}}}}function lT(n,e){if(n.g){zV(n);const t=n.g,i=n.C[0]?Dw:null;n.g=null,n.C=null,e||_r(n,"ready");try{t.onreadystatechange=i}catch{}}}function zV(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(ft.clearTimeout(n.A),n.A=null)}function Vl(n){return n.g?n.g.readyState:0}je.aa=function(){try{return 2<Vl(this)?this.g.status:-1}catch{return-1}};je.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}};je.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),Hfe(e)}};function pO(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case FV:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}je.Ea=function(){return this.m};je.Oa=function(){return typeof this.j=="string"?this.j:String(this.j)};function UV(n){let e="";return xP(n,function(t,i){e+=i,e+=":",e+=t,e+=`\r
`}),e}function DP(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=UV(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):kn(n,e,t))}function Xm(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function GV(n){this.Ca=0,this.i=[],this.j=new tT,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Xm("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Xm("baseRetryDelayMs",5e3,n),this.bb=Xm("retryDelaySeedMs",1e4,n),this.$a=Xm("forwardChannelMaxRetries",2,n),this.ta=Xm("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new AV(n&&n.concurrentRequestLimit),this.Fa=new Vfe,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}je=GV.prototype;je.ma=8;je.G=1;function FP(n){if(jV(n),n.G==3){var e=n.U++,t=ru(n.F);kn(t,"SID",n.I),kn(t,"RID",e),kn(t,"TYPE","terminate"),T_(n,t),e=new v_(n,n.j,e,void 0),e.K=2,e.v=oT(ru(t)),t=!1,ft.navigator&&ft.navigator.sendBeacon&&(t=ft.navigator.sendBeacon(e.v.toString(),"")),!t&&ft.Image&&(new Image().src=e.v,t=!0),t||(e.g=KV(e.l,null),e.g.da(e.v)),e.F=Date.now(),x_(e)}XV(n)}function uT(n){n.g&&(NP(n),n.g.cancel(),n.g=null)}function jV(n){uT(n),n.u&&(ft.clearTimeout(n.u),n.u=null),Gw(n),n.h.cancel(),n.m&&(typeof n.m=="number"&&ft.clearTimeout(n.m),n.m=null)}function cT(n){kV(n.h)||n.m||(n.m=!0,uV(n.Ja,n),n.C=0)}function Yfe(n,e){return PV(n.h)>=n.h.j-(n.m?1:0)?!1:n.m?(n.i=e.D.concat(n.i),!0):n.G==1||n.G==2||n.C>=(n.Za?0:n.$a)?!1:(n.m=y_(Ur(n.Ja,n,e),HV(n,n.C)),n.C++,!0)}je.Ja=function(n){if(this.m)if(this.m=null,this.G==1){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const r=new v_(this,this.j,n,void 0);let s=this.s;if(this.S&&(s?(s=tV(s),nV(s,this.S)):s=this.S),this.o!==null||this.N||(r.H=s,s=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){t:{var i=this.i[t];if("__data__"in i.g&&(i=i.g.__data__,typeof i=="string")){i=i.length;break t}i=void 0}if(i===void 0)break;if(e+=i,4096<e){e=t;break e}if(e===4096||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=BV(this,r,e),t=ru(this.F),kn(t,"RID",n),kn(t,"CVER",22),this.D&&kn(t,"X-HTTP-Session-Id",this.D),T_(this,t),s&&(this.N?e="headers="+encodeURIComponent(String(UV(s)))+"&"+e:this.o&&DP(t,this.o,s)),PP(this.h,r),this.Ya&&kn(t,"TYPE","init"),this.O?(kn(t,"$req",e),kn(t,"SID","null"),r.Z=!0,sb(r,t,null)):sb(r,t,e),this.G=2}}else this.G==3&&(n?mO(this,n):this.i.length==0||kV(this.h)||mO(this))};function mO(n,e){var t;e?t=e.m:t=n.U++;const i=ru(n.F);kn(i,"SID",n.I),kn(i,"RID",t),kn(i,"AID",n.T),T_(n,i),n.o&&n.s&&DP(i,n.o,n.s),t=new v_(n,n.j,t,n.C+1),n.o===null&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=BV(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),PP(n.h,t),sb(t,i,e)}function T_(n,e){n.ia&&xP(n.ia,function(t,i){kn(e,i,t)}),n.l&&SV({},function(t,i){kn(e,i,t)})}function BV(n,e,t){t=Math.min(n.i.length,t);var i=n.l?Ur(n.l.Ra,n.l,n):null;e:{var r=n.i;let s=-1;for(;;){const o=["count="+t];s==-1?0<t?(s=r[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<t;l++){let u=r[l].h;const h=r[l].g;if(u-=s,0>u)s=Math.max(0,r[l].h-100),a=!1;else try{$fe(h,o,"req"+u+"_")}catch{i&&i(h)}}if(a){i=o.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,i}function VV(n){n.g||n.u||(n.Z=1,uV(n.Ia,n),n.A=0)}function OP(n){return n.g||n.u||3<=n.A?!1:(n.Z++,n.u=y_(Ur(n.Ia,n),HV(n,n.A)),n.A++,!0)}je.Ia=function(){if(this.u=null,$V(this),this.$&&!(this.K||this.g==null||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=y_(Ur(this.eb,this),n)}};je.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,ss(10),uT(this),$V(this))};function NP(n){n.B!=null&&(ft.clearTimeout(n.B),n.B=null)}function $V(n){n.g=new v_(n,n.j,"rpc",n.Z),n.o===null&&(n.g.H=n.s),n.g.N=0;var e=ru(n.sa);kn(e,"RID","rpc"),kn(e,"SID",n.I),kn(e,"CI",n.L?"0":"1"),kn(e,"AID",n.T),kn(e,"TYPE","xmlhttp"),T_(n,e),n.o&&n.s&&DP(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=oT(ru(e)),t.s=null,t.P=!0,xV(t,n)}je.cb=function(){this.v!=null&&(this.v=null,uT(this),OP(this),ss(19))};function Gw(n){n.v!=null&&(ft.clearTimeout(n.v),n.v=null)}function WV(n,e){var t=null;if(n.g==e){Gw(n),NP(n),n.g=null;var i=2}else if(ab(n.h,e))t=e.D,LV(n.h,e),i=1;else return;if(n.G!=0){if(n.pa=e.Y,e.i)if(i==1){t=e.s?e.s.length:0,e=Date.now()-e.F;var r=n.C;i=nT(),_r(i,new mV(i,t)),cT(n)}else VV(n);else if(r=e.o,r==3||r==0&&0<n.pa||!(i==1&&Yfe(n,e)||i==2&&OP(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),r){case 1:Ph(n,5);break;case 4:Ph(n,10);break;case 3:Ph(n,6);break;default:Ph(n,2)}}}function HV(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function Ph(n,e){if(n.j.info("Error code "+e),e==2){var t=null;n.l&&(t=null);var i=Ur(n.kb,n);t||(t=new zh("//www.google.com/images/cleardot.gif"),ft.location&&ft.location.protocol=="http"||zw(t,"https"),oT(t)),Wfe(t.toString(),i)}else ss(2);n.G=0,n.l&&n.l.va(e),XV(n),jV(n)}je.kb=function(n){n?(this.j.info("Successfully pinged google.com"),ss(2)):(this.j.info("Failed to ping google.com"),ss(1))};function XV(n){if(n.G=0,n.la=[],n.l){const e=MV(n.h);(e.length!=0||n.i.length!=0)&&(sO(n.la,e),sO(n.la,n.i),n.h.i.length=0,_P(n.i),n.i.length=0),n.l.ua()}}function qV(n,e,t){var i=t instanceof zh?ru(t):new zh(t,void 0);if(i.g!="")e&&(i.g=e+"."+i.g),Uw(i,i.m);else{var r=ft.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new zh(null,void 0);i&&zw(s,i),e&&(s.g=e),r&&Uw(s,r),t&&(s.l=t),i=s}return t=n.D,e=n.za,t&&e&&kn(i,t,e),kn(i,"VER",n.ma),T_(n,i),i}function KV(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=t&&n.Da&&!n.ra?new Jn(new w_({jb:!0})):new Jn(n.ra),e.Ka(n.H),e}function YV(){}je=YV.prototype;je.xa=function(){};je.wa=function(){};je.va=function(){};je.ua=function(){};je.Ra=function(){};function jw(){if(ep&&!(10<=Number(dfe)))throw Error("Environmental error: no available transport.")}jw.prototype.g=function(n,e){return new Qs(n,e)};function Qs(n,e){ir.call(this),this.g=new GV(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Fw(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Fw(e)&&(this.g.D=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new Cp(this)}Er(Qs,ir);Qs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;ss(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=qV(n,null,n.V),cT(n)};Qs.prototype.close=function(){FP(this.g)};Qs.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=CP(n),n=t);e.i.push(new jfe(e.ab++,n)),e.G==3&&cT(e)};Qs.prototype.M=function(){this.g.l=null,delete this.j,FP(this.g),delete this.g,Qs.X.M.call(this)};function ZV(n){AP.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}Er(ZV,AP);function QV(){kP.call(this),this.status=1}Er(QV,kP);function Cp(n){this.g=n}Er(Cp,YV);Cp.prototype.xa=function(){_r(this.g,"a")};Cp.prototype.wa=function(n){_r(this.g,new ZV(n))};Cp.prototype.va=function(n){_r(this.g,new QV)};Cp.prototype.ua=function(){_r(this.g,"b")};jw.prototype.createWebChannel=jw.prototype.g;Qs.prototype.send=Qs.prototype.u;Qs.prototype.open=Qs.prototype.m;Qs.prototype.close=Qs.prototype.close;iT.NO_ERROR=0;iT.TIMEOUT=8;iT.HTTP_ERROR=6;yV.COMPLETE="complete";_V.EventType=__;__.OPEN="a";__.CLOSE="b";__.ERROR="c";__.MESSAGE="d";ir.prototype.listen=ir.prototype.N;Jn.prototype.listenOnce=Jn.prototype.O;Jn.prototype.getLastError=Jn.prototype.Oa;Jn.prototype.getLastErrorCode=Jn.prototype.Ea;Jn.prototype.getStatus=Jn.prototype.aa;Jn.prototype.getResponseJson=Jn.prototype.Sa;Jn.prototype.getResponseText=Jn.prototype.fa;Jn.prototype.send=Jn.prototype.da;Jn.prototype.setWithCredentials=Jn.prototype.Ka;var Zfe=function(){return new jw},Qfe=function(){return nT()},eI=iT,Jfe=yV,ede=Nf,yO={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},tde=w_,G1=_V,nde=Jn;const _O="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dr.UNAUTHENTICATED=new Dr(null),Dr.GOOGLE_CREDENTIALS=new Dr("google-credentials-uid"),Dr.FIRST_PARTY=new Dr("first-party-uid"),Dr.MOCK_USER=new Dr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ip="9.17.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wf=new BE("@firebase/firestore");function vO(){return wf.logLevel}function We(n,...e){if(wf.logLevel<=Qt.DEBUG){const t=e.map(zP);wf.debug(`Firestore (${Ip}): ${n}`,...t)}}function su(n,...e){if(wf.logLevel<=Qt.ERROR){const t=e.map(zP);wf.error(`Firestore (${Ip}): ${n}`,...t)}}function lb(n,...e){if(wf.logLevel<=Qt.WARN){const t=e.map(zP);wf.warn(`Firestore (${Ip}): ${n}`,...t)}}function zP(n){if(typeof n=="string")return n;try{return e=n,JSON.stringify(e)}catch{return n}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(n="Unexpected state"){const e=`FIRESTORE (${Ip}) INTERNAL ASSERTION FAILED: `+n;throw su(e),new Error(e)}function pn(n,e){n||at()}function Et(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ye={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends xa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ide{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Dr.UNAUTHENTICATED))}shutdown(){}}class rde{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class sde{constructor(e){this.t=e,this.currentUser=Dr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let i=this.i;const r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new Cc;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Cc,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Cc)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(pn(typeof i.accessToken=="string"),new JV(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return pn(e===null||typeof e=="string"),new Dr(e)}}class ode{constructor(e,t,i,r){this.h=e,this.l=t,this.m=i,this.g=r,this.type="FirstParty",this.user=Dr.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(pn(!(typeof this.h!="object"||this.h===null||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class ade{constructor(e,t,i,r){this.h=e,this.l=t,this.m=i,this.g=r}getToken(){return Promise.resolve(new ode(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(Dr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lde{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ude{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const i=s=>{s.error!=null&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.A;return this.A=s.token,We("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.T.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.T.getImmediate({optional:!0});s?r(s):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(pn(typeof t.token=="string"),this.A=t.token,new lde(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cde(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=cde(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}}function en(n,e){return n<e?-1:n>e?1:0}function tp(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ue(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Gi.fromMillis(Date.now())}static fromDate(e){return Gi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Gi(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?en(this.nanoseconds,e.nanoseconds):en(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new yt(e)}static min(){return new yt(new Gi(0,0))}static max(){return new yt(new Gi(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,t,i){t===void 0?t=0:t>e.length&&at(),i===void 0?i=e.length-t:i>e.length-t&&at(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return M0.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof M0?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Cn extends M0{construct(e,t,i){return new Cn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ue(ye.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new Cn(t)}static emptyPath(){return new Cn([])}}const hde=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nr extends M0{construct(e,t,i){return new Nr(e,t,i)}static isValidIdentifier(e){return hde.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Nr(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Ue(ye.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Ue(ye.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ue(ye.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Ue(ye.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nr(t)}static emptyPath(){return new Nr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.path=e}static fromPath(e){return new qe(Cn.fromString(e))}static fromName(e){return new qe(Cn.fromString(e).popFirst(5))}static empty(){return new qe(Cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Cn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Cn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new Cn(e.slice()))}}function fde(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=yt.fromTimestamp(i===1e9?new Gi(t+1,0):new Gi(t,i));return new Mc(r,qe.empty(),e)}function dde(n){return new Mc(n.readTime,n.key,-1)}class Mc{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Mc(yt.min(),qe.empty(),-1)}static max(){return new Mc(yt.max(),qe.empty(),-1)}}function gde(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=qe.comparator(n.documentKey,e.documentKey),t!==0?t:en(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pde="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mde{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S_(n){if(n.code!==ye.FAILED_PRECONDITION||n.message!==pde)throw n;We("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&at(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new we((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof we?t:we.resolve(t)}catch(t){return we.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):we.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):we.reject(t)}static resolve(e){return new we((t,i)=>{t(e)})}static reject(e){return new we((t,i)=>{i(e)})}static waitFor(e){return new we((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=we.resolve(!1);for(const i of e)t=t.next(r=>r?we.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new we((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(h=>{o[u]=h,++a,a===s&&i(o)},h=>r(h))}})}static doWhile(e,t){return new we((i,r)=>{const s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}}function C_(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ut(i),this.ct=i=>t.writeSequenceNumber(i))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}UP.at=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yde{constructor(e,t,i,r,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class D0{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new D0("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof D0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xO(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Rp(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function t4(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(n){return n==null}function Bw(n){return n===0&&1/n==-1/0}function _de(n){return typeof n=="number"&&Number.isInteger(n)&&!Bw(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new $r(t)}static fromUint8Array(e){const t=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new $r(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return en(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$r.EMPTY_BYTE_STRING=new $r("");const vde=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dc(n){if(pn(!!n),typeof n=="string"){let e=0;const t=vde.exec(n);if(pn(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:vi(n.seconds),nanos:vi(n.nanos)}}function vi(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function np(n){return typeof n=="string"?$r.fromBase64String(n):$r.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function i4(n){const e=n.mapValue.fields.__previous_value__;return n4(e)?i4(e):e}function F0(n){const e=Dc(n.mapValue.fields.__local_write_time__.timestampValue);return new Gi(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ef(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?n4(n)?4:xde(n)?9007199254740991:10:at()}function ul(n,e){if(n===e)return!0;const t=Ef(n);if(t!==Ef(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return F0(n).isEqual(F0(e));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=Dc(i.timestampValue),o=Dc(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,r){return np(i.bytesValue).isEqual(np(r.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return vi(i.geoPointValue.latitude)===vi(r.geoPointValue.latitude)&&vi(i.geoPointValue.longitude)===vi(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return vi(i.integerValue)===vi(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=vi(i.doubleValue),o=vi(r.doubleValue);return s===o?Bw(s)===Bw(o):isNaN(s)&&isNaN(o)}return!1}(n,e);case 9:return tp(n.arrayValue.values||[],e.arrayValue.values||[],ul);case 10:return function(i,r){const s=i.mapValue.fields||{},o=r.mapValue.fields||{};if(xO(s)!==xO(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!ul(s[a],o[a])))return!1;return!0}(n,e);default:return at()}}function O0(n,e){return(n.values||[]).find(t=>ul(t,e))!==void 0}function ip(n,e){if(n===e)return 0;const t=Ef(n),i=Ef(e);if(t!==i)return en(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return en(n.booleanValue,e.booleanValue);case 2:return function(r,s){const o=vi(r.integerValue||r.doubleValue),a=vi(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(n,e);case 3:return wO(n.timestampValue,e.timestampValue);case 4:return wO(F0(n),F0(e));case 5:return en(n.stringValue,e.stringValue);case 6:return function(r,s){const o=np(r),a=np(s);return o.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(r,s){const o=r.split("/"),a=s.split("/");for(let l=0;l<o.length&&l<a.length;l++){const u=en(o[l],a[l]);if(u!==0)return u}return en(o.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,s){const o=en(vi(r.latitude),vi(s.latitude));return o!==0?o:en(vi(r.longitude),vi(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(r,s){const o=r.values||[],a=s.values||[];for(let l=0;l<o.length&&l<a.length;++l){const u=ip(o[l],a[l]);if(u)return u}return en(o.length,a.length)}(n.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===j1.mapValue&&s===j1.mapValue)return 0;if(r===j1.mapValue)return 1;if(s===j1.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),l=s.fields||{},u=Object.keys(l);a.sort(),u.sort();for(let h=0;h<a.length&&h<u.length;++h){const p=en(a[h],u[h]);if(p!==0)return p;const m=ip(o[a[h]],l[u[h]]);if(m!==0)return m}return en(a.length,u.length)}(n.mapValue,e.mapValue);default:throw at()}}function wO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return en(n,e);const t=Dc(n),i=Dc(e),r=en(t.seconds,i.seconds);return r!==0?r:en(t.nanos,i.nanos)}function rp(n){return ub(n)}function ub(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const r=Dc(i);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?np(n.bytesValue).toBase64():"referenceValue"in n?(t=n.referenceValue,qe.fromName(t).toString()):"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let r="[",s=!0;for(const o of i.values||[])s?s=!1:r+=",",r+=ub(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${ub(i.fields[a])}`;return s+"}"}(n.mapValue):at();var e,t}function EO(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function cb(n){return!!n&&"integerValue"in n}function GP(n){return!!n&&"arrayValue"in n}function TO(n){return!!n&&"nullValue"in n}function SO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function fx(n){return!!n&&"mapValue"in n}function Ry(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Rp(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Ry(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ry(n.arrayValue.values[t]);return e}return Object.assign({},n)}function xde(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e,t){this.position=e,this.inclusive=t}}function CO(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=qe.comparator(qe.fromName(o.referenceValue),t.key):i=ip(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function IO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ul(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{}class wi extends r4{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Ede(e,t,i):t==="array-contains"?new Cde(e,i):t==="in"?new Ide(e,i):t==="not-in"?new Rde(e,i):t==="array-contains-any"?new bde(e,i):new wi(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Tde(e,i):new Sde(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ip(t,this.value)):t!==null&&Ef(this.value)===Ef(t)&&this.matchesComparison(ip(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return at()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class _a extends r4{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new _a(e,t)}matches(e){return s4(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ht!==null||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(t=>t.isInequality());return e!==null?e.field:null}lt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function s4(n){return n.op==="and"}function o4(n){return wde(n)&&s4(n)}function wde(n){for(const e of n.filters)if(e instanceof _a)return!1;return!0}function hb(n){if(n instanceof wi)return n.field.canonicalString()+n.op.toString()+rp(n.value);if(o4(n))return n.filters.map(e=>hb(e)).join(",");{const e=n.filters.map(t=>hb(t)).join(",");return`${n.op}(${e})`}}function a4(n,e){return n instanceof wi?function(t,i){return i instanceof wi&&t.op===i.op&&t.field.isEqual(i.field)&&ul(t.value,i.value)}(n,e):n instanceof _a?function(t,i){return i instanceof _a&&t.op===i.op&&t.filters.length===i.filters.length?t.filters.reduce((r,s,o)=>r&&a4(s,i.filters[o]),!0):!1}(n,e):void at()}function l4(n){return n instanceof wi?function(e){return`${e.field.canonicalString()} ${e.op} ${rp(e.value)}`}(n):n instanceof _a?function(e){return e.op.toString()+" {"+e.getFilters().map(l4).join(" ,")+"}"}(n):"Filter"}class Ede extends wi{constructor(e,t,i){super(e,t,i),this.key=qe.fromName(i.referenceValue)}matches(e){const t=qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Tde extends wi{constructor(e,t){super(e,"in",t),this.keys=u4("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Sde extends wi{constructor(e,t){super(e,"not-in",t),this.keys=u4("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function u4(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>qe.fromName(i.referenceValue))}class Cde extends wi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return GP(t)&&O0(t.arrayValue,this.value)}}class Ide extends wi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&O0(this.value.arrayValue,t)}}class Rde extends wi{constructor(e,t){super(e,"not-in",t)}matches(e){if(O0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!O0(this.value.arrayValue,t)}}class bde extends wi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!GP(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>O0(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ade(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,t){this.comparator=e,this.root=t||gr.EMPTY}insert(e,t){return new Bi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gr.BLACK,null,null))}remove(e){return new Bi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new B1(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new B1(this.root,e,this.comparator,!1)}getReverseIterator(){return new B1(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new B1(this.root,e,this.comparator,!0)}}class B1{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gr{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??gr.RED,this.left=r??gr.EMPTY,this.right=s??gr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new gr(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return gr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return gr.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw at();const e=this.left.check();if(e!==this.right.check())throw at();return e+(this.isRed()?0:1)}}gr.EMPTY=null,gr.RED=!0,gr.BLACK=!1;gr.EMPTY=new class{constructor(){this.size=0}get key(){throw at()}get value(){throw at()}get color(){throw at()}get left(){throw at()}get right(){throw at()}copy(n,e,t,i,r){return this}insert(n,e,t){return new gr(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this.comparator=e,this.data=new Bi(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new RO(this.data.getIterator())}getIteratorFrom(e){return new RO(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof ji)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ji(this.comparator);return t.data=e,t}}class RO{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e){this.fields=e,e.sort(Nr.comparator)}static empty(){return new ua([])}unionWith(e){let t=new ji(Nr.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ua(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tp(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e){this.value=e}static empty(){return new Io({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!fx(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ry(t)}setAll(e){let t=Nr.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Ry(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());fx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ul(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];fx(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Rp(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Io(Ry(this.value))}}function c4(n){const e=[];return Rp(n.fields,(t,i)=>{const r=new Nr([t]);if(fx(i)){const s=c4(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new ua(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Or(e,0,yt.min(),yt.min(),yt.min(),Io.empty(),0)}static newFoundDocument(e,t,i,r){return new Or(e,1,t,yt.min(),i,r,0)}static newNoDocument(e,t){return new Or(e,2,t,yt.min(),yt.min(),Io.empty(),0)}static newUnknownDocument(e,t){return new Or(e,3,t,yt.min(),yt.min(),Io.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(yt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Io.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Io.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=yt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Or(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kde{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ft=null}}function bO(n,e=null,t=[],i=[],r=null,s=null,o=null){return new kde(n,e,t,i,r,s,o)}function jP(n){const e=Et(n);if(e.ft===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>hb(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),hT(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>rp(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>rp(i)).join(",")),e.ft=t}return e.ft}function BP(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Ade(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!a4(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!IO(n.startAt,e.startAt)&&IO(n.endAt,e.endAt)}function fb(n){return qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.dt=null,this._t=null,this.startAt,this.endAt}}function Pde(n,e,t,i,r,s,o,a){return new I_(n,e,t,i,r,s,o,a)}function h4(n){return new I_(n)}function AO(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function f4(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function VP(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(t!==null)return t}return null}function d4(n){return n.collectionGroup!==null}function Lg(n){const e=Et(n);if(e.dt===null){e.dt=[];const t=VP(e),i=f4(e);if(t!==null&&i===null)t.isKeyField()||e.dt.push(new by(t)),e.dt.push(new by(Nr.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.dt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new by(Nr.keyField(),s))}}}return e.dt}function ou(n){const e=Et(n);if(!e._t)if(e.limitType==="F")e._t=bO(e.path,e.collectionGroup,Lg(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Lg(e)){const o=s.dir==="desc"?"asc":"desc";t.push(new by(s.field,o))}const i=e.endAt?new Vw(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Vw(e.startAt.position,e.startAt.inclusive):null;e._t=bO(e.path,e.collectionGroup,t,e.filters,e.limit,i,r)}return e._t}function db(n,e){e.getFirstInequalityField(),VP(n);const t=n.filters.concat([e]);return new I_(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function gb(n,e,t){return new I_(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function fT(n,e){return BP(ou(n),ou(e))&&n.limitType===e.limitType}function g4(n){return`${jP(ou(n))}|lt:${n.limitType}`}function pb(n){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(i=>l4(i)).join(", ")}]`),hT(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(i=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(i)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>rp(i)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>rp(i)).join(",")),`Target(${t})`}(ou(n))}; limitType=${n.limitType})`}function dT(n,e){return e.isFoundDocument()&&function(t,i){const r=i.key.path;return t.collectionGroup!==null?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):qe.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(n,e)&&function(t,i){for(const r of Lg(t))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(n,e)&&function(t,i){for(const r of t.filters)if(!r.matches(i))return!1;return!0}(n,e)&&function(t,i){return!(t.startAt&&!function(r,s,o){const a=CO(r,s,o);return r.inclusive?a<=0:a<0}(t.startAt,Lg(t),i)||t.endAt&&!function(r,s,o){const a=CO(r,s,o);return r.inclusive?a>=0:a>0}(t.endAt,Lg(t),i))}(n,e)}function Lde(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function p4(n){return(e,t)=>{let i=!1;for(const r of Lg(n)){const s=Mde(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Mde(n,e,t){const i=n.field.isKeyField()?qe.comparator(e.key,t.key):function(r,s,o){const a=s.data.field(r),l=o.data.field(r);return a!==null&&l!==null?ip(a,l):at()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return at()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(n,e){if(n.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bw(e)?"-0":e}}function y4(n){return{integerValue:""+n}}function Dde(n,e){return _de(e)?y4(e):m4(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(){this._=void 0}}function Fde(n,e,t){return n instanceof $w?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):n instanceof N0?v4(n,e):n instanceof z0?x4(n,e):function(i,r){const s=_4(i,r),o=kO(s)+kO(i.gt);return cb(s)&&cb(i.gt)?y4(o):m4(i.yt,o)}(n,e)}function Ode(n,e,t){return n instanceof N0?v4(n,e):n instanceof z0?x4(n,e):t}function _4(n,e){return n instanceof Ww?cb(t=e)||function(i){return!!i&&"doubleValue"in i}(t)?e:{integerValue:0}:null;var t}class $w extends gT{}class N0 extends gT{constructor(e){super(),this.elements=e}}function v4(n,e){const t=w4(e);for(const i of n.elements)t.some(r=>ul(r,i))||t.push(i);return{arrayValue:{values:t}}}class z0 extends gT{constructor(e){super(),this.elements=e}}function x4(n,e){let t=w4(e);for(const i of n.elements)t=t.filter(r=>!ul(r,i));return{arrayValue:{values:t}}}class Ww extends gT{constructor(e,t){super(),this.yt=e,this.gt=t}}function kO(n){return vi(n.integerValue||n.doubleValue)}function w4(n){return GP(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Nde(n,e){return n.field.isEqual(e.field)&&function(t,i){return t instanceof N0&&i instanceof N0||t instanceof z0&&i instanceof z0?tp(t.elements,i.elements,ul):t instanceof Ww&&i instanceof Ww?ul(t.gt,i.gt):t instanceof $w&&i instanceof $w}(n.transform,e.transform)}class zde{constructor(e,t){this.version=e,this.transformResults=t}}class nl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new nl}static exists(e){return new nl(void 0,e)}static updateTime(e){return new nl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dx(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pT{}function E4(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new $P(n.key,nl.none()):new R_(n.key,n.data,nl.none());{const t=n.data,i=Io.empty();let r=new ji(Nr.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new zf(n.key,i,new ua(r.toArray()),nl.none())}}function Ude(n,e,t){n instanceof R_?function(i,r,s){const o=i.value.clone(),a=LO(i.fieldTransforms,r,s.transformResults);o.setAll(a),r.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(n,e,t):n instanceof zf?function(i,r,s){if(!dx(i.precondition,r))return void r.convertToUnknownDocument(s.version);const o=LO(i.fieldTransforms,r,s.transformResults),a=r.data;a.setAll(T4(i)),a.setAll(o),r.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):function(i,r,s){r.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Ay(n,e,t,i){return n instanceof R_?function(r,s,o,a){if(!dx(r.precondition,s))return o;const l=r.value.clone(),u=MO(r.fieldTransforms,a,s);return l.setAll(u),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,i):n instanceof zf?function(r,s,o,a){if(!dx(r.precondition,s))return o;const l=MO(r.fieldTransforms,a,s),u=s.data;return u.setAll(T4(r)),u.setAll(l),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(h=>h.field))}(n,e,t,i):function(r,s,o){return dx(r.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(n,e,t)}function Gde(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=_4(i.transform,r||null);s!=null&&(t===null&&(t=Io.empty()),t.set(i.field,s))}return t||null}function PO(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(t,i){return t===void 0&&i===void 0||!(!t||!i)&&tp(t,i,(r,s)=>Nde(r,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class R_ extends pT{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class zf extends pT{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function T4(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function LO(n,e,t){const i=new Map;pn(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Ode(o,a,t[r]))}return i}function MO(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,Fde(s,o,e))}return i}class $P extends pT{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jde extends pT{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bde{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yi,Gt;function Vde(n){switch(n){default:return at();case ye.CANCELLED:case ye.UNKNOWN:case ye.DEADLINE_EXCEEDED:case ye.RESOURCE_EXHAUSTED:case ye.INTERNAL:case ye.UNAVAILABLE:case ye.UNAUTHENTICATED:return!1;case ye.INVALID_ARGUMENT:case ye.NOT_FOUND:case ye.ALREADY_EXISTS:case ye.PERMISSION_DENIED:case ye.FAILED_PRECONDITION:case ye.ABORTED:case ye.OUT_OF_RANGE:case ye.UNIMPLEMENTED:case ye.DATA_LOSS:return!0}}function S4(n){if(n===void 0)return su("GRPC error has no .code"),ye.UNKNOWN;switch(n){case yi.OK:return ye.OK;case yi.CANCELLED:return ye.CANCELLED;case yi.UNKNOWN:return ye.UNKNOWN;case yi.DEADLINE_EXCEEDED:return ye.DEADLINE_EXCEEDED;case yi.RESOURCE_EXHAUSTED:return ye.RESOURCE_EXHAUSTED;case yi.INTERNAL:return ye.INTERNAL;case yi.UNAVAILABLE:return ye.UNAVAILABLE;case yi.UNAUTHENTICATED:return ye.UNAUTHENTICATED;case yi.INVALID_ARGUMENT:return ye.INVALID_ARGUMENT;case yi.NOT_FOUND:return ye.NOT_FOUND;case yi.ALREADY_EXISTS:return ye.ALREADY_EXISTS;case yi.PERMISSION_DENIED:return ye.PERMISSION_DENIED;case yi.FAILED_PRECONDITION:return ye.FAILED_PRECONDITION;case yi.ABORTED:return ye.ABORTED;case yi.OUT_OF_RANGE:return ye.OUT_OF_RANGE;case yi.UNIMPLEMENTED:return ye.UNIMPLEMENTED;case yi.DATA_LOSS:return ye.DATA_LOSS;default:return at()}}(Gt=yi||(yi={}))[Gt.OK=0]="OK",Gt[Gt.CANCELLED=1]="CANCELLED",Gt[Gt.UNKNOWN=2]="UNKNOWN",Gt[Gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gt[Gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gt[Gt.NOT_FOUND=5]="NOT_FOUND",Gt[Gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gt[Gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gt[Gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gt[Gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gt[Gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gt[Gt.ABORTED=10]="ABORTED",Gt[Gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gt[Gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gt[Gt.INTERNAL=13]="INTERNAL",Gt[Gt.UNAVAILABLE=14]="UNAVAILABLE",Gt[Gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Rp(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return t4(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $de=new Bi(qe.comparator);function au(){return $de}const C4=new Bi(qe.comparator);function sy(...n){let e=C4;for(const t of n)e=e.insert(t.key,t);return e}function I4(n){let e=C4;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Lh(){return ky()}function R4(){return ky()}function ky(){return new bp(n=>n.toString(),(n,e)=>n.isEqual(e))}const Wde=new Bi(qe.comparator),Hde=new ji(qe.comparator);function Nt(...n){let e=Hde;for(const t of n)e=e.add(t);return e}const Xde=new ji(en);function b4(){return Xde}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,b_.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new mT(yt.min(),r,b4(),au(),Nt())}}class b_{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new b_(i,t,Nt(),Nt(),Nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,t,i,r){this.It=e,this.removedTargetIds=t,this.key=i,this.Tt=r}}class A4{constructor(e,t){this.targetId=e,this.Et=t}}class k4{constructor(e,t,i=$r.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class DO{constructor(){this.At=0,this.Rt=OO(),this.bt=$r.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return this.At!==0}get St(){return this.vt}Dt(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}Ct(){let e=Nt(),t=Nt(),i=Nt();return this.Rt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:at()}}),new b_(this.bt,this.Pt,e,t,i)}xt(){this.vt=!1,this.Rt=OO()}Nt(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}kt(e){this.vt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class qde{constructor(e){this.$t=e,this.Bt=new Map,this.Lt=au(),this.qt=FO(),this.Ut=new ji(en)}Kt(e){for(const t of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(t,e.Tt):this.Qt(t,e.key,e.Tt);for(const t of e.removedTargetIds)this.Qt(t,e.key,e.Tt)}jt(e){this.forEachTarget(e,t=>{const i=this.Wt(t);switch(e.state){case 0:this.zt(t)&&i.Dt(e.resumeToken);break;case 1:i.Mt(),i.Vt||i.xt(),i.Dt(e.resumeToken);break;case 2:i.Mt(),i.Vt||this.removeTarget(t);break;case 3:this.zt(t)&&(i.Ft(),i.Dt(e.resumeToken));break;case 4:this.zt(t)&&(this.Ht(t),i.Dt(e.resumeToken));break;default:at()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((i,r)=>{this.zt(r)&&t(r)})}Jt(e){const t=e.targetId,i=e.Et.count,r=this.Yt(t);if(r){const s=r.target;if(fb(s))if(i===0){const o=new qe(s.path);this.Qt(t,o,Or.newNoDocument(o,yt.min()))}else pn(i===1);else this.Xt(t)!==i&&(this.Ht(t),this.Ut=this.Ut.add(t))}}Zt(e){const t=new Map;this.Bt.forEach((s,o)=>{const a=this.Yt(o);if(a){if(s.current&&fb(a.target)){const l=new qe(a.target.path);this.Lt.get(l)!==null||this.te(o,l)||this.Qt(o,l,Or.newNoDocument(l,e))}s.St&&(t.set(o,s.Ct()),s.xt())}});let i=Nt();this.qt.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Yt(l);return!u||u.purpose===2||(a=!1,!1)}),a&&(i=i.add(s))}),this.Lt.forEach((s,o)=>o.setReadTime(e));const r=new mT(e,t,this.Ut,this.Lt,i);return this.Lt=au(),this.qt=FO(),this.Ut=new ji(en),r}Gt(e,t){if(!this.zt(e))return;const i=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,i),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}Qt(e,t,i){if(!this.zt(e))return;const r=this.Wt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),i&&(this.Lt=this.Lt.insert(t,i))}removeTarget(e){this.Bt.delete(e)}Xt(e){const t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.Wt(e).Ot()}Wt(e){let t=this.Bt.get(e);return t||(t=new DO,this.Bt.set(e,t)),t}ee(e){let t=this.qt.get(e);return t||(t=new ji(en),this.qt=this.qt.insert(e,t)),t}zt(e){const t=this.Yt(e)!==null;return t||We("WatchChangeAggregator","Detected inactive target",e),t}Yt(e){const t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}Ht(e){this.Bt.set(e,new DO),this.$t.getRemoteKeysForTarget(e).forEach(t=>{this.Qt(e,t,null)})}te(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}function FO(){return new Bi(qe.comparator)}function OO(){return new Bi(qe.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kde=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Yde=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Zde=(()=>({and:"AND",or:"OR"}))();class Qde{constructor(e,t){this.databaseId=e,this.wt=t}}function Hw(n,e){return n.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function P4(n,e){return n.wt?e.toBase64():e.toUint8Array()}function Jde(n,e){return Hw(n,e.toTimestamp())}function il(n){return pn(!!n),yt.fromTimestamp(function(e){const t=Dc(e);return new Gi(t.seconds,t.nanos)}(n))}function WP(n,e){return function(t){return new Cn(["projects",t.projectId,"databases",t.database])}(n).child("documents").child(e).canonicalString()}function L4(n){const e=Cn.fromString(n);return pn(O4(e)),e}function mb(n,e){return WP(n.databaseId,e.path)}function tI(n,e){const t=L4(e);if(t.get(1)!==n.databaseId.projectId)throw new Ue(ye.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ue(ye.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new qe(M4(t))}function yb(n,e){return WP(n.databaseId,e)}function ege(n){const e=L4(n);return e.length===4?Cn.emptyPath():M4(e)}function _b(n){return new Cn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function M4(n){return pn(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function NO(n,e,t){return{name:mb(n,e),fields:t.value.mapValue.fields}}function tge(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:at()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(l,u){return l.wt?(pn(u===void 0||typeof u=="string"),$r.fromBase64String(u||"")):(pn(u===void 0||u instanceof Uint8Array),$r.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const u=l.code===void 0?ye.UNKNOWN:S4(l.code);return new Ue(u,l.message||"")}(o);t=new k4(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=tI(n,i.document.name),s=il(i.document.updateTime),o=i.document.createTime?il(i.document.createTime):yt.min(),a=new Io({mapValue:{fields:i.document.fields}}),l=Or.newFoundDocument(r,s,o,a),u=i.targetIds||[],h=i.removedTargetIds||[];t=new gx(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=tI(n,i.document),s=i.readTime?il(i.readTime):yt.min(),o=Or.newNoDocument(r,s),a=i.removedTargetIds||[];t=new gx([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=tI(n,i.document),s=i.removedTargetIds||[];t=new gx([],s,r,null)}else{if(!("filter"in e))return at();{e.filter;const i=e.filter;i.targetId;const r=i.count||0,s=new Bde(r),o=i.targetId;t=new A4(o,s)}}return t}function nge(n,e){let t;if(e instanceof R_)t={update:NO(n,e.key,e.value)};else if(e instanceof $P)t={delete:mb(n,e.key)};else if(e instanceof zf)t={update:NO(n,e.key,e.data),updateMask:hge(e.fieldMask)};else{if(!(e instanceof jde))return at();t={verify:mb(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,s){const o=s.transform;if(o instanceof $w)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof N0)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof z0)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ww)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw at()}(0,i))),e.precondition.isNone||(t.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:Jde(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:at()}(n,e.precondition)),t}function ige(n,e){return n&&n.length>0?(pn(e!==void 0),n.map(t=>function(i,r){let s=i.updateTime?il(i.updateTime):il(r);return s.isEqual(yt.min())&&(s=il(r)),new zde(s,i.transformResults||[])}(t,e))):[]}function rge(n,e){return{documents:[yb(n,e.path)]}}function sge(n,e){const t={structuredQuery:{}},i=e.path;e.collectionGroup!==null?(t.parent=yb(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=yb(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(l){if(l.length!==0)return F4(_a.create(l,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:jd(h.field),direction:lge(h.dir)}}(u))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=function(l,u){return l.wt||hT(u)?u:{value:u}}(n,e.limit);var a;return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),t}function oge(n){let e=ege(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){pn(i===1);const h=t.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(h){const p=D4(h);return p instanceof _a&&o4(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(h=>function(p){return new by(Bd(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h)));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,hT(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(h){const p=!!h.before,m=h.values||[];return new Vw(m,p)}(t.startAt));let u=null;return t.endAt&&(u=function(h){const p=!h.before,m=h.values||[];return new Vw(m,p)}(t.endAt)),Pde(e,r,o,s,a,"F",l,u)}function age(n,e){const t=function(i,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return at()}}(0,e.purpose);return t==null?null:{"goog-listen-tags":t}}function D4(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Bd(e.unaryFilter.field);return wi.create(t,"==",{doubleValue:NaN});case"IS_NULL":const i=Bd(e.unaryFilter.field);return wi.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Bd(e.unaryFilter.field);return wi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Bd(e.unaryFilter.field);return wi.create(s,"!=",{nullValue:"NULL_VALUE"});default:return at()}}(n):n.fieldFilter!==void 0?function(e){return wi.create(Bd(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return at()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return _a.create(e.compositeFilter.filters.map(t=>D4(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return at()}}(e.compositeFilter.op))}(n):at()}function lge(n){return Kde[n]}function uge(n){return Yde[n]}function cge(n){return Zde[n]}function jd(n){return{fieldPath:n.canonicalString()}}function Bd(n){return Nr.fromServerFormat(n.fieldPath)}function F4(n){return n instanceof wi?function(e){if(e.op==="=="){if(SO(e.value))return{unaryFilter:{field:jd(e.field),op:"IS_NAN"}};if(TO(e.value))return{unaryFilter:{field:jd(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(SO(e.value))return{unaryFilter:{field:jd(e.field),op:"IS_NOT_NAN"}};if(TO(e.value))return{unaryFilter:{field:jd(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jd(e.field),op:uge(e.op),value:e.value}}}(n):n instanceof _a?function(e){const t=e.getFilters().map(i=>F4(i));return t.length===1?t[0]:{compositeFilter:{op:cge(e.op),filters:t}}}(n):at()}function hge(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function O4(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fge{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Ude(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Ay(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Ay(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=R4();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=E4(o,a);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(yt.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Nt())}isEqual(e){return this.batchId===e.batchId&&tp(this.mutations,e.mutations,(t,i)=>PO(t,i))&&tp(this.baseMutations,e.baseMutations,(t,i)=>PO(t,i))}}class HP{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){pn(e.mutations.length===i.length);let r=Wde;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new HP(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dge{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t,i,r,s=yt.min(),o=yt.min(),a=$r.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Uh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Uh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Uh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gge{constructor(e){this.ie=e}}function pge(n){const e=oge({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?gb(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mge{constructor(){this.Je=new yge}addToCollectionParentIndex(e,t){return this.Je.add(t),we.resolve()}getCollectionParents(e,t){return we.resolve(this.Je.getEntries(t))}addFieldIndex(e,t){return we.resolve()}deleteFieldIndex(e,t){return we.resolve()}getDocumentsMatchingTarget(e,t){return we.resolve(null)}getIndexType(e,t){return we.resolve(0)}getFieldIndexes(e,t){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,t){return we.resolve(Mc.min())}getMinOffsetFromCollectionGroup(e,t){return we.resolve(Mc.min())}updateCollectionGroup(e,t,i){return we.resolve()}updateIndexEntries(e,t){return we.resolve()}}class yge{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new ji(Cn.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new ji(Cn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new sp(0)}static vn(){return new sp(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ge{constructor(){this.changes=new bp(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?we.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vge{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xge{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Ay(i.mutation,r,ua.empty(),Gi.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Nt()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Nt()){const r=Lh();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=sy();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=Lh();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Nt()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=au();const o=ky(),a=ky();return t.forEach((l,u)=>{const h=i.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof zf)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Ay(h.mutation,u,h.mutation.getFieldMask(),Gi.now())):o.set(u.key,ua.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),t.forEach((u,h)=>{var p;return a.set(u,new vge(h,(p=o.get(u))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){const i=ky();let r=new Bi((o,a)=>o-a),s=Nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let h=i.get(l)||ua.empty();h=a.applyToLocalView(u,h),i.set(l,h);const p=(r.get(a.batchId)||Nt()).add(l);r=r.insert(a.batchId,p)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,p=R4();h.forEach(m=>{if(!s.has(m)){const y=E4(t.get(m),i.get(m));y!==null&&p.set(m,y),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return we.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i){return function(r){return qe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):d4(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i):this.getDocumentsMatchingCollectionQuery(e,t,i)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):we.resolve(Lh());let a=-1,l=s;return o.next(u=>we.forEach(u,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(h)?we.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Nt())).next(h=>({batchId:a,changes:I4(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new qe(t)).next(i=>{let r=sy();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i){const r=t.collectionGroup;let s=sy();return this.indexManager.getCollectionParents(e,r).next(o=>we.forEach(o,a=>{const l=function(u,h){return new I_(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(t,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,l,i).next(u=>{u.forEach((h,p)=>{s=s.insert(h,p)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r))).next(s=>{r.forEach((a,l)=>{const u=l.getKey();s.get(u)===null&&(s=s.insert(u,Or.newInvalidDocument(u)))});let o=sy();return s.forEach((a,l)=>{const u=r.get(a);u!==void 0&&Ay(u.mutation,l,ua.empty(),Gi.now()),dT(t,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wge{constructor(e){this.yt=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return we.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var i;return this.Zn.set(t.id,{id:(i=t).id,version:i.version,createTime:il(i.createTime)}),we.resolve()}getNamedQuery(e,t){return we.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,function(i){return{name:i.name,query:pge(i.bundledQuery),readTime:il(i.readTime)}}(t)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ege{constructor(){this.overlays=new Bi(qe.comparator),this.es=new Map}getOverlay(e,t){return we.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Lh();return we.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.oe(e,t,s)}),we.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.es.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.es.delete(i)),we.resolve()}getOverlaysForCollection(e,t,i){const r=Lh(),s=t.length+1,o=new qe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return we.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Bi((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let h=s.get(u.largestBatchId);h===null&&(h=Lh(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=Lh(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=r)););return we.resolve(a)}oe(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.es.get(r.largestBatchId).delete(i.key);this.es.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new dge(t,i));let s=this.es.get(t);s===void 0&&(s=Nt(),this.es.set(t,s)),this.es.set(t,s.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this.ns=new ji(Zi.ss),this.rs=new ji(Zi.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const i=new Zi(e,t);this.ns=this.ns.add(i),this.rs=this.rs.add(i)}us(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.cs(new Zi(e,t))}hs(e,t){e.forEach(i=>this.removeReference(i,t))}ls(e){const t=new qe(new Cn([])),i=new Zi(t,e),r=new Zi(t,e+1),s=[];return this.rs.forEachInRange([i,r],o=>{this.cs(o),s.push(o.key)}),s}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new qe(new Cn([])),i=new Zi(t,e),r=new Zi(t,e+1);let s=Nt();return this.rs.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Zi(e,0),i=this.ns.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Zi{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return qe.comparator(e.key,t.key)||en(e._s,t._s)}static os(e,t){return en(e._s,t._s)||qe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tge{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new ji(Zi.ss)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new fge(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.gs=this.gs.add(new Zi(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return we.resolve(o)}lookupMutationBatch(e,t){return we.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ps(i),s=r<0?0:r;return we.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?-1:this.ws-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Zi(t,0),r=new Zi(t,Number.POSITIVE_INFINITY),s=[];return this.gs.forEachInRange([i,r],o=>{const a=this.ys(o._s);s.push(a)}),we.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new ji(en);return t.forEach(r=>{const s=new Zi(r,0),o=new Zi(r,Number.POSITIVE_INFINITY);this.gs.forEachInRange([s,o],a=>{i=i.add(a._s)})}),we.resolve(this.Is(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;qe.isDocumentKey(s)||(s=s.child(""));const o=new Zi(new qe(s),0);let a=new ji(en);return this.gs.forEachWhile(l=>{const u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(a=a.add(l._s)),!0)},o),we.resolve(this.Is(a))}Is(e){const t=[];return e.forEach(i=>{const r=this.ys(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){pn(this.Ts(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.gs;return we.forEach(t.mutations,r=>{const s=new Zi(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.gs=i})}An(e){}containsKey(e,t){const i=new Zi(t,0),r=this.gs.firstAfterOrEqual(i);return we.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}Ts(e,t){return this.ps(e)}ps(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sge{constructor(e){this.Es=e,this.docs=new Bi(qe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Es(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return we.resolve(i?i.document.mutableCopy():Or.newInvalidDocument(t))}getEntries(e,t){let i=au();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Or.newInvalidDocument(r))}),we.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=au();const o=t.path,a=new qe(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||gde(dde(h),i)<=0||(r.has(h.key)||dT(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return we.resolve(s)}getAllFromCollectionGroup(e,t,i,r){at()}As(e,t){return we.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Cge(this)}getSize(e){return we.resolve(this.size)}}class Cge extends _ge{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Yn.addEntry(e,r)):this.Yn.removeEntry(i)}),we.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ige{constructor(e){this.persistence=e,this.Rs=new bp(t=>jP(t),BP),this.lastRemoteSnapshotVersion=yt.min(),this.highestTargetId=0,this.bs=0,this.Ps=new XP,this.targetCount=0,this.vs=sp.Pn()}forEachTarget(e,t){return this.Rs.forEach((i,r)=>t(r)),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.bs&&(this.bs=t),we.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new sp(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,we.resolve()}updateTargetData(e,t){return this.Dn(t),we.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.Rs.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.Rs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),we.waitFor(s).next(()=>r)}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,t){const i=this.Rs.get(t)||null;return we.resolve(i)}addMatchingKeys(e,t,i){return this.Ps.us(t,i),we.resolve()}removeMatchingKeys(e,t,i){this.Ps.hs(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),we.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),we.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Ps.ds(t);return we.resolve(i)}containsKey(e,t){return we.resolve(this.Ps.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rge{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new UP(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new Ige(this),this.indexManager=new mge,this.remoteDocumentCache=function(i){return new Sge(i)}(i=>this.referenceDelegate.xs(i)),this.yt=new gge(t),this.Ns=new wge(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ege,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Vs[e.toKey()];return i||(i=new Tge(t,this.referenceDelegate),this.Vs[e.toKey()]=i),i}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,i){We("MemoryPersistence","Starting transaction:",e);const r=new bge(this.Ss.next());return this.referenceDelegate.ks(),i(r).next(s=>this.referenceDelegate.Os(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ms(e,t){return we.or(Object.values(this.Vs).map(i=>()=>i.containsKey(e,t)))}}class bge extends mde{constructor(e){super(),this.currentSequenceNumber=e}}class qP{constructor(e){this.persistence=e,this.Fs=new XP,this.$s=null}static Bs(e){return new qP(e)}get Ls(){if(this.$s)return this.$s;throw at()}addReference(e,t,i){return this.Fs.addReference(i,t),this.Ls.delete(i.toString()),we.resolve()}removeReference(e,t,i){return this.Fs.removeReference(i,t),this.Ls.add(i.toString()),we.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),we.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(r=>this.Ls.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Ls.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.Ls,i=>{const r=qe.fromPath(i);return this.qs(e,r).next(s=>{s||t.removeEntry(r,yt.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.qs(e,t).next(i=>{i?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}qs(e,t){return we.or([()=>we.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Si=i,this.Di=r}static Ci(e,t){let i=Nt(),r=Nt();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new KP(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Age{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,i,r){return this.ki(e,t).next(s=>s||this.Oi(e,t,r,i)).next(s=>s||this.Mi(e,t))}ki(e,t){if(AO(t))return we.resolve(null);let i=ou(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=gb(t,null,"F"),i=ou(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=Nt(...s);return this.Ni.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const u=this.Fi(t,a);return this.$i(t,u,o,l.readTime)?this.ki(e,gb(t,null,"F")):this.Bi(e,u,t,l)}))})))}Oi(e,t,i,r){return AO(t)||r.isEqual(yt.min())?this.Mi(e,t):this.Ni.getDocuments(e,i).next(s=>{const o=this.Fi(t,s);return this.$i(t,o,i,r)?this.Mi(e,t):(vO()<=Qt.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),pb(t)),this.Bi(e,o,t,fde(r,-1)))})}Fi(e,t){let i=new ji(p4(e));return t.forEach((r,s)=>{dT(e,s)&&(i=i.add(s))}),i}$i(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Mi(e,t){return vO()<=Qt.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",pb(t)),this.Ni.getDocumentsMatchingQuery(e,t,Mc.min())}Bi(e,t,i,r){return this.Ni.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kge{constructor(e,t,i,r){this.persistence=e,this.Li=t,this.yt=r,this.qi=new Bi(en),this.Ui=new bp(s=>jP(s),BP),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(i)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xge(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.qi))}}function Pge(n,e,t,i){return new kge(n,e,t,i)}async function N4(n,e){const t=Et(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.Qi(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let l=Nt();for(const u of r){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(i,l).next(u=>({ji:u,removedBatchIds:o,addedBatchIds:a}))})})}function Lge(n,e){const t=Et(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.Gi.newChangeBuffer({trackRemovals:!0});return function(o,a,l,u){const h=l.batch,p=h.keys();let m=we.resolve();return p.forEach(y=>{m=m.next(()=>u.getEntry(a,y)).next(x=>{const w=l.docVersions.get(y);pn(w!==null),x.version.compareTo(w)<0&&(h.applyToRemoteDocument(x,l),x.isValidDocument()&&(x.setReadTime(l.commitVersion),u.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(a,h))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(o){let a=Nt();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function z4(n){const e=Et(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function Mge(n,e){const t=Et(n),i=e.snapshotVersion;let r=t.qi;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Gi.newChangeBuffer({trackRemovals:!0});r=t.qi;const a=[];e.targetChanges.forEach((h,p)=>{const m=r.get(p);if(!m)return;a.push(t.Cs.removeMatchingKeys(s,h.removedDocuments,p).next(()=>t.Cs.addMatchingKeys(s,h.addedDocuments,p)));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.has(p)?y=y.withResumeToken($r.EMPTY_BYTE_STRING,yt.min()).withLastLimboFreeSnapshotVersion(yt.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,i)),r=r.insert(p,y),function(x,w,R){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(m,y,h)&&a.push(t.Cs.updateTargetData(s,y))});let l=au(),u=Nt();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(Dge(s,o,e.documentUpdates).next(h=>{l=h.Wi,u=h.zi})),!i.isEqual(yt.min())){const h=t.Cs.getLastRemoteSnapshotVersion(s).next(p=>t.Cs.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(h)}return we.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.qi=r,s))}function Dge(n,e,t){let i=Nt(),r=Nt();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=au();return t.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(yt.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):We("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Wi:o,zi:r}})}function Fge(n,e){const t=Et(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Oge(n,e){const t=Et(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Cs.getTargetData(i,e).next(s=>s?(r=s,we.resolve(r)):t.Cs.allocateTargetId(i).next(o=>(r=new Uh(e,o,0,i.currentSequenceNumber),t.Cs.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.qi.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.qi=t.qi.insert(i.targetId,i),t.Ui.set(e,i.targetId)),i})}async function vb(n,e,t){const i=Et(n),r=i.qi.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!C_(o))throw o;We("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.qi=i.qi.remove(e),i.Ui.delete(r.target)}function zO(n,e,t){const i=Et(n);let r=yt.min(),s=Nt();return i.persistence.runTransaction("Execute query","readonly",o=>function(a,l,u){const h=Et(a),p=h.Ui.get(u);return p!==void 0?we.resolve(h.qi.get(p)):h.Cs.getTargetData(l,u)}(i,o,ou(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i.Li.getDocumentsMatchingQuery(o,e,t?r:yt.min(),t?s:Nt())).next(a=>(Nge(i,Lde(e),a),{documents:a,Hi:s})))}function Nge(n,e,t){let i=n.Ki.get(e)||yt.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.Ki.set(e,i)}class UO{constructor(){this.activeTargetIds=b4()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zge{constructor(){this.Lr=new UO,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.Lr.er(e),this.qr[e]||"not-current"}updateQueryState(e,t,i){this.qr[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new UO,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uge{Ur(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){We("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){We("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gge={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jge{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bge extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.oo=t+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,i,r,s){const o=this.ho(e,t);We("RestConnection","Sending: ",o,i);const a={};return this.lo(a,r,s),this.fo(e,o,a,i).then(l=>(We("RestConnection","Received: ",l),l),l=>{throw lb("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",i),l})}_o(e,t,i,r,s,o){return this.ao(e,t,i,r,s)}lo(e,t,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ip,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}ho(e,t){const i=Gge[e];return`${this.oo}/v1/${t}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,i,r){return new Promise((s,o)=>{const a=new nde;a.setWithCredentials(!0),a.listenOnce(Jfe.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case eI.NO_ERROR:const u=a.getResponseJson();We("Connection","XHR received:",JSON.stringify(u)),s(u);break;case eI.TIMEOUT:We("Connection",'RPC "'+e+'" timed out'),o(new Ue(ye.DEADLINE_EXCEEDED,"Request time out"));break;case eI.HTTP_ERROR:const h=a.getStatus();if(We("Connection",'RPC "'+e+'" failed with status:',h,"response text:",a.getResponseText()),h>0){let p=a.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const y=function(x){const w=x.toLowerCase().replace(/_/g,"-");return Object.values(ye).indexOf(w)>=0?w:ye.UNKNOWN}(m.status);o(new Ue(y,m.message))}else o(new Ue(ye.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ue(ye.UNAVAILABLE,"Connection failed."));break;default:at()}}finally{We("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(r);a.send(t,"POST",l,i,15)})}wo(e,t,i){const r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Zfe(),o=Qfe(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new tde({})),this.lo(a.initMessageHeaders,t,i),a.encodeInitMessageHeaders=!0;const l=r.join("");We("Connection","Creating WebChannel: "+l,a);const u=s.createWebChannel(l,a);let h=!1,p=!1;const m=new jge({Hr:x=>{p?We("Connection","Not sending because WebChannel is closed:",x):(h||(We("Connection","Opening WebChannel transport."),u.open(),h=!0),We("Connection","WebChannel sending:",x),u.send(x))},Jr:()=>u.close()}),y=(x,w,R)=>{x.listen(w,E=>{try{R(E)}catch(T){setTimeout(()=>{throw T},0)}})};return y(u,G1.EventType.OPEN,()=>{p||We("Connection","WebChannel transport opened.")}),y(u,G1.EventType.CLOSE,()=>{p||(p=!0,We("Connection","WebChannel transport closed"),m.io())}),y(u,G1.EventType.ERROR,x=>{p||(p=!0,lb("Connection","WebChannel transport errored:",x),m.io(new Ue(ye.UNAVAILABLE,"The operation could not be completed")))}),y(u,G1.EventType.MESSAGE,x=>{var w;if(!p){const R=x.data[0];pn(!!R);const E=R,T=E.error||((w=E[0])===null||w===void 0?void 0:w.error);if(T){We("Connection","WebChannel received error:",T);const I=T.status;let A=function(F){const O=yi[F];if(O!==void 0)return S4(O)}(I),L=T.message;A===void 0&&(A=ye.INTERNAL,L="Unknown error status: "+I+" with message "+T.message),p=!0,m.io(new Ue(A,L)),u.close()}else We("Connection","WebChannel received:",R),m.ro(R)}}),y(o,ede.STAT_EVENT,x=>{x.stat===yO.PROXY?We("Connection","Detected buffering proxy"):x.stat===yO.NOPROXY&&We("Connection","Detected no buffering proxy")}),setTimeout(()=>{m.so()},0),m}}function nI(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yT(n){return new Qde(n,!0)}class U4{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Hs=e,this.timerId=t,this.mo=i,this.yo=r,this.po=s,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),i=Math.max(0,Date.now()-this.Eo),r=Math.max(0,t-i);r>0&&We("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,r,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){this.To!==null&&(this.To.skipDelay(),this.To=null)}cancel(){this.To!==null&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e,t,i,r,s,o,a,l){this.Hs=e,this.vo=i,this.Vo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new U4(e,t)}No(){return this.state===1||this.state===5||this.ko()}ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&this.Do===null&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(e,t){this.Lo(),this.qo(),this.xo.cancel(),this.So++,e!==4?this.xo.reset():t&&t.code===ye.RESOURCE_EXHAUSTED?(su(t.toString()),su("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):t&&t.code===ye.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Uo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(t)}Uo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.So===t&&this.Go(i,r)},i=>{e(()=>{const r=new Ue(ye.UNKNOWN,"Fetching auth token failed: "+i.message);return this.Qo(r)})})}Go(e,t){const i=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{i(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(r=>{i(()=>this.Qo(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Oo(){this.state=5,this.xo.Ro(async()=>{this.state=0,this.start()})}Qo(e){return We("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(We("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Vge extends G4{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.yt=s}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=tge(this.yt,e),i=function(r){if(!("targetChange"in r))return yt.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?yt.min():s.readTime?il(s.readTime):yt.min()}(e);return this.listener.Wo(t,i)}zo(e){const t={};t.database=_b(this.yt),t.addTarget=function(r,s){let o;const a=s.target;return o=fb(a)?{documents:rge(r,a)}:{query:sge(r,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?o.resumeToken=P4(r,s.resumeToken):s.snapshotVersion.compareTo(yt.min())>0&&(o.readTime=Hw(r,s.snapshotVersion.toTimestamp())),o}(this.yt,e);const i=age(this.yt,e);i&&(t.labels=i),this.Bo(t)}Ho(e){const t={};t.database=_b(this.yt),t.removeTarget=e,this.Bo(t)}}class $ge extends G4{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.yt=s,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(pn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=ige(e.writeResults,e.commitTime),i=il(e.commitTime);return this.listener.Zo(i,t)}return pn(!e.writeResults||e.writeResults.length===0),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=_b(this.yt),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>nge(this.yt,i))};this.Bo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wge extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.yt=r,this.nu=!1}su(){if(this.nu)throw new Ue(ye.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.ao(e,t,i,r,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Ue(ye.UNKNOWN,r.toString())})}_o(e,t,i,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection._o(e,t,i,s,o,r)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ue(ye.UNKNOWN,s.toString())})}terminate(){this.nu=!0}}class Hge{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){this.iu===0&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){this.state==="Online"?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,e==="Online"&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(su(t),this.ou=!1):We("OnlineStateTracker",t)}lu(){this.ru!==null&&(this.ru.cancel(),this.ru=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xge{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=s,this.mu.Ur(o=>{i.enqueueAndForget(async()=>{Uf(this)&&(We("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=Et(a);l._u.add(4),await A_(l),l.gu.set("Unknown"),l._u.delete(4),await _T(l)}(this))})}),this.gu=new Hge(i,r)}}async function _T(n){if(Uf(n))for(const e of n.wu)await e(!0)}async function A_(n){for(const e of n.wu)await e(!1)}function j4(n,e){const t=Et(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),QP(t)?ZP(t):Ap(t).ko()&&YP(t,e))}function B4(n,e){const t=Et(n),i=Ap(t);t.du.delete(e),i.ko()&&V4(t,e),t.du.size===0&&(i.ko()?i.Fo():Uf(t)&&t.gu.set("Unknown"))}function YP(n,e){n.yu.Ot(e.targetId),Ap(n).zo(e)}function V4(n,e){n.yu.Ot(e),Ap(n).Ho(e)}function ZP(n){n.yu=new qde({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>n.du.get(e)||null}),Ap(n).start(),n.gu.uu()}function QP(n){return Uf(n)&&!Ap(n).No()&&n.du.size>0}function Uf(n){return Et(n)._u.size===0}function $4(n){n.yu=void 0}async function qge(n){n.du.forEach((e,t)=>{YP(n,e)})}async function Kge(n,e){$4(n),QP(n)?(n.gu.hu(e),ZP(n)):n.gu.set("Unknown")}async function Yge(n,e,t){if(n.gu.set("Online"),e instanceof k4&&e.state===2&&e.cause)try{await async function(i,r){const s=r.cause;for(const o of r.targetIds)i.du.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.du.delete(o),i.yu.removeTarget(o))}(n,e)}catch(i){We("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Xw(n,i)}else if(e instanceof gx?n.yu.Kt(e):e instanceof A4?n.yu.Jt(e):n.yu.jt(e),!t.isEqual(yt.min()))try{const i=await z4(n.localStore);t.compareTo(i)>=0&&await function(r,s){const o=r.yu.Zt(s);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const u=r.du.get(l);u&&r.du.set(l,u.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach(a=>{const l=r.du.get(a);if(!l)return;r.du.set(a,l.withResumeToken($r.EMPTY_BYTE_STRING,l.snapshotVersion)),V4(r,a);const u=new Uh(l.target,a,1,l.sequenceNumber);YP(r,u)}),r.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(i){We("RemoteStore","Failed to raise snapshot:",i),await Xw(n,i)}}async function Xw(n,e,t){if(!C_(e))throw e;n._u.add(1),await A_(n),n.gu.set("Offline"),t||(t=()=>z4(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{We("RemoteStore","Retrying IndexedDB access"),await t(),n._u.delete(1),await _T(n)})}function W4(n,e){return e().catch(t=>Xw(n,t,e))}async function vT(n){const e=Et(n),t=Fc(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;Zge(e);)try{const r=await Fge(e.localStore,i);if(r===null){e.fu.length===0&&t.Fo();break}i=r.batchId,Qge(e,r)}catch(r){await Xw(e,r)}H4(e)&&X4(e)}function Zge(n){return Uf(n)&&n.fu.length<10}function Qge(n,e){n.fu.push(e);const t=Fc(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function H4(n){return Uf(n)&&!Fc(n).No()&&n.fu.length>0}function X4(n){Fc(n).start()}async function Jge(n){Fc(n).eu()}async function epe(n){const e=Fc(n);for(const t of n.fu)e.Xo(t.mutations)}async function tpe(n,e,t){const i=n.fu.shift(),r=HP.from(i,e,t);await W4(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await vT(n)}async function npe(n,e){e&&Fc(n).Yo&&await async function(t,i){if(r=i.code,Vde(r)&&r!==ye.ABORTED){const s=t.fu.shift();Fc(t).Mo(),await W4(t,()=>t.remoteSyncer.rejectFailedWrite(s.batchId,i)),await vT(t)}var r}(n,e),H4(n)&&X4(n)}async function jO(n,e){const t=Et(n);t.asyncQueue.verifyOperationInProgress(),We("RemoteStore","RemoteStore received new credentials");const i=Uf(t);t._u.add(3),await A_(t),i&&t.gu.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),await _T(t)}async function ipe(n,e){const t=Et(n);e?(t._u.delete(2),await _T(t)):e||(t._u.add(2),await A_(t),t.gu.set("Unknown"))}function Ap(n){return n.pu||(n.pu=function(e,t,i){const r=Et(e);return r.su(),new Vge(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,i)}(n.datastore,n.asyncQueue,{Yr:qge.bind(null,n),Zr:Kge.bind(null,n),Wo:Yge.bind(null,n)}),n.wu.push(async e=>{e?(n.pu.Mo(),QP(n)?ZP(n):n.gu.set("Unknown")):(await n.pu.stop(),$4(n))})),n.pu}function Fc(n){return n.Iu||(n.Iu=function(e,t,i){const r=Et(e);return r.su(),new $ge(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,i)}(n.datastore,n.asyncQueue,{Yr:Jge.bind(null,n),Zr:npe.bind(null,n),tu:epe.bind(null,n),Zo:tpe.bind(null,n)}),n.wu.push(async e=>{e?(n.Iu.Mo(),await vT(n)):(await n.Iu.stop(),n.fu.length>0&&(We("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))})),n.Iu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Cc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new JP(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(ye.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function eL(n,e){if(su("AsyncQueue",`${e}: ${n}`),C_(n))return new Ue(ye.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e){this.comparator=e?(t,i)=>e(t,i)||qe.comparator(t.key,i.key):(t,i)=>qe.comparator(t.key,i.key),this.keyedMap=sy(),this.sortedSet=new Bi(this.comparator)}static emptySet(e){return new Mg(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Mg)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Mg;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(){this.Tu=new Bi(qe.comparator)}track(e){const t=e.doc.key,i=this.Tu.get(t);i?e.type!==0&&i.type===3?this.Tu=this.Tu.insert(t,e):e.type===3&&i.type!==1?this.Tu=this.Tu.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.Tu=this.Tu.remove(t):e.type===1&&i.type===2?this.Tu=this.Tu.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):at():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,i)=>{e.push(i)}),e}}class op{constructor(e,t,i,r,s,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new op(e,t,Mg.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fT(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rpe{constructor(){this.Au=void 0,this.listeners=[]}}class spe{constructor(){this.queries=new bp(e=>g4(e),fT),this.onlineState="Unknown",this.Ru=new Set}}async function ope(n,e){const t=Et(n),i=e.query;let r=!1,s=t.queries.get(i);if(s||(r=!0,s=new rpe),r)try{s.Au=await t.onListen(i)}catch(o){const a=eL(o,`Initialization of query '${pb(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.listeners.push(e),e.bu(t.onlineState),s.Au&&e.Pu(s.Au)&&tL(t)}async function ape(n,e){const t=Et(n),i=e.query;let r=!1;const s=t.queries.get(i);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),r=s.listeners.length===0)}if(r)return t.queries.delete(i),t.onUnlisten(i)}function lpe(n,e){const t=Et(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.listeners)a.Pu(r)&&(i=!0);o.Au=r}}i&&tL(t)}function upe(n,e,t){const i=Et(n),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);i.queries.delete(e)}function tL(n){n.Ru.forEach(e=>{e.next()})}class cpe{constructor(e,t,i){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=i||{}}Pu(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new op(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){if(!e.fromCache)return!0;const i=t!=="Offline";return(!this.options.Nu||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Du(e){if(e.docChanges.length>0)return!0;const t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}xu(e){e=op.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e){this.key=e}}class K4{constructor(e){this.key=e}}class hpe{constructor(e,t){this.query=e,this.qu=t,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Nt(),this.mutatedKeys=Nt(),this.Gu=p4(e),this.Qu=new Mg(this.Gu)}get ju(){return this.qu}Wu(e,t){const i=t?t.zu:new BO,r=t?t.Qu:this.Qu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,p)=>{const m=r.get(h),y=dT(this.query,p)?p:null,x=!!m&&this.mutatedKeys.has(m.key),w=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let R=!1;m&&y?m.data.isEqual(y.data)?x!==w&&(i.track({type:3,doc:y}),R=!0):this.Hu(m,y)||(i.track({type:2,doc:y}),R=!0,(l&&this.Gu(y,l)>0||u&&this.Gu(y,u)<0)&&(a=!0)):!m&&y?(i.track({type:0,doc:y}),R=!0):m&&!y&&(i.track({type:1,doc:m}),R=!0,(l||u)&&(a=!0)),R&&(y?(o=o.add(y),s=w?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),i.track({type:1,doc:h})}return{Qu:o,zu:i,$i:a,mutatedKeys:s}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const r=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const s=e.zu.Eu();s.sort((u,h)=>function(p,m){const y=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at()}};return y(p)-y(m)}(u.type,h.type)||this.Gu(u.doc,h.doc)),this.Ju(i);const o=t?this.Yu():[],a=this.Ku.size===0&&this.current?1:0,l=a!==this.Uu;return this.Uu=a,s.length!==0||l?{snapshot:new op(this.query,e.Qu,r,s,e.mutatedKeys,a===0,l,!1,!!i&&i.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new BO,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.qu=this.qu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qu=this.qu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Nt(),this.Qu.forEach(i=>{this.Zu(i.key)&&(this.Ku=this.Ku.add(i.key))});const t=[];return e.forEach(i=>{this.Ku.has(i)||t.push(new K4(i))}),this.Ku.forEach(i=>{e.has(i)||t.push(new q4(i))}),t}tc(e){this.qu=e.Hi,this.Ku=Nt();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return op.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,this.Uu===0,this.hasCachedResults)}}class fpe{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class dpe{constructor(e){this.key=e,this.nc=!1}}class gpe{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new bp(a=>g4(a),fT),this.rc=new Map,this.oc=new Set,this.uc=new Bi(qe.comparator),this.cc=new Map,this.ac=new XP,this.hc={},this.lc=new Map,this.fc=sp.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return this.dc===!0}}async function ppe(n,e){const t=Cpe(n);let i,r;const s=t.ic.get(e);if(s)i=s.targetId,t.sharedClientState.addLocalQueryTarget(i),r=s.view.ec();else{const o=await Oge(t.localStore,ou(e));t.isPrimaryClient&&j4(t.remoteStore,o);const a=t.sharedClientState.addLocalQueryTarget(o.targetId);i=o.targetId,r=await mpe(t,e,i,a==="current",o.resumeToken)}return r}async function mpe(n,e,t,i,r){n._c=(p,m,y)=>async function(x,w,R,E){let T=w.view.Wu(R);T.$i&&(T=await zO(x.localStore,w.query,!1).then(({documents:L})=>w.view.Wu(L,T)));const I=E&&E.targetChanges.get(w.targetId),A=w.view.applyChanges(T,x.isPrimaryClient,I);return $O(x,w.targetId,A.Xu),A.snapshot}(n,p,m,y);const s=await zO(n.localStore,e,!0),o=new hpe(e,s.Hi),a=o.Wu(s.documents),l=b_.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),u=o.applyChanges(a,n.isPrimaryClient,l);$O(n,t,u.Xu);const h=new fpe(e,t,o);return n.ic.set(e,h),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),u.snapshot}async function ype(n,e){const t=Et(n),i=t.ic.get(e),r=t.rc.get(i.targetId);if(r.length>1)return t.rc.set(i.targetId,r.filter(s=>!fT(s,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||await vb(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),B4(t.remoteStore,i.targetId),xb(t,i.targetId)}).catch(S_)):(xb(t,i.targetId),await vb(t.localStore,i.targetId,!0))}async function _pe(n,e,t){const i=Ipe(n);try{const r=await function(s,o){const a=Et(s),l=Gi.now(),u=o.reduce((m,y)=>m.add(y.key),Nt());let h,p;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=au(),x=Nt();return a.Gi.getEntries(m,u).next(w=>{y=w,y.forEach((R,E)=>{E.isValidDocument()||(x=x.add(R))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,y)).next(w=>{h=w;const R=[];for(const E of o){const T=Gde(E,h.get(E.key).overlayedDocument);T!=null&&R.push(new zf(E.key,T,c4(T.value.mapValue),nl.exists(!0)))}return a.mutationQueue.addMutationBatch(m,l,R,o)}).next(w=>{p=w;const R=w.applyToLocalDocumentSet(h,x);return a.documentOverlayCache.saveOverlays(m,w.batchId,R)})}).then(()=>({batchId:p.batchId,changes:I4(h)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(s,o,a){let l=s.hc[s.currentUser.toKey()];l||(l=new Bi(en)),l=l.insert(o,a),s.hc[s.currentUser.toKey()]=l}(i,r.batchId,t),await k_(i,r.changes),await vT(i.remoteStore)}catch(r){const s=eL(r,"Failed to persist write");t.reject(s)}}async function Y4(n,e){const t=Et(n);try{const i=await Mge(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.cc.get(s);o&&(pn(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.nc=!0:r.modifiedDocuments.size>0?pn(o.nc):r.removedDocuments.size>0&&(pn(o.nc),o.nc=!1))}),await k_(t,i,e)}catch(i){await S_(i)}}function VO(n,e,t){const i=Et(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.ic.forEach((s,o)=>{const a=o.view.bu(e);a.snapshot&&r.push(a.snapshot)}),function(s,o){const a=Et(s);a.onlineState=o;let l=!1;a.queries.forEach((u,h)=>{for(const p of h.listeners)p.bu(o)&&(l=!0)}),l&&tL(a)}(i.eventManager,e),r.length&&i.sc.Wo(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function vpe(n,e,t){const i=Et(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.cc.get(e),s=r&&r.key;if(s){let o=new Bi(qe.comparator);o=o.insert(s,Or.newNoDocument(s,yt.min()));const a=Nt().add(s),l=new mT(yt.min(),new Map,new ji(en),o,a);await Y4(i,l),i.uc=i.uc.remove(s),i.cc.delete(e),nL(i)}else await vb(i.localStore,e,!1).then(()=>xb(i,e,t)).catch(S_)}async function xpe(n,e){const t=Et(n),i=e.batch.batchId;try{const r=await Lge(t.localStore,e);Q4(t,i,null),Z4(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await k_(t,r)}catch(r){await S_(r)}}async function wpe(n,e,t){const i=Et(n);try{const r=await function(s,o){const a=Et(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return a.mutationQueue.lookupMutationBatch(l,o).next(h=>(pn(h!==null),u=h.keys(),a.mutationQueue.removeMutationBatch(l,h))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>a.localDocuments.getDocuments(l,u))})}(i.localStore,e);Q4(i,e,t),Z4(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await k_(i,r)}catch(r){await S_(r)}}function Z4(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function Q4(n,e,t){const i=Et(n);let r=i.hc[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.hc[i.currentUser.toKey()]=r}}function xb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.rc.get(e))n.ic.delete(i),t&&n.sc.wc(i,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(i=>{n.ac.containsKey(i)||J4(n,i)})}function J4(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);t!==null&&(B4(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),nL(n))}function $O(n,e,t){for(const i of t)i instanceof q4?(n.ac.addReference(i.key,e),Epe(n,i)):i instanceof K4?(We("SyncEngine","Document no longer in limbo: "+i.key),n.ac.removeReference(i.key,e),n.ac.containsKey(i.key)||J4(n,i.key)):at()}function Epe(n,e){const t=e.key,i=t.path.canonicalString();n.uc.get(t)||n.oc.has(i)||(We("SyncEngine","New document in limbo: "+t),n.oc.add(i),nL(n))}function nL(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new qe(Cn.fromString(e)),i=n.fc.next();n.cc.set(i,new dpe(t)),n.uc=n.uc.insert(t,i),j4(n.remoteStore,new Uh(ou(h4(t.path)),i,2,UP.at))}}async function k_(n,e,t){const i=Et(n),r=[],s=[],o=[];i.ic.isEmpty()||(i.ic.forEach((a,l)=>{o.push(i._c(l,e,t).then(u=>{if((u||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(l.targetId,u!=null&&u.fromCache?"not-current":"current"),u){r.push(u);const h=KP.Ci(l.targetId,u);s.push(h)}}))}),await Promise.all(o),i.sc.Wo(r),await async function(a,l){const u=Et(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>we.forEach(l,p=>we.forEach(p.Si,m=>u.persistence.referenceDelegate.addReference(h,p.targetId,m)).next(()=>we.forEach(p.Di,m=>u.persistence.referenceDelegate.removeReference(h,p.targetId,m)))))}catch(h){if(!C_(h))throw h;We("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const p=h.targetId;if(!h.fromCache){const m=u.qi.get(p),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);u.qi=u.qi.insert(p,x)}}}(i.localStore,s))}async function Tpe(n,e){const t=Et(n);if(!t.currentUser.isEqual(e)){We("SyncEngine","User change. New user:",e.toKey());const i=await N4(t.localStore,e);t.currentUser=e,function(r,s){r.lc.forEach(o=>{o.forEach(a=>{a.reject(new Ue(ye.CANCELLED,s))})}),r.lc.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await k_(t,i.ji)}}function Spe(n,e){const t=Et(n),i=t.cc.get(e);if(i&&i.nc)return Nt().add(i.key);{let r=Nt();const s=t.rc.get(e);if(!s)return r;for(const o of s){const a=t.ic.get(o);r=r.unionWith(a.view.ju)}return r}}function Cpe(n){const e=Et(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Y4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Spe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vpe.bind(null,e),e.sc.Wo=lpe.bind(null,e.eventManager),e.sc.wc=upe.bind(null,e.eventManager),e}function Ipe(n){const e=Et(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xpe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wpe.bind(null,e),e}class Rpe{constructor(){this.synchronizeTabs=!1}async initialize(e){this.yt=yT(e.databaseInfo.databaseId),this.sharedClientState=this.gc(e),this.persistence=this.yc(e),await this.persistence.start(),this.localStore=this.Ic(e),this.gcScheduler=this.Tc(e,this.localStore),this.indexBackfillerScheduler=this.Ec(e,this.localStore)}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return Pge(this.persistence,new Age,e.initialUser,this.yt)}yc(e){return new Rge(qP.Bs,this.yt)}gc(e){return new zge}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class bpe{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>VO(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Tpe.bind(null,this.syncEngine),await ipe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new spe}createDatastore(e){const t=yT(e.databaseInfo.databaseId),i=(r=e.databaseInfo,new Bge(r));var r;return function(s,o,a,l){return new Wge(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,r=e.asyncQueue,s=a=>VO(this.syncEngine,a,0),o=GO.C()?new GO:new Uge,new Xge(t,i,r,s,o);var t,i,r,s,o}createSyncEngine(e,t){return function(i,r,s,o,a,l,u){const h=new gpe(i,r,s,o,a,l);return u&&(h.dc=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Et(e);We("RemoteStore","RemoteStore shutting down."),t._u.add(5),await A_(t),t.mu.shutdown(),t.gu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e5(n,e,t){if(!t)throw new Ue(ye.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Ape(n,e,t,i){if(e===!0&&i===!0)throw new Ue(ye.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function WO(n){if(!qe.isDocumentKey(n))throw new Ue(ye.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function HO(n){if(qe.isDocumentKey(n))throw new Ue(ye.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function xT(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":at()}function U0(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ue(ye.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xT(n);throw new Ue(ye.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=new Map;class qO{constructor(e){var t;if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(ye.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ue(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Ape("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qO({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ue(ye.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Ue(ye.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qO(e),e.credentials!==void 0&&(this._authCredentials=function(t){if(!t)return new ide;switch(t.type){case"gapi":const i=t.client;return new ade(i,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ue(ye.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=XO.get(e);t&&(We("ComponentProvider","Removing Datastore"),XO.delete(e),t.terminate())}(this),Promise.resolve()}}function kpe(n,e,t,i={}){var r;const s=(n=U0(n,wT))._getSettings();if(s.host!=="firestore.googleapis.com"&&s.host!==e&&lb("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),i.mockUserToken){let o,a;if(typeof i.mockUserToken=="string")o=i.mockUserToken,a=Dr.MOCK_USER;else{o=_ae(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new Ue(ye.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Dr(l)}n._authCredentials=new rde(new JV(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ic(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Lo(this.firestore,e,this._key)}}class kp{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new kp(this.firestore,e,this._query)}}class Ic extends kp{constructor(e,t,i){super(e,t,h4(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lo(this.firestore,null,new qe(e))}withConverter(e){return new Ic(this.firestore,e,this._path)}}function Ppe(n,e,...t){if(n=Vr(n),e5("collection","path",e),n instanceof wT){const i=Cn.fromString(e,...t);return HO(i),new Ic(n,null,i)}{if(!(n instanceof Lo||n instanceof Ic))throw new Ue(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Cn.fromString(e,...t));return HO(i),new Ic(n.firestore,null,i)}}function t5(n,e,...t){if(n=Vr(n),arguments.length===1&&(e=e4.R()),e5("doc","path",e),n instanceof wT){const i=Cn.fromString(e,...t);return WO(i),new Lo(n,null,new qe(i))}{if(!(n instanceof Lo||n instanceof Ic))throw new Ue(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Cn.fromString(e,...t));return WO(i),new Lo(n.firestore,n instanceof Ic?n.converter:null,new qe(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lpe{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):su("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mpe{constructor(e,t,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Dr.UNAUTHENTICATED,this.clientId=e4.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async s=>{We("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(We("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ue(ye.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=eL(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Dpe(n,e){n.asyncQueue.verifyOperationInProgress(),We("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await N4(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}async function Fpe(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Ope(n);We("FirestoreClient","Initializing OnlineComponentProvider");const i=await n.getConfiguration();await e.initialize(t,i),n.setCredentialChangeListener(r=>jO(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>jO(e.remoteStore,s)),n.onlineComponents=e}async function Ope(n){return n.offlineComponents||(We("FirestoreClient","Using default OfflineComponentProvider"),await Dpe(n,new Rpe)),n.offlineComponents}async function n5(n){return n.onlineComponents||(We("FirestoreClient","Using default OnlineComponentProvider"),await Fpe(n,new bpe)),n.onlineComponents}function Npe(n){return n5(n).then(e=>e.syncEngine)}async function zpe(n){const e=await n5(n),t=e.eventManager;return t.onListen=ppe.bind(null,e.syncEngine),t.onUnlisten=ype.bind(null,e.syncEngine),t}function Upe(n,e,t={}){const i=new Cc;return n.asyncQueue.enqueueAndForget(async()=>function(r,s,o,a,l){const u=new Lpe({next:p=>{s.enqueueAndForget(()=>ape(r,h)),p.fromCache&&a.source==="server"?l.reject(new Ue(ye.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new cpe(o,u,{includeMetadataChanges:!0,Nu:!0});return ope(r,h)}(await zpe(n),n.asyncQueue,e,t,i)),i.promise}class Gpe{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new U4(this,"async_queue_retry"),this.Wc=()=>{const t=nI();t&&We("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const e=nI();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;const t=nI();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.qc)return new Promise(()=>{});const t=new Cc;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}async Jc(){if(this.Lc.length!==0){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(e){if(!C_(e))throw e;We("AsyncQueue","Operation failed with retryable error: "+e)}this.Lc.length>0&&this.xo.Ro(()=>this.Jc())}}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(i=>{this.Kc=i,this.Gc=!1;const r=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(i);throw su("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Gc=!1,i))));return this.Bc=t,t}enqueueAfterDelay(e,t,i){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const r=JP.createAndSchedule(this,e,t,i,s=>this.Yc(s));return this.Uc.push(r),r}zc(){this.Kc&&at()}verifyOperationInProgress(){}async Xc(){let e;do e=this.Bc,await e;while(e!==this.Bc)}Zc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.Uc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Uc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}class ET extends wT{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Gpe,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||r5(this),this._firestoreClient.terminate()}}function jpe(n,e){const t=typeof n=="object"?n:rP(),i=typeof n=="string"?n:e||"(default)",r=Of(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=pae("firestore");s&&kpe(r,...s)}return r}function i5(n){return n._firestoreClient||r5(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function r5(n){var e;const t=n._freezeSettings(),i=function(r,s,o,a){return new yde(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,t);n._firestoreClient=new Mpe(n._authCredentials,n._appCheckCredentials,n._queue,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ap($r.fromBase64String(e))}catch(t){throw new Ue(ye.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ap($r.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(ye.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(ye.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(ye.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return en(this._lat,e._lat)||en(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bpe=/^__.*__$/;class Vpe{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new zf(e,this.data,this.fieldMask,t,this.fieldTransforms):new R_(e,this.data,t,this.fieldTransforms)}}function o5(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at()}}class sL{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.yt=i,this.ignoreUndefinedProperties=r,s===void 0&&this.na(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new sL(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.ia({path:i,oa:!1});return r.ua(e),r}ca(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.ia({path:i,oa:!1});return r.na(),r}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return qw(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(e.length===0)throw this.ha("Document fields must not be empty");if(o5(this.sa)&&Bpe.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class $pe{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.yt=i||yT(e)}da(e,t,i,r=!1){return new sL({sa:e,methodName:t,fa:i,path:Nr.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function a5(n){const e=n._freezeSettings(),t=yT(n._databaseId);return new $pe(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Wpe(n,e,t,i,r,s={}){const o=n.da(s.merge||s.mergeFields?2:0,e,t,r);c5("Data must be an object, but it was:",o,i);const a=l5(i,o);let l,u;if(s.merge)l=new ua(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const p of s.mergeFields){const m=Xpe(e,p,t);if(!o.contains(m))throw new Ue(ye.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Kpe(h,m)||h.push(m)}l=new ua(h),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new Vpe(new Io(a),l,u)}function Hpe(n,e,t,i=!1){return oL(t,n.da(i?4:3,e))}function oL(n,e){if(u5(n=Vr(n)))return c5("Unsupported field value:",e,n),l5(n,e);if(n instanceof s5)return function(t,i){if(!o5(i.sa))throw i.ha(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i.ha(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&e.sa!==4)throw e.ha("Nested arrays are not supported");return function(t,i){const r=[];let s=0;for(const o of t){let a=oL(o,i.aa(s));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),s++}return{arrayValue:{values:r}}}(n,e)}return function(t,i){if((t=Vr(t))===null)return{nullValue:"NULL_VALUE"};if(typeof t=="number")return Dde(i.yt,t);if(typeof t=="boolean")return{booleanValue:t};if(typeof t=="string")return{stringValue:t};if(t instanceof Date){const r=Gi.fromDate(t);return{timestampValue:Hw(i.yt,r)}}if(t instanceof Gi){const r=new Gi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Hw(i.yt,r)}}if(t instanceof rL)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ap)return{bytesValue:P4(i.yt,t._byteString)};if(t instanceof Lo){const r=i.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw i.ha(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:WP(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i.ha(`Unsupported field value: ${xT(t)}`)}(n,e)}function l5(n,e){const t={};return t4(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rp(n,(i,r)=>{const s=oL(r,e.ra(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function u5(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Gi||n instanceof rL||n instanceof ap||n instanceof Lo||n instanceof s5)}function c5(n,e,t){if(!u5(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const i=xT(t);throw i==="an object"?e.ha(n+" a custom object"):e.ha(n+" "+i)}}function Xpe(n,e,t){if((e=Vr(e))instanceof iL)return e._internalPath;if(typeof e=="string")return h5(n,e);throw qw("Field path arguments must be of type string or ",n,!1,void 0,t)}const qpe=new RegExp("[~\\*/\\[\\]]");function h5(n,e,t){if(e.search(qpe)>=0)throw qw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new iL(...e.split("."))._internalPath}catch{throw qw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qw(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new Ue(ye.INVALID_ARGUMENT,a+n+l)}function Kpe(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Lo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Ype(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(aL("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Ype extends f5{data(){return super.data()}}function aL(n,e){return typeof e=="string"?h5(n,e):e instanceof iL?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zpe(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ue(ye.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lL{}class Qpe extends lL{}function KO(n,e,...t){let i=[];e instanceof lL&&i.push(e),i=i.concat(t),function(r){const s=r.filter(a=>a instanceof uL).length,o=r.filter(a=>a instanceof TT).length;if(s>1||s>0&&o>0)throw new Ue(ye.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class TT extends Qpe{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new TT(e,t,i)}_apply(e){const t=this._parse(e);return d5(e._query,t),new kp(e.firestore,e.converter,db(e._query,t))}_parse(e){const t=a5(e.firestore);return function(r,s,o,a,l,u,h){let p;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ue(ye.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){QO(h,u);const m=[];for(const y of h)m.push(ZO(a,r,y));p={arrayValue:{values:m}}}else p=ZO(a,r,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||QO(h,u),p=Hpe(o,s,h,u==="in"||u==="not-in");return wi.create(l,u,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function YO(n,e,t){const i=e,r=aL("where",n);return TT._create(r,i,t)}class uL extends lL{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new uL(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:_a.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,r){let s=i;const o=r.getFlattenedFilters();for(const a of o)d5(s,a),s=db(s,a)}(e._query,t),new kp(e.firestore,e.converter,db(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function ZO(n,e,t){if(typeof(t=Vr(t))=="string"){if(t==="")throw new Ue(ye.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!d4(e)&&t.indexOf("/")!==-1)throw new Ue(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Cn.fromString(t));if(!qe.isDocumentKey(i))throw new Ue(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return EO(n,new qe(i))}if(t instanceof Lo)return EO(n,t._key);throw new Ue(ye.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xT(t)}.`)}function QO(n,e){if(!Array.isArray(n)||n.length===0)throw new Ue(ye.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Ue(ye.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function d5(n,e){if(e.isInequality()){const i=VP(n),r=e.field;if(i!==null&&!i.isEqual(r))throw new Ue(ye.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const s=f4(n);s!==null&&Jpe(n,r,s)}const t=function(i,r){for(const s of i)for(const o of s.getFlattenedFilters())if(r.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ue(ye.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(ye.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Jpe(n,e,t){if(!t.isEqual(e))throw new Ue(ye.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class eme{convertValue(e,t="none"){switch(Ef(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(np(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw at()}}convertObject(e,t){const i={};return Rp(e.fields,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new rL(vi(e.latitude),vi(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=i4(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(F0(e));default:return null}}convertTimestamp(e){const t=Dc(e);return new Gi(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Cn.fromString(e);pn(O4(i));const r=new D0(i.get(1),i.get(3)),s=new qe(i.popFirst(5));return r.isEqual(t)||su(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tme(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nme extends f5{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new px(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(aL("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class px extends nme{data(e={}){return super.data(e)}}class ime{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new V1(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new px(this._firestore,this._userDataWriter,i.key,i,new V1(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(ye.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const a=new px(i._firestore,i._userDataWriter,o.doc.key,o.doc,new V1(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new px(i._firestore,i._userDataWriter,o.doc.key,o.doc,new V1(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:rme(o.type),doc:a,oldIndex:l,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function rme(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at()}}class sme extends eme{constructor(e){super(),this.firestore=e}convertBytes(e){return new ap(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Lo(this.firestore,null,t)}}function JO(n){n=U0(n,kp);const e=U0(n.firestore,ET),t=i5(e),i=new sme(e);return Zpe(n._query),Upe(t,n._query).then(r=>new ime(e,i,n,r))}function ome(n){return g5(U0(n.firestore,ET),[new $P(n._key,nl.none())])}function ame(n,e){const t=U0(n.firestore,ET),i=t5(n),r=tme(n.converter,e);return g5(t,[Wpe(a5(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,nl.exists(!1))]).then(()=>i)}function g5(n,e){return function(t,i){const r=new Cc;return t.asyncQueue.enqueueAndForget(async()=>_pe(await Npe(t),i,r)),r.promise}(i5(n),e)}(function(n,e=!0){(function(t){Ip=t})(h_),al(new ya("firestore",(t,{instanceIdentifier:i,options:r})=>{const s=t.getProvider("app").getImmediate(),o=new ET(new sde(t.getProvider("auth-internal")),new ude(t.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Ue(ye.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new D0(a.options.projectId,l)}(s,i),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),ko(_O,"3.8.3",n),ko(_O,"3.8.3","esm2017")})();const lme={apiKey:"AIzaSyAIuuslz-mzVUlKj0ccbQ4dbxE6t4ims5Q",authDomain:"wfrp-map-system.firebaseapp.com",projectId:"wfrp-map-system",storageBucket:"wfrp-map-system.appspot.com",messagingSenderId:"1023795605850",appId:"1:1023795605850:web:f5c1292289b85b23f54363",measurementId:"G-ST5035RYSY"},cL=Kj(lme);Jue(cL);const vs=efe(cL),p5=jpe(cL),wb=Ppe(p5,"points"),ume=new Nl,cme=async()=>{try{const n=await che(vs,ume)}catch(n){console.error(n),alert(n.message)}},hme=()=>{Gce(vs)},fme=async()=>{var i,r;let n=[];const e=(s,o)=>{var l;let a=s.data();n.push({...a,owned_by_user:a.owner_id==((l=vs==null?void 0:vs.currentUser)==null?void 0:l.uid),id:s.id})};return(await JO(KO(wb,YO("public","==",!0)))).forEach(e),(i=vs==null?void 0:vs.currentUser)!=null&&i.uid&&(await JO(KO(wb,YO("owner_id","==",((r=vs==null?void 0:vs.currentUser)==null?void 0:r.uid)||"dummy")))).forEach(e),console.table(n),n=n.filter((s,o,a)=>a.findIndex(l=>l.coordinates.join()===s.coordinates.join())===o),n},dme=async({point:n,image:e})=>{console.log("AddPoint",n);let t={created:new Date,owner_id:vs.currentUser.uid,...n,owned_by_user:void 0};delete t.owned_by_user,delete t.id,await ame(wb,t)},gme=async n=>{console.log(n),await ome(t5(p5,"points",n))};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function pme(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(i.next(h))}catch(p){o(p)}}function l(h){try{u(i.throw(h))}catch(p){o(p)}}function u(h){h.done?s(h.value):r(h.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}function mme(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(h){return l([u,h])}}function l(u){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(s=u[0]&2?r.return:u[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,u[1])).done)return s;switch(r=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,r=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(h){u=[6,h],r=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lg=function(){return lg=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},lg.apply(this,arguments)},m5=function(n){return{loading:n==null,value:n}},yme=function(){return function(n,e){switch(e.type){case"error":return lg(lg({},n),{error:e.error,loading:!1,value:void 0});case"reset":return m5(e.defaultValue);case"value":return lg(lg({},n),{error:void 0,loading:!1,value:e.value});default:return n}}},_me=function(n){var e=n?n():void 0,t=Vt.useReducer(yme(),m5(e)),i=t[0],r=t[1],s=Vt.useCallback(function(){var l=n?n():void 0;r({type:"reset",defaultValue:l})},[n]),o=Vt.useCallback(function(l){r({type:"error",error:l})},[]),a=Vt.useCallback(function(l){r({type:"value",value:l})},[]);return Vt.useMemo(function(){return{error:i.error,loading:i.loading,reset:s,setError:o,setValue:a,value:i.value}},[i.error,i.loading,s,o,a,i.value])},y5=function(n,e){var t=_me(function(){return n.currentUser}),i=t.error,r=t.loading,s=t.setError,o=t.setValue,a=t.value;return Vt.useEffect(function(){var l=Uce(n,function(u){return pme(void 0,void 0,void 0,function(){var h;return mme(this,function(p){switch(p.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return p.sent(),[3,4];case 3:return h=p.sent(),s(h),[3,4];case 4:return o(u),[2]}})})},s);return function(){l()}},[n]),[a,r,i]};const vme=({authChangeHook:n})=>{const[e,t,i]=y5(vs);return Vt.useEffect(()=>{n()},[e]),Ni("div",{children:[t?"loading":null,e?Ni("div",{children:[e.displayName," "]}):Ke("div",{children:"Sign in to save progress"}),e?Ke("button",{onClick:hme,children:"signout"}):Ke("button",{onClick:cme,children:"signin"})]})};function xme(){const[n,e,t]=y5(vs),[i,r]=Vt.useState([]),[s,o]=Vt.useState([]),[a,l]=Vt.useState(!1),[u,h]=Vt.useState(!1),p=({coordinates:R})=>{l(!0),h(R)},m=()=>{l(!1),h(null)},y=async()=>{r(await fme()||[])};return Ni("div",{className:"App",children:[Ni("div",{children:[Ke(vme,{authChangeHook:y}),Ke(lae,{points:i,selectedPoints:s,addNewPointHook:async R=>{let E={public:!1,...R,coordinates:u};await dme({point:E}),await y()},removePointHook:async R=>{await gme(R),o(s.filter(E=>E.id!=R)),await y()},addPointDialogOpen:a,closePointDialog:m,user:n})]}),Ke(iae,{points:i,setSelectedPoints:o,newLocationHook:p,addPointDialogOpen:a,user:n})]})}iI.createRoot(document.getElementById("root")).render(Ke(H1.StrictMode,{children:Ke(xme,{})}));export{Ome as L,Nme as a};
